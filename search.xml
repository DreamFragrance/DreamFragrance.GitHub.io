<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Androidæ•°æ®å­˜å‚¨</title>
    <url>/2021/09/24/Android%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/</url>
    <content><![CDATA[<h2 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h2><p>ä½œä¸ºä¸€ä¸ªå®Œæ•´çš„åº”ç”¨ç¨‹åºï¼Œä¸å¯èƒ½æ¯ä¸€æ¬¡æ‰‹æœºé‡å¯äº†ï¼Œæ•´ä¸ªåº”ç”¨ç¨‹åºå°±å’Œåˆšä¸‹è½½æ—¶å€™ä¸€æ ·ï¼Œå› æ­¤æ•°æ®çš„å­˜å‚¨ä¸æ“ä½œæ˜¯å¿…ä¸å¯å°‘çš„ã€‚Android ç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›äº†4ç§æ•°æ®å­˜å‚¨æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯ï¼šSharedPreferenceã€SQLiteã€ContentProvider å’Œæ–‡ä»¶ã€‚</p>
<span id="more"></span>
<p><br></p>
<h4 id="1-SharedPreference-å­˜å‚¨ï¼š"><a href="#1-SharedPreference-å­˜å‚¨ï¼š" class="headerlink" title="1. SharedPreference å­˜å‚¨ï¼š"></a>1. SharedPreference å­˜å‚¨ï¼š</h4><p><strong>æœ¬è´¨å°±æ˜¯åŸºäº xml æ–‡ä»¶å­˜å‚¨<code>é”®å€¼å¯¹</code>æ•°æ®ï¼Œé€šå¸¸ç”¨æ¥å­˜å‚¨ä¸€äº›ç®€å•çš„é…ç½®ä¿¡æ¯ã€‚</strong></p>
<p>   (1) getPreferencesï¼Œæ–‡ä»¶åä¸ Activity åä¸€è‡´ï¼Œæ˜¯è¯¥ Activity ç‹¬æœ‰çš„ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sharedpreference;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.SharedPreferences;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        SharedPreferences shp = getPreferences(Context.MODE_PRIVATE);</span><br><span class="line">        SharedPreferences.Editor editor = shp.edit();</span><br><span class="line">        editor.putInt(<span class="string">"data"</span>, <span class="number">1234</span>);</span><br><span class="line">        editor.apply();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ•°æ®è¢«å†™å…¥åˆ° /data/data/packageï¼ˆåŒ…åï¼‰/shared_prefs/MainActivity.xml ä¸­</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">"data"</span> <span class="attr">value</span>=<span class="string">"1234"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>â€‹    (2) getSharedPreferences ä¸ (1)ç±»ä¼¼ï¼Œå¯ä»¥è‡ªå·±è®¾ç½®æ–‡ä»¶åï¼Œ è€Œä¸”æ˜¯å…±äº«çš„ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.sharedpreference;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.SharedPreferences;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        SharedPreferences shp = getSharedPreferences(<span class="string">"SavedData"</span>, Context.MODE_PRIVATE);</span><br><span class="line">        SharedPreferences.Editor editor = shp.edit();</span><br><span class="line">        editor.putInt(<span class="string">"data"</span>, <span class="number">8888</span>);</span><br><span class="line">        editor.apply();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ•°æ®è¢«å†™å…¥åˆ° /data/data/packageï¼ˆåŒ…åï¼‰/shared_prefs/SavedData.xml ä¸­</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">int</span> <span class="attr">name</span>=<span class="string">"data"</span> <span class="attr">value</span>=<span class="string">"8888"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<p><strong>è¿ç”¨åˆ°ViewModelä¸­</strong></p>
<p>ViewModeléƒ¨åˆ†</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.androidviewmodel;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Application;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.SharedPreferences;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.AndroidViewModel;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.LiveData;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.MutableLiveData;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.SavedStateHandle;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyViewModel</span> <span class="keyword">extends</span> <span class="title">AndroidViewModel</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> SavedStateHandle handle;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyViewModel</span><span class="params">(Application application, SavedStateHandle handle)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(application);</span><br><span class="line">        <span class="keyword">this</span>.handle = handle;</span><br><span class="line">        <span class="keyword">if</span> (!handle.contains(MainActivity.KEY_NAME)) {</span><br><span class="line">            load();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> LiveData&lt;Integer&gt; <span class="title">getNumber</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> handle.getLiveData(MainActivity.KEY_NAME);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">load</span><span class="params">()</span></span>{</span><br><span class="line">        SharedPreferences shp = getApplication().getSharedPreferences(<span class="string">"data"</span>, Context.MODE_PRIVATE);</span><br><span class="line">        handle.set(MainActivity.KEY_NAME, shp.getInt(MainActivity.KEY_NAME, <span class="number">0</span>));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">()</span></span>{</span><br><span class="line">        SharedPreferences shp = getApplication().getSharedPreferences(<span class="string">"data"</span>, Context.MODE_PRIVATE);</span><br><span class="line">        SharedPreferences.Editor editor = shp.edit();</span><br><span class="line">        editor.putInt(MainActivity.KEY_NAME, handle.get(MainActivity.KEY_NAME));</span><br><span class="line">        editor.apply();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span></span>{</span><br><span class="line">        handle.set(MainActivity.KEY_NAME, getNumber().getValue() + x);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>MainaActivityéƒ¨åˆ†</p>
<p>è¿™é‡Œ viewModel.save() ä¹‹æ‰€ä»¥æ”¾åœ¨onPause() ä¸­ï¼Œæ˜¯å› ä¸ºæ¯”è¾ƒä¿é™©ï¼Œå¦‚æœæ”¾åœ¨ add() ä¸­ï¼Œæ¯åŠ ä¸€æ¬¡éƒ½è¿›è¡Œä¸€æ¬¡è¯»å†™æ“ä½œï¼Œå¼€é”€ä¼šæ¯”è¾ƒå¤§ï¼Œè€Œå¦‚æœæ”¾åœ¨onStop() æˆ– onDestory() ä¸­ï¼Œåˆä¼šé¢ä¸´ç€ä¸‡ä¸€å‡ºç°æ„æ–™ä»¥å¤–çš„é—®é¢˜æ²¡æœ‰è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•å¯¼è‡´æ•°æ®ä¸¢å¤±å°±æ¯”è¾ƒå°´å°¬äº†ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.androidviewmodel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> androidx.databinding.DataBindingUtil;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.SavedStateViewModelFactory;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModelProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.androidviewmodel.databinding.ActivityMainBinding;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> ActivityMainBinding binding;</span><br><span class="line">    <span class="keyword">private</span> MyViewModel viewModel;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String KEY_NAME = <span class="string">"Number"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        viewModel = <span class="keyword">new</span> ViewModelProvider(<span class="keyword">this</span>).get(MyViewModel.class);</span><br><span class="line">        binding = DataBindingUtil.setContentView(<span class="keyword">this</span>, R.layout.activity_main);</span><br><span class="line">        binding.setData(viewModel);</span><br><span class="line">        binding.setLifecycleOwner(<span class="keyword">this</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onPause();</span><br><span class="line">        viewModel.save();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
]]></content>
      <categories>
        <category>Android</category>
      </categories>
  </entry>
  <entry>
    <title>Activityç”Ÿå‘½å‘¨æœŸ</title>
    <url>/2021/09/23/Android%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</url>
    <content><![CDATA[<h2 id="ActivityçŠ¶æ€"><a href="#ActivityçŠ¶æ€" class="headerlink" title="ActivityçŠ¶æ€"></a>ActivityçŠ¶æ€</h2><p>Activity ç”Ÿå‘½å‘¨æœŸæ˜¯æŒ‡ Activity ä»<code>åˆ›å»º</code>åˆ°<code>é”€æ¯</code>çš„è¿‡ç¨‹ï¼Œåœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼ŒActivity ä¸€èˆ¬å¤„äº4ç§çŠ¶æ€ï¼Œå³Active/Runningã€Pausedã€Stopã€Killedã€‚</p>
<ol>
<li>Active/Runningã€‚æ­¤æ—¶ Activity ä¸€å®šå¤„äºå±å¹•çš„æœ€é¡¶ç«¯ï¼Œå¯ä»¥è¢«çœ‹åˆ°ï¼Œå¹¶ä¸”å¯ä»¥ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ã€‚å¯¹äº Activity æ ˆæ¥è¯´ï¼Œå®ƒå¤„äº<code>æ ˆé¡¶</code>ã€‚</li>
<li>Pausedã€‚æ­¤æ—¶ Activity åœ¨å±å¹•ä¸Šä»ç„¶<code>å¯è§</code>ï¼Œä½†å®ƒå·²ç»å¤±å»äº†ç„¦ç‚¹ï¼Œç”¨æˆ·ä¸èƒ½ä¸ä¹‹äº¤äº’ã€‚å¤„äºæš‚åœçš„ Activity ä»ç„¶æ˜¯å­˜æ´»çš„ï¼Œå®ƒä»ç„¶ç»´æŒç€å…¶å†…éƒ¨çš„çŠ¶æ€çš„ä¿¡æ¯ï¼Œä½†æ˜¯ç³»ç»Ÿå¯èƒ½ä¼šåœ¨å†…å­˜ä¸è¶³æ—¶æ€æ­»è¯¥ Activityã€‚</li>
<li>Stopã€‚æ­¤æ—¶ Activity åœ¨å±å¹•ä¸Šä¸èƒ½è¢«ç”¨æˆ·æ‰€è§ï¼Œå³è¯¥ Activity è¢«å…¶å®ƒ Activity æ‰€<code>é®ç›–</code>ã€‚åŒ Paused çŠ¶æ€ç±»ä¼¼ï¼Œå¤„äºåœæ­¢çŠ¶æ€çš„ Activity ä»ç„¶ä¿ç•™ç€å…¶å†…éƒ¨çš„çŠ¶æ€å’Œæˆå‘˜ä¿¡æ¯ï¼Œä½†æ˜¯ä¼šç”±äºæ‰‹æœºç³»ç»Ÿå†…å­˜è¢«å¾ç”¨è€Œè¢«ç³»ç»Ÿæ€æ­»å›æ”¶ã€‚</li>
<li>Killedã€‚Activity è¢«ç³»ç»Ÿæ€æ­»<code>å›æ”¶</code>æˆ–æœªå¯åŠ¨ã€‚</li>
</ol>
<p><br></p>
<h2 id="ç”Ÿå‘½å‘¨æœŸçš„äº‹ä»¶å›è°ƒå‡½æ•°"><a href="#ç”Ÿå‘½å‘¨æœŸçš„äº‹ä»¶å›è°ƒå‡½æ•°" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸçš„äº‹ä»¶å›è°ƒå‡½æ•°"></a>ç”Ÿå‘½å‘¨æœŸçš„äº‹ä»¶å›è°ƒå‡½æ•°</h2><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">å‡½æ•°</th>
<th style="text-align:center">æè¿°</th>
<th style="text-align:center">å¯è¢«æ€æ­»</th>
<th style="text-align:center">ä¸‹ä¸€ä¸ª</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">onCreate()</td>
<td style="text-align:center">å½“ Activity ç¬¬ä¸€æ¬¡è¢«åˆ›å»ºæ—¶è°ƒç”¨</td>
<td style="text-align:center">å¦</td>
<td style="text-align:center">onStart()</td>
</tr>
<tr>
<td style="text-align:center">onRestart()</td>
<td style="text-align:center">å½“ Activity åœæ­¢åï¼Œå†æ¬¡å¯åŠ¨å‰è°ƒç”¨</td>
<td style="text-align:center">å¦</td>
<td style="text-align:center">onStart()</td>
</tr>
<tr>
<td style="text-align:center">onStart()</td>
<td style="text-align:center">å½“ Activity æ­£è¦å˜å¾—ä¸ºç”¨æˆ·æ‰€è§æ—¶è¢«è°ƒç”¨<br>å½“ Activity è½¬å‘å‰å°æ—¶ç»§ä»¥ onResume()<br>å½“ Activity å˜ä¸ºéšè—æ—¶ç»§ä»¥ onStop()</td>
<td style="text-align:center">å¦</td>
<td style="text-align:center">onResume() <br>onStop()</td>
</tr>
<tr>
<td style="text-align:center">onResume()</td>
<td style="text-align:center">å½“ Activity å¼€å§‹ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’å‰è¢«è°ƒç”¨<br>æ­¤æ—¶ Activity ä½äºå †æ ˆé¡¶éƒ¨ï¼Œç”¨æˆ·å¯è§ã€‚ç»§ä»¥ onPause()</td>
<td style="text-align:center">å¦</td>
<td style="text-align:center">onPause()</td>
</tr>
<tr>
<td style="text-align:center">onPause()</td>
<td style="text-align:center">å½“ç³»ç»Ÿå°†è¦å¯åŠ¨å¦ä¸€ä¸ª Activity æˆ–è€…å¼¹å‡ºå¯¹è¯æ¡†æ—¶è°ƒç”¨<br>æ­¤æ–¹æ³•ä¼šå°†æ‰€æœ‰æŒä¹…æ€§æ•°æ®å†™å…¥å­˜å‚¨ä¸­ï¼Œä¸‹ä¸€ä¸ª Activity å¿…é¡»å¾…å…¶å®Œæˆæ‰èƒ½ç»§ç»­<br>å½“ Activity é‡æ–°å›åˆ°å‰å°æ—¶ç»§ä»¥ onResume()<br>å½“ Activity å˜ä¸ºç”¨æˆ·ä¸å¯è§æ—¶ç»§ä»¥ onStop()</td>
<td style="text-align:center">æ˜¯</td>
<td style="text-align:center">onResume()<br>onStop()</td>
</tr>
<tr>
<td style="text-align:center">onStop()</td>
<td style="text-align:center">å½“ Activity ä¸å†ä¸ºç”¨æˆ·å¯è§æ—¶è°ƒç”¨<br>è¿™å¯èƒ½å‘ç”Ÿåœ¨å®ƒè¢«é”€æ¯æˆ–è€…å¦ä¸€ä¸ª Activity ï¼ˆå¯èƒ½æ˜¯ç°å­˜æˆ–æ–°å»ºçš„ï¼‰å›åˆ°è¿è¡ŒçŠ¶æ€å¹¶è¦†ç›–å®ƒæ—¶<br>å¦‚æœ Activity å†æ¬¡å›åˆ°å‰å°è·Ÿç”¨æˆ·äº¤äº’åˆ™ç»§ä»¥ onRestart()<br>å¦‚æœå…³é—­ Activity åˆ™ç»§ä»¥ onDestory()</td>
<td style="text-align:center">æ˜¯</td>
<td style="text-align:center">onRestart()<br>onDestory()</td>
</tr>
<tr>
<td style="text-align:center">onDestroy()</td>
<td style="text-align:center">åœ¨ Activity é”€æ¯å‰è°ƒç”¨<br>è¿™å¯èƒ½å‘ç”Ÿåœ¨ Activity ç»“æŸï¼ˆè°ƒç”¨å®ƒçš„ finish() æ–¹æ³•ï¼‰æˆ–è€…å› ä¸ºç³»ç»Ÿéœ€è¦ä¸´æ—¶ç©ºé—´è€Œé”€æ¯è¯¥ Activity å®ä¾‹æ—¶<br>å¯ä»¥ç”¨ isFinishing() æ¥åŒºåˆ†è¿™ä¸¤ç§æƒ…å†µ</td>
<td style="text-align:center">æ˜¯</td>
<td style="text-align:center">æ— </td>
</tr>
</tbody>
</table>
</div>
<p>æ³¨ï¼šè¡¨æ ¼ä¸­â€œå¯è¢«æ€æ­»â€ä¸€åˆ—æ˜¯æŒ‡åœ¨è¯¥æ–¹æ³•è¢«è°ƒç”¨åï¼Œç³»ç»Ÿæ˜¯å¦å¯ä»¥æ€æ­»åŒ…å«æ­¤ Activity çš„è¿›ç¨‹ã€‚</p>
<p><br></p>
<p>ä¸ºäº†è·å– Activity è¢«æ€æ­»å‰çš„çŠ¶æ€ï¼Œå¯ä»¥åœ¨ Activity è¢«é”€æ¯å‰ä½¿ç”¨ onSaveInstanceState() æ–¹æ³•ã€‚</p>
<p>å®ƒä¼šå°†ä¸€ä¸ª<code>é”®å€¼å¯¹</code>æ–¹å¼è®°å½•çš„ Activity åŠ¨æ€çŠ¶æ€çš„ Bundle å¯¹è±¡ä¼ é€’ç»™è¯¥æ–¹æ³•ã€‚</p>
<p>è€Œå½“ Activity å†æ¬¡å¯åŠ¨æ—¶ï¼Œè¿™ä¸ª Bundle ä¼šä¼ é€’ç»™ onCreate() æ–¹æ³•æˆ–éšç€ onStart() æ–¹æ³•è°ƒç”¨çš„ onRestoreInstanceState()ï¼Œæ‰€ä»¥å®ƒä»¬ä¸¤ä¸ªéƒ½èƒ½æ¢å¤ä¹‹å‰ä¿å­˜çš„çŠ¶æ€ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">æ–¹æ³•</th>
<th style="text-align:center">æè¿°</th>
<th style="text-align:center">æ˜¯å¦å¯ç»ˆæ­¢</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">onSaveInstanceState()</td>
<td style="text-align:center">Android ç³»ç»Ÿå› èµ„æºä¸è¶³è€Œç»ˆæ­¢ Activity å‰è¢«è°ƒç”¨ï¼Œç”¨ä»¥ä¿å­˜ Activity çš„çŠ¶æ€ä¿¡æ¯<br>ä¾› onCreate() å’Œ onRestoreInstanceState()æ–¹æ³•æ¢å¤ä½¿ç”¨</td>
<td style="text-align:center">å¦</td>
</tr>
<tr>
<td style="text-align:center">onRestoreInstanceState()</td>
<td style="text-align:center">æ¢å¤ onSaveInstanceState() ä¿å­˜çš„ Activity çŠ¶æ€ä¿¡æ¯<br>åœ¨ onStart() å’Œ onResume() æ–¹æ³•ä¹‹é—´ä½¿ç”¨</td>
<td style="text-align:center">å¦</td>
</tr>
</tbody>
</table>
</div>
<span id="more"></span>
<p><br></p>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>Android ç•Œé¢å¦‚ä¸‹ï¼Œå½“å‰æ˜¯åœ¨ Activity1 ä¸‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/23/40dtr8.png" height="400px" width="230px"></p>
<p>ç‚¹å‡» â€œè¿›å…¥Activity2â€ï¼Œæ­¤æ—¶å…ˆè°ƒç”¨äº† onPause() ï¼ŒActivity1 å…ˆè¿›å…¥PausedçŠ¶æ€ï¼Œç„¶åå†è°ƒç”¨onCreate() -&gt; onStart() -&gt; onResume() ï¼Œæ­¤ä¹ƒåˆ›å»º Activity ä¸‰ä»¶å¥—ã€‚ç„¶å Activity1 è°ƒç”¨ onStop() è½¬å‘åå°ï¼ŒonSaveInstanceState() ä¿å­˜çŠ¶æ€ä¿¡æ¯ã€‚</p>
<div style="display: flex;justify-content: center;">
    <img src="https://z3.ax1x.com/2021/09/24/4BJI1K.png" height="400px" width="230px" style="margin: 50px;">
    <img src="https://z3.ax1x.com/2021/09/23/40wUQx.png" height="400px" width="230px" style="margin: 50px;">
</div>

<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">E/Activity1: onPause</span><br><span class="line">E/Activity2: onCreate</span><br><span class="line">E/Activity2: onStart</span><br><span class="line">E/Activity2: onResume</span><br><span class="line">E/Activity1: onStop</span><br><span class="line">E/Activity1: onSaveInstanceState</span><br></pre></td></tr></tbody></table></figure>
<p>éšå³ç‚¹å‡»â€œè¿›å…¥ Activity1 â€å›åˆ°ä¸»ç•Œé¢ï¼Œä¸ä¸Šé¢æƒ…å†µç±»ä¼¼ï¼Œæ˜¯å…ˆæš‚åœ Activity2ï¼Œè€Œå<code>åˆ›å»º</code>Activity1ï¼Œåœ¨ä¿å­˜ Activity2 çš„çŠ¶æ€ä¿¡æ¯ã€‚</p>
<div style="display: flex;justify-content: center;">
    <img src="https://z3.ax1x.com/2021/09/24/4BNr1P.png" height="400px" width="230px" style="margin: 50px;">
    <img src="https://z3.ax1x.com/2021/09/23/40dtr8.png" height="400px" width="230px" style="margin: 50px;">
</div>

<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">E/Activity2: onPause</span><br><span class="line">E/Activity1: onCreate</span><br><span class="line">E/Activity1: onStart</span><br><span class="line">E/Activity1: onResume</span><br><span class="line">E/Activity2: onStop</span><br><span class="line">E/Activity2: onSaveInstanceState</span><br></pre></td></tr></tbody></table></figure>
<p>ä½†å¦‚æœä½¿ç”¨çš„æ˜¯ç‰©ç†æŒ‰é”®<span class="github-emoji" style="display:inline;vertical-align:middle"><span>â—€</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/25c0.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span>ï¼Œåˆ™æ˜¯<code>é‡å¯</code> Activity1ï¼Œç„¶åæŠŠ Activity2 <code>é”€æ¯</code>ã€‚</p>
<div style="display: flex;justify-content: center;">
    <img src="https://z3.ax1x.com/2021/09/24/4BNocV.png" height="400px" width="230px" style="margin: 50px;">
    <img src="https://z3.ax1x.com/2021/09/23/40dtr8.png" height="400px" width="230px" style="margin: 50px;">
</div>

<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">E/Activity2: onPause</span><br><span class="line">E/Activity1: onRestart</span><br><span class="line">E/Activity1: onStart</span><br><span class="line">E/Activity1: onResume</span><br><span class="line">E/Activity2: onStop</span><br><span class="line">E/Activity2: onDestroy</span><br></pre></td></tr></tbody></table></figure>
<p>æœ€åæˆ‘ä»¬å°è¯•ä¸€ä¸‹ç‚¹å‡»â€œè¿›å…¥ Activity3 â€ï¼Œä¼šè·³å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œæ­¤æ—¶ Activity1 è¿˜æ˜¯å¯è§çš„ã€‚</p>
<p>å› æ­¤æ˜¯æ²¡æœ‰ onStop() ï¼ˆåœæ­¢ Activityï¼‰å’Œ onSaveInstanceState() ï¼ˆä¿å­˜ Activity çŠ¶æ€ä¿¡æ¯ï¼‰è¿™ä¸€æ­¥çš„ã€‚</p>
<div style="display: flex;justify-content: center;">
    <img src="https://z3.ax1x.com/2021/09/24/4BNx91.png" height="400px" width="230px" style="margin: 50px;">
    <img src="https://z3.ax1x.com/2021/09/24/4BUPBD.png" height="400px" width="230px" style="margin: 50px;">
</div>

<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">E/Activity1: onPause</span><br><span class="line">E/Activity3: onCreate</span><br><span class="line">E/Activity3: onStart</span><br><span class="line">E/Activity3: onResume</span><br></pre></td></tr></tbody></table></figure>
<p>ç‚¹å‡»å¯¹è¯æ¡†å¤–é¢å…³é—­è¯¥å¯¹è¯æ¡†ï¼Œæ˜¯å…ˆæš‚åœ Activity3ï¼Œéšå³ Activity1 è°ƒç”¨ onResume()ï¼Œä½¿å¾—å®ƒå¯ä»¥ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ï¼Œæœ€ååœæ­¢å¹¶é”€æ¯ Activity3ã€‚</p>
<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">E/Activity3: onPause</span><br><span class="line">E/Activity1: onResume</span><br><span class="line">E/Activity3: onStop</span><br><span class="line">E/Activity3: onDestroy</span><br></pre></td></tr></tbody></table></figure>
]]></content>
      <categories>
        <category>Android</category>
      </categories>
  </entry>
  <entry>
    <title>Hexoä½¿ç”¨è‡ªå®šä¹‰çš„CSSå’ŒJS</title>
    <url>/2021/08/26/Hexo%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84CSS%E5%92%8CJS/</url>
    <content><![CDATA[<h2 id="Hexoçš„æ‰§è¡Œé€»è¾‘"><a href="#Hexoçš„æ‰§è¡Œé€»è¾‘" class="headerlink" title="Hexoçš„æ‰§è¡Œé€»è¾‘"></a>Hexoçš„æ‰§è¡Œé€»è¾‘</h2><p>Hexoæ˜¯æ ¹æ®ç”¨æˆ·å†™çš„mdæ–‡ä»¶è¿›è¡Œæ¸²æŸ“ï¼Œå¾—åˆ°å¯¹åº”çš„htmlæ–‡ä»¶åœ¨ç½‘ç«™ä¸Šæ˜¾ç¤ºã€‚ä½†æœ‰çš„æ—¶å€™ä¼šéœ€è¦è‡ªå®šä¹‰é¡µé¢ï¼Œå½“ç„¶Hexoä¹Ÿç»™æˆ‘ä»¬é¢„ç•™äº†è§£å†³æ–¹æ¡ˆã€‚</p>
<p>è¿™é‡Œæˆ‘è¦å®ç°çš„æ•ˆæœå°±æ˜¯æ–°å»ºä¸€ä¸ªæ¸¸æˆæ ‡ç­¾é¡µï¼Œæ•ˆæœå¦‚ä¸‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/08/29/hG12W9.png" alt="game"></p>
<p><br></p>
<h2 id="åˆ›å»ºæ ‡ç­¾"><a href="#åˆ›å»ºæ ‡ç­¾" class="headerlink" title="åˆ›å»ºæ ‡ç­¾"></a>åˆ›å»ºæ ‡ç­¾</h2><p>é¦–å…ˆï¼Œè¦æ–°å»ºä¸€ä¸ªæ ‡ç­¾é¡µé¢å°±éœ€è¦åœ¨NexTçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ ‡ç­¾ä»¥åŠå¯¹åº”è·¯ç”±ã€‚</p>
<p>å…¶ä¸­<code>fa fa-gamepad</code>æ˜¯<a href="http://www.fontawesome.com.cn">Font Awesome</a>æä¾›çš„çŸ¢é‡å›¾æ ‡ã€‚</p>
<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: / || fa fa-home</span><br><span class="line">  #about: /about/ || fa fa-user</span><br><span class="line">  tags: /tags/ || fa fa-tags</span><br><span class="line">  categories: /categories/ || fa fa-th</span><br><span class="line">  archives: /archives/ || fa fa-archive</span><br><span class="line">  #schedule: /schedule/ || fa fa-calendar</span><br><span class="line">  #sitemap: /sitemap.xml || fa fa-sitemap</span><br><span class="line">  #commonweal: /404/ || fa fa-heartbeat</span><br><span class="line">  game: /game/ || fa fa-gamepad</span><br></pre></td></tr></tbody></table></figure>
<p>å¦‚æœä¸æƒ³è¦è‹±æ–‡çš„æ ‡ç­¾çš„è¯ï¼Œä»¥ä¸­æ–‡ä¸¾ä¾‹ï¼Œå¯ä»¥åˆ°<code>themes/next/languages/zh-CN.yml</code>ä¸‹æ·»åŠ gameå¯¹åº”çš„ä¸­æ–‡ã€‚</p>
<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: é¦–é¡µ</span><br><span class="line">  archives: å½’æ¡£</span><br><span class="line">  categories: åˆ†ç±»</span><br><span class="line">  tags: æ ‡ç­¾</span><br><span class="line">  about: å…³äº</span><br><span class="line">  search: æœç´¢</span><br><span class="line">  schedule: æ—¥ç¨‹è¡¨</span><br><span class="line">  sitemap: ç«™ç‚¹åœ°å›¾</span><br><span class="line">  commonweal: å…¬ç›Š 404</span><br><span class="line">  game: æ¸¸æˆ</span><br></pre></td></tr></tbody></table></figure>
<p>ç„¶åä½¿ç”¨gitå‘½ä»¤<code>hexo new page game</code>ï¼Œåˆ›å»º/gameå¯¹åº”mdæ–‡ä»¶ã€‚</p>
<p>æ³¨ï¼šå¦‚éœ€æ›´æ”¹ä¸€äº›å…¨å±€æ ·å¼ï¼Œå¯åˆ°Nexté…ç½®æ–‡ä»¶çš„<code>custom_file_path</code>ä¸­ä¿®æ”¹</p>
<span id="more"></span>
<p><br></p>
<h2 id="è‡ªå®šä¹‰æ¸²æŸ“"><a href="#è‡ªå®šä¹‰æ¸²æŸ“" class="headerlink" title="è‡ªå®šä¹‰æ¸²æŸ“"></a>è‡ªå®šä¹‰æ¸²æŸ“</h2><p>è‡ªå®šä¹‰æ¸²æŸ“åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯ä¸»é¢˜å†…æ¸²æŸ“ï¼Œä¸€ç§æ˜¯å®Œå…¨é¡µé¢æ¸²æŸ“ã€‚</p>
<h4 id="1-ä¸»é¢˜å†…æ¸²æŸ“"><a href="#1-ä¸»é¢˜å†…æ¸²æŸ“" class="headerlink" title="1.ä¸»é¢˜å†…æ¸²æŸ“"></a>1.ä¸»é¢˜å†…æ¸²æŸ“</h4><p><code>layout: false</code>è¡¨ç¤ºè¯¥mdä¸ä¼šç»è¿‡layoutçš„æ¸²æŸ“ã€‚</p>
<p>åŒæ—¶å¯ä»¥ä¿å­˜æ·»åŠ çš„æ¨¡å—ï¼Œä¸»é¢˜çš„å¤´éƒ¨ä¿¡æ¯ï¼Œä»…å¯¹ä¸»ä½“éƒ¨åˆ†è¿›è¡Œè‡ªå®šä¹‰ã€‚</p>
<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">title: game</span><br><span class="line">date: 2021-08-26 15:45:42</span><br><span class="line">layout: false</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™é‡Œå¤´éƒ¨çš„å¯¼èˆªæ ä»¥åŠä¾§è¾¹çš„ç»Ÿè®¡æ éƒ½æ˜¯ä¿å­˜çš„ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/08/29/hG12W9.png" alt="game"></p>
<h4 id="2-å®Œå…¨é¡µé¢æ¸²æŸ“"><a href="#2-å®Œå…¨é¡µé¢æ¸²æŸ“" class="headerlink" title="2.å®Œå…¨é¡µé¢æ¸²æŸ“"></a>2.å®Œå…¨é¡µé¢æ¸²æŸ“</h4><p>åœ¨Hexoçš„é…ç½®æ–‡ä»¶ä¸­ï¼Œ<code>skip_render</code>ç”¨æ¥é…ç½®è·³è¿‡æ¸²æŸ“çš„æ–‡ä»¶ã€‚</p>
<p>ä¾‹ï¼š<code>skip_render: game/*</code>ï¼ŒæŒ‡game/ä¸‹çš„æ–‡ä»¶ä¸ä¼šè¢«æ¸²æŸ“ã€‚</p>
<p>è‹¥æ˜¯<code>game/**</code>åˆ™ä»£è¡¨ç›®å½•é€’å½’ï¼ŒåŒ…å«å­ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚</p>
<p>æˆ–æ˜¯æŒ‡å®šæŸä¸ªæ–‡ä»¶ï¼š<code>game/index.md</code></p>
<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line"><span class="section"># Directory</span></span><br><span class="line">source<span class="emphasis">_dir: source</span></span><br><span class="line"><span class="emphasis">public_</span>dir: public</span><br><span class="line">tag<span class="emphasis">_dir: tags</span></span><br><span class="line"><span class="emphasis">archive_</span>dir: archives</span><br><span class="line">category<span class="emphasis">_dir: categories</span></span><br><span class="line"><span class="emphasis">code_</span>dir: downloads/code</span><br><span class="line">i18n<span class="emphasis">_dir: :lang</span></span><br><span class="line"><span class="emphasis">skip_</span>render: game/<span class="emphasis">*</span></span><br></pre></td></tr></tbody></table></figure>
<p>å®Œå…¨é¡µé¢æ¸²æŸ“æ­£å¦‚å…¶åï¼Œä¸ä¼šåŒ…å«ä¸»é¢˜æ¨¡å—ç­‰ä¿¡æ¯ï¼Œå…¨æƒç”±è‡ªå·±æ¥è®¾è®¡ã€‚</p>
<p>è¿™é‡Œæˆ‘è¿˜æ²¡æœ‰æ·»åŠ CSSå’ŒJSã€‚</p>
<p><img src="https://z3.ax1x.com/2021/08/29/hG1fQ1.png" alt="example2"></p>
<p><br></p>
<h2 id="è‡ªå®šä¹‰CSS"><a href="#è‡ªå®šä¹‰CSS" class="headerlink" title="è‡ªå®šä¹‰CSS"></a>è‡ªå®šä¹‰CSS</h2><p>ä¸»é¢˜å†…æ¸²æŸ“ç”±äºå¤´éƒ¨ä¿¡æ¯æ˜¯ä¸»é¢˜ç»™å®šçš„ï¼Œå› æ­¤CSSä¸èƒ½ç›´æ¥ä½¿ç”¨htmlçš„<code>&lt;style&gt;</code>å¯¼å…¥CSSï¼ŒJSåŒç†ã€‚</p>
<p>æ‰€ä»¥éœ€è¦ç›´æ¥ç»™NexTæ·»åŠ æˆ‘ä»¬éœ€è¦çš„CSSæ–‡ä»¶ã€‚</p>
<p>åœ¨<code>themes/next/source/css</code>ä¸­ï¼Œé¦–å…ˆåˆ›å»ºCSSæ–‡ä»¶çš„ç›®å½•ï¼Œä¸ºäº†ä¸ä¸»é¢˜è‡ªå¸¦çš„CSSåŒºåˆ†å¼€ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹<code>_mycss</code>ï¼Œç„¶ååˆ›å»º<code>game.styl</code>ï¼Œä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line">.game_img *,.game_img *:after,.game_img *:before { -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; }</span><br><span class="line">body .game_img, html .game_img { font-size: 100%; padding: 0; margin: 0;}</span><br><span class="line">body .game_img{</span><br><span class="line">	font-family: 'Lato', Calibri, Arial, sans-serif;</span><br><span class="line">	color: #b3b9bf;</span><br><span class="line">	background: #f9f9f9;</span><br><span class="line">}</span><br><span class="line">.game_img a {</span><br><span class="line">	color: #888;</span><br><span class="line">	text-decoration: none;</span><br><span class="line">}</span><br><span class="line">.game_img a:hover,.game_img a:active {</span><br><span class="line">	color: #333;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.grid {</span><br><span class="line">	padding: 20px 20px 100px 20px;</span><br><span class="line">	max-width: 1300px;</span><br><span class="line">	margin: 0 auto;</span><br><span class="line">	list-style: none;</span><br><span class="line">	text-align: center;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.grid li {</span><br><span class="line">	display: inline-block;</span><br><span class="line">	width: 350px;</span><br><span class="line">	margin: 0;</span><br><span class="line">	padding: 20px;</span><br><span class="line">	text-align: left;</span><br><span class="line">	position: relative;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.grid figure {</span><br><span class="line">	margin: 0;</span><br><span class="line">	position: relative;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.grid figure img {</span><br><span class="line">	max-width: 100%;</span><br><span class="line">	display: block;</span><br><span class="line">	position: relative;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.grid figcaption {</span><br><span class="line">	position: absolute;</span><br><span class="line">	top: 0;</span><br><span class="line">	left: 0;</span><br><span class="line">	padding: 20px;</span><br><span class="line">	background: #2c3f52;</span><br><span class="line">	color: #ed4e6e;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.grid figcaption h3 {</span><br><span class="line">	margin: 0;</span><br><span class="line">	padding: 0;</span><br><span class="line">	color: #fff;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.grid figcaption span:before {</span><br><span class="line">	content: 'by ';</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.grid figcaption a {</span><br><span class="line">	text-align: center;</span><br><span class="line">	padding: 5px 10px;</span><br><span class="line">	border-radius: 2px;</span><br><span class="line">	display: inline-block;</span><br><span class="line">	background: #ed4e6e;</span><br><span class="line">	color: #fff;</span><br><span class="line">}</span><br><span class="line">   </span><br><span class="line">/* è¯´æ˜æ–‡å­—æ ·å¼ 1 */</span><br><span class="line"></span><br><span class="line">.cs-style-1 figcaption {</span><br><span class="line">	height: 100%;</span><br><span class="line">	width: 100%;</span><br><span class="line">	opacity: 0;</span><br><span class="line">	text-align: center;</span><br><span class="line">	-webkit-backface-visibility: hidden;</span><br><span class="line">	-moz-backface-visibility: hidden;</span><br><span class="line">	backface-visibility: hidden;</span><br><span class="line">	-webkit-transition: -webkit-transform 0.3s, opacity 0.3s;</span><br><span class="line">	-moz-transition: -moz-transform 0.3s, opacity 0.3s;</span><br><span class="line">	transition: transform 0.3s, opacity 0.3s;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.no-touch .cs-style-1 figure:hover figcaption,</span><br><span class="line">.cs-style-1 figure.cs-hover figcaption {</span><br><span class="line">	opacity: 1;</span><br><span class="line">	-webkit-transform: translate(15px, 15px);</span><br><span class="line">	-moz-transform: translate(15px, 15px);</span><br><span class="line">	-ms-transform: translate(15px, 15px);</span><br><span class="line">	transform: translate(15px, 15px);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.cs-style-1 figcaption h3 {</span><br><span class="line">	margin-top: 35px;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.cs-style-1 figcaption span {</span><br><span class="line">	display: block;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">.cs-style-1 figcaption a {</span><br><span class="line">	margin-top: 20px;</span><br><span class="line">} </span><br></pre></td></tr></tbody></table></figure>
<p>ç„¶åè¿”å›ä¸Šä¸€çº§ç›®å½•ï¼Œç°åœ¨åœ¨<code>themes/next/source/css</code>ä¸­ï¼Œæ‰“å¼€<code>main.styl</code>åœ¨å°¾éƒ¨æ·»åŠ å¦‚ä¸‹ä»£ç ï¼Œå°†æˆ‘ä»¬çš„CSSå¯¼å…¥è¿›æ¥å°±å¥½äº†ï¼</p>
<p>ä¸€å®šè¦åŠ æ³¨é‡Šï¼ä¸ç„¶è¿‡å‡ å¤©éƒ½ä¸çŸ¥é“è¿™ä¸€æ®µCSSæ˜¯å¹²ä»€ä¹ˆç”¨çš„ã€‚</p>
<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">//Games</span><br><span class="line">@import "<span class="emphasis">_mycss/game";</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h2 id="è‡ªå®šä¹‰JS"><a href="#è‡ªå®šä¹‰JS" class="headerlink" title="è‡ªå®šä¹‰JS"></a>è‡ªå®šä¹‰JS</h2><p>åŒCSSä¸€æ ·ï¼Œæ¥åˆ°<code>themes/next/source/js</code>ä¸‹ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„JSæ–‡ä»¶å¤¹<code>game</code>ï¼Œç„¶åå°†æˆ‘ä»¬é¢„å…ˆä¸‹è½½å¥½çš„<code>modernizr.custom.js</code>æ”¾åœ¨è¯¥ç›®å½•ä¸‹ï¼Œå‡†å¤‡å·¥ä½œå°±å®Œæ¯•äº†ã€‚</p>
<p>ç„¶åå°±éœ€è¦å¯¼å…¥JSæ–‡ä»¶ï¼Œæˆ‘ä»¬æ‰“å¼€<code>themes/next/layout/_layout.swig</code>ï¼Œåœ¨<code>&lt;head&gt;</code>æ ‡ç­¾ä¸‹ï¼Œæ·»åŠ JSè·¯å¾„ï¼Œå°±å¤§åŠŸå‘Šæˆäº†ï¼</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/js/game/modernizr.custom.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h2 id="HTMLä»£ç "><a href="#HTMLä»£ç " class="headerlink" title="HTMLä»£ç "></a>HTMLä»£ç </h2><p>æœ€åé™„ä¸Šæˆ‘çš„HTMLä»£ç ï¼Œç›®å‰åªæœ‰ä¸€ä¸ªæ¡†æ¶ï¼Œæ¸¸æˆè¿˜æ²¡æœ‰å†™<span class="github-emoji" style="display:inline;vertical-align:middle"><span>ğŸŒ</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f31d.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"game_img"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"grid cs-style-1"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">figure</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/uploads/images/tetris.jpg"</span> <span class="attr">alt</span>=<span class="string">"img04"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">figcaption</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">h3</span>&gt;</span>ä¿„ç½—æ–¯æ–¹å—<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">span</span>&gt;</span>DeFlory<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Take a look<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">figcaption</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">figure</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">figure</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/uploads/images/tetris.jpg"</span> <span class="attr">alt</span>=<span class="string">"img04"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">figcaption</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">h3</span>&gt;</span>ä¿„ç½—æ–¯æ–¹å—<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">span</span>&gt;</span>DeFlory<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Take a look<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">figcaption</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">figure</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">figure</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/uploads/images/tetris.jpg"</span> <span class="attr">alt</span>=<span class="string">"img04"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">figcaption</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">h3</span>&gt;</span>ä¿„ç½—æ–¯æ–¹å—<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">span</span>&gt;</span>DeFlory<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>Take a look<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">figcaption</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">figure</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>å…¥é—¨</tag>
      </tags>
  </entry>
  <entry>
    <title>KNNç®—æ³•</title>
    <url>/2021/09/12/KNN%E7%AE%97%E6%B3%95/</url>
    <content><![CDATA[<h2 id="ç®—æ³•æ€æƒ³"><a href="#ç®—æ³•æ€æƒ³" class="headerlink" title="ç®—æ³•æ€æƒ³"></a>ç®—æ³•æ€æƒ³</h2><p>KNNç®—æ³•éœ€è¦å…ˆç»™å®šä¸€ç»„å¸¦æœ‰æ ‡ç­¾çš„æ•°æ®ï¼Œéœ€è¦é¢„æµ‹çš„æ•°æ®åªéœ€å’Œç°æœ‰çš„æ•°æ®æµ‹å‡ºâ€œè·ç¦»â€ï¼Œé€‰å‡ºæœ€è¿‘çš„Kä¸ªã€‚</p>
<p>å¦‚æœæ˜¯åˆ†ç±»é—®é¢˜å°±é€‰æ‹©å¤šæ•°çš„é‚£ä¸ªæ ·æœ¬ç±»åˆ«ï¼Œæ˜¯å›å½’é—®é¢˜å°±å–å¹³å‡å€¼å³å¯ã€‚</p>
<p>å› æ­¤Kçš„é€‰æ‹©ä¸€èˆ¬éƒ½æ˜¯å¥‡æ•°ï¼Œä¸ä¼šå‡ºç°å¹³ç¥¨çš„æƒ…å†µã€‚</p>
<p>æ³¨ï¼šKNNå…¨ç§°K-Nearest Neighborï¼Œä¹Ÿå«ä½œKè¿‘é‚»ç®—æ³•ã€‚</p>
<p><br></p>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line">x1 = np.random.random(<span class="number">100</span>) * <span class="number">10</span></span><br><span class="line">x2 = np.random.random(<span class="number">100</span>) * <span class="number">10</span></span><br><span class="line">y = (x1 &lt; <span class="number">5</span>) &amp; (x2 &lt; <span class="number">5</span>)</span><br><span class="line">y.dtype = np.int8</span><br><span class="line"></span><br><span class="line">plt.scatter(x1[y], x2[y], color = <span class="string">"red"</span>)</span><br><span class="line">plt.scatter(x1[~y], x2[~y], color = <span class="string">"blue"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™é‡Œæˆ‘éšæœºåˆ›å»ºäº†ä¸€ç»„æ•°æ®</p>
<p><img src="https://z3.ax1x.com/2021/09/12/4SxwnK.png" alt=""></p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">z_x1 = np.random.random() * <span class="number">10</span></span><br><span class="line">z_x2 = np.random.random() * <span class="number">10</span></span><br><span class="line">y = y.dtype.int8</span><br><span class="line"></span><br><span class="line">distance = np.sqrt(np.square(x1 - z_x1) + np.square(x2 - z_x2))</span><br><span class="line">distance_nearest = np.argsort(distance)</span><br><span class="line"></span><br><span class="line"><span class="string">''' distance_nearest</span></span><br><span class="line"><span class="string">array([94, 20, 11, 23, 52, 62, 63, 51, 81, 60, 85, 73, 84, 70, 25, 59, 90,</span></span><br><span class="line"><span class="string">       29, 82, 46, 35, 38, 71, 61, 66, 49, 22, 76,  0, 68, 58,  6, 13,  8,</span></span><br><span class="line"><span class="string">       54, 98, 56, 80, 48, 78, 86, 10, 50, 44, 93, 16, 67, 92, 64, 41, 95,</span></span><br><span class="line"><span class="string">       91, 79, 83, 53,  9, 88,  1, 24, 45, 87, 89, 21, 34, 32, 33, 28, 72,</span></span><br><span class="line"><span class="string">       17, 69, 77, 40, 27, 39,  2,  7, 96, 65, 42, 14, 31,  4, 47, 97, 18,</span></span><br><span class="line"><span class="string">        3, 57, 36, 30, 37, 15, 43,  5, 26, 12, 74, 55, 99, 75, 19],</span></span><br><span class="line"><span class="string">      dtype=int64)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">plt.scatter(x1[y], x2[y], color = <span class="string">"red"</span>)</span><br><span class="line">plt.scatter(x1[~y], x2[~y], color = <span class="string">"blue"</span>)</span><br><span class="line">plt.scatter(z_x1, z_x2, color = <span class="string">"cyan"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/12/4p1ai4.png" alt=""></p>
<p>è¿™é‡Œæˆ‘éšæœºç”Ÿæˆäº†ä¸€ä¸ªæµ…è“è‰²çš„ç‚¹ï¼Œæ˜¾è€Œæ˜“è§ï¼Œä»–åº”è¯¥æ˜¯å±äºè“è‰²è¿™ä¸€ç±»çš„ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å»æ±‚å®ƒå’Œç°æœ‰æ•°æ®çš„æ¬§æ‹‰è·ç¦»$d = \sqrt{(x - x_1)^2 +(x-x_2)^2}$ï¼Œå½“ç„¶æ›¼å“ˆé¡¿è·ç¦»æˆ–æ˜¯é—µå¯å¤«æ–¯åŸºè·ç¦»ã€‚</p>
<p>å–å‡ºå‰Kä¸ªè¿›è¡ŒæŠ•ç¥¨å³å¯ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">distance = np.sqrt(np.square(x1 - z_x1) + np.square(x2 - z_x2))</span><br><span class="line">distance_nearest = np.argsort(distance)</span><br><span class="line"></span><br><span class="line"><span class="string">""" distance_nearest</span></span><br><span class="line"><span class="string">array([94, 20, 11, 23, 52, 62, 63, 51, 81, 60, 85, 73, 84, 70, 25, 59, 90,</span></span><br><span class="line"><span class="string">       29, 82, 46, 35, 38, 71, 61, 66, 49, 22, 76,  0, 68, 58,  6, 13,  8,</span></span><br><span class="line"><span class="string">       54, 98, 56, 80, 48, 78, 86, 10, 50, 44, 93, 16, 67, 92, 64, 41, 95,</span></span><br><span class="line"><span class="string">       91, 79, 83, 53,  9, 88,  1, 24, 45, 87, 89, 21, 34, 32, 33, 28, 72,</span></span><br><span class="line"><span class="string">       17, 69, 77, 40, 27, 39,  2,  7, 96, 65, 42, 14, 31,  4, 47, 97, 18,</span></span><br><span class="line"><span class="string">        3, 57, 36, 30, 37, 15, 43,  5, 26, 12, 74, 55, 99, 75, 19],</span></span><br><span class="line"><span class="string">      dtype=int64)</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="string">""" distance_nearest[:6]</span></span><br><span class="line"><span class="string">array([94, 20, 11, 23, 52, 62], dtype=int64)</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">counter = Counter(y[distance_nearest[:<span class="number">6</span>]])		<span class="comment"># Counter({0: 6})</span></span><br><span class="line">counter.most_common(<span class="number">1</span>)							<span class="comment"># [(0, 6)]</span></span><br><span class="line">counter.most_common(<span class="number">1</span>)[<span class="number">0</span>][<span class="number">0</span>]					<span class="comment"># 0</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KNN</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, neighbour</span>):</span></span><br><span class="line">        self.neighbour = neighbour</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span>(<span class="params">self, X, y</span>):</span></span><br><span class="line">        self.data = X</span><br><span class="line">        self.label = y</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span>(<span class="params">self, X_test</span>):</span></span><br><span class="line">        distance = [np.square(x - x1) <span class="keyword">for</span> X_data <span class="keyword">in</span> self.data </span><br><span class="line">                    				  <span class="keyword">for</span> x,x1 <span class="keyword">in</span> <span class="built_in">zip</span>(X_data,X_test)]</span><br><span class="line">        distance = np.sqrt(np.<span class="built_in">sum</span>(distance))</span><br><span class="line">        distance_sorted_idx = np.argsort(distance)</span><br><span class="line">        distance_sorted_idx_top_k = distance_sorted_idx[:self.neighbour]</span><br><span class="line">        counter = Counter(self.label[distance_sorted_idx_top_k])</span><br><span class="line">        <span class="keyword">return</span> counter.most_common(<span class="number">1</span>)[<span class="number">0</span>][<span class="number">0</span>]</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>æ•°æ®ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰éšæœºå‡ºæ¥çš„æ•°æ®ï¼Œæµ‹è¯•ç»“æœä¸åŸç»“æœä¸€è‡´</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># [100, 2]</span></span><br><span class="line">X = np.vstack([x1, x2])</span><br><span class="line">Z = np.vstack([z_x1, z_x2])</span><br><span class="line"><span class="comment"># [2, 100]</span></span><br><span class="line">X = np.transpose(X)</span><br><span class="line">Z = np.transpose(Z)</span><br><span class="line"></span><br><span class="line">knn_clf = KNN(<span class="number">3</span>)</span><br><span class="line">knn_clf.fit(X,y)</span><br><span class="line">knn_clf.transform(Z)			<span class="comment"># 0</span></span><br></pre></td></tr></tbody></table></figure>
]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
  </entry>
  <entry>
    <title>Markdownå…¥é—¨</title>
    <url>/2021/08/20/MarkDown%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="MarkDownå…¥é—¨"><a href="#MarkDownå…¥é—¨" class="headerlink" title="MarkDownå…¥é—¨"></a>MarkDownå…¥é—¨</h1><h2 id="1-ä»£ç å—"><a href="#1-ä»£ç å—" class="headerlink" title="1. ä»£ç å—"></a>1. ä»£ç å—</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">```python</span><br><span class="line">    </span><br><span class="line">`è¡Œå†…ä»£ç å—`</span><br></pre></td></tr></tbody></table></figure>
<p><strong>pythonä»£ç </strong></p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="built_in">sum</span> += i</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">sum</span>)</span><br></pre></td></tr></tbody></table></figure>
<p><code>è¡Œå†…ä»£ç å—</code></p>
<h2 id="2-æ ‡é¢˜"><a href="#2-æ ‡é¢˜" class="headerlink" title="2. æ ‡é¢˜"></a>2. æ ‡é¢˜</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸€çº§æ ‡é¢˜</span></span><br><span class="line"><span class="comment">## äºŒçº§æ ‡é¢˜</span></span><br><span class="line"><span class="comment">### ä¸‰çº§æ ‡é¢˜</span></span><br><span class="line"><span class="comment">#### å››çº§æ ‡é¢˜</span></span><br><span class="line"><span class="comment">##### äº”çº§æ ‡é¢˜</span></span><br><span class="line"><span class="comment">###### å…­çº§æ ‡é¢˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ€å¤šæ”¯æŒå…­çº§æ ‡é¢˜</span></span><br></pre></td></tr></tbody></table></figure>
<h1 id="ä¸€çº§æ ‡é¢˜"><a href="#ä¸€çº§æ ‡é¢˜" class="headerlink" title="ä¸€çº§æ ‡é¢˜"></a>ä¸€çº§æ ‡é¢˜</h1><h2 id="äºŒçº§æ ‡é¢˜"><a href="#äºŒçº§æ ‡é¢˜" class="headerlink" title="äºŒçº§æ ‡é¢˜"></a>äºŒçº§æ ‡é¢˜</h2><h3 id="ä¸‰çº§æ ‡é¢˜"><a href="#ä¸‰çº§æ ‡é¢˜" class="headerlink" title="ä¸‰çº§æ ‡é¢˜"></a>ä¸‰çº§æ ‡é¢˜</h3><h4 id="å››çº§æ ‡é¢˜"><a href="#å››çº§æ ‡é¢˜" class="headerlink" title="å››çº§æ ‡é¢˜"></a>å››çº§æ ‡é¢˜</h4><h5 id="äº”çº§æ ‡é¢˜"><a href="#äº”çº§æ ‡é¢˜" class="headerlink" title="äº”çº§æ ‡é¢˜"></a>äº”çº§æ ‡é¢˜</h5><h6 id="å…­çº§æ ‡é¢˜"><a href="#å…­çº§æ ‡é¢˜" class="headerlink" title="å…­çº§æ ‡é¢˜"></a>å…­çº§æ ‡é¢˜</h6><span id="more"></span>
<h2 id="3-å­—ä½“"><a href="#3-å­—ä½“" class="headerlink" title="3. å­—ä½“"></a>3. å­—ä½“</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">~~åˆ é™¤~~					<span class="comment"># åˆ é™¤çº¿</span></span><br><span class="line">**åŠ ç²—**					<span class="comment"># åŠ ç²—</span></span><br><span class="line">*æ–œä½“*					<span class="comment"># æ–œä½“</span></span><br><span class="line">***åŠ ç²—+æ–œä½“***					<span class="comment"># ç²—æ–œä½“</span></span><br><span class="line">&lt;code&gt;é«˜äº®&lt;/code&gt;					<span class="comment"># é«˜äº®</span></span><br><span class="line">`$H_2O_2$`					<span class="comment"># ä¸‹æ ‡</span></span><br><span class="line">`$X^{a^<span class="number">2</span>}$`					<span class="comment"># å¹³æ–¹</span></span><br><span class="line">&lt;u&gt;ä¸‹åˆ’çº¿&lt;/u&gt;					<span class="comment"># ä¸‹åˆ’çº¿</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–œä½“ã€åŠ ç²—ä¸­*å’Œ_æ•ˆæœç›¸åŒ</span></span><br><span class="line"><span class="comment"># HTMLè¯­æ³•å¯ä»¥åœ¨Markdownä¸­ä½¿ç”¨</span></span><br></pre></td></tr></tbody></table></figure>
<p><del>åˆ é™¤</del>            </p>
<p><strong>åŠ ç²—</strong>            </p>
<p><em>æ–œä½“</em>            </p>
<p><strong><em>åŠ ç²—+æ–œä½“</em></strong>  </p>
<p><code>é«˜äº®</code></p>
<script type="math/tex; mode=display">H_2O_2</script><script type="math/tex; mode=display">X^{a^2}</script><p><u>ä¸‹åˆ’çº¿</u>        </p>
<h2 id="4-è¡¨æƒ…ç¬¦å·"><a href="#4-è¡¨æƒ…ç¬¦å·" class="headerlink" title="4.è¡¨æƒ…ç¬¦å·"></a>4.è¡¨æƒ…ç¬¦å·</h2><figure class="highlight py"><table><tbody><tr><td class="code"><pre><span class="line">:smile_cat: :smile: :laughing: :dizzy_face: :sob: :weary:</span><br></pre></td></tr></tbody></table></figure>
<p><span class="github-emoji" style="display:inline;vertical-align:middle"><span>ğŸ˜¸</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f638.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><span class="github-emoji" style="display:inline;vertical-align:middle"><span>ğŸ˜„</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> <span class="github-emoji" style="display:inline;vertical-align:middle"><span>ğŸ˜†</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f606.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> <span class="github-emoji" style="display:inline;vertical-align:middle"><span>ğŸ˜µ</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f635.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> <span class="github-emoji" style="display:inline;vertical-align:middle"><span>ğŸ˜­</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f62d.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> <span class="github-emoji" style="display:inline;vertical-align:middle"><span>ğŸ˜©</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f629.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>
<h2 id="5-è¡¨æ ¼"><a href="#5-è¡¨æ ¼" class="headerlink" title="5.è¡¨æ ¼"></a>5.è¡¨æ ¼</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">name | price</span><br><span class="line">:---  | ---:			<span class="comment"># :åœ¨å·¦è¾¹è¡¨ç¤ºè¯¥åˆ—å·¦å¯¹é½ï¼›åœ¨å³è¾¹è¡¨ç¤ºå³å¯¹é½ï¼›å·¦å³éƒ½æœ‰å±…ä¸­å¯¹é½</span></span><br><span class="line">fried chicken | <span class="number">19</span></span><br><span class="line">cola | <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¡¨æ ¼è¯­æ³•è¾ƒä¸ºç¹çï¼Œå»ºè®®å³é”®æ’å…¥è¡¨æ ¼</span></span><br></pre></td></tr></tbody></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">name</th>
<th style="text-align:right">price</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">fried chicken</td>
<td style="text-align:right">19</td>
</tr>
<tr>
<td style="text-align:left">cola</td>
<td style="text-align:right">5</td>
</tr>
</tbody>
</table>
</div>
<h2 id="6-å¼•ç”¨"><a href="#6-å¼•ç”¨" class="headerlink" title="6.å¼•ç”¨"></a>6.å¼•ç”¨</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">&gt; ä¸€çº§å¼•ç”¨</span><br><span class="line">&gt;&gt; äºŒçº§å¼•ç”¨</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ä¸‰çº§å¼•ç”¨</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥æ­¤ç±»æ¨</span></span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>ä¸€çº§å¼•ç”¨</p>
<blockquote>
<p>äºŒçº§å¼•ç”¨</p>
<blockquote>
<p>ä¸‰çº§å¼•ç”¨</p>
</blockquote>
</blockquote>
</blockquote>
<h2 id="7-åˆ—è¡¨"><a href="#7-åˆ—è¡¨" class="headerlink" title="7.åˆ—è¡¨"></a>7.åˆ—è¡¨</h2><h4 id="7-1æ— åºåˆ—è¡¨"><a href="#7-1æ— åºåˆ—è¡¨" class="headerlink" title="7.1æ— åºåˆ—è¡¨"></a>7.1æ— åºåˆ—è¡¨</h4><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">* æ— åºåˆ—è¡¨<span class="number">1</span></span><br><span class="line">+ æ— åºåˆ—è¡¨<span class="number">2</span></span><br><span class="line">- æ— åºåˆ—è¡¨<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥ä¸Šä¸‰ç§æ–¹å¼å‡å¯</span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>æ— åºåˆ—è¡¨1</li>
</ul>
<ul>
<li>æ— åºåˆ—è¡¨2</li>
</ul>
<ul>
<li>æ— åºåˆ—è¡¨3</li>
</ul>
<h4 id="7-2æœ‰åºåˆ—è¡¨"><a href="#7-2æœ‰åºåˆ—è¡¨" class="headerlink" title="7.2æœ‰åºåˆ—è¡¨"></a>7.2æœ‰åºåˆ—è¡¨</h4><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="number">1.</span> æœ‰åºåˆ—è¡¨<span class="number">1</span></span><br><span class="line"><span class="number">2.</span> æœ‰åºåˆ—è¡¨<span class="number">2</span></span><br><span class="line"><span class="number">3.</span> æœ‰åºåˆ—è¡¨<span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ä»¥ä½¿ç”¨ æ•°å­—\.æ¥å–æ¶ˆæ˜¾ç¤ºåˆ—è¡¨ï¼ˆç”¨åæ–œæ è¿›è¡Œè½¬ä¹‰ï¼‰</span></span><br></pre></td></tr></tbody></table></figure>
<ol>
<li>æœ‰åºåˆ—è¡¨1</li>
<li>æœ‰åºåˆ—è¡¨2</li>
<li>æœ‰åºåˆ—è¡¨3</li>
</ol>
<h2 id="8-åˆ†å‰²çº¿"><a href="#8-åˆ†å‰²çº¿" class="headerlink" title="8.åˆ†å‰²çº¿"></a>8.åˆ†å‰²çº¿</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">***</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨ä¸€è¡Œä¸­ä½¿ç”¨ä¸‰ä¸ªåŠä»¥ä¸Šçš„*å³å¯</span></span><br></pre></td></tr></tbody></table></figure>
<hr>
<h2 id="9-è·³è½¬"><a href="#9-è·³è½¬" class="headerlink" title="9.è·³è½¬"></a>9.è·³è½¬</h2><h4 id="9-1å¤–éƒ¨è·³è½¬"><a href="#9-1å¤–éƒ¨è·³è½¬" class="headerlink" title="9.1å¤–éƒ¨è·³è½¬"></a>9.1å¤–éƒ¨è·³è½¬</h4><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">[ç´«æ¢¦æ²é¦™çš„åšå®¢](https://ç´«æ¢¦æ²é¦™.com)</span><br></pre></td></tr></tbody></table></figure>
<p><a href="https://ç´«æ¢¦æ²é¦™.com">ç´«æ¢¦æ²é¦™çš„åšå®¢</a></p>
<h4 id="9-2å†…éƒ¨è·³è½¬"><a href="#9-2å†…éƒ¨è·³è½¬" class="headerlink" title="9.2å†…éƒ¨è·³è½¬"></a>9.2å†…éƒ¨è·³è½¬</h4><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">[è·³è½¬è‡³<span class="number">1.</span>ä»£ç å—](<span class="comment">#1-ä»£ç å—)</span></span><br><span class="line">    </span><br><span class="line">[è·³è½¬è‡³Connor](<span class="comment">#Connor)</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># ç©ºæ ¼ç”¨-ä»£æ›¿ï¼Œç‰¹æ®Šå­—ç¬¦ç›´æ¥åˆ æ‰</span></span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥ä½¿ç”¨HTMLæ ‡ç­¾ä¸­çš„idæ¥è¿›è¡Œè·³è½¬</span></span><br></pre></td></tr></tbody></table></figure>
<p><a href="#1-ä»£ç å—">è·³è½¬è‡³1.ä»£ç å—</a></p>
<p><a href="#Connor">è·³è½¬è‡³åº·å¨œé…±</a></p>
<h4 id="9-3è‡ªåŠ¨é“¾æ¥"><a href="#9-3è‡ªåŠ¨é“¾æ¥" class="headerlink" title="9.3è‡ªåŠ¨é“¾æ¥"></a>9.3è‡ªåŠ¨é“¾æ¥</h4><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">&lt;https://ç´«æ¢¦æ²é¦™.com&gt;</span><br><span class="line">&lt;https://www.baidu.com&gt;</span><br><span class="line">    </span><br><span class="line"><span class="comment"># åè®®ä¹Ÿå†™å…¨ï¼Œä¸ç„¶ä¼šæœ‰bug</span></span><br></pre></td></tr></tbody></table></figure>
<p><a href="https://ç´«æ¢¦æ²é¦™.com">https://ç´«æ¢¦æ²é¦™.com</a><br><a href="https://www.baidu.com">https://www.baidu.com</a></p>
<h2 id="10-å›¾ç‰‡"><a href="#10-å›¾ç‰‡" class="headerlink" title="10.å›¾ç‰‡"></a>10.å›¾ç‰‡</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">![åº·å¨œé…±](Connor.jpg)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›¸å¯¹è·¯å¾„åœ¨source/_posts/åŒåæ–‡ä»¶å¤¹</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/08/29/hG1BLV.jpg" alt="åº·å¨œé…±"></p>
<h2 id="11-å†…ç½®æ ‡ç­¾"><a href="#11-å†…ç½®æ ‡ç­¾" class="headerlink" title="11.å†…ç½®æ ‡ç­¾"></a>11.å†…ç½®æ ‡ç­¾</h2><h4 id="11-1æ–‡æœ¬å±…ä¸­"><a href="#11-1æ–‡æœ¬å±…ä¸­" class="headerlink" title="11.1æ–‡æœ¬å±…ä¸­"></a>11.1æ–‡æœ¬å±…ä¸­</h4><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># HTMLï¼Œå…¶ä¸­class="blockquote-center"æ˜¯å¿…è¦çš„</span></span><br><span class="line">&lt;blockquote <span class="class"><span class="keyword">class</span>="<span class="title">blockquote</span>-<span class="title">center</span>"&gt;<span class="title">HTML</span>å±…ä¸­&lt;/<span class="title">blockquote</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># æ ‡ç­¾</span></span><br><span class="line"><span class="class">{% <span class="title">centerquote</span> %}æ ‡ç­¾å±…ä¸­{% <span class="title">endcenterquote</span> %}</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># æ ‡ç­¾åˆ«å</span></span><br><span class="line"><span class="class">{% <span class="title">cq</span> %}æ ‡ç­¾åˆ«åå±…ä¸­{% <span class="title">endcq</span> %}</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># æ­¤æ ‡ç­¾å°†ç”Ÿæˆä¸€ä¸ªå¸¦ä¸Šä¸‹åˆ†å‰²çº¿çš„å¼•ç”¨ï¼ŒåŒæ—¶å¼•ç”¨å†…æ–‡æœ¬å°†è‡ªåŠ¨å±…ä¸­</span></span><br><span class="line"><span class="class"># æ–‡æœ¬å±…ä¸­æ—¶ï¼Œå¤šè¡Œæ–‡æœ¬è‹¥é•¿åº¦ä¸ç­‰ï¼Œè§†è§‰ä¸Šä¼šæ˜¾å¾—ä¸å¯¹ç§°ï¼Œå› æ­¤å»ºè®®åœ¨å¼•ç”¨å•è¡Œæ–‡æœ¬çš„åœºæ™¯ä¸‹ä½¿ç”¨</span></span><br></pre></td></tr></tbody></table></figure>
<blockquote class="blockquote-center">HTMLå±…ä¸­</blockquote>

<blockquote class="blockquote-center">
            <i class="fa fa-quote-left"></i>
            <p>æ ‡ç­¾å±…ä¸­</p>

            <i class="fa fa-quote-right"></i>
          </blockquote>
<blockquote class="blockquote-center">
            <i class="fa fa-quote-left"></i>
            <p>æ ‡ç­¾åˆ«åå±…ä¸­</p>

            <i class="fa fa-quote-right"></i>
          </blockquote>
<h4 id="11-2å›¾ç‰‡è¶Šç•Œ"><a href="#11-2å›¾ç‰‡è¶Šç•Œ" class="headerlink" title="11.2å›¾ç‰‡è¶Šç•Œ"></a>11.2å›¾ç‰‡è¶Šç•Œ</h4><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># HTMLï¼Œå…¶ä¸­class="full-image"æ˜¯å¿…è¦çš„</span></span><br><span class="line">&lt;img src=<span class="string">"Connor.jpg"</span> <span class="class"><span class="keyword">class</span>="<span class="title">full</span>-<span class="title">image</span>" /&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># æ ‡ç­¾çš„æ–¹å¼å¤±æ•ˆäº†ï¼Œå¯èƒ½æ¢äº†å…¶å®ƒçš„æ ‡ç­¾å</span></span><br><span class="line"><span class="class"># çœ‹èµ·æ¥æ²¡å•¥æ•ˆæœ</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/08/29/hG1BLV.jpg" class="full-image" id="Connor"></p>
<h4 id="11-3Bootstrap-Callout"><a href="#11-3Bootstrap-Callout" class="headerlink" title="11.3Bootstrap Callout"></a>11.3Bootstrap Callout</h4><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">{% note class_name %} Content (md partial supported) {% endnote %}</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä¸­class_nameå¯ä»¥æ˜¯ä»¥ä¸‹å€¼</span></span><br><span class="line"><span class="comment"># danger primary success info warning default</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note danger">
            <p>Itâ€™s danger </p>
          </div>
<div class="note primary">
            <p>Itâ€™s primary </p>
          </div>
<div class="note success">
            <p>Itâ€™s success </p>
          </div>
<div class="note info">
            <p>Itâ€™s info </p>
          </div>
<div class="note warning">
            <p>Itâ€™s warning </p>
          </div>
<div class="note default">
            <p>Itâ€™s default </p>
          </div>
]]></content>
      <categories>
        <category>Markdown</category>
      </categories>
      <tags>
        <tag>å…¥é—¨</tag>
      </tags>
  </entry>
  <entry>
    <title>Navigation</title>
    <url>/2021/09/25/Navigation/</url>
    <content><![CDATA[<h2 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h2><p>ä¸€ä¸ªAPPä¸å¯èƒ½åªæœ‰ä¸€ä¸ªé¡µé¢å§ï¼Œè¿™æ—¶å€™å°±éœ€è¦ Navigation å’Œ Fragment æ¥å¸®åŠ©æˆ‘ä»¬åˆ‡æ¢é¡µé¢ã€‚æ•ˆæœå›¾å¦‚ä¸‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/25/4shGLT.gif" alt=""></p>
<p>Fragment ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/25/4yVf4U.png" alt=""></p>
<span id="more"></span>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>MainActivity éƒ¨åˆ†</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.navigation1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.NavController;</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.fragment.NavHostFragment;</span><br><span class="line"><span class="keyword">import</span> androidx.navigation.ui.NavigationUI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        NavHostFragment navHostFragment = (NavHostFragment) getSupportFragmentManager().findFragmentById(R.id.fragment);</span><br><span class="line">        NavController controller = navHostFragment.getNavController();</span><br><span class="line">        <span class="comment">// æ˜¾ç¤ºå¯¼èˆªæ ä¸Šæ–¹è¿”å›æŒ‰é’®</span></span><br><span class="line">        NavigationUI.setupActionBarWithNavController(<span class="keyword">this</span>, controller);</span><br><span class="line">    }</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// å¯¼èˆªæ ä¸Šæ–¹è¿”å›æŒ‰é’®äº‹ä»¶</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onSupportNavigateUp</span><span class="params">()</span> </span>{</span><br><span class="line">        NavHostFragment navHostFragment = (NavHostFragment) getSupportFragmentManager().findFragmentById(R.id.fragment);</span><br><span class="line">        NavController controller = navHostFragment.getNavController();</span><br><span class="line">        <span class="keyword">return</span> controller.navigateUp();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Navigation.xml ä¸­å¯ä»¥å†™å‡ºå„ä¸ª Fragment çš„æ€ç»´å¯¼å›¾ï¼ˆå…·ä½“è·³è½¬ä»£ç å†™åœ¨ java æ–‡ä»¶ä¸­ï¼‰ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šåˆ‡æ¢åŠ¨ç”»ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/25/4s4SXV.png" alt=""></p>
<p>åˆ›å»º Fragment è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç å°±ç•¥å»äº†ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="comment">// è·³è½¬é¡µé¢</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewCreated</span><span class="params">(<span class="meta">@NonNull</span> View view, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onViewCreated(view, savedInstanceState);</span><br><span class="line">        Button button = getView().findViewById(R.id.button2);</span><br><span class="line">        button.setOnClickListener(Navigation.createNavigateOnClickListener(R.id.action_secondFragment_to_firstFragment));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h2 id="ä¼ é€’æ•°æ®"><a href="#ä¼ é€’æ•°æ®" class="headerlink" title="ä¼ é€’æ•°æ®"></a>ä¼ é€’æ•°æ®</h2><p>ï¼ˆ1ï¼‰ ä½¿ç”¨Bundle</p>
<p>æœ‰æ—¶ç•Œé¢ä¼šä¼´éšç€æ•°æ®ä¸€èµ·è·³è½¬ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ Bundle è¿™ä¸ªé”®å€¼å¯¹å­˜å‚¨æ•°æ®è¿›è¡Œä¼ é€äº†ã€‚</p>
<p>æ•ˆæœå›¾å¦‚ä¸‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/25/4ypemD.gif" alt=""></p>
<p>å‘é€æ–¹ Fragment</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">	<span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewCreated</span><span class="params">(<span class="meta">@NonNull</span> View view, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onViewCreated(view, savedInstanceState);</span><br><span class="line">        Button button = getView().findViewById(R.id.button);</span><br><span class="line">        EditText editText = getView().findViewById(R.id.editTextTextPersonName);</span><br><span class="line">        button.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>{</span><br><span class="line">                String text = editText.getText().toString();</span><br><span class="line">                <span class="keyword">if</span>(TextUtils.isEmpty(text)){</span><br><span class="line">                    Toast.makeText(getActivity(), <span class="string">"è¯·è¾“å…¥å§“å"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                }</span><br><span class="line">                Bundle bundle = <span class="keyword">new</span> Bundle();</span><br><span class="line">                bundle.putString(<span class="string">"name"</span>, text);</span><br><span class="line">                NavController navController = Navigation.findNavController(view);</span><br><span class="line">                navController.navigate(R.id.action_firstFragment_to_secondFragment, bundle);</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ¥æ”¶æ–¹ Fragment</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onViewCreated</span><span class="params">(<span class="meta">@NonNull</span> View view, <span class="meta">@Nullable</span> Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onViewCreated(view, savedInstanceState);</span><br><span class="line">        TextView textView = getView().findViewById(R.id.textView);</span><br><span class="line">        textView.setText(getArguments().getString(<span class="string">"name"</span>));</span><br><span class="line">        Button button = getView().findViewById(R.id.button2);</span><br><span class="line">        button.setOnClickListener(Navigation.createNavigateOnClickListener(R.id.action_secondFragment_to_firstFragment));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰ ä½¿ç”¨ ViewModelï¼Œæ•ˆæœå›¾å¦‚ä¸‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/26/4yrL6g.gif" alt=""></p>
<p>FirstFragmentéƒ¨åˆ†ã€‚</p>
<p>è¦æ³¨æ„ onCreateView æ˜¯åˆ›å»ºçš„æ—¶å€™è°ƒç”¨ï¼ŒonViewCreated æ˜¯åœ¨ onCreateView åè¢«è§¦å‘çš„äº‹ä»¶ï¼Œå‰åå…³ç³»ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container,</span></span></span><br><span class="line"><span class="params"><span class="function">                             Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        MyViewModel myViewModel = <span class="keyword">new</span> ViewModelProvider(getActivity()).get(MyViewModel.class);</span><br><span class="line">        FragmentFirstBinding binding = DataBindingUtil.inflate(inflater, R.layout.fragment_first, container, <span class="keyword">false</span>);</span><br><span class="line">        binding.setData(myViewModel);</span><br><span class="line">        binding.setLifecycleOwner(getActivity());</span><br><span class="line">        binding.buttonNext.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>{</span><br><span class="line">                NavController navController = Navigation.findNavController(view);</span><br><span class="line">                navController.navigate(R.id.action_firstFragment_to_secondFragment);</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">        binding.seekBar.setProgress(myViewModel.getNumber().getValue());</span><br><span class="line">        binding.seekBar.setOnSeekBarChangeListener(<span class="keyword">new</span> SeekBar.OnSeekBarChangeListener() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onProgressChanged</span><span class="params">(SeekBar seekBar, <span class="keyword">int</span> i, <span class="keyword">boolean</span> b)</span> </span>{</span><br><span class="line">                myViewModel.getNumber().setValue(binding.seekBar.getProgress());</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStartTrackingTouch</span><span class="params">(SeekBar seekBar)</span> </span>{</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStopTrackingTouch</span><span class="params">(SeekBar seekBar)</span> </span>{</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">        <span class="keyword">return</span>  binding.getRoot();</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>
<p>SecondFragmentéƒ¨åˆ†ã€‚</p>
<p>ä¸¤è¾¹è·å– ViewModelProvider éƒ½æ˜¯ä½¿ç”¨çš„ <code>getActivity()</code> è€Œä¸æ˜¯ <code>this</code>ï¼Œå› æ­¤è¯·æ±‚çš„ ViewModel æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™å°±æ˜¯ Singleton çš„å«ä¹‰ï¼Œæ•…èƒ½æ•°æ®å…±äº«ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> View <span class="title">onCreateView</span><span class="params">(LayoutInflater inflater, ViewGroup container,</span></span></span><br><span class="line"><span class="params"><span class="function">                             Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        FragmentSecondBinding binding = DataBindingUtil.inflate(inflater, R.layout.fragment_second, container, <span class="keyword">false</span>);</span><br><span class="line">        MyViewModel myViewModel = <span class="keyword">new</span> ViewModelProvider(getActivity()).get(MyViewModel.class);</span><br><span class="line">        binding.setData(myViewModel);</span><br><span class="line">        binding.setLifecycleOwner(getActivity());</span><br><span class="line">        binding.buttonBack.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>{</span><br><span class="line">                NavController navController = Navigation.findNavController(view);</span><br><span class="line">                navController.navigate(R.id.action_secondFragment_to_firstFragment);</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">        <span class="keyword">return</span> binding.getRoot();</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>
<h2 id="åŠ¨ç”»è¡¥é—´"><a href="#åŠ¨ç”»è¡¥é—´" class="headerlink" title="åŠ¨ç”»è¡¥é—´"></a>åŠ¨ç”»è¡¥é—´</h2><p>å„ä¸ª Fragment ä¹‹é—´çš„åˆ‡æ¢åŠ¨ä½œã€‚æ•ˆæœå›¾å¦‚ä¸‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/25/4yCqfA.gif" alt=""></p>
<p>Slide_From_Left è¿›å…¥åŠ¨ç”»ã€‚</p>
<p>fromXDeltaï¼šèµ·å§‹ä½ç½®ã€‚ï¼ˆ0% è¡¨ç¤º Fragment ä¸­çš„ä½ç½®ï¼‰</p>
<p>toXDeltaï¼šç»“æŸä½ç½®ã€‚</p>
<p>durationï¼šæŒç»­æ—¶é—´ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">translate</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXDelta</span>=<span class="string">"-100%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXDelta</span>=<span class="string">"0%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"1000"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>Slide_To_Right ç§»å‡ºåŠ¨ç”»ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">translate</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXDelta</span>=<span class="string">"0%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXDelta</span>=<span class="string">"100%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"1000"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>ä¹Ÿå¯ä»¥å®šåˆ¶å…¶å®ƒèŠ±é‡Œèƒ¡å“¨çš„åŠ¨ç”»ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/25/4yPzg1.gif" alt=""></p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">set</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rotate</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromDegrees</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toDegrees</span>=<span class="string">"720"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotX</span>=<span class="string">"50%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotY</span>=<span class="string">"50%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"1000"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scale</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXScale</span>=<span class="string">"0%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXScale</span>=<span class="string">"100%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromYScale</span>=<span class="string">"0%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toYScale</span>=<span class="string">"100%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotX</span>=<span class="string">"50%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:pivotY</span>=<span class="string">"50%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"1000"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">alpha</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromAlpha</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toAlpha</span>=<span class="string">"100"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"1000"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">translate</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fromXDelta</span>=<span class="string">"-100%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:toXDelta</span>=<span class="string">"0%"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:duration</span>=<span class="string">"1000"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
]]></content>
      <categories>
        <category>Android</category>
      </categories>
  </entry>
  <entry>
    <title>ViewModelSavedStateï¼ˆå³ä½¿è¿›ç¨‹åœ¨åå°è¢«ç³»ç»Ÿæ€æ­»æ•°æ®ä¹Ÿèƒ½ä¿å­˜ä¸‹æ¥ï¼‰</title>
    <url>/2021/09/24/ViewModelSavedState%EF%BC%88%E5%8D%B3%E4%BD%BF%E8%BF%9B%E7%A8%8B%E5%9C%A8%E5%90%8E%E5%8F%B0%E8%A2%AB%E7%B3%BB%E7%BB%9F%E6%9D%80%E6%AD%BB%E6%95%B0%E6%8D%AE%E4%B9%9F%E8%83%BD%E4%BF%9D%E5%AD%98%E4%B8%8B%E6%9D%A5%EF%BC%89/</url>
    <content><![CDATA[<h2 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h2><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹è¢«ç§»åˆ°åå°ï¼Œä¸”å½“å‰ç³»ç»Ÿå†…å­˜ä¸è¶³æ—¶ï¼Œä¼šæœ‰ä¸€å®šæ¦‚ç‡ä¼šå°†è¯¥è¿›ç¨‹æ€æ­»æ¥é‡Šæ”¾å†…å­˜èµ„æºï¼Œè€Œè¢«ç³»ç»Ÿæ€æ­»æ—¶ï¼ŒViewModelä¹Ÿä¼šè¢«åˆ é™¤ï¼ŒUIçš„æ•°æ®å°±ä¼šé­åˆ°ä¸¢å¤±ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/24/4DxeOJ.png" alt=""></p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸€æ—¦åˆ‡å‡ºåå°è¿›ç¨‹è¢«ç³»ç»Ÿæ€æ­»æ•°æ®å°±ä¼šä¸¢å¤±ã€‚</p>
<p>ä¸è¿‡å¥½åœ¨ç³»ç»Ÿæ€æ­»è¿›ç¨‹æ—¶ï¼Œä¼šè°ƒç”¨ onSaveInstanceState() æ–¹æ³•ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯ä¿å­˜å®ä¾‹çŠ¶æ€çš„ï¼Œæˆ‘ä»¬é‡å†™è¿™ä¸ªæ–¹æ³•æ¥ä¿å­˜æˆ‘ä»¬çš„æ•°æ®ã€‚</p>
<div style="display: flex;justify-content: center;">
    <img src="https://z3.ax1x.com/2021/09/24/4Dzc8K.png" height="400px" width="230px" style="margin: 50px;">
    <img src="https://z3.ax1x.com/2021/09/24/4Dz6C6.png" height="400px" width="230px" style="margin: 50px;">
</div>

<span id="more"></span>
<p><br></p>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><h4 id="1-onSaveInstanceState"><a href="#1-onSaveInstanceState" class="headerlink" title="1. onSaveInstanceState"></a>1. onSaveInstanceState</h4><p>ViewModeléƒ¨åˆ†</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.viewmodelsavedstate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.MutableLiveData;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyViewModel</span> <span class="keyword">extends</span> <span class="title">ViewModel</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> MutableLiveData&lt;Integer&gt; number;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MutableLiveData&lt;Integer&gt; <span class="title">getNumber</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">if</span>(number == <span class="keyword">null</span>){</span><br><span class="line">            number = <span class="keyword">new</span> MutableLiveData&lt;&gt;();</span><br><span class="line">            number.setValue(<span class="number">0</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> number;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span></span>{</span><br><span class="line">        number.setValue(number.getValue() + x);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>MainActivityï¼Œ21 - 23è¡Œæ˜¯è½½å…¥ savedInstanceStateï¼Œ28 - 32æ˜¯å†™å…¥ savedInstanceStateã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.viewmodelsavedstate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.annotation.NonNull;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> androidx.databinding.DataBindingUtil;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModelProvider;</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> com.example.viewmodelsavedstate.databinding.ActivityMainBinding;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line">    MyViewModel myViewModel;</span><br><span class="line">    ActivityMainBinding binding;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String SAVED_KEY_NAME = <span class="string">"number"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        binding = DataBindingUtil.setContentView(<span class="keyword">this</span>, R.layout.activity_main);</span><br><span class="line">        myViewModel = <span class="keyword">new</span> ViewModelProvider(<span class="keyword">this</span>).get(MyViewModel.class);</span><br><span class="line">        <span class="keyword">if</span>(savedInstanceState != <span class="keyword">null</span>){</span><br><span class="line">            myViewModel.getNumber().setValue(savedInstanceState.getInt(SAVED_KEY_NAME));</span><br><span class="line">        }</span><br><span class="line">        binding.setData(myViewModel);</span><br><span class="line">        binding.setLifecycleOwner(<span class="keyword">this</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onSaveInstanceState</span><span class="params">(<span class="meta">@NonNull</span> Bundle outState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onSaveInstanceState(outState);</span><br><span class="line">        outState.putInt(SAVED_KEY_NAME, myViewModel.getNumber().getValue());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="2-SavedStateHandle"><a href="#2-SavedStateHandle" class="headerlink" title="2. SavedStateHandle"></a>2. SavedStateHandle</h4><p>ViewModeléƒ¨åˆ†ï¼Œä½¿ç”¨ SavedStateHandle æ¥ä»£æ›¿ MutableLiveData å­˜å‚¨æ•°æ®ï¼ŒåŒæ—¶åœ¨åˆ›å»º ViewModel æ—¶å°†SavedStateHandle ä¼ å…¥ä¾›åç»­ä½¿ç”¨ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.viewmodelsavedstate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.MutableLiveData;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.SavedStateHandle;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyViewModel</span> <span class="keyword">extends</span> <span class="title">ViewModel</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> SavedStateHandle handle;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyViewModel</span><span class="params">(SavedStateHandle handle)</span></span>{</span><br><span class="line">        <span class="keyword">this</span>.handle = handle;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MutableLiveData&lt;Integer&gt; <span class="title">getNumber</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">if</span>(!handle.contains(MainActivity.SAVED_KEY_NAME)){</span><br><span class="line">            handle.set(MainActivity.SAVED_KEY_NAME, <span class="number">0</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> handle.getLiveData(MainActivity.SAVED_KEY_NAME);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span></span>{</span><br><span class="line">        getNumber().setValue(getNumber().getValue() + x);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>MainActivityéƒ¨åˆ†</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.viewmodelsavedstate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> androidx.databinding.DataBindingUtil;</span><br><span class="line"><span class="keyword">import</span> androidx.lifecycle.ViewModelProvider;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.viewmodelsavedstate.databinding.ActivityMainBinding;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>{</span><br><span class="line">    MyViewModel myViewModel;</span><br><span class="line">    ActivityMainBinding binding;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> String SAVED_KEY_NAME = <span class="string">"number"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        binding = DataBindingUtil.setContentView(<span class="keyword">this</span>, R.layout.activity_main);</span><br><span class="line">        myViewModel = <span class="keyword">new</span> ViewModelProvider(<span class="keyword">this</span>).get(MyViewModel.class);</span><br><span class="line">        binding.setData(myViewModel);</span><br><span class="line">        binding.setLifecycleOwner(<span class="keyword">this</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
]]></content>
      <categories>
        <category>Android</category>
      </categories>
  </entry>
  <entry>
    <title>ä½è¿ç®—</title>
    <url>/2021/12/15/%E4%BD%8D%E8%BF%90%E7%AE%97/</url>
    <content><![CDATA[<h2 id="ä½è¿ç®—"><a href="#ä½è¿ç®—" class="headerlink" title="ä½è¿ç®—"></a>ä½è¿ç®—</h2><p>ä½è¿ç®—æ˜¯ç¨‹åºè®¾è®¡ä¸­å¯¹ä½æ¨¡å¼æŒ‰ä½æˆ–äºŒè¿›åˆ¶æ•°çš„ä¸€å…ƒå’ŒäºŒå…ƒæ“ä½œã€‚</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½è¿ç®—å’ŒåŠ å‡è¿ç®—çš„è¿ç®—é€Ÿåº¦ç›¸å½“ï¼Œä¸”æå¤§ç¨‹åº¦ä¸Šå¿«äºä¹˜é™¤è¿ç®—ï¼ˆ10å€ï¼‰ã€‚</p>
<p>å¾ˆå¤šç¼–ç¨‹è¯­è¨€éƒ½æœ‰ä½è¿ç®—ç¬¦ï¼ŒJavaè¯­è¨€ä¹Ÿä¸ä¾‹å¤–ã€‚åœ¨Javaè¯­è¨€ä¸­ï¼Œæä¾›äº†7ç§ä½è¿ç®—ç¬¦ï¼Œåˆ†åˆ«æ˜¯ <code>&amp;</code>ï¼ˆä¸ï¼‰ã€<code>|</code>ï¼ˆæˆ–ï¼‰ã€<code>^</code>ï¼ˆå¼‚æˆ–ï¼‰ã€<code>\~</code>ï¼ˆéï¼‰ã€<code>&lt;&lt;</code>ï¼ˆå·¦ç§»ï¼‰ã€<code>&gt;&gt;</code>ï¼ˆå¸¦ç¬¦å·å³ç§»ï¼‰å’Œ<code>&gt;&gt;&gt;</code>ï¼ˆæ— ç¬¦å·å³ç§»ï¼‰ã€‚è¿™äº›è¿ç®—ç¬¦å½“ä¸­ï¼Œä»…æœ‰ <strong>~</strong> æ˜¯å•ç›®è¿ç®—ç¬¦ï¼Œå…¶ä»–è¿ç®—ç¬¦å‡ä¸ºåŒç›®è¿ç®—ç¬¦ã€‚</p>
<div class="note danger">
            <p>ä½è¿ç®—åªèƒ½å¯¹ <strong>long</strong>ã€<strong>int</strong>ã€<strong>short</strong>ã€<strong>byte</strong> å’Œ <strong>char</strong> è¿™äº”ä¸ªæ•´å‹ç±»å‹æ•°æ®è¿›è¡Œè¿ç®—ï¼Œä¸èƒ½ç”¨äº doubleã€floatã€boolean ä»¥åŠå…¶ä»– å¼•ç”¨ç±»å‹ã€‚</p>
          </div>
<h3 id="ä¸€ã€æŒ‰ä½ä¸è¿ç®—"><a href="#ä¸€ã€æŒ‰ä½ä¸è¿ç®—" class="headerlink" title="ä¸€ã€æŒ‰ä½ä¸è¿ç®—"></a>ä¸€ã€æŒ‰ä½ä¸è¿ç®—</h3><p>æŒ‰ä½ä¸è¿ç®—ç¬¦çš„å†™æ³•æ˜¯ä¸€ä¸ª <strong>&amp;</strong> ç¬¦å·ï¼Œè§„åˆ™å¦‚ä¸‹ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/15/TSCBYn.png" alt="image"></p>
<p>è¿ç®—è§„åˆ™æ€»ç»“æˆä¸€å¥è¯å°±æ˜¯ï¼šå¦‚æœä¸¤ä¸ªäºŒè¿›åˆ¶ä½ä¸Šçš„æ•°éƒ½æ˜¯1ï¼Œé‚£ä¹ˆè¿ç®—ç»“æœä¸º1ï¼Œå…¶ä»–æƒ…å†µè¿ç®—ç»“æœå‡ä¸º0ã€‚ä¸‹é¢ä¸¾ä¾‹è¯´æ˜æŒ‰ä½ä¸è¿ç®—ç¬¦çš„è¿ç®—è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç”¨æ•°å­—5å’Œ6è¿›è¡ŒæŒ‰ä½ä¸è¿ç®—ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç”¨ä¸‹å›¾è¡¨ç¤ºï¼š</p>
<p><img src="https://s4.ax1x.com/2021/12/15/TSCL0e.png" alt="image"></p>
<p>å¯ä»¥ä½¿ç”¨ä¸è¿ç®—æ¥åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦æ˜¯å¥‡æ•°ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    System.out.println((<span class="number">788</span> &amp; <span class="number">1</span>) == <span class="number">1</span>);	<span class="comment">// false</span></span><br><span class="line">    System.out.println((<span class="number">789</span> &amp; <span class="number">1</span>) == <span class="number">1</span>);	<span class="comment">// true</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h3 id="äºŒã€æŒ‰ä½æˆ–è¿ç®—"><a href="#äºŒã€æŒ‰ä½æˆ–è¿ç®—" class="headerlink" title="äºŒã€æŒ‰ä½æˆ–è¿ç®—"></a>äºŒã€æŒ‰ä½æˆ–è¿ç®—</h3><p>æŒ‰ä½æˆ–è¿ç®—ç¬¦çš„å†™æ³•æ˜¯ä¸€ä¸ª <strong>|</strong> ç¬¦å·ï¼Œè§„åˆ™å¦‚ä¸‹ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/15/TSPF0g.png" alt="image"></p>
<p>è¿ç®—è§„åˆ™æ¦‚æ‹¬æˆæ¯”è¾ƒå¥½è®°çš„ä¸€å¥è¯å°±æ˜¯ï¼šä¸¤ä¸ªäºŒè¿›åˆ¶ä½ä¸Šçš„æ•°å­—å¦‚æœéƒ½ä¸º0ï¼Œé‚£ä¹ˆè¿ç®—ç»“æœä¸º0ï¼Œå¦åˆ™è¿ç®—ç»“æœæ˜¯1ã€‚åŒæŒ‰ä½ä¸è¿ç®—ä¸€æ ·ï¼Œç¬¦å·ä½ä¹Ÿè¦å‚ä¸è¿ç®—ã€‚ä¸‹é¢æˆ‘ä»¬è¿˜æ˜¯ç”¨5å’Œ6ä¸ºä¾‹æ¥è®²è§£ä¸€ä¸‹æŒ‰ä½æˆ–çš„è¿ç®—è¿‡ç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://s4.ax1x.com/2021/12/15/TSC5f1.png" alt="image"></p>
<p><br></p>
<h3 id="ä¸‰ã€æŒ‰ä½å¼‚æˆ–è¿ç®—ã€é‡ç‚¹ã€‘"><a href="#ä¸‰ã€æŒ‰ä½å¼‚æˆ–è¿ç®—ã€é‡ç‚¹ã€‘" class="headerlink" title="ä¸‰ã€æŒ‰ä½å¼‚æˆ–è¿ç®—ã€é‡ç‚¹ã€‘"></a>ä¸‰ã€æŒ‰ä½å¼‚æˆ–è¿ç®—ã€é‡ç‚¹ã€‘</h3><p>æŒ‰ä½æˆ–è¿ç®—ç¬¦çš„å†™æ³•æ˜¯ä¸€ä¸ª <strong>^</strong> ç¬¦å·ï¼Œè§„åˆ™å¦‚ä¸‹ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/15/TSPBHe.png" alt="image"></p>
<p>å¦‚ä¸Šå›¾ï¼Œè¿ç®—è§„åˆ™ä¸ºï¼šä¸¤ä¸ªäºŒè¿›åˆ¶ä½ä¸Šçš„æ•°å­—å¦‚æœç›¸åŒï¼Œåˆ™è¿ç®—ç»“æœä¸º0ï¼Œå¦‚æœä¸¤ä¸ªäºŒè¿›åˆ¶ä½ä¸Šçš„æ•°å­—ä¸ç›¸åŒï¼Œåˆ™è¿ç®—ç»“æœä¸º1ã€‚ä¸‹é¢æˆ‘ä»¬è¿˜æ˜¯ç”¨5å’Œ6ä¸ºä¾‹æ¥è®²è§£ä¸€ä¸‹å¼‚æˆ–çš„è¿ç®—è¿‡ç¨‹ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://s4.ax1x.com/2021/12/15/TSPc9I.png" alt="image"></p>
<h4 id="å¼‚æˆ–è¿ç®—çš„æ€§è´¨"><a href="#å¼‚æˆ–è¿ç®—çš„æ€§è´¨" class="headerlink" title="å¼‚æˆ–è¿ç®—çš„æ€§è´¨"></a>å¼‚æˆ–è¿ç®—çš„æ€§è´¨</h4><p><strong>$I$ã€å¼‚æˆ–è¿ç®—æ»¡è¶³äº¤æ¢å¾‹ã€‚</strong></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œa \^ b ä¸ b \^ aæ˜¯ç­‰ä»·çš„ï¼Œè™½ç„¶ a å’Œ b äº¤æ¢äº†ä½ç½®ï¼Œä½†è¿˜æ˜¯ä¼šè¿ç®—å‡ºç›¸åŒçš„ç»“æœã€‚è¿™ä¸ªè§„å¾‹è¿˜å¯ä»¥æ¨å¹¿åˆ° N ä¸ªæ“ä½œæ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæœ‰Nä¸ªå˜é‡éƒ½å‚ä¸äº†å¼‚æˆ–è¿ç®—ï¼Œé‚£ä¹ˆå®ƒä»¬çš„ä½ç½®æ— è®ºå¦‚ä½•äº¤æ¢ï¼Œè¿ç®—çš„ç»“æœéƒ½æ˜¯ç›¸åŒçš„ã€‚</p>
<p><strong>$II$ã€ä»»ä½•ä¸¤ä¸ªç›¸åŒçš„æ•°å­—è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œæ‰€å¾—åˆ°çš„ç»“æœä¸º 0ã€‚</strong></p>
<p>å› ä¸ºä¸¤ä¸ªç›¸åŒçš„æ•°å­—ï¼Œæ¢ç®—æˆè¡¥ç åï¼Œæ¯ä¸ªäºŒè¿›åˆ¶ä½ä¸Šçš„æ•°ä¹Ÿéƒ½ç›¸åŒï¼Œè¿™æ ·åœ¨è¿›è¡Œå¼‚æˆ–è¿ç®—æ—¶ï¼ŒæŒ‰ç…§è¿ç®—è§„åˆ™ï¼Œæ¯ä¸ªäºŒè¿›åˆ¶ä½ä¸Šå¾—åˆ°çš„è¿ç®—ç»“æœä¹Ÿéƒ½æ˜¯ 0ï¼Œè¿™ N ä¸ª 0 æ‰€ç»„æˆçš„äºŒè¿›åˆ¶ä¸²å°±æ˜¯æ•°å­— 0 çš„è¡¥ç ã€‚</p>
<ul>
<li>å¯ä»¥åˆ¤æ–­ä¸¤æ•°æ˜¯å¦ç›¸ç­‰ï¼ša \^ b = 0  -&gt;  a = bã€‚</li>
<li>å¿«é€Ÿæ¸…é›¶ï¼ša ^= aã€‚</li>
</ul>
<p><strong>$III$ã€å¯¹äºä»»æ„ä¸€ä¸ªäºŒè¿›åˆ¶ä½æ¥è¯´ï¼Œè¿™ä¸ªä½ä¸Šçš„æ•°ä¸ 0 è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œè¿ç®—ç»“æœä¸å˜ã€‚</strong></p>
<p>0 ^ 1 = 1ï¼Œ0 ^ 0 = 0ï¼Œç»“æœä¸å˜ã€‚</p>
<p><strong>$IV$ã€å¯¹äºä»»æ„ä¸€ä¸ªäºŒè¿›åˆ¶ä½æ¥è¯´ï¼Œè¿™ä¸ªä½ä¸Šçš„æ•°ä¸ 1 è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œè¿ç®—ç»“æœå–åã€‚</strong></p>
<p>1 ^ 0 = 1ï¼Œ1 ^ 1 = 0ï¼Œç»“æœå–åã€‚</p>
<p><strong>$V$ã€å¯¹äºä»»æ„ä¸¤ä¸ªæ•´æ•° a å’Œ bï¼Œa \^ b \^ a = b ã€‚</strong></p>
<p>a ^ b ^ a = a ^ a ^ b = 0 ^ b = bã€‚</p>
<p>è¿™ä¸ªç‰¹æ€§åœ¨åŠ å¯†è¿ç®—æ–¹é¢æœ‰ç€å¾ˆæ™®éçš„åº”ç”¨ã€‚æˆ‘ä»¬å¯ä»¥æŠŠ a å½“ä½œè¦åŠ å¯†çš„æ•°æ®ï¼Œè€ŒæŠŠ b å½“ä½œå¯†é’¥ã€‚a å¼‚æˆ– b å°±æ˜¯æŠŠ a ç”¨å¯†é’¥ b è¿›è¡Œäº†åŠ å¯†æ“ä½œï¼Œå½“éœ€è¦è§£å¯†æ—¶ï¼Œä»ç„¶ä»¥ b ä½œä¸ºå¯†é’¥ï¼Œå†è¿›è¡Œä¸€æ¬¡å¼‚æˆ–å°±å®ç°äº†è§£å¯†ã€‚</p>
<p><br></p>
<h3 id="å››ã€æŒ‰ä½å–åè¿ç®—"><a href="#å››ã€æŒ‰ä½å–åè¿ç®—" class="headerlink" title="å››ã€æŒ‰ä½å–åè¿ç®—"></a>å››ã€æŒ‰ä½å–åè¿ç®—</h3><p>æŒ‰ä½æˆ–è¿ç®—ç¬¦çš„å†™æ³•æ˜¯ä¸€ä¸ª <strong>~</strong> ç¬¦å·ï¼Œè§„åˆ™å¦‚ä¸‹ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/15/TSAdGd.png" alt="image"></p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="keyword">int</span> a = <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">int</span> b = ~a;</span><br><span class="line">        System.out.println(a);  <span class="comment">// 5</span></span><br><span class="line">        System.out.println(b);  <span class="comment">// -6</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>é¦–å…ˆæŠŠæ•°å­—5è½¬æ¢æˆè¡¥ç å½¢å¼ï¼Œä¹‹åæŠŠæ¯ä¸ªäºŒè¿›åˆ¶ä½ä¸Šçš„æ•°å­—è¿›è¡Œå–åï¼Œå¦‚æœæ˜¯0å°±å˜æˆ1ï¼Œå¦‚æœ1å°±å˜æˆ0ï¼Œç»è¿‡å–ååå¾—åˆ°çš„äºŒè¿›åˆ¶ä¸²å°±æ˜¯è¿ç®—ç»“æœï¼Œè¿™ä¸ªè¿ç®—ç»“æœè¢«è¿˜åŸä¸ºåè¿›åˆ¶æ•°æ˜¯-6ã€‚</p>
<p><br></p>
<h3 id="äº”ã€å·¦ç§»è¿ç®—ç¬¦"><a href="#äº”ã€å·¦ç§»è¿ç®—ç¬¦" class="headerlink" title="äº”ã€å·¦ç§»è¿ç®—ç¬¦"></a>äº”ã€å·¦ç§»è¿ç®—ç¬¦</h3><p>æŒ‰ä½æˆ–è¿ç®—ç¬¦çš„å†™æ³•æ˜¯ä¸€ä¸ª <strong>&lt;&lt;</strong> ç¬¦å·ï¼Œè§„åˆ™å¦‚ä¸‹ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/15/TSER0K.png" alt="image"></p>
<p>å·¦ç§»è¿ç®—æœ‰ä¹˜ä»¥2çš„Næ¬¡æ–¹çš„æ•ˆæœã€‚ä¸€ä¸ªæ•°å‘å·¦ç§»åŠ¨1ä½ï¼Œå°±ç›¸å½“äºä¹˜ä»¥2çš„1æ¬¡æ–¹ï¼Œç§»åŠ¨ä¸¤ä½å°±ç›¸å½“äºä¹˜ä»¥2çš„2æ¬¡æ–¹ï¼Œä¹Ÿå°±æ˜¯ä¹˜ä»¥4ã€‚<strong>ä½ç§»æ“ä½œåœ¨å®é™…è¿ç®—æ—¶è¿œè¿œå¿«äºä¹˜æ³•æ“ä½œ</strong>ï¼Œæ‰€ä»¥åœ¨æŸäº›å¯¹è¿ç®—é€Ÿåº¦è¦æ±‚éå¸¸é«˜çš„åœºåˆï¼Œå¯ä»¥è€ƒè™‘ç”¨å·¦ç§»ä»£æ›¿ä¹˜ä»¥2çš„Næ¬¡æ–¹çš„ä¹˜æ³•æ“ä½œã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// å¯å®é™…æµ‹è¯•ä¸‹æ¥ä¸¤è€…çš„é€Ÿåº¦å‡ ä¹ä¸€è‡´</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1e9</span>;i++){</span><br><span class="line">        <span class="keyword">int</span> a = i * <span class="number">1024</span>;</span><br><span class="line">    }</span><br><span class="line">    System.out.println(System.currentTimeMillis() - start);	<span class="comment">// 1031</span></span><br><span class="line"></span><br><span class="line">    start = System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1e9</span>;i++){</span><br><span class="line">        <span class="keyword">int</span> a = i &lt;&lt; <span class="number">10</span>;</span><br><span class="line">    }</span><br><span class="line">    System.out.println(System.currentTimeMillis() - start);	<span class="comment">// 1022</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä½†å½“ä½ç§»çš„ä½æ•°å¾ˆå¤šæ—¶ï¼Œå¯¼è‡´æœ€å·¦è¾¹çš„ç¬¦å·ä½å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¸å†å…·æœ‰ä¹˜ä»¥2çš„Næ¬¡æ–¹çš„æ•ˆæœäº†ã€‚æ¯”å¦‚åè¿›åˆ¶çš„5è½¬æ¢ä¸ºè¡¥ç å½¢å¼æ˜¯ï¼šå‰é¢29ä¸ª0æœ€å3ä½æ˜¯101ï¼Œå¦‚æœç§»åŠ¨29ä½ï¼Œé‚£ä¹ˆæœ€å‰é¢çš„ç¬¦å·ä½å°±å˜æˆäº†1ï¼Œ<strong>æ­¤æ—¶è¿ç®—çš„ç»“æœå°±æˆä¸ºäº†ä¸€ä¸ªè´Ÿæ•°</strong>ï¼Œä¸å†æ˜¯5ä¹˜ä»¥2çš„29æ¬¡æ–¹çš„ä¹˜æ³•ç»“æœã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">5</span>;</span><br><span class="line">    System.out.println(a &lt;&lt; <span class="number">29</span>);	<span class="comment">// -1610612736</span></span><br><span class="line">    a = -<span class="number">5</span>;</span><br><span class="line">    System.out.println(a &lt;&lt; <span class="number">29</span>);	<span class="comment">// 1610612736</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å¯¹äº <strong>byte/short/int</strong> ä¸‰ç§ç±»å‹çš„æ•°æ®ï¼ŒJava è¯­è¨€æœ€å¤šæ”¯æŒ31ä½çš„ä½ç§»è¿ç®—ï¼ˆåŒ…æ‹¬ä¸‹é¢çš„å³ç§»è¿ç®—ï¼‰ã€‚å¦‚æœä½ç§»æ•°è¶…è¿‡31ï¼Œåˆ™è™šæ‹Ÿæœºä¼šå¯¹ä½ç§»æ•°æŒ‰è¿ç»­å‡å»32ï¼Œ<strong>ç›´åˆ°å¾—åˆ°ä¸€ä¸ªå°äº32å¹¶ä¸”å¤§äºç­‰äº0çš„æ•°</strong>ï¼Œç„¶åä»¥è¿™ä¸ªæ•°ä½œä¸ºæœ€ç»ˆçš„ä½ç§»æ•°ã€‚</p>
<p>ä¾‹å¦‚å¯¹ int å‹å˜é‡è¿›è¡Œä½ç§»97ä½çš„æ“ä½œï¼Œè™šæ‹Ÿæœºä¼šé¦–å…ˆå¯¹97è¿ç»­å‡å»3ä¸ª32ï¼Œæœ€ç»ˆå¾—åˆ°æ•°å­—1ï¼Œå®é™…è¿›è¡Œä½ç§»è¿ç®—æ—¶åªå¯¹å˜é‡ä½ç§»1ä½ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">2</span>;</span><br><span class="line">    System.out.println(a &lt;&lt; <span class="number">97</span>);	<span class="comment">// 4</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è€Œå¯¹äº long ç±»å‹çš„æ•°æ®è€Œè¨€ï¼Œæœ€å¤šæ”¯æŒ63ä½çš„ä½ç§»è¿ç®—ï¼Œå¦‚æœä½ç§»æ•°è¶…è¿‡63ï¼Œåˆ™è¿ç»­å‡å»64ï¼Œä»¥æœ€ç»ˆå¾—åˆ°çš„å°äº64å¹¶ä¸”å¤§äºç­‰äº0çš„æ•°ä½œä¸ºä½ç§»æ•°ã€‚å°ä¼™ä¼´ä»¬å¯ä»¥è¯•ä¸€ä¸‹æ•°å­—5å·¦ç§»32ä½æ˜¯ä»€ä¹ˆç»“æœã€‚</p>
<p><br></p>
<h3 id="å…­ã€å¸¦ç¬¦å·å³ç§»è¿ç®—ç¬¦"><a href="#å…­ã€å¸¦ç¬¦å·å³ç§»è¿ç®—ç¬¦" class="headerlink" title="å…­ã€å¸¦ç¬¦å·å³ç§»è¿ç®—ç¬¦"></a>å…­ã€å¸¦ç¬¦å·å³ç§»è¿ç®—ç¬¦</h3><p>å³ç§»è¿ç®—åˆ†ä¸ºä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯å¸¦ç¬¦å·å³ç§»å’Œæ— ç¬¦å·å³ç§»ã€‚é¦–å…ˆæˆ‘ä»¬æ¥è¯´è¯´å¸¦ç¬¦å·å³ç§»è¿ç®—ç¬¦ã€‚å¸¦ç¬¦å·å³ç§»è¿ç®—ç¬¦çš„å†™æ³•æ˜¯ <strong>&gt;&gt;</strong>ï¼Œä¸å·¦ç§»è¿ç®—ç¬¦çš„æ–¹å‘æ°å¥½ç›¸åã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/15/TSZ3Mn.png" alt="image"></p>
<p>å¸¦ç¬¦å·å³ç§»è¿ç®—å’Œå·¦ç§»è¿ç®—ç±»ä¼¼ï¼Œå…·æœ‰ <strong>/2</strong> çš„åŠŸèƒ½ï¼Œå°æ•°ä¼šè¢«èˆå¼ƒã€‚</p>
<p><strong>ä½†æ˜¯å¯¹äºè´Ÿæ•°è€Œè¨€ï¼Œå¸¦ç¬¦å·å³ç§»çš„æ•ˆæœåˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œæˆ‘ä»¬åˆ†åˆ«æ¥è®¨è®ºã€‚</strong></p>
<p>å¦‚æœè¿™ä¸ªè´Ÿæ•°æ˜¯â€œ2çš„Næ¬¡æ–¹â€çš„æ•´æ•°å€ï¼Œé‚£ä¹ˆå¸¦ç¬¦å·å³ç§»Nä½çš„æ•ˆæœä¹Ÿç­‰äºé™¤ä»¥2çš„Næ¬¡æ–¹ã€‚ä¸¾ä¸ªä¾‹å­ï¼šæˆ‘ä»¬è¿˜æ˜¯æŠŠNçš„å€¼è®¾ä¸º3ï¼Œå¦‚æœå¯¹äºâ€œ-16â€æ¥è¯´ï¼Œå®ƒæ˜¯â€œ2çš„3æ¬¡æ–¹â€çš„æ•´æ•°å€ï¼Œé‚£ä¹ˆå¸¦ç¬¦å·å³ç§»3ä½çš„ç»“æœæ˜¯-2ï¼Œè¿™ä¸ªç»“æœç›¸å½“äºâ€œ-16é™¤ä»¥2çš„3æ¬¡æ–¹â€ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> a = -<span class="number">16</span>;</span><br><span class="line">    System.out.println(a &gt;&gt; <span class="number">3</span>);	<span class="comment">// -2</span></span><br><span class="line">    System.out.println(a / <span class="number">8</span>);	<span class="comment">// -2</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è€Œå¦‚æœè¿™ä¸ªè´Ÿæ•°ä¸æ˜¯â€œ2çš„Næ¬¡æ–¹â€çš„æ•´æ•°å€ï¼Œé‚£ä¹ˆå³ç§»Nä½ä¹‹åï¼Œæ˜¯åœ¨é™¤ä»¥2çš„Næ¬¡æ–¹çš„ç»“æœä¹‹ä¸Šè¿˜è¦å‡å»1ã€‚æ¯”å¦‚ï¼Œå¯¹äº-15æ¥è¯´ï¼Œå®ƒä¸æ˜¯â€œ2çš„3æ¬¡æ–¹â€çš„æ•´æ•°å€ï¼Œé‚£ä¹ˆå¸¦ç¬¦å·å³ç§»3ä½çš„ç»“æœæ˜¯-2ï¼Œè¿™ä¸ªè¿ç®—ç»“æœå…¶å®å°±æ˜¯â€œ-15è¢«2çš„3æ¬¡æ–¹æ•´é™¤å†å‡å»1â€ï¼ˆå‡1æ˜¯å› ä¸ºå³ç§»çš„æ—¶å€™ä¸¢å¼ƒäº†ä½æ•°æ˜¯ 1 çš„ä½ï¼‰ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> a = -<span class="number">15</span>;</span><br><span class="line">    System.out.println(a &gt;&gt; <span class="number">3</span>);	<span class="comment">// -2</span></span><br><span class="line">    System.out.println(a / <span class="number">8</span>);	<span class="comment">// -1</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å¸¦ç¬¦å·å³ç§»çš„æ“ä½œå¯ä»¥ä¿è¯ç§»åŠ¨ä¹‹å‰å’Œç§»åŠ¨ä¹‹åæ•°å­—çš„æ­£è´Ÿå±æ€§ä¸å˜ï¼ŒåŸæ¥æ˜¯æ­£æ•°ï¼Œä¸ç®¡ç§»åŠ¨å¤šå°‘ä½ï¼Œç§»åŠ¨ä¹‹åè¿˜æ˜¯æ­£æ•°ï¼ŒåŸæ¥æ˜¯è´Ÿæ•°ï¼Œç§»åŠ¨ä¹‹åè¿˜æ˜¯è´Ÿæ•°ã€‚</p>
<p><strong>å¯¹äºä»»ä½• ä¸€ä¸ªbyteã€short æˆ–è€… int ç±»å‹çš„æ•°æ®è€Œè¨€ï¼Œå¸¦ç¬¦å·å³ç§»31ä½ä¹‹åï¼Œå¾—åˆ°çš„å¿…ç„¶æ˜¯ 0 æˆ–è€…æ˜¯ -1ã€‚å¯¹äº long ç±»å‹çš„æ•°æ®è€Œè¨€ï¼Œå¸¦ç¬¦å·å³ç§» 63 ä½ä¹‹åï¼Œå¾—åˆ°çš„ä¹Ÿå¿…ç„¶æ˜¯ 0 æˆ–è€…æ˜¯ -1ã€‚</strong></p>
<p><br></p>
<h3 id="ä¸ƒã€æ— ç¬¦å·å³ç§»è¿ç®—ç¬¦"><a href="#ä¸ƒã€æ— ç¬¦å·å³ç§»è¿ç®—ç¬¦" class="headerlink" title="ä¸ƒã€æ— ç¬¦å·å³ç§»è¿ç®—ç¬¦"></a>ä¸ƒã€æ— ç¬¦å·å³ç§»è¿ç®—ç¬¦</h3><p>æ— ç¬¦å·å³ç§»è¿ç®—ç¬¦çš„å†™æ³•æ˜¯ <strong>&gt;&gt;&gt;</strong>ï¼Œå¸¦ç¬¦å·å³ç§»çš„è¿ç®—è§„åˆ™ä¸æ— ç¬¦å·å³ç§»çš„è¿ç®—è§„åˆ™å·®åˆ«å°±åœ¨äºï¼šæ— ç¬¦å·å³ç§»åœ¨äºŒè¿›åˆ¶ä¸²ç§»åŠ¨ä¹‹åï¼Œç©ºä½ç”±0æ¥è¡¥å……ï¼Œä¸ç¬¦å·ä½æ˜¯0è¿˜æ˜¯1æ¯«æ— å…³ç³»ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://s4.ax1x.com/2021/12/15/TSmzV0.png" alt="image"></p>
<div class="note danger">
            <p>è¿›è¡Œä½è¿ç®—çš„æ—¶å€™ï¼Œæœ€å·¦è¾¹çš„ç¬¦å·ä½ä¹Ÿæ˜¯è¦å‚ä¸è¿ç®—çš„ã€‚</p>
          </div>
]]></content>
  </entry>
  <entry>
    <title>åˆ¶ä½œä¿„ç½—æ–¯æ–¹å—</title>
    <url>/2021/08/29/%E5%88%B6%E4%BD%9C%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹å‰æ¸¸æˆæ ‡ç­¾ä¸‹åªæ˜¯å¤§è‡´åšäº†ä¸ªç›®å½•ï¼Œæ¸¸æˆå®è´¨å†…å®¹å¹¶æ²¡æœ‰å®ç°ï¼Œæœ€è¿‘åˆè¶…çº§ä¸æƒ³å­¦<code>Deep Learning</code>ï¼Œå°±æ¥æŠŠè¿™ä¸ªä¿„ç½—æ–¯æ–¹å—ç»™å†™äº†å§ï¼Œåç»­çš„æ¸¸æˆç­‰æœ‰ç©ºå†å†™ï¼ˆä¸‹æ¬¡ä¸€å®šï¼‰ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/08/29/hG3GOx.jpg" alt="empty"></p>
<span id="more"></span>
<p><br></p>
<h2 id="è®¾è®¡"><a href="#è®¾è®¡" class="headerlink" title="è®¾è®¡"></a>è®¾è®¡</h2><p>å†™æ¸¸æˆå˜›ï¼Œè‚¯å®šè¦å…ˆæŠŠå¤§è‡´çš„æ¡†æ¶å’Œè¦å®ç°çš„åŠŸèƒ½æƒ³å¥½ã€‚äºæ˜¯æˆ‘å°±ç”»äº†ä¸ªæ¯”è¾ƒç®€ç•¥çš„å›¾ï¼Œä¸è¿‡åº”è¯¥è¿˜æ˜¯æŒºæ¸…æ¥šçš„ï¼Œè¿˜é™„åŠ äº†å°ºå¯¸ï¼Œæ²¡æåˆ°çš„éƒ¨åˆ†å°±è‡ªç”±å‘æŒ¥å§ï¼Œæ€ä¹ˆèˆ’æœæ€ä¹ˆæ¥ã€‚</p>
<p>å…¶ä¸­æ¯ä¸ªä¿„ç½—æ–¯æ–¹å—éƒ½æ˜¯ç”±å››ä¸ªå°æ–¹å—ç»„æˆï¼Œæ¯ä¸ªå°æ–¹å—éƒ½æ˜¯32px * 32pxçš„ï¼Œä¸€å…±19è¡Œï¼Œ12åˆ—ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/08/29/hGGVaT.jpg" alt="design"></p>
<p>å®é™…HTMLå®ç°æ•ˆæœå¦‚ä¸‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/08/29/hGGQMR.jpg" alt="efficiency"></p>
<p>ç„¶åè®¾è®¡æ¯ä¸€ä¸ªä¿„ç½—æ–¯æ–¹å—ï¼Œç”±äºè€ƒè™‘åˆ°æ—‹è½¬çš„é—®é¢˜ï¼Œè¿™é‡Œå°†ä»–ä»¬éƒ½ç”¨ä¸€ä¸ªå¤§çš„çŸ©å½¢æ¡†èµ·æ¥ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/08/29/hGBD3V.jpg" alt="tetrisCube"></p>
<p>å¹³ç§»å°±ä¸ç”¨å¤šè¯´äº†ï¼Œæˆ‘å°±ç€é‡è¯´ä¸‹æ—‹è½¬å§ï¼</p>
<p>ä¸‹é¢æ˜¯Lå‹çš„æ—‹è½¬å›¾ç¤ºï¼Œä»å·¦è‡³å³ï¼Œä»ä¸Šè‡³ä¸‹ï¼Œæˆ‘æŠŠå¯¹åº”æ–¹å—çš„Xï¼ŒYåæ ‡ä¹Ÿå†™åœ¨æ—è¾¹äº†ã€‚</p>
<p>ä»”ç»†è§‚å¯Ÿçš„è¯å¯ä»¥å‘ç°ï¼Œæ—‹è½¬ä¹‹åå›¾å½¢çš„Yå°±æ˜¯æ—‹è½¬ä¹‹å‰å›¾å½¢çš„Xï¼Œè€Œæ—‹è½¬ä¹‹åå›¾å½¢çš„Xå°±æ˜¯æ—‹è½¬ä¹‹å‰çš„ï¼ˆ3 - Yï¼‰ã€‚</p>
<p>ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ—‹è½¬ä¹Ÿä¼šè¶Šç•Œï¼Œéœ€åšä¸€å®šçš„åˆ¤æ–­ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/08/29/hGzkdO.jpg" alt="rotate"></p>
<p><br></p>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>è®¾è®¡å¥½å®ç°çš„æ¡†æ¶åï¼Œå†æ·»åŠ äº¿ç‚¹ä»£ç å°±å®Œäº‹äº†<span class="github-emoji" style="display:inline;vertical-align:middle"><span>ğŸ˜¢</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f622.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>
<p>è¿™é‡Œå°±ä¸æŠŠä»£ç è´´å‡ºæ¥äº†ï¼Œæ²¡æ€ä¹ˆå†™æ³¨é‡Šï¼Œè®©æˆ‘å†çœ‹ä¸€éä¹Ÿè´¹åŠ²ï¼Œç›¸ä¿¡èªæ˜çš„äººçœ‹äº†ä¸Šé¢çš„è®¾è®¡å›¾å°±ä¼šæœ‰æ€è·¯äº†ã€‚</p>
<p>ä»æ˜¨å¤©ä¸‹åˆå†™åˆ°ä»Šå¤©ä¸‹åˆï¼Œä¸€åŠçš„æ—¶é—´éƒ½åœ¨æ”¹bugï¼Œä¸æ˜¯å¾ˆä¼šç”¨JSçš„debugã€‚</p>
<p><img src="https://z3.ax1x.com/2021/08/30/htyG1s.gif" alt="code"></p>
]]></content>
      <categories>
        <category>Game</category>
      </categories>
      <tags>
        <tag>æ¸¸æˆåˆ¶ä½œ</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ¶ä½œè´ªåƒè›‡</title>
    <url>/2021/09/10/%E5%88%B6%E4%BD%9C%E8%B4%AA%E5%90%83%E8%9B%87/</url>
    <content><![CDATA[<h2 id="è®¾è®¡"><a href="#è®¾è®¡" class="headerlink" title="è®¾è®¡"></a>è®¾è®¡</h2><p>ç›´æ¥æ­¥å…¥æ­£é¢˜ï¼Œç”±äºæ¸¸æˆæœ¬èº«æ¸¸ç©ä»¥åŠæ“ä½œæ¯”è¾ƒç®€å•ï¼Œå› æ­¤è¿™æ¬¡çš„æ¸¸æˆç•Œé¢ä¼šæœ‰ç‚¹ç®€é™‹ï¼Œå®åœ¨æ˜¯ä¸çŸ¥é“è¯¥åŠ å•¥ä¸œè¥¿äº†<span class="github-emoji" style="display:inline;vertical-align:middle"><span>ğŸ˜¿</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f63f.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>
<p>æ¸¸æˆä¸»ä½“éƒ¨åˆ†æ˜¯å®½ä¸º650pxï¼Œé«˜ä¸º450pxï¼Œè€Œå°è›‡çš„æ¯ä¸€æ ¼èº«ä½“éƒ½æ˜¯25 * 25çš„ï¼Œå› æ­¤æ•´ä¸ªæ¸¸æˆç•Œé¢æœ‰18è¡Œï¼Œ26åˆ—ã€‚</p>
<p>è¿™ä¸€æ¬¡æˆ‘ä¼šå°½é‡æŠŠæ¯ä¸€ä¸ªåŠŸèƒ½çš„ä»£ç éƒ½è®°å½•ä¸‹æ¥ï¼Œä¸€æ˜¯å› ä¸ºè¿™ä¸ªè´ªåƒè›‡ä»£ç è‚¯å®šæ¯”ä¿„ç½—æ–¯æ–¹å—è¦å°‘ï¼ŒäºŒæ˜¯å› ä¸ºï¼Œä¸å†™ä»£ç çš„è¯ï¼Œæˆ‘è¿™ç¯‡åšå®¢å·²ç»ç»“æŸäº†ï¼Œè¿™ä¹Ÿå¤ªçŸ­äº†å§å–‚ï¼</p>
<p><img src="https://z3.ax1x.com/2021/09/10/hjBnGF.jpg" alt=""></p>
<span id="more"></span>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>HTMLä»£ç å¦‚ä¸‹ï¼Œå¸ƒå±€éƒ½æ˜¯é‡‡ç”¨positionï¼šabsoluteçš„æ–¹å¼ï¼Œå› ä¸ºéƒ¨ä»¶æ¯”è¾ƒå°‘ï¼Œè¿™æ ·ä»£ç ä¹Ÿä¸ä¼šå¾ˆç¹çï¼Œè€Œä¸”å¾ˆç®€å•ã€‚</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>è´ªåƒè›‡<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./snake.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">			<span class="selector-tag">div</span>{</span></span><br><span class="line"><span class="css">				<span class="attribute">border</span>: <span class="number">#000000</span> <span class="number">3.5px</span> solid;</span></span><br><span class="line"><span class="css">			}</span></span><br><span class="line"><span class="css">			</span></span><br><span class="line"><span class="css">			<span class="selector-class">.container</span>{</span></span><br><span class="line"><span class="css">				<span class="attribute">height</span>: <span class="number">570px</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">width</span>: <span class="number">707px</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">				<span class="attribute">margin</span>: <span class="number">0px</span> auto;</span></span><br><span class="line"><span class="css">				<span class="attribute">margin-top</span>: <span class="number">75px</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">			}</span></span><br><span class="line"><span class="css">			</span></span><br><span class="line"><span class="css">			<span class="selector-class">.gameDiv</span>{</span></span><br><span class="line"><span class="css">				<span class="attribute">height</span>: <span class="number">450px</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">width</span>: <span class="number">650px</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">				<span class="attribute">left</span>: <span class="number">25px</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">top</span>: <span class="number">70px</span>;</span></span><br><span class="line"><span class="css">			}</span></span><br><span class="line"><span class="css">			</span></span><br><span class="line"><span class="css">			<span class="selector-tag">p</span>{</span></span><br><span class="line"><span class="css">				<span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">				<span class="attribute">font-weight</span>: <span class="number">600</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">right</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="css">			}</span></span><br><span class="line"><span class="css">			</span></span><br><span class="line"><span class="css">			<span class="selector-class">.length</span>{</span></span><br><span class="line"><span class="css">				<span class="attribute">top</span>: -<span class="number">5px</span>;</span></span><br><span class="line"><span class="css">			}</span></span><br><span class="line"><span class="css">			</span></span><br><span class="line"><span class="css">			<span class="selector-class">.score</span>{</span></span><br><span class="line"><span class="css">				<span class="attribute">top</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">			}</span></span><br><span class="line"><span class="css">			</span></span><br><span class="line"><span class="css">			<span class="selector-tag">h2</span>{</span></span><br><span class="line"><span class="css">				<span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">				<span class="attribute">font-weight</span>: <span class="number">600</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">left</span>: <span class="number">305px</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">font-size</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">top</span>: -<span class="number">10px</span>;</span></span><br><span class="line"><span class="css">			}</span></span><br><span class="line"><span class="css">			</span></span><br><span class="line"><span class="css">			<span class="selector-class">.deflory</span>{</span></span><br><span class="line"><span class="css">				<span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">				<span class="attribute">bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">right</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="css">				<span class="attribute">width</span>: <span class="number">150px</span>;</span></span><br><span class="line"><span class="css">			}</span></span><br><span class="line"><span class="css">			</span></span><br><span class="line"><span class="css">			<span class="selector-class">.snakeCube</span>{</span></span><br><span class="line"><span class="css">				<span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">			}</span></span><br><span class="line"><span class="css">		</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">"init()"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">h2</span>&gt;</span>è´ªåƒè›‡<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"length"</span>&gt;</span></span><br><span class="line">				é•¿åº¦ï¼š</span><br><span class="line">			<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"score"</span>&gt;</span></span><br><span class="line">				åˆ†æ•°ï¼š</span><br><span class="line">			<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"gameDiv"</span>&gt;</span></span><br><span class="line">				</span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/Deflory.png"</span> <span class="attr">class</span>=<span class="string">"deflory"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h4 id="1-ç§»åŠ¨è´ªåƒè›‡"><a href="#1-ç§»åŠ¨è´ªåƒè›‡" class="headerlink" title="1. ç§»åŠ¨è´ªåƒè›‡"></a>1. ç§»åŠ¨è´ªåƒè›‡</h4><p>ï¼ˆ1ï¼‰ é”®ç›˜ç›‘å¬</p>
<p>é¦–å…ˆéœ€è¦è®©å°è›‡åŠ¨èµ·æ¥ï¼Œå› æ­¤å°±ä¼šéœ€è¦é”®ç›˜ç›‘å¬äº‹ä»¶ã€‚</p>
<p>å‡¡äº‹éƒ½ä¸èƒ½ä¸€å£åƒæˆä¸€ä¸ªå¤§èƒ–å­ï¼Œä¸è¦æ€¥ç€å†™ç§»åŠ¨çš„åŠŸèƒ½ï¼Œå…ˆçœ‹çœ‹èƒ½å¦ç›‘å¬åˆ°é”®ç›˜ã€‚</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> ROWS = <span class="number">18</span></span><br><span class="line"><span class="keyword">var</span> COLS = <span class="number">26</span></span><br><span class="line"><span class="keyword">var</span> SNAKE_SIZE = <span class="number">25</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>)</span>{</span><br><span class="line">	onKeyDown();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// é”®ç›˜ç›‘å¬äº‹ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onKeyDown</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="built_in">document</span>.onkeydown = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>{</span><br><span class="line">		<span class="keyword">switch</span>(event.keyCode){</span><br><span class="line">			<span class="comment">// W å’Œ â†‘</span></span><br><span class="line">			<span class="keyword">case</span> <span class="number">38</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">87</span>:{</span><br><span class="line">				<span class="built_in">console</span>.log(<span class="string">"ä¸Š"</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			}</span><br><span class="line">			<span class="comment">// A å’Œ â†</span></span><br><span class="line">			<span class="keyword">case</span> <span class="number">37</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">65</span>:{</span><br><span class="line">				<span class="built_in">console</span>.log(<span class="string">"å·¦"</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			}</span><br><span class="line">			<span class="comment">// S å’Œ â†“</span></span><br><span class="line">			<span class="keyword">case</span> <span class="number">40</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">83</span>:{</span><br><span class="line">				<span class="built_in">console</span>.log(<span class="string">"ä¸‹"</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			}</span><br><span class="line">			<span class="comment">// D å’Œ â†’</span></span><br><span class="line">			<span class="keyword">case</span> <span class="number">39</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">68</span>:{</span><br><span class="line">				<span class="built_in">console</span>.log(<span class="string">"å³"</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ç¨å¾®æŒ‰äº†å‡ ä¸‹ï¼Œæµè§ˆå™¨çš„è¾“å‡ºä¹Ÿæ­£å¸¸ï¼Œæ¥ä¸‹æ¥å°±å¼€å§‹å†™ç§»åŠ¨çš„å‡½æ•°äº†ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/10/hjfPHg.jpg" alt="console"></p>
<p>ä½†åœ¨æ­¤ä¹‹å‰ï¼Œè¿˜æœ‰ä¸€ä»¶äº‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/10/hjIFs0.png" alt="havesomethingmore"></p>
<p>ï¼ˆ2ï¼‰ åˆ›å»ºå°è›‡</p>
<p>æˆ‘ä»¬æ²¡æœ‰ä¸œè¥¿å»ç§»åŠ¨å•Šï¼æ‰€ä»¥è¦å†™ä¸€ä¸ªå°è›‡åˆå§‹åŒ–çš„å‡½æ•°ã€‚</p>
<p>æ­¤å¤„snakeCubeç±»æˆ‘åªå†™äº†ä¸ªpositionï¼šabsoluteï¼Œä¸ç„¶æ¯æ¬¡å†™æŒºéº»çƒ¦çš„ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºåˆå§‹çš„è´ªåƒè›‡</span></span><br><span class="line"><span class="function">function <span class="title">createSnake</span><span class="params">()</span></span>{</span><br><span class="line">	game_div = document.getElementsByClassName(<span class="string">"gameDiv"</span>)[<span class="number">0</span>];</span><br><span class="line">	<span class="comment">// è›‡å¤´</span></span><br><span class="line">	snakeHead = document.createElement(<span class="string">"img"</span>);</span><br><span class="line">	snakeHead.setAttribute(<span class="string">"src"</span>,<span class="string">"./img/right.png"</span>)</span><br><span class="line">	snakeHead.className = <span class="string">"snakeCube"</span>;</span><br><span class="line">	game_div.appendChild(snakeHead);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// è›‡èº«Ã—3</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++){</span><br><span class="line">		snakeBody = document.createElement(<span class="string">"img"</span>);</span><br><span class="line">		snakeBody.setAttribute(<span class="string">"src"</span>,<span class="string">"./img/body.png"</span>)</span><br><span class="line">		snakeBody.className = <span class="string">"snakeCube"</span>;</span><br><span class="line">		game_div.appendChild(snakeBody);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å¦‚æœå•å•åªæ˜¯åˆ›å»ºå…ƒç´ ï¼Œè€Œä¸ç»™å®ƒâ€œå®šä½â€ï¼Œä¹Ÿå°±æ˜¯è®¾å®štopå’Œleftå€¼ï¼Œä»–æ˜¾ç¤ºæ˜¯ä¼šå åœ¨ä¸€èµ·çš„ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/10/hjozgs.jpg" alt="error"></p>
<p>ï¼ˆ3ï¼‰ å®šä½</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œè¿˜æœ‰ä¸€ä»¶äº‹ï¼Œå†å†™ä¸€ä¸ªå®šä½çš„å‡½æ•°ã€‚ä¸è¦å¿˜äº†åœ¨createSnakeçš„æœ«å°¾åŠ ä¸Šè¿™ä¸ªå®šä½å‡½æ•°ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/10/hjogHK.jpg" alt=""></p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// å®šä½è›‡çš„ä½ç½®</span></span><br><span class="line"><span class="keyword">var</span> snakeLocation = [[<span class="number">200</span>, <span class="number">125</span>],[<span class="number">175</span>, <span class="number">125</span>],[<span class="number">150</span>, <span class="number">125</span>],[<span class="number">125</span>, <span class="number">125</span>]]</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">snakeLocate</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="keyword">var</span> snakes = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"snakeCube"</span>);</span><br><span class="line">	<span class="keyword">var</span> len = snakes.length;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;len;i++){</span><br><span class="line">		snakes[i].style.left = snakeLocation[i][<span class="number">0</span>] + <span class="string">"px"</span>;</span><br><span class="line">		snakes[i].style.top = snakeLocation[i][<span class="number">1</span>] + <span class="string">"px"</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/10/hjbUM9.jpg" alt=""></p>
<p>ï¼ˆ4ï¼‰ ç§»åŠ¨</p>
<p>å¥½äº†ï¼Œå†ç»åƒè¾›ä¸‡è‹¦ï¼Œç»ˆäºå¯ä»¥å‡†å¤‡è®©è¿™ä¸ªå°è›‡åŠ¨èµ·æ¥äº†ã€‚</p>
<p>å…ˆæ¥è§£é‡Šä¸‹è¿™é‡Œçš„é€»è¾‘å§ï¼Œæƒ³æƒ³è´ªåƒè›‡æ˜¯æ€ä¹ˆç§»åŠ¨çš„å‘¢ï¼Ÿ</p>
<p>æ˜¯ä¸æ˜¯å¤´å…ˆåŠ¨ï¼Œç„¶åç´§æ¥ç€ç¬¬ä¸€èŠ‚èº«ä½“ç§»åŠ¨åˆ°åŸå…ˆå¤´çš„ä½ç½®ï¼Œç¬¬äºŒèŠ‚èº«ä½“ç§»åŠ¨åˆ°åŸå…ˆç¬¬ä¸€èŠ‚èº«ä½“çš„ä½ç½®ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦æŠŠsnakeLocationæ•°ç»„ä»åå¾€å‰è¦†ç›–å°±è¡Œäº†ï¼ˆä¸èƒ½ä»å…ˆå¾€åå™¢ï¼Œæƒ³æƒ³å°±æ˜ç™½äº†ï¼‰ã€‚</p>
<p>æ­¤å¤–è¿™é‡Œxï¼Œyéƒ½æ˜¯å•ä½é•¿åº¦ï¼Œå› æ­¤è¿˜è¦ä¹˜ä»¥è›‡çš„å¤§å°ã€‚</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// è´ªåƒè›‡ç§»åŠ¨ï¼Œxä¸ºæ¨ªå‘ï¼Œyä¸ºçºµå‘</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params">x, y</span>)</span>{</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=snakeLen-<span class="number">1</span>;i&gt;<span class="number">0</span>;i--){</span><br><span class="line">		snakeLocation[i][<span class="number">0</span>] = snakeLocation[i-<span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">		snakeLocation[i][<span class="number">1</span>] = snakeLocation[i-<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">	}</span><br><span class="line">	snakeLocation[<span class="number">0</span>][<span class="number">0</span>] = snakeLocation[<span class="number">0</span>][<span class="number">0</span>] + SNAKE_SIZE * x;</span><br><span class="line">	snakeLocation[<span class="number">0</span>][<span class="number">1</span>] = snakeLocation[<span class="number">0</span>][<span class="number">1</span>] + SNAKE_SIZE * y;</span><br><span class="line">	snakeLocate();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å¥½åƒç•¥å¾®æœ‰äº›æƒŠæ‚šå˜›ï¼Œä¸è¿‡æ²¡å…³ç³»ï¼Œä¿®æ”¹ä¸€ä¸‹ç§»åŠ¨æ—¶å¤´éƒ¨çš„æ–¹å‘å°±è¡Œã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/10/hjO7RO.png" alt=""></p>
<p>åªéœ€è¦åœ¨ç§»åŠ¨å‰ä¿®æ”¹æ–¹å‘å˜é‡ï¼Œå®šä½æ—¶åˆ¤æ–­æ–¹å‘å³å¯ï¼Œè¿™é‡Œä»£ç å¤ªå¤šå°±æ”¾å‡ºæ¥ä¸€éƒ¨åˆ†ã€‚</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> snakeHeadDirection = <span class="string">"right"</span>;</span><br><span class="line"><span class="comment">// é”®ç›˜ç›‘å¬äº‹ä»¶ï¼Œ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onKeyDown</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="built_in">document</span>.onkeydown = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>{</span><br><span class="line">		<span class="keyword">switch</span>(event.keyCode){</span><br><span class="line">			<span class="comment">// W å’Œ â†‘</span></span><br><span class="line">			<span class="keyword">case</span> <span class="number">38</span>:</span><br><span class="line">			<span class="keyword">case</span> <span class="number">87</span>:{</span><br><span class="line">				snakeHeadDirection = <span class="string">"up"</span>;</span><br><span class="line">				move(<span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">				<span class="built_in">console</span>.log(<span class="string">"ä¸Š"</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä½è›‡çš„ä½ç½®</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">snakeLocate</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="keyword">var</span> snakes = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"snakeCube"</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;snakeLen;i++){</span><br><span class="line">		snakes[i].style.left = snakeLocation[i][<span class="number">0</span>] + <span class="string">"px"</span>;</span><br><span class="line">		snakes[i].style.top = snakeLocation[i][<span class="number">1</span>] + <span class="string">"px"</span>;</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">switch</span>(snakeHeadDirection){</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"up"</span>:{</span><br><span class="line">			snakes[<span class="number">0</span>].setAttribute(<span class="string">"src"</span>,<span class="string">"./img/up.png"</span>)</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/10/hjzREj.gif" alt=""></p>
<h4 id="2-ç¢°æ’åˆ¤å®š"><a href="#2-ç¢°æ’åˆ¤å®š" class="headerlink" title="2. ç¢°æ’åˆ¤å®š"></a>2. ç¢°æ’åˆ¤å®š</h4><p>ï¼ˆ1ï¼‰ è‡ªèº«ç¢°æ’åˆ¤å®š</p>
<p>è´ªåƒè›‡ç¢°åˆ°è‡ªå·±èº«ä½“å°±åº”è¯¥ç»“æŸæ¸¸æˆäº†ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/10/hvSKsS.png" alt=""></p>
<p>è‡ªèº«ç¢°æ’åˆ¤å®šæ— éå°±æ˜¯åˆ¤æ–­å¤´å’Œèº«ä½“æœ‰æ²¡æœ‰ç¢°æ’ï¼Œä¸€ä¸ªfor-loopå°±è¡Œäº†ã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªflagï¼Œæ¥åˆ¤æ–­å½“å‰æ˜¯å¦å·²ç»ç»“æŸï¼Œé»˜è®¤æ˜¯falseã€‚</p>
<p>å‡½æ•°å®ç°èµ·æ¥æ¯”è¾ƒè½»æ¾ï¼Œæ³¨æ„æ¯æ¬¡moveéƒ½éœ€åˆ¤æ–­ï¼Œè€Œä¸”å¾—åœ¨â€œå®šä½â€ä¹‹å‰åˆ¤æ–­ã€‚</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// è‡ªèº«ç¢°æ’åˆ¤å®š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isTouchItself</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="keyword">var</span> left = snakeLocation[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">var</span> top = snakeLocation[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">1</span>;i&lt;snakeLen;i++){</span><br><span class="line">		<span class="keyword">if</span>(left == snakeLocation[i][<span class="number">0</span>] &amp;&amp; top == snakeLocation[i][<span class="number">1</span>]){</span><br><span class="line">			gameover = <span class="literal">true</span>;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ç„¶åè¿˜å¾—ä¿®æ”¹ä¸€ä¸‹é”®ç›˜ç›‘å¬äº‹ä»¶ï¼Œåªæœ‰gameover = falseæ—¶æ‰ç›‘å¬ç§»åŠ¨äº‹ä»¶ã€‚</p>
<p>è¿™é‡Œæˆ‘å¤šæ·»åŠ äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸€ä¼šå„¿å®ç°ã€‚</p>
<p>ä¸€ä¸ªæ˜¯gameover = trueæ—¶çš„restart()ï¼›ä¸€ä¸ªæ˜¯gameover = falseæ—¶çš„pause()ã€‚</p>
<p>å‰è€…ç”¨äºé‡æ–°å¼€å§‹ï¼Œåè€…ç”¨äºæ¸¸æˆæš‚åœ</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// é”®ç›˜ç›‘å¬äº‹ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onKeyDown</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="built_in">document</span>.onkeydown = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span>{</span><br><span class="line">		<span class="keyword">if</span>(!gameover){</span><br><span class="line">			<span class="keyword">switch</span>(event.keyCode){</span><br><span class="line">				<span class="comment">// W å’Œ â†‘</span></span><br><span class="line">				<span class="keyword">case</span> <span class="number">38</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">87</span>:{</span><br><span class="line">					snakeHeadDirection = <span class="string">"up"</span>;</span><br><span class="line">					move(<span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">					<span class="built_in">console</span>.log(<span class="string">"ä¸Š"</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">				<span class="comment">// A å’Œ â†</span></span><br><span class="line">				<span class="keyword">case</span> <span class="number">37</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">65</span>:{</span><br><span class="line">					snakeHeadDirection = <span class="string">"left"</span>;</span><br><span class="line">					move(-<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">					<span class="built_in">console</span>.log(<span class="string">"å·¦"</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">				<span class="comment">// S å’Œ â†“</span></span><br><span class="line">				<span class="keyword">case</span> <span class="number">40</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">83</span>:{</span><br><span class="line">					snakeHeadDirection = <span class="string">"down"</span>;</span><br><span class="line">					move(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">					<span class="built_in">console</span>.log(<span class="string">"ä¸‹"</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">				<span class="comment">// D å’Œ â†’</span></span><br><span class="line">				<span class="keyword">case</span> <span class="number">39</span>:</span><br><span class="line">				<span class="keyword">case</span> <span class="number">68</span>:{</span><br><span class="line">					snakeHeadDirection = <span class="string">"right"</span>;</span><br><span class="line">					move(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">					<span class="built_in">console</span>.log(<span class="string">"å³"</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">				<span class="comment">// ç©ºæ ¼é”®</span></span><br><span class="line">				<span class="keyword">case</span> <span class="number">32</span>:{</span><br><span class="line">					pause();</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">		}<span class="keyword">else</span>{</span><br><span class="line">			<span class="keyword">switch</span>(event.keyCode){</span><br><span class="line">				<span class="comment">// ç©ºæ ¼é”®</span></span><br><span class="line">				<span class="keyword">case</span> <span class="number">32</span>:{</span><br><span class="line">					restart();</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰ è¾¹æ¡†ç¢°æ’åˆ¤å®š</p>
<p>è´ªåƒè›‡æ˜¯ä¸èƒ½ç©¿è¶Šè¿™ä¸ªæ¸¸æˆçš„è¾¹æ¡†çš„ï¼Œè‡³äºç¢°åˆ°è¾¹æ¡†æ˜¯ä¼šæ­»ï¼Œè¿˜æ˜¯ä»å¦ä¸€è¾¹å‡ºæ¥å¯ä»¥è‡ªç”±å‘æŒ¥ã€‚</p>
<p>æˆ‘è¿™é‡Œå®ç°çš„æ˜¯ä»å¦ä¸€å¤´å‡ºæ¥çš„æ–¹å¼ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/10/hvSWLD.png" alt=""></p>
<p>ç±»ä¼¼è‡ªèº«ç¢°æ’åˆ¤å®šï¼Œä¹Ÿæ˜¯è¦åœ¨â€œå®šä½â€ä¹‹å‰åˆ¤æ–­ã€‚</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// è¾¹ç•Œç¢°æ’åˆ¤å®š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">crashBoundary</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="keyword">var</span> left = snakeLocation[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">var</span> top = snakeLocation[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">if</span>(left &lt; <span class="number">0</span>){</span><br><span class="line">		snakeLocation[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">625</span>;</span><br><span class="line">	}<span class="keyword">else</span> <span class="keyword">if</span>(left &gt; <span class="number">625</span>){</span><br><span class="line">		snakeLocation[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">	}<span class="keyword">else</span> <span class="keyword">if</span>(top &lt; <span class="number">0</span>){</span><br><span class="line">		snakeLocation[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">425</span>;</span><br><span class="line">	}<span class="keyword">else</span> <span class="keyword">if</span>(top &gt; <span class="number">425</span>){</span><br><span class="line">		snakeLocation[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/10/hvwSEV.gif" alt=""></p>
<h4 id="3-æ¸¸æˆç»“æŸ"><a href="#3-æ¸¸æˆç»“æŸ" class="headerlink" title="3.æ¸¸æˆç»“æŸ"></a>3.æ¸¸æˆç»“æŸ</h4><p>ï¼ˆ1ï¼‰ è®¡æ—¶å™¨</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬çš„å°è›‡ä¸èƒ½è‡ªå·±åŠ¨ï¼Œéœ€è¦è®¾ç½®ä¸€ä¸ªè®¡æ—¶å™¨ã€‚</p>
<p>å› ä¸ºéœ€è¦æš‚åœå’Œç»§ç»­æ¸¸æˆï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ–¹æ³•ä¸­åˆ¤æ–­ï¼Œå¦‚æœå½“å‰æœ‰è®¡æ—¶å™¨å°±å–æ¶ˆå®ƒï¼Œæ²¡æœ‰åˆ™è®¾ç½®ä¸€ä¸ªã€‚</p>
<p>è®°å¾—åœ¨åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨ä¸€ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// æš‚åœ/ç»§ç»­æ¸¸æˆ</span></span><br><span class="line"><span class="keyword">var</span> timer = <span class="literal">null</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pause</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="keyword">if</span>(timer == <span class="literal">null</span>){</span><br><span class="line">		timer = <span class="built_in">setInterval</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{</span><br><span class="line">			<span class="keyword">switch</span>(snakeHeadDirection){</span><br><span class="line">				<span class="keyword">case</span> <span class="string">"up"</span>:{</span><br><span class="line">					move(<span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">				<span class="keyword">case</span> <span class="string">"down"</span>:{</span><br><span class="line">					move(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">				<span class="keyword">case</span> <span class="string">"left"</span>:{</span><br><span class="line">					move(-<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">				<span class="keyword">case</span> <span class="string">"right"</span>:{</span><br><span class="line">					move(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">		}, <span class="number">200</span>);</span><br><span class="line">	}<span class="keyword">else</span>{</span><br><span class="line">		<span class="built_in">clearInterval</span>(timer);</span><br><span class="line">		timer = <span class="literal">null</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æš‚åœçš„æ—¶å€™ï¼Œå±å¹•ä¸Šç©ºè¡è¡çš„ä¹Ÿä¸å¤§å¥½ï¼Œç»™äººæœ‰ä¸€ç§æ²¡æœ‰æš‚åœçš„é”™è§‰ã€‚æ‰€ä»¥åŠ ä¸€ä¸ªdivï¼Œç¾åŒ–ä¸‹æš‚åœçš„ç•Œé¢ã€‚</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-class">.paused</span>{</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">210px</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">9</span>; </span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">205px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">60px</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"paused"</span>&gt;</span></span><br><span class="line">    æŒ‰ä¸‹ SPACE ç»§ç»­æ¸¸æˆ</span><br><span class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/10/hvWBxx.png" alt=""></p>
<p>åœ¨ä¿®æ”¹ä¸‹ä¸Šé¢pauseæ–¹æ³•ï¼Œæš‚åœçš„æ—¶å€™æ˜¾ç¤ºæç¤ºï¼Œç»§ç»­æ—¶éšå»æç¤ºã€‚</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pause</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="keyword">if</span>(timer == <span class="literal">null</span>){</span><br><span class="line">		timer = <span class="built_in">setInterval</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{</span><br><span class="line">			<span class="keyword">switch</span>(snakeHeadDirection){</span><br><span class="line">				<span class="keyword">case</span> <span class="string">"up"</span>:{</span><br><span class="line">					move(<span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">				<span class="keyword">case</span> <span class="string">"down"</span>:{</span><br><span class="line">					move(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">				<span class="keyword">case</span> <span class="string">"left"</span>:{</span><br><span class="line">					move(-<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">				<span class="keyword">case</span> <span class="string">"right"</span>:{</span><br><span class="line">					move(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">		}, <span class="number">200</span>);</span><br><span class="line">		<span class="keyword">var</span> end = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"paused"</span>)[<span class="number">0</span>]</span><br><span class="line">		end.style.display = <span class="string">"none"</span>;</span><br><span class="line">	}<span class="keyword">else</span>{</span><br><span class="line">		<span class="built_in">clearInterval</span>(timer);</span><br><span class="line">		timer = <span class="literal">null</span>;</span><br><span class="line">		<span class="keyword">var</span> end = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"paused"</span>)[<span class="number">0</span>]</span><br><span class="line">		end.style.display = <span class="string">"block"</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰ æ¸¸æˆç»“æŸ</p>
<p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘åˆå†™äº†ä¸ªdivï¼Œå¯ä»¥å…ˆçœ‹çœ‹æ•ˆæœã€‚åŒæš‚åœç±»ä¼¼ï¼Œåªéœ€è¦å°†å®ƒçš„displayå€¼é»˜è®¤è®¾ä¸ºnoneï¼Œå¾…åˆ°æ¸¸æˆç»“æŸæ—¶åœ¨æ”¹æˆblockå³å¯ã€‚</p>
<p>å¤„äºç¾è§‚ï¼Œæˆ‘å°†æ¸¸æˆèƒŒæ™¯é¢œè‰²æ”¹æˆäº†æ·±ç°è‰²ã€‚</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-class">.gameover</span>{</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">190px</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">9</span>; </span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">205px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">60px</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"gameover"</span>&gt;</span></span><br><span class="line">    æ¸¸æˆç»“æŸ</span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    æŒ‰ä¸‹ <span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">"#ee3000"</span>&gt;</span>SPACE<span class="tag">&lt;/<span class="name">font</span>&gt;</span> é‡æ–°å¼€å§‹</span><br><span class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">final</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="keyword">var</span> end = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"gameover"</span>)[<span class="number">0</span>]</span><br><span class="line">	end.style.display = <span class="string">"none"</span>;</span><br><span class="line">	pause();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/10/hvgmVJ.png" alt=""></p>
<p>ï¼ˆ3ï¼‰ é‡æ–°å¼€å§‹</p>
<p>é‡æ–°å¼€å§‹éœ€è¦æŠŠæ‰€æœ‰çš„å˜é‡éƒ½é‡ç½®ï¼Œç„¶ååˆ é™¤æ¸¸æˆä¸­çš„è´ªåƒè›‡ï¼Œå†æŠŠæ¸¸æˆç»“æŸçš„æç¤ºéšå»ï¼Œç„¶åå’Œinit()ä¸€æ ·ã€‚</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// é‡æ–°å¼€å§‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">restart</span>(<span class="params"></span>)</span>{</span><br><span class="line">	snakeLocation = [[<span class="number">200</span>, <span class="number">125</span>],[<span class="number">175</span>, <span class="number">125</span>],[<span class="number">150</span>, <span class="number">125</span>],[<span class="number">125</span>, <span class="number">125</span>]]</span><br><span class="line">	snakeLen = <span class="number">4</span>;</span><br><span class="line">	snakeHeadDirection = <span class="string">"right"</span>;</span><br><span class="line">	gameover = <span class="literal">false</span>;</span><br><span class="line">	timer = <span class="literal">null</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">var</span> gameDiv = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"gameDiv"</span>)[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">var</span> children = gameDiv.children;</span><br><span class="line">	<span class="keyword">var</span> childrenLen = children.length;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=childrenLen-<span class="number">1</span>;i&gt;=<span class="number">0</span>;i--){</span><br><span class="line">		gameDiv.removeChild(children[i]);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">var</span> end = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"gameover"</span>)[<span class="number">0</span>]</span><br><span class="line">	end.style.display = <span class="string">"none"</span>; </span><br><span class="line">	createSnake();</span><br><span class="line">	pause();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-åˆ†æ•°ç³»ç»Ÿ"><a href="#4-åˆ†æ•°ç³»ç»Ÿ" class="headerlink" title="4. åˆ†æ•°ç³»ç»Ÿ"></a>4. åˆ†æ•°ç³»ç»Ÿ</h4><p>æœ€åå°±æ˜¯å°è›‡è›‡åƒçš„é£Ÿç‰©å•¦ã€‚</p>
<p>ï¼ˆ1ï¼‰ é£Ÿç‰©æ˜¯åœ¨å±å¹•ä¸­éšæœºå‡ºç°ï¼Œè€Œä¸”åƒå®Œä¸€ä¸ªå°±ä¼šå‡ºç°ä¸‹ä¸€ä¸ªã€‚</p>
<p>åˆ›å»ºé£Ÿç‰©åŒåˆ›å»ºå°è›‡ç±»ä¼¼ï¼Œåªæ˜¯å¤šäº†ä¸ªrandomå‡½æ•°ï¼Œè¦ç¡®ä¿é£Ÿç‰©éšæœºåœ¨æ¸¸æˆç•Œé¢ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºé£Ÿç‰©</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createFood</span>(<span class="params"></span>)</span>{</span><br><span class="line">	foodLeft = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * COLS);</span><br><span class="line">	foodTop = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * ROWS);</span><br><span class="line">	<span class="keyword">var</span> gameDiv = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"gameDiv"</span>)[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">var</span> food = <span class="built_in">document</span>.createElement(<span class="string">"img"</span>);</span><br><span class="line">	food.className = <span class="string">"foodCube"</span>;</span><br><span class="line">	food.setAttribute(<span class="string">"src"</span>,<span class="string">"./img/food.png"</span>);</span><br><span class="line">	food.style.top = foodTop * SNAKE_SIZE + <span class="string">"px"</span>;</span><br><span class="line">	food.style.left = foodLeft * SNAKE_SIZE + <span class="string">"px"</span>;</span><br><span class="line">	gameDiv.appendChild(food);</span><br><span class="line">	updateData();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰ åƒä¸€ä¸ªé•¿åº¦+1ï¼Œåˆ†æ•°+10ï¼Œä¸”å°è›‡çš„èº«ä½“+1ã€‚</p>
<p>è›‡å¤´ç¢°åˆ°é£Ÿç‰©å³åƒæ‰ï¼Œåˆ é™¤è¯¥imgï¼Œç„¶åç”Ÿæˆæ–°çš„é£Ÿç‰©ï¼›</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// åƒæ‰é£Ÿç‰©</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">eatFood</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="keyword">var</span> left = snakeLocation[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">var</span> top = snakeLocation[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">if</span>(foodLeft == left &amp;&amp; foodTop == top){</span><br><span class="line">		snakeLen++;</span><br><span class="line">		score += <span class="number">10</span>;</span><br><span class="line">		<span class="keyword">var</span> food = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"foodCube"</span>)[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">var</span> gameDiv = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"gameDiv"</span>)[<span class="number">0</span>];</span><br><span class="line">		gameDiv.removeChild(food);</span><br><span class="line">		createFood();</span><br><span class="line">		grow();</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// é•¿èº«ä½“</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">grow</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="keyword">var</span> gameDiv = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"gameDiv"</span>)[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">var</span> body = <span class="built_in">document</span>.createElement(<span class="string">"img"</span>);</span><br><span class="line">	body.className = <span class="string">"snakeCube"</span>;</span><br><span class="line">	body.setAttribute(<span class="string">"src"</span>,<span class="string">"./img/body.png"</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// å½“å‰æœ€åä¸€ä¸ªèº«ä½“çš„ä½ç½®</span></span><br><span class="line">	<span class="keyword">var</span> lastTop = snakeLocation[snakeLen-<span class="number">2</span>][<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">var</span> lastLeft = snakeLocation[snakeLen-<span class="number">2</span>][<span class="number">0</span>];</span><br><span class="line">	<span class="comment">// æ–°çš„èº«ä½“çš„ä½ç½®</span></span><br><span class="line">	<span class="keyword">var</span> bodyTop = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">var</span> bodyLeft = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">switch</span>(snakeHeadDirection){</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"up"</span>:{</span><br><span class="line">			bodyTop = lastTop + <span class="number">1</span>;</span><br><span class="line">			bodyLeft = lastLeft;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"down"</span>:{</span><br><span class="line">			bodyTop = lastTop - <span class="number">1</span>;</span><br><span class="line">			bodyLeft = lastLeft;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"left"</span>:{</span><br><span class="line">			bodyTop = lastTop;</span><br><span class="line">			bodyLeft = lastLeft + <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"right"</span>:{</span><br><span class="line">			bodyTop = lastTop;</span><br><span class="line">			bodyLeft = lastLeft - <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	body.style.top = bodyTop * SNAKE_SIZE + <span class="string">"px"</span>;</span><br><span class="line">	body.style.left = bodyLeft * SNAKE_SIZE + <span class="string">"px"</span>;</span><br><span class="line">	snakeLocation[snakeLen-<span class="number">1</span>] = [bodyLeft, bodyTop];</span><br><span class="line">	gameDiv.appendChild(body);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä¹‹åæ›´æ–°ç•Œé¢åˆ†æ•°</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// æ›´æ–°ç•Œé¢ä¸­åˆ†æ•°å’Œé•¿åº¦</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateData</span>(<span class="params"></span>)</span>{</span><br><span class="line">	<span class="keyword">var</span> scoreH1 = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"score"</span>)[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">var</span> lengthH1 = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"length"</span>)[<span class="number">0</span>];</span><br><span class="line">	scoreH1.innerHTML = <span class="string">"åˆ†æ•°ï¼š"</span> + score;</span><br><span class="line">	lengthH1.innerHTML = <span class="string">"é•¿åº¦ï¼š"</span> + snakeLen;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ3ï¼‰ åˆ†æ•°è¶Šé«˜ï¼Œå°è›‡ç§»åŠ¨é€Ÿåº¦è¶Šå¿«ã€‚</p>
<p>ä¸‰å¥ä»£ç å³å¯ï¼Œè®°å¾—æ·»åŠ åˆ°é€‚å½“çš„ä½ç½®ï¼Œè¿™é‡Œå°±ä¸ç»™å‡ºæ¥äº†ã€‚</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> speed = <span class="number">1</span>;</span><br><span class="line">speed += score / <span class="number">10</span> * <span class="number">0.05</span>;</span><br><span class="line"><span class="built_in">setInterval</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>{}, <span class="number">100</span> / speed);</span><br></pre></td></tr></tbody></table></figure>
<h4 id="5-æ¸¸æˆæ€§"><a href="#5-æ¸¸æˆæ€§" class="headerlink" title="5. æ¸¸æˆæ€§"></a>5. æ¸¸æˆæ€§</h4><p>è‡³æ­¤ï¼Œè´ªåƒè›‡çš„ä»£ç å·²å…¨éƒ¨å†™å®Œï¼Œä¹‹åå¯ä»¥æŒ‰è‡ªå·±çš„æƒ³æ³•æ·»åŠ ä¸€äº›æ¸¸æˆçš„è§„åˆ™ï¼Œä¾‹å¦‚å¯ä»¥æ·»åŠ ä¸€ä¸ªçº¢è‰²æœå®çš„è®¾å®šï¼Œæ•ˆæœæ˜¯ç»¿è‰²æœå®çš„ä¸‰å€ï¼Œå‡ºç°æ¦‚ç‡10%ã€‚æˆ‘å°±ä¸å®ç°äº†ï¼Œç°åœ¨å·²ç»å‡Œæ™¨äº†ï¼Œç´¯äº†ã€‚</p>
<p>æ¸¸æˆè¿è¡Œç”»é¢å¦‚ä¸‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/11/hvLwJf.gif" alt=""></p>
<p>ä»¥åå†™å°æ¸¸æˆå°±ä¸å†™è¿™ä¹ˆè¯¦ç»†äº†ï¼Œè¿™ä¹Ÿå¤ªç´¯äº†<span class="github-emoji" style="display:inline;vertical-align:middle"><span>ğŸ˜­</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f62d.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>
]]></content>
      <categories>
        <category>Game</category>
      </categories>
      <tags>
        <tag>æ¸¸æˆåˆ¶ä½œ</tag>
      </tags>
  </entry>
  <entry>
    <title>å¤šé¡¹å¼å›å½’</title>
    <url>/2021/09/27/%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%9B%9E%E5%BD%92/</url>
    <content><![CDATA[<h2 id="ç®—æ³•æ€æƒ³"><a href="#ç®—æ³•æ€æƒ³" class="headerlink" title="ç®—æ³•æ€æƒ³"></a>ç®—æ³•æ€æƒ³</h2><p>å¦‚æœä½ çš„æ•°æ®æ¯”ç›´çº¿æ›´å¤æ‚æ€ä¹ˆåŠï¼Ÿä¾‹å¦‚æŠ›ç‰©çº¿ã€‚æ˜¾ç„¶ <a href="/2021/09/13/çº¿æ€§å›å½’">çº¿æ€§å›å½’</a> æ— æ³•èƒœä»»è¿™ä¸ªå·¥ä½œï¼Œä½†æˆ‘ä»¬åªéœ€è¦ç¨åŠ ä¿®æ”¹ï¼Œå°†æ¯ä¸ªç‰¹å¾çš„å¹‚æ¬¡æ–¹ä½œä¸ºä¸€ä¸ªæ–°ç‰¹å¾å³å¯ï¼Œå¤§è‡´ä¸<code>çº¿æ€§å›å½’</code>ç±»ä¼¼ï¼Œä¸è¿‡æ˜¯å¤šå…ƒä¸€æ¬¡å’Œå¤šå…ƒå¤šæ¬¡çš„åŒºåˆ«ã€‚</p>
<p>çº¿æ€§å›å½’å‡è®¾ç›®æ ‡æ‹Ÿåˆæ›²çº¿å‡½æ•°ä¸º$y = w_1x_1 + w_2x_2 + w_3x_3 + â€¦ + b$ï¼Œå…¶ä¸­ $w_n$ ä¸ºç³»æ•° $x_n$ ä¸ºç‰¹å¾ã€‚</p>
<p>è€Œå¤šé¡¹å¼å›å½’å‡è®¾ç›®æ ‡æ‹Ÿåˆæ›²çº¿ä¸º$y = w_1x_1^n + w_2x_1^{n-1}x_2 + w_3x_1^{n-2}x_2^2 + â€¦ + w_nx_2^n$ï¼Œè¿™é‡Œå‡ºäºç®€ä¾¿åªå†™äº†ä¸¤ä¸ªæœªçŸ¥æ•°çš„æƒ…å†µã€‚</p>
<p><br></p>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>è¿™é‡Œæˆ‘ç”¨çš„æ˜¯ä¸‰æ¬¡å‡½æ•°çš„å›¾åƒå¤–åŠ äº†ç‚¹å™ªå£°ï¼Œç”¨<code>çº¿æ€§å›å½’</code>è‚¯å®šæ˜¯æ‹Ÿåˆä¸äº†çš„ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line">x = np.arange(-<span class="number">10</span>, <span class="number">10</span>, <span class="number">0.1</span>)</span><br><span class="line">y = <span class="number">2.6</span> * x ** <span class="number">3</span> - <span class="number">3.14</span> * x ** <span class="number">2</span> - <span class="number">8.8</span> * x + np.random.normal(<span class="number">0</span>, <span class="number">700</span>, (<span class="number">200</span>, ))</span><br><span class="line"></span><br><span class="line">plt.scatter(x, y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/27/4RC9un.png" alt=""></p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">X = x.reshape([-<span class="number">1</span>, <span class="number">1</span>])</span><br><span class="line">X = np.hstack([X ** <span class="number">3</span>, X ** <span class="number">2</span>, X])</span><br><span class="line">X_b = np.hstack([np.ones([<span class="built_in">len</span>(y), <span class="number">1</span>]), X])</span><br><span class="line"><span class="comment"># X [200, 3]</span></span><br><span class="line"><span class="built_in">print</span>(X.shape)</span><br></pre></td></tr></tbody></table></figure>
<p>å¦‚ç®—æ³•æ€æƒ³æ‰€è¿°ï¼Œæ¢¯åº¦ä¸‹é™çš„ä»£ç æ˜¯æ²¡æœ‰æ”¹å˜çš„ï¼Œåªæ˜¯æ·»åŠ äº†ç‰¹å¾çš„å¹‚æŒ‡æ•°ä½œä¸ºé¢å¤–çš„ç‰¹å¾å€¼ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">J</span>(<span class="params">X_b, y, theta</span>):</span></span><br><span class="line">    <span class="keyword">return</span> np.mean((X_b.dot(theta) - y) ** <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DJ</span>(<span class="params">X_b, y, theta</span>):</span></span><br><span class="line">    <span class="keyword">return</span> X_b.T.dot((X_b.dot(theta) - y)) * <span class="number">2</span> / <span class="built_in">len</span>(y);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gradient_descent</span>(<span class="params">X_b, y, theta, eta = <span class="number">0.01</span>, n_iters = <span class="number">1e4</span>, epsilon = <span class="number">1e-6</span></span>):</span></span><br><span class="line">    i_iter = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> i_iter &lt; n_iters:</span><br><span class="line">        gradient = DJ(X_b, y, theta)</span><br><span class="line">        last_theta = theta</span><br><span class="line">        theta = theta - eta * gradient</span><br><span class="line">        <span class="keyword">if</span> np.<span class="built_in">abs</span>(J(X_b, y, theta) - J(X_b, y, last_theta)) &lt; epsilon:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        i_iter += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> theta</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">initial_theta = np.zeros(X_b.shape[<span class="number">1</span>])</span><br><span class="line">theta = gradient_descent(X_b, y, initial_theta, eta = <span class="number">1e-6</span>, n_iters = <span class="number">1e5</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>å¾—å‡º theta = array([-12.65120346,   2.89719563,  -3.12234806, -15.72650818])</p>
<p>ä¹ŸåŸºæœ¬å¯¹åº”äº†æˆ‘é¢„è®¾çš„å‡½æ•°ç³»æ•°[2.6, -3.14, -8.8]</p>
<p>æ³¨ï¼štheta æ¯ä¸€é¡¹åˆ†åˆ«å¯¹åº”äº†æˆªè·ï¼Œ$x^3$ çš„ç³»æ•°ï¼Œ$x^2$ çš„ç³»æ•°ï¼Œ$x$ çš„ç³»æ•°ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">pred_y = theta[<span class="number">1</span>] * x ** <span class="number">3</span> + theta[<span class="number">2</span>] * x ** <span class="number">2</span> + theta[<span class="number">3</span>] * x + theta[<span class="number">0</span>]</span><br><span class="line">plt.scatter(x, y)</span><br><span class="line">plt.plot(x, pred_y, color = <span class="string">"r"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/27/4RPGd0.png" alt=""></p>
<p><br></p>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>éœ€è¦æ³¨æ„çš„æ˜¯å¤šé¡¹å¼åŒ–æ˜¯æˆ<code>é˜¶ä¹˜å¼</code>çš„å¢é•¿ï¼Œæ¯”æŒ‡æ•°çˆ†ç‚¸æ›´å¯æ€•ï¼</p>
<p>$\frac{(n + d)!}{d!n!}$ï¼Œå…¶ä¸­ n ä¸ºåŸæœ¬ç‰¹å¾æ•°ï¼Œd ä¸ºæœ€é«˜æ¬¡æ•°ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PolynomialRegression</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, degree</span>):</span></span><br><span class="line">        self.degree = degree</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span>(<span class="params">self, X, y, eta = <span class="number">0.01</span>, n_iters = <span class="number">1e4</span>, epsilon = <span class="number">1e-6</span></span>):</span></span><br><span class="line">        self.X = self._getPolynomialFeatures(X, <span class="number">0</span>, np.ones([<span class="built_in">len</span>(X), <span class="number">1</span>]), self.degree)</span><br><span class="line">        </span><br><span class="line">        initial_theta = np.zeros([self.X.shape[<span class="number">1</span>]])</span><br><span class="line">        theta = self._gradient_descent(self.X, y, initial_theta, eta, n_iters, epsilon)</span><br><span class="line">        self.theta = theta</span><br><span class="line">        self.coefficient = theta[<span class="number">1</span>:]</span><br><span class="line">        self.intercept = theta[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¤šé¡¹å¼åŒ–</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_getPolynomialFeatures</span>(<span class="params">self, X, start, col_val, degree</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dfs</span>(<span class="params">X, result, start, col_val, degree</span>):</span></span><br><span class="line">            result.append(col_val)</span><br><span class="line">            <span class="keyword">if</span>(degree == <span class="number">0</span>):</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start, X.shape[<span class="number">1</span>]):</span><br><span class="line">                dfs(X, result, start, col_val * X[:, i].reshape([-<span class="number">1</span>, <span class="number">1</span>]), degree - <span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        result = []</span><br><span class="line">        dfs(X, result, <span class="number">0</span>, np.ones([<span class="built_in">len</span>(X), <span class="number">1</span>]), degree)</span><br><span class="line">        <span class="keyword">return</span> np.squeeze(np.array(result), -<span class="number">1</span>).T</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span>(<span class="params">self, X</span>):</span></span><br><span class="line">        X_b = self._getPolynomialFeatures(X, <span class="number">0</span>, np.ones([<span class="built_in">len</span>(X), <span class="number">1</span>]), self.degree)</span><br><span class="line">        y_pred = X_b.dot(self.theta)</span><br><span class="line">        <span class="keyword">return</span> y_pred</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">self, X, y</span>):</span></span><br><span class="line">        y_pred = self.predict(X)</span><br><span class="line">        <span class="keyword">return</span> np.mean((y - y_pred) ** <span class="number">2</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_gradient_descent</span>(<span class="params">self, X_b, y, theta, eta, n_iters, epsilon</span>):</span></span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">J</span>(<span class="params">X_b, y, theta</span>):</span></span><br><span class="line">            <span class="keyword">return</span> np.mean((X_b.dot(theta) - y) ** <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">DJ</span>(<span class="params">X_b, y, theta</span>):</span></span><br><span class="line">            <span class="keyword">return</span> X_b.T.dot((X_b.dot(theta) - y)) * <span class="number">2</span> / <span class="built_in">len</span>(y);</span><br><span class="line">        </span><br><span class="line">        i_iter = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">while</span> i_iter &lt; n_iters:</span><br><span class="line">            gradient = DJ(X_b, y, theta)</span><br><span class="line">            last_theta = theta</span><br><span class="line">            theta = theta - eta * gradient</span><br><span class="line">            <span class="keyword">if</span> np.<span class="built_in">abs</span>(J(X_b, y, theta) - J(X_b, y, last_theta)) &lt; epsilon:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            i_iter += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> theta</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">poly_reg = PolynomialRegression(<span class="number">3</span>)</span><br><span class="line">poly_reg.fit(x.reshape([-<span class="number">1</span>, <span class="number">1</span>]), y, eta = <span class="number">1e-6</span>, n_iters = <span class="number">1e5</span>)</span><br><span class="line"></span><br><span class="line">theta = poly_reg.theta</span><br><span class="line">pred_y = theta[<span class="number">3</span>] * x ** <span class="number">3</span> + theta[<span class="number">2</span>] * x ** <span class="number">2</span> + theta[<span class="number">1</span>] * x + theta[<span class="number">0</span>]</span><br><span class="line">plt.scatter(x, y)</span><br><span class="line">plt.plot(x, pred_y, color = <span class="string">"r"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p>ç»“æœå¦‚å‡ºä¸€è¾™ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/28/4fChIP.png" alt=""></p>
]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
  </entry>
  <entry>
    <title>æ•°æ®å½’ä¸€åŒ–</title>
    <url>/2021/09/14/%E6%95%B0%E6%8D%AE%E5%BD%92%E4%B8%80%E5%8C%96/</url>
    <content><![CDATA[<h2 id="ç®—æ³•æ€æƒ³"><a href="#ç®—æ³•æ€æƒ³" class="headerlink" title="ç®—æ³•æ€æƒ³"></a>ç®—æ³•æ€æƒ³</h2><p>è§‚å¯Ÿä¸‹å›¾ï¼Œå¯ä»¥å‘ç°æ¯ä¸ªç‰¹å¾ä¹‹é—´çš„é‡çº²ä¸åŒï¼Œæ²¡æœ‰åŠæ³•æ”¾åœ¨ä¸€èµ·æ¯”è¾ƒï¼Œå­¦ä¹ å‡ºæ¥çš„æ¨¡å‹å¯è§£é‡Šæ€§æ¯”è¾ƒå·®ã€‚è€Œä¸”å¯¹äºKNNç®—æ³•æ¥è¯´ï¼Œæ ·æœ¬ä¹‹é—´çš„è·ç¦»æå¤§éƒ¨åˆ†ä¼šç”±å‘ç°æ—¶é—´ï¼ˆå¤©ï¼‰æ¥å¼•å¯¼ï¼Œè‚¿ç˜¤å¤§å°ï¼ˆå˜ç±³ï¼‰å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/14/4k3M9K.png" alt=""></p>
<p>ä¸ºæ­¤æˆ‘ä»¬å°±éœ€è¦é‡‡ç”¨å½’ä¸€åŒ–ï¼ŒæŠŠæœ‰é‡çº²çš„è¡¨è¾¾å¼æ”¹æˆ<code>æ— é‡çº²</code>çš„è¡¨è¾¾å¼ï¼Œå°†æ•°æ®çš„æ‰€æœ‰ç‰¹å¾éƒ½æ˜ å°„åˆ°ä¸€ä¸ªç»Ÿä¸€çš„å°ºåº¦ä¸‹ã€‚ï¼ˆå¯¹äºå…¶å®ƒç®—æ³•å¦‚çº¿æ€§å›å½’åˆ™ä¸ä¼šå½±å“åˆ†ç±»æˆ–é¢„æµ‹ç»“æœï¼‰</p>
<p>è€Œä¸”å½’ä¸€åŒ–åå¯ä»¥åŠ é€Ÿè®­ç»ƒï¼Œå·¦ä¾§å› ä¸ºè¿›è¡Œäº†å½’ä¸€åŒ–ï¼Œå› æ­¤ç­‰é«˜çº¿å‡ ä¹æ˜¯æ­£åœ†ï¼Œç­‰é«˜çº¿ä¸Šçš„æ³•çº¿æŒ‡å‘åœ†å¿ƒï¼Œå› æ­¤èƒ½å¿«é€Ÿæ”¶æ•›åˆ°æœ€å°å€¼ï¼Œè€Œå³å›¾æ²¡æœ‰è¿›è¡Œå½’ä¸€åŒ–åˆ™éœ€è¿›è¡Œå¤šæ¬¡è¿­ä»£ã€‚</p>
<p>æ²¡æœ‰è¿›è¡Œå½’ä¸€åŒ–ï¼Œå­¦ä¹ ç‡ä¹Ÿå¾—æŒ‰ç…§ç‰¹å¾å–å€¼èŒƒå›´æœ€å°çš„é‚£ä¸ªç»´åº¦æ¥å–ï¼Œä¸ç„¶å¾ˆå®¹æ˜“å‡ºç°nanã€‚</p>
<p>æ³¨ï¼šç”±äºè¿›è¡Œäº†å½’ä¸€åŒ–ï¼Œæˆ‘ä»¬çš„æ¨¡å‹éƒ½æ˜¯æŒ‰ç…§å½’ä¸€åŒ–çš„æ•°æ®è¿›è¡Œè®­ç»ƒçš„ï¼Œå› æ­¤æµ‹è¯•æ•°æ®ä¹Ÿè¦è¿›è¡Œå½’ä¸€åŒ–ï¼Œå¦åˆ™æ²¡æœ‰æ„ä¹‰äº†ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/14/4kxFRU.png" alt=""></p>
<p>ï¼ˆ1ï¼‰ å‡å€¼æ–¹å·®å½’ä¸€åŒ–ï¼ˆstandardizationï¼‰</p>
<script type="math/tex; mode=display">
X_{scale} = \frac{X - X_{mean}}{X_{std}}</script><p>ç»è¿‡è¯¥æ ‡å‡†åŒ–å¤„ç†çš„æ•°æ®ï¼Œå‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1ï¼Œç¬¦åˆæ­£æ€åˆ†å¸ƒã€‚</p>
<p>é€‚ç”¨äºæ•°æ®åˆ†å¸ƒæ²¡æœ‰æ˜æ˜¾çš„è¾¹ç•Œï¼Œæœ‰å¯èƒ½å­˜åœ¨æç«¯çš„æ•°æ®å€¼ã€‚</p>
<p>æ­£å¥½å­¦äº†æ¦‚ç‡è®ºï¼Œå°±æ¥ç®€å•æ¨å¯¼ä¸‹å§ã€‚</p>
<script type="math/tex; mode=display">
è®¾ç»è¿‡å‡å€¼æ–¹å·®å½’ä¸€åŒ–åX^*çš„æ•°å­¦æœŸæœ›å’Œæ–¹å·®åˆ†åˆ«ä¸ºE^*X, D^*X \qquad (X^* = \frac{X - EX}{\sqrt{DX}})
\\
E^*X = E(\frac{X - EX}{\sqrt{DX}}) = \frac{1}{\sqrt{DX}} * (EX - EX) = 0
\\
D^*X = D(\frac{X - EX}{\sqrt{DX}}) = \frac{1}{DX} * D(X - EX) = \frac{1}{DX} * DX = 1</script><p>ï¼ˆ2ï¼‰æœ€å€¼å½’ä¸€åŒ–ï¼ˆNormalizationï¼‰</p>
<script type="math/tex; mode=display">
X_{scale} = \frac{X - X_{min}}{X_{max} - X_{min}}</script><p>ç»è¿‡è¯¥æ ‡å‡†åŒ–å¤„ç†çš„æ•°æ®ï¼Œæ•°æ®åˆ†å¸ƒåœ¨(0, 1)ã€‚</p>
<p>é€‚ç”¨äºåˆ†å¸ƒæœ‰æ˜æ˜¾è¾¹ç•Œçš„æƒ…å†µï¼Œå— outlinerå½±å“è¾ƒå¤§ã€‚</p>
<p>ä¾‹å¦‚åƒç´ èŒƒå›´ï¼ˆ0 ~ 255ï¼‰ï¼Œå­¦ç”Ÿæˆç»©ï¼ˆ0 ~ 100ï¼‰ã€‚</p>
<p><br></p>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>ï¼ˆ1ï¼‰ æœ€å€¼å½’ä¸€åŒ–</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinMaxScaler</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span>(<span class="params">self, X</span>):</span></span><br><span class="line">        self.X = X</span><br><span class="line">        self.<span class="built_in">max</span> = np.<span class="built_in">max</span>(X, axis = <span class="number">0</span>)</span><br><span class="line">        self.<span class="built_in">min</span> = np.<span class="built_in">min</span>(X, axis = <span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span>(<span class="params">self, X</span>):</span></span><br><span class="line">        <span class="keyword">return</span> (X - self.<span class="built_in">min</span>) / (self.<span class="built_in">max</span> - self.<span class="built_in">min</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>åŸå§‹æ•°æ®å‡å€¼ä¸º46.995ï¼Œæ ‡å‡†å·®ä¸º27.97007284581147ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">X = np.random.randint(<span class="number">0</span>, <span class="number">100</span>, (<span class="number">100</span>, <span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(np.mean(X))			<span class="comment"># 46.995</span></span><br><span class="line"><span class="built_in">print</span>(np.std(X))			<span class="comment"># 27.97007284581147</span></span><br><span class="line"></span><br><span class="line">plt.scatter(X[:, <span class="number">0</span>], X[:, <span class="number">1</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/14/4kODbt.png" alt=""></p>
<p>ç»è¿‡æœ€å€¼å½’ä¸€åŒ–åï¼Œå‡å€¼ä¸º0.4721085858585859ï¼Œæ ‡å‡†å·®ä¸º0.2863025514861211ã€‚</p>
<p>æ‰€æœ‰å€¼éƒ½è¢«æ˜ å°„åˆ°ï¼ˆ0ï¼Œ 1ï¼‰ä¹‹é—´</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">minMaxScaler = MinMaxScaler()</span><br><span class="line">minMaxScaler.fit(X)</span><br><span class="line">X1 = minMaxScaler.transform(X)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(np.mean(X1))			<span class="comment"># 0.4721085858585859</span></span><br><span class="line"><span class="built_in">print</span>(np.std(X1))			<span class="comment"># 0.2863025514861211</span></span><br><span class="line"></span><br><span class="line">plt.scatter(X1[:, <span class="number">0</span>], X1[:, <span class="number">1</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/14/4kXqTP.png" alt=""></p>
<p>ï¼ˆ2ï¼‰ å‡å€¼æ–¹å·®å½’ä¸€åŒ–</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StandardScaler</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span>(<span class="params">self, X</span>):</span></span><br><span class="line">        self.X = X</span><br><span class="line">        self.mean = np.mean(X, axis = <span class="number">0</span>)</span><br><span class="line">        self.std = np.std(X, axis = <span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span>(<span class="params">self, X</span>):</span></span><br><span class="line">        <span class="keyword">return</span> (X - self.mean) / self.std</span><br></pre></td></tr></tbody></table></figure>
<p>ç»è¿‡å‡å€¼æ–¹å·®å½’ä¸€åŒ–åï¼Œå‡å€¼å‡ ä¹ä¸º0ï¼Œæ ‡å‡†å·®ä¹Ÿå‡ ä¹ä¸º1ï¼Œä½†æ•°æ®èŒƒå›´ä¸ä¸€å®šåœ¨ï¼ˆ0ï¼Œ 1ï¼‰ä¸­ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">standardScaler = StandardScaler()</span><br><span class="line">standardScaler.fit(X)</span><br><span class="line">X1 = standardScaler.transform(X)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(np.mean(X1))				<span class="comment"># -2.7755575615628914e-17</span></span><br><span class="line"><span class="built_in">print</span>(np.std(X1))				<span class="comment"># 0.9999999999999998</span></span><br><span class="line"></span><br><span class="line">plt.scatter(X1[:, <span class="number">0</span>], X1[:, <span class="number">1</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/14/4kXEMd.png" alt=""></p>
<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>å…ˆä»‹ç»ä¸€ä¸‹ <code>train test split</code>ï¼Œæ­£å¦‚å®ƒçš„å­—é¢æ„æ€ã€‚å°†ä¸€ä»½æ•°æ®é›†åˆ†æˆè®­ç»ƒæ•°æ®é›†å’Œæµ‹è¯•æ•°æ®é›†ï¼Œè¿™æ ·åœ¨ä½¿ç”¨ score å‡½æ•°æ—¶ï¼Œä½¿ç”¨çš„éƒ½æ˜¯è®­ç»ƒæ—¶æ²¡æœ‰è§è¿‡çš„æ•°æ®é›†ï¼Œå¾—å‡ºæ¥çš„å‡†ç¡®ç‡ä¹Ÿå°±æ›´å¯é ã€‚</p>
<p>é¦–å…ˆæ•°æ®é›†éœ€è¦æ‰“ä¹±ï¼Œå› ä¸ºæœ‰äº›æ•°æ®é›†æ˜¯æ ¹æ®ç±»åˆ«æ¥åˆ†ç±»çš„ï¼Œä¾‹å¦‚å‰ k ä¸ªéƒ½æ˜¯ç±»åˆ«1ï¼Œå k ä¸ªéƒ½æ˜¯ç±»åˆ«2ï¼Œè¿™æ · train å’Œtestä¸­çš„ç±»åˆ«åˆ†å¸ƒå·®è·å¾ˆå¤§ï¼Œä¼šå¯¼è‡´æ³›åŒ–æ•ˆæœä¸å¥½ã€‚</p>
<p>np.random.seed(seed) ä½¿ç”¨åŒä¸€ä¸ªç§å­ä¸ºäº†èƒ½æ›´å¥½çš„æ¯”è¾ƒä½¿ç”¨å½’ä¸€åŒ–å’Œä¸ä½¿ç”¨å½’ä¸€åŒ–çš„åŒºåˆ«ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">train_test_split</span>(<span class="params">X, y, split_rate, seed</span>):</span></span><br><span class="line">    np.random.seed(seed)</span><br><span class="line">    length = <span class="built_in">int</span>(<span class="built_in">len</span>(X) * split_rate)</span><br><span class="line">    p = np.random.permutation(<span class="built_in">len</span>(X))</span><br><span class="line">    <span class="keyword">return</span> X[p[length:]], X[p[:length]], y[p[length:]], y[p[:length]]</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<p>ï¼ˆ1ï¼‰ ä¸ä½¿ç”¨å½’ä¸€åŒ–è¿›è¡Œå­¦ä¹ </p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">boston=datasets.load_boston()</span><br><span class="line">X=boston.data			<span class="comment"># (506, 13)</span></span><br><span class="line">y=boston.target			<span class="comment"># (506, )</span></span><br><span class="line"></span><br><span class="line">split_rate = <span class="number">0.2</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, split_rate)</span><br><span class="line"></span><br><span class="line">lr = LinearRegression()</span><br><span class="line">lr.fit(X_train, y_train, eta = <span class="number">1e-6</span>, n_iters = <span class="number">1e6</span>)</span><br><span class="line">lr.score(X_test, y_test)</span><br></pre></td></tr></tbody></table></figure>
<p>eta = 1e-6</p>
<p>score = 31.348463775149956</p>
<p>ï¼ˆ2ï¼‰ ä½¿ç”¨æœ€å€¼å½’ä¸€åŒ–</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">boston=datasets.load_boston()</span><br><span class="line">X=boston.data</span><br><span class="line">y=boston.target</span><br><span class="line"></span><br><span class="line">minMaxScaler = MinMaxScaler()</span><br><span class="line">minMaxScaler.fit(X)</span><br><span class="line">X = minMaxScaler.transform(X)</span><br><span class="line"></span><br><span class="line">split_rate = <span class="number">0.2</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, split_rate)</span><br><span class="line"></span><br><span class="line">lr = LinearRegression()</span><br><span class="line">lr.fit(X_train, y_train, eta = <span class="number">1e-2</span>, n_iters = <span class="number">1e6</span>)</span><br><span class="line">lr.score(X_test, y_test)</span><br></pre></td></tr></tbody></table></figure>
<p>eta = 1e-2</p>
<p>score = 25.209485526542817</p>
<p>ï¼ˆ3ï¼‰ ä½¿ç”¨å‡å€¼æ–¹å·®å½’ä¸€åŒ–</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">boston=datasets.load_boston()</span><br><span class="line">X=boston.data</span><br><span class="line">y=boston.target</span><br><span class="line"></span><br><span class="line">standardScaler = StandardScaler()</span><br><span class="line">standardScaler.fit(X)</span><br><span class="line">X = standardScaler.transform(X)</span><br><span class="line"></span><br><span class="line">split_rate = <span class="number">0.2</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, split_rate)</span><br><span class="line"></span><br><span class="line">lr = LinearRegression()</span><br><span class="line">lr.fit(X_train, y_train, eta = <span class="number">1e-2</span>, n_iters = <span class="number">1e6</span>)</span><br><span class="line">lr.score(X_test, y_test)</span><br></pre></td></tr></tbody></table></figure>
<p>eta = 1e-2</p>
<p>score = 18.92473923096906</p>
<p>ç»è¿‡å¯¹æ¯”ï¼Œä½¿ç”¨åŒæ ·çš„è®­ç»ƒæ¬¡æ•°ï¼Œç»è¿‡äº†å½’ä¸€åŒ–çš„é¢„æµ‹ç‡æ˜æ˜¾æ¯”æ²¡æœ‰ç»è¿‡å½’ä¸€åŒ–çš„é¢„æµ‹ç‡æ›´é«˜ï¼Œè€Œä¸”etaå–1e-2å°±è¡Œï¼Œä¸ç”¨å¤šæ¬¡å°è¯•ã€‚</p>
]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
  </entry>
  <entry>
    <title>æ ‘è“æ´¾çš„å®‰è£…</title>
    <url>/2021/12/05/%E6%A0%91%E8%8E%93%E6%B4%BE%E7%9A%84%E5%AE%89%E8%A3%85/</url>
    <content><![CDATA[<h3 id="1-å‡†å¤‡å·¥ä½œ"><a href="#1-å‡†å¤‡å·¥ä½œ" class="headerlink" title="1. å‡†å¤‡å·¥ä½œ"></a>1. å‡†å¤‡å·¥ä½œ</h3><ol>
<li><p>ä¸€å¼  TF å¡ï¼ˆclass10ï¼‰</p>
</li>
<li><p>Raspberry Pi OSï¼š<a href="https://www.raspberrypi.com/software/operating-systems">https://www.raspberrypi.com/software/operating-systems</a></p>
</li>
<li>åˆ†åŒºè½¯ä»¶ï¼šDiskGenius</li>
<li>çƒ§å†™ç³»ç»Ÿè½¯ä»¶ï¼šWin32DiskImager</li>
</ol>
<h3 id="2-è¿œç¨‹è¿æ¥"><a href="#2-è¿œç¨‹è¿æ¥" class="headerlink" title="2. è¿œç¨‹è¿æ¥"></a>2. è¿œç¨‹è¿æ¥</h3><h4 id="2-1-çƒ§å†™ç³»ç»Ÿ"><a href="#2-1-çƒ§å†™ç³»ç»Ÿ" class="headerlink" title="2.1 çƒ§å†™ç³»ç»Ÿ"></a>2.1 çƒ§å†™ç³»ç»Ÿ</h4><p>å¦‚æœåŸæœ¬ TF å¡ä¸­æœ‰åˆ†åŒºï¼Œå¯ä»¥ç”¨ <strong>DiskGenius</strong> æ ¼å¼åŒ–åœ¨åˆ›å»ºä¸€ä¸ªæ–°åˆ†åŒºã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/05/oBSSDs.png" alt="image"></p>
<p>ç„¶åå¯åŠ¨ <strong>Win32DiskImager</strong> é€‰æ‹©ä¹‹å‰åœ¨å®˜ç½‘ä¸Šä¸‹è½½çš„é•œåƒæ–‡ä»¶çƒ§å†™åˆ° TF å¡ä¸­ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/05/oBSE2F.png" alt="image"></p>
<p>æ³¨æ„ï¼ŒRaspberry é»˜è®¤æ˜¯ä¸å¼€å¯ SSH æœåŠ¡çš„ï¼Œéœ€è¦åœ¨ TF å¡ä¸­åˆ›å»ºä¸€ä¸ªåä¸º <code>SSH</code> çš„æ–‡ä»¶ï¼Œå°±èƒ½å¼€å¯äº†ï¼</p>
<p><img src="https://s4.ax1x.com/2021/12/05/oBSYKH.md.png" alt="image"></p>
<p>ä¹‹åå°† TF å¡æ’åˆ°æ ‘è“æ´¾ä¸Šå°±èƒ½æ­£å¸¸å¼€æœºäº†ï¼Œä½†å› ä¸ºæ²¡æœ‰ç”»é¢ï¼Œæˆ‘ä»¬å…ˆè¦ç»™æ ‘è“æ´¾è¿ä¸Šä»¥å¤ªç½‘ï¼Œç„¶åæŸ¥è¯¢ IPï¼Œè¿™æ ·é€šè¿‡åˆšåˆšå¼€å¯çš„ SSH æœåŠ¡è¿œç¨‹è¿æ¥æˆ‘ä»¬çš„æ ‘è“æ´¾äº†ï¼</p>
<h4 id="2-2-é…ç½®æ•°æ®æº"><a href="#2-2-é…ç½®æ•°æ®æº" class="headerlink" title="2.2 é…ç½®æ•°æ®æº"></a>2.2 é…ç½®æ•°æ®æº</h4><p>è¿æ¥åå…ˆé…ç½®æ•°æ®æºï¼Œæ”¹ä¸ºæ¸…åæºï¼ˆå›½å¤–çš„æºå¾ˆæ…¢ï¼‰ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">sudo nano /etc/apt/sources.list</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib rpi</span><br><span class="line">deb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib rpi</span><br><span class="line"></span><br><span class="line">sudo nano /etc/apt/sources.list.d/raspi.list</span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui</span><br><span class="line">deb-src http://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui</span><br><span class="line"></span><br><span class="line"><span class="comment"># CTRL+O ä¿å­˜ -&gt; ENTER ç¡®è®¤ -&gt; CTRL+X é€€å‡º</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ›´æ–°æ•°æ®æºã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br></pre></td></tr></tbody></table></figure>
<p>å®‰è£… xrdp å®ç° Windows è¿œç¨‹è®¿é—®ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">sudo apt-get install xrdp</span><br></pre></td></tr></tbody></table></figure>
<h3 id="3-ç½‘ç»œé…ç½®"><a href="#3-ç½‘ç»œé…ç½®" class="headerlink" title="3. ç½‘ç»œé…ç½®"></a>3. ç½‘ç»œé…ç½®</h3><h4 id="3-1-ping-é€šæ ‘è“æ´¾"><a href="#3-1-ping-é€šæ ‘è“æ´¾" class="headerlink" title="3.1 ping é€šæ ‘è“æ´¾"></a>3.1 ping é€šæ ‘è“æ´¾</h4><p>åœ¨ä¸çŸ¥é“æ ‘è“æ´¾ ip çš„æƒ…å†µä¸‹ï¼Œåœ¨ windows çš„ cmd çª—å£ä¸­è¾“å…¥</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">ping raspberrypi.local</span><br></pre></td></tr></tbody></table></figure>
<p>å³å¯å¾—åˆ°æ ‘è“æ´¾çš„ ip åœ°å€ã€‚</p>
<p>(å®é™…ä¸Šåœ¨ XShell çš„ ip åœ°å€ä¸Šç›´æ¥è¾“å…¥ raspberrypi.local å°±èƒ½è¿æ¥ä¸Šæ ‘è“æ´¾)</p>
<h4 id="3-2-é…ç½®ç½‘å¡"><a href="#3-2-é…ç½®ç½‘å¡" class="headerlink" title="3.2 é…ç½®ç½‘å¡"></a>3.2 é…ç½®ç½‘å¡</h4><p>ä¿®æ”¹ <code>/etc/dhcpcd.conf</code>ï¼Œä¿®æ”¹ä¹‹å‰å…ˆå¤‡ä»½ï¼ï¼ï¼</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># å…¶ä¸­eth0æ˜¯æœ‰çº¿ç½‘å¡ï¼Œwlan0æ˜¯æ— çº¿ç½‘å¡ã€‚</span></span><br><span class="line">interface eth0</span><br><span class="line">static ip_address=192.168.1.88/24</span><br><span class="line">static routers=192.168.1.1</span><br><span class="line">static domain_name_servers=114.114.114.114</span><br><span class="line"></span><br><span class="line">interface wlan0</span><br><span class="line">static ip_address=192.168.1.89/24</span><br><span class="line">static routers=192.168.1.1</span><br><span class="line">static domain_name_dervers=114.114.114.114</span><br></pre></td></tr></tbody></table></figure>
<p>é€šè¿‡è¿™ä¸ªæ–‡ä»¶å°†æœ‰çº¿ç½‘å¡å’Œæ— çº¿ç½‘å¡éƒ½é…ç½®ä¸Šäº†é™æ€ipã€‚</p>
<p>ä½†è¿™æ ·è¿˜ä¸å¤Ÿï¼Œè¿˜è¦ä¿®æ”¹/etc/network/interfacesæ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶åé¢æ·»åŠ å¦‚ä¸‹å‡ è¡Œã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># è‡ªåŠ¨å¼€å¯loopback</span></span><br><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰‹åŠ¨å¼€å¯eth0</span></span><br><span class="line">iface eth0 inet manual</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªåŠ¨å¼€å¯wlan0</span></span><br><span class="line">auto wlan0</span><br><span class="line">allow-hotplug wlan0</span><br><span class="line"></span><br><span class="line">iface wlan0 inet static</span><br><span class="line">wpa-ssid <span class="string">"wifi_name"</span></span><br><span class="line">wpa-psk <span class="string">"password"</span></span><br><span class="line">address 192.168.1.89</span><br><span class="line">netmask 255.255.255.0</span><br><span class="line">gateway 192.168.1.1</span><br><span class="line">network 192.168.1.1</span><br><span class="line">iface default inet dhcp</span><br></pre></td></tr></tbody></table></figure>
<p>ç„¶åé‡å¯æ ‘è“æ´¾å³å¯ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">sudo reboot</span><br></pre></td></tr></tbody></table></figure>
<p>ä¿®æ”¹å®Œé™æ€ ip åï¼Œå°±å¯ä»¥ä½¿ç”¨ XShell é€šè¿‡æ–°è®¾ç½®çš„é™æ€ ip è¿æ¥æ ‘è“æ´¾äº†ã€‚</p>
]]></content>
      <categories>
        <category>RaspberryPi</category>
      </categories>
  </entry>
  <entry>
    <title>æ¢¯åº¦ä¸‹é™æ³•</title>
    <url>/2021/09/12/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95/</url>
    <content><![CDATA[<h2 id="ç®—æ³•æ€æƒ³"><a href="#ç®—æ³•æ€æƒ³" class="headerlink" title="ç®—æ³•æ€æƒ³"></a>ç®—æ³•æ€æƒ³</h2><p>æ¢¯åº¦ä¸‹é™æ³•æ˜¯ä¸€ç§éå¸¸é€šç”¨çš„ä¼˜åŒ–ç®—æ³•ï¼Œèƒ½å¤Ÿä¸ºå¤§èŒƒå›´çš„é—®é¢˜æ‰¾åˆ°æœ€ä¼˜è§£ã€‚æ¢¯åº¦ä¸‹é™çš„ä¸­å¿ƒæ€æƒ³å°±æ˜¯è¿­ä»£åœ°è°ƒæ•´å‚æ•°ä»è€Œä½¿æˆæœ¬å‡½æ•°æœ€å°åŒ–ã€‚ï¼ˆPSï¼šæ¢¯åº¦ä¸Šå‡æ³•è§£å†³æœ€å¤§åŒ–é—®é¢˜ï¼‰</p>
<p><img src="https://z3.ax1x.com/2021/09/12/4p2RAS.png" alt=""></p>
<p>æ–œç‡ä¸ºæ­£ï¼Œä»£è¡¨å•è°ƒé€’å¢ï¼Œè¯´æ˜æå€¼ç‚¹åœ¨å·¦è¾¹ï¼›</p>
<p>æ–œç‡ä¸ºè´Ÿï¼Œä»£è¡¨å•è°ƒé€’å‡ï¼Œè¯´æ˜æå€¼ç‚¹åœ¨å³è¾¹ã€‚</p>
<p>å› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡å‡å»å¯¼æ•°æ¥æ‰¾åˆ°æœ€å€¼ç‚¹ï¼ˆå‡å¦‚æå€¼ç‚¹åªæœ‰ä¸€ä¸ªï¼‰ï¼Œå› æ­¤è¢«ç§°ä¸ºæ¢¯åº¦ä¸‹é™æ³•ã€‚</p>
<p>ä¸è¿‡ç”±äºæ¯ä¸ªç‚¹ä¸Šçš„å¯¼æ•°æ˜¯å›ºå®šçš„ï¼Œä¾‹å¦‚æ¥è¿‘ç¬”ç›´çš„ç›´çº¿æ–œç‡å°±å‡ ä¹æ˜¯æ— ç©·å¤§ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥å‡å»å¯¼æ•°ï¼Œæ˜¾ç„¶å°±ä¸å¤§åˆé€‚ã€‚</p>
<p>æ‰€ä»¥å°±å¼•ç”³å‡ºäº†etaï¼Œä¹Ÿè¢«ç§°ä½œå­¦ä¹ ç‡ï¼ˆlearning rateï¼‰ã€‚ç°åœ¨æˆ‘ä»¬åªéœ€å‡å»eta * gradientå°±å¯ä»¥äº†ï¼Œé€šè¿‡è°ƒæ•´etaçš„å¤§å°æ¥æ”¹å˜æ‹Ÿåˆçš„é€Ÿåº¦</p>
<p>etaè¿‡å¤§å¯èƒ½å¯¼è‡´æ— æ³•æ‹Ÿåˆï¼Œetaè¿‡å°åˆ™ä¼šæ‹Ÿåˆè¿‡æ…¢ï¼Œä¸‹é¢ä¼šæœ‰å®ä¾‹å±•ç¤ºã€‚</p>
<p><br></p>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>è¿™æ˜¯etaé€‚ä¸­çš„æƒ…å†µï¼ŒåªèŠ±äº†26æ­¥å°±æ‰¾åˆ°äº†æœ€å°å€¼ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">start = -<span class="number">10.0</span></span><br><span class="line">epsilon = <span class="number">1e-5</span></span><br><span class="line">eta = <span class="number">0.4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 26 steps</span></span><br><span class="line">plot_gradient_tracks(start, epsilon, eta)</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/12/4pIdbR.png" alt=""></p>
<p>è¿™é‡Œetaå°±åå°äº†ï¼Œè™½ç„¶ä¹Ÿèƒ½æ‰¾åˆ°æœ€å°å€¼ï¼Œä½†è¿è¡Œäº†875æ¬¡ï¼Œæ˜¯ä¸Šé¢çš„äº”åå¤šå€ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">start = -<span class="number">10.0</span></span><br><span class="line">epsilon = <span class="number">1e-5</span></span><br><span class="line">eta = <span class="number">0.01</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 875 steps</span></span><br><span class="line">plot_gradient_tracks(start, epsilon, eta)</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/12/4pTA1S.png" alt=""></p>
<p>è¿™é‡Œetaä¹Ÿç®—æ˜¯é€‚ä¸­çš„æƒ…å†µï¼Œåªä¸è¿‡å›¾åƒä¼šæ¯”è¾ƒç‰¹æ®Šï¼Œå·¦å³åå¤æ¨ªè·³ï¼Œå› æ­¤æˆ‘ä¹Ÿæ‹¿å‡ºæ¥å½“ä¸ªæ ·ä¾‹ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">start = -<span class="number">10.0</span></span><br><span class="line">epsilon = <span class="number">1e-5</span></span><br><span class="line">eta = <span class="number">1.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 21 steps</span></span><br><span class="line">plot_gradient_tracks(start, epsilon, eta)</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/12/4pTtB9.png" alt=""></p>
<p>è¿™æ˜¯æœ€å·®çš„æƒ…å†µï¼Œetaè¿‡å¤§ï¼Œå¯¼è‡´yè¶Šæ¥è¶Šå¤§ï¼Œå·²ç»æ— æ³•å–å¾—æœ€å°å€¼äº†ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">start = -<span class="number">10.0</span></span><br><span class="line">epsilon = <span class="number">1e-5</span></span><br><span class="line">eta = <span class="number">2.5</span></span><br><span class="line"></span><br><span class="line">plot_gradient_tracks(start, epsilon, eta, max_len = <span class="number">4</span>)</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/12/4p7FER.png" alt=""></p>
<p><br></p>
<p>å½“ç„¶ä¹Ÿä¼šæœ‰å­˜åœ¨å¤šä¸ªæå€¼ç‚¹çš„æƒ…å†µï¼Œä¸‹å›¾ä¸­å¦‚æœé€‰æ‹©å·¦è¾¹ä½œä¸ºèµ·å§‹ç‚¹ï¼ŒåŸºæœ¬å°±æ‰¾ä¸åˆ°å…¨å±€æœ€ä¼˜è§£äº†ï¼Œåªèƒ½æ‰¾åˆ°å±€éƒ¨æœ€ä¼˜è§£ã€‚</p>
<p>ä¸è¿‡å¹¸å¥½ï¼Œä¸€èˆ¬ä½¿ç”¨MSE(Mean Square Error)ä½œä¸ºæˆæœ¬å‡½æ•°ï¼Œè€ŒMSEæ°å¥½æ˜¯ä¸ªå‡¸å‡½æ•°ï¼Œè¿™å°±æ„å‘³ç€è¿æ¥æ›²çº¿ä¸Šä»»æ„ä¸¤ç‚¹çš„çº¿æ®µæ°¸è¿œä¹Ÿä¸ä¼šè·Ÿæ›²çº¿ç›¸äº¤ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸å­˜åœ¨å±€éƒ¨æœ€å°å€¼ï¼Œåªæœ‰ä¸€ä¸ªå…¨å±€æœ€å°å€¼ã€‚å®ƒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªè¿ç»­å‡½æ•°ï¼Œæ‰€ä»¥æ–œç‡ä¸ä¼šäº§ç”Ÿé™¡å³­çš„å˜åŒ–ã€‚</p>
<p>è¿™ä¸¤ç‚¹ä¿è¯çš„ç»“è®ºæ˜¯ï¼šå³ä¾¿æ˜¯ä¹±èµ°ï¼Œæ¢¯åº¦ä¸‹é™ä¹Ÿå¯ä»¥è¶‹è¿‘åˆ°å…¨å±€æœ€å°å€¼ï¼ˆåªè¦ç­‰å¾…æ—¶é—´è¶³å¤Ÿé•¿ï¼Œå­¦ä¹ ç‡ä¹Ÿä¸æ˜¯å¤ªé«˜ï¼‰ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/13/4CjCQI.png" alt=""></p>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®æ ‡å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">J</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.5</span> * x ** <span class="number">2</span> + <span class="number">3.5</span> * x + <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®æ ‡å¯¼å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DJ</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> x + <span class="number">3.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶å¯¼æ•°è½¨è¿¹æ›²çº¿</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_gradient_tracks</span>(<span class="params">start, epsilon, eta, max_len = <span class="number">1e4</span></span>):</span></span><br><span class="line">    a = start</span><br><span class="line"></span><br><span class="line">    historys = []</span><br><span class="line">    <span class="keyword">while</span>(max_len &gt; <span class="number">0</span>):</span><br><span class="line">        last = J(a)</span><br><span class="line">        historys.append([a, J(a)])</span><br><span class="line">        a = a - eta * DJ(a)</span><br><span class="line">        <span class="keyword">if</span> np.<span class="built_in">abs</span>(last - J(a)) &lt; epsilon:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        max_len -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    historys = np.array(historys)</span><br><span class="line">    plt.plot(x, y)</span><br><span class="line">    plt.plot(historys[:, <span class="number">0</span>], historys[:, <span class="number">1</span>])</span><br><span class="line">    plt.show()</span><br><span class="line">    <span class="built_in">print</span>(historys.shape[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> historys[-<span class="number">1</span>]</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">start = -<span class="number">10.0</span></span><br><span class="line">epsilon = <span class="number">1e-5</span></span><br><span class="line">eta = <span class="number">1.5</span></span><br><span class="line"></span><br><span class="line">plot_gradient_tracks(start, epsilon, eta)		<span class="comment"># array([-3.5000062, -4.125])</span></span><br></pre></td></tr></tbody></table></figure>
<p>å°†ç›®æ ‡å‡½æ•°é…æ–¹å¾—ï¼Œ$\frac{1}{2}x^2 + \frac{7}{2}x + 2 = \frac{1}{2}[(x + \frac{7}{2})^2 + \frac{33}{4}]$</p>
<p>å¯ä»¥å¾—å‡ºåœ¨$x = -\frac{7}{2}$å¤„ï¼Œå–å¾—æœ€å°å€¼$y = \frac{33}{8}$</p>
<p>ä¸æµ‹è¯•ç»“æœåŸºæœ¬ä¸€è‡´ã€‚</p>
<p>æ³¨ï¼šè®¡ç®—ç»“æœä¸å¯èƒ½ä¸ç†è®ºå€¼ç›¸ç­‰ã€‚</p>
]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
  </entry>
  <entry>
    <title>æ¦‚ç‡è®º</title>
    <url>/2021/09/16/%E6%A6%82%E7%8E%87%E8%AE%BA/</url>
    <content><![CDATA[<h1 id="ä¸€-å…¬å¼"><a href="#ä¸€-å…¬å¼" class="headerlink" title="ä¸€. å…¬å¼"></a>ä¸€. å…¬å¼</h1><h2 id="1-æ’åˆ—ç»„åˆ"><a href="#1-æ’åˆ—ç»„åˆ" class="headerlink" title="1. æ’åˆ—ç»„åˆ"></a>1. æ’åˆ—ç»„åˆ</h2><p><strong>ï¼ˆ1ï¼‰ æ’åˆ—</strong></p>
<p>$P_m^n = m(m - 1)(m - 2)Â·Â·Â·(m - n + 1)$</p>
<p>$P_m^n = \frac{m!}{(m - n)!}$</p>
<p><strong>ï¼ˆ2ï¼‰ ç»„åˆ</strong></p>
<p>$C_m^n = \frac{P_m^n}{n!} = \frac{m(m - 1)(m - 2)Â·Â·Â·(m - n + 1)}{n!}$</p>
<p>$C_m^n = \frac{m!}{n!(m - n)!}$</p>
<p>$C_m^n = C_m^{m-n}$</p>
<p>$C^n_{m+1} = \frac{(m+1)m(m-1)Â·Â·Â·(m-n+2)}{n!} = \frac{[(m - n + 1) + n]m(m-1)Â·Â·Â·(m-n+2)}{n!} = \frac{m(m-1)Â·Â·Â·(m-n+1)}{n!} + \frac{m(m-1)Â·Â·Â·(m-n+2)}{(n-1)!} = C_m^n + C_m^{n-1}$</p>
<h2 id="2-æ¡ä»¶æ¦‚ç‡"><a href="#2-æ¡ä»¶æ¦‚ç‡" class="headerlink" title="2.æ¡ä»¶æ¦‚ç‡"></a>2.æ¡ä»¶æ¦‚ç‡</h2><p>ï¼ˆ1ï¼‰ æ¡ä»¶æ¦‚ç‡</p>
<p>$P(B|A) = \frac{P(AB)}{P(A)}$ï¼Œ                P(A) &gt; 0</p>
<p>ï¼ˆ2ï¼‰ ä¹˜æ³•å…¬å¼</p>
<p>$$</p>
<p>ï¼ˆ3ï¼‰ å®Œå¤‡äº‹ä»¶ç»„</p>
<p>ï¼ˆ4ï¼‰ å…¨æ¦‚ç‡å…¬å¼</p>
<p>ï¼ˆ5ï¼‰ è´å¶æ–¯å…¬å¼</p>
]]></content>
  </entry>
  <entry>
    <title>æ¨¡å‹çš„è®­ç»ƒ</title>
    <url>/2021/10/08/%E6%A8%A1%E5%9E%8B%E7%9A%84%E8%AE%AD%E7%BB%83/</url>
    <content><![CDATA[<h2 id="1ã€ç½‘æ ¼æœç´¢"><a href="#1ã€ç½‘æ ¼æœç´¢" class="headerlink" title="1ã€ç½‘æ ¼æœç´¢"></a>1ã€ç½‘æ ¼æœç´¢</h2><h4 id="1-1ã€ä»€ä¹ˆæ˜¯ç½‘æ ¼æœç´¢ï¼Ÿ"><a href="#1-1ã€ä»€ä¹ˆæ˜¯ç½‘æ ¼æœç´¢ï¼Ÿ" class="headerlink" title="1.1ã€ä»€ä¹ˆæ˜¯ç½‘æ ¼æœç´¢ï¼Ÿ"></a>1.1ã€ä»€ä¹ˆæ˜¯ç½‘æ ¼æœç´¢ï¼Ÿ</h4><p>åœ¨ <a href="/2021/09/28/è¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆ/">è¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆ</a> ä¸­ï¼Œæˆ‘ä»¬æ˜¯æ‰‹åŠ¨è°ƒæ•´è¶…å‚æ•° <code>degree</code> ï¼Œç»ç”±äººå·¥ä¸€ä¸€æ¯”å¯¹æ¥è·å–æœ€å¥½çš„å€¼ï¼Œæ•ˆç‡æ¯”è¾ƒä½ä¸‹ã€‚å› æ­¤æˆ‘ä»¬å¼•å…¥ç½‘æ ¼æœç´¢è¿™ä¸ªæ¦‚å¿µï¼Œä¸è¦è¢«è¿™ä¸ªçœ‹èµ·æ¥å¾ˆé«˜å¤§ä¸Šçš„åè¯å“å”¬ä½äº†ï¼Œå…¶å®é€»è¾‘ååˆ†ç®€å•ï¼Œå…·ä½“è¯·çœ‹ä¸‹è¿°ä»£ç ã€‚</p>
<p>ä½¿ç”¨ sklearn ä¸­è‡ªå¸¦çš„æ³¢å£«é¡¿æˆ¿äº§æ•°æ®ä½œä¸ºæˆ‘ä»¬çš„æµ‹è¯•æ•°æ®ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sklearn</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsRegressor</span><br><span class="line"></span><br><span class="line">boston = datasets.load_boston()</span><br><span class="line">X = boston.data</span><br><span class="line">y = boston.target</span><br><span class="line"></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y)</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬è¦ç½‘æ ¼æœç´¢çš„å‚æ•°å³ä¸º pï¼Œneighborï¼Œ weightã€‚</p>
<p>å¯ä»¥çœ‹åˆ°æ‰€è°“ <code>ç½‘æ ¼æœç´¢</code> å°±æ˜¯ä½¿ç”¨ for-loop åƒç½‘æ ¼ä¸€æ ·å°†ä½ é¢„è®¾çš„å¯èƒ½çš„å€¼éƒ½éå†ä¸€éï¼Œä¾æ¬¡å¯»æ±‚ score æœ€é«˜çš„è¶…å‚æ•°ç»„åˆã€‚</p>
<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">KNNä¸­çš„è¶…å‚æ•°ï¼š</span><br><span class="line"><span class="bullet">  -</span> weightsï¼šå«æœ‰ <span class="code">`uniform`</span> å’Œ <span class="code">`distance`</span> ä¸¤ç§æ¨¡å¼</span><br><span class="line"><span class="code">             uniform æ˜¯æ­£å¸¸çš„æ¨¡å¼</span></span><br><span class="line"><span class="code">             distance ç»™ k ä¸ªç›¸é‚»çš„ç‚¹æŒ‰ç…§è·ç¦»è¿œè¿‘éƒ½èµ‹äºˆä¸€ä¸ªæƒé‡ï¼Œç¦»é¢„æµ‹æ ·æœ¬ç‚¹è·ç¦»è¿œçš„æƒé‡å°±ä½ä¸€äº›ï¼Œè·ç¦»è¿‘çš„æƒé‡å°±é«˜ä¸€äº›ï¼Œ</span></span><br><span class="line"><span class="code">             </span></span><br><span class="line"><span class="code">  - pï¼šé—µå¯å¤«æ–¯åŸºè·ç¦»å‚æ•°</span></span><br><span class="line"><span class="code">       p = 1 æ—¶ï¼Œç­‰ä»·äºæ›¼å“ˆé¡¿è·ç¦»</span></span><br><span class="line"><span class="code">       p = 2 æ—¶ï¼Œç­‰ä»·äºæ¬§æ‹‰è·ç¦»</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">weights = [<span class="string">"uniform"</span>, <span class="string">"distance"</span>]</span><br><span class="line">best_score = -<span class="number">1</span></span><br><span class="line">best_p = <span class="number">0</span></span><br><span class="line">best_neighbor = <span class="number">0</span></span><br><span class="line">best_weight = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> weight <span class="keyword">in</span> weights:</span><br><span class="line">    <span class="keyword">for</span> neighbor <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">            reg = KNeighborsRegressor(n_neighbors=neighbor,</span><br><span class="line">                                      weights = weight,</span><br><span class="line">                                      p = p,</span><br><span class="line">                                      n_jobs = -<span class="number">1</span>)</span><br><span class="line">            reg.fit(X_train, y_train)</span><br><span class="line">            score = reg.score(X_test, y_test)</span><br><span class="line">            <span class="keyword">if</span> score &gt; best_score:</span><br><span class="line">                best_score = score</span><br><span class="line">                best_neighbor = neighbor</span><br><span class="line">                best_p = p</span><br><span class="line">                best_weight = weight</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"best_weight ="</span>, best_weight)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"best_p ="</span>, best_p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"best_neighbor ="</span>, best_neighbor)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"best_score ="</span>, best_score)</span><br></pre></td></tr></tbody></table></figure>
<p>è¾“å‡ºç»“æœå¦‚ä¸‹ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">best_weight = distance</span><br><span class="line">best_p = <span class="number">1</span></span><br><span class="line">best_neighbor = <span class="number">3</span></span><br><span class="line">best_score = <span class="number">0.7420720968121362</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ³¨ï¼šKNeighborsRegressor å’Œ KNeighborsClassifier æ€æƒ³ç›¸åŒã€‚</p>
<p>KNeighborsClassifier æ˜¯æ‰¾åˆ°é™„è¿‘ <code>k</code> ä¸ªæ•°æ®ï¼Œæ‰¾åˆ°æœ€å¤šé‚£ä¸ªç±»åˆ«ä½œä¸ºé¢„æµ‹çš„<code>ç±»åˆ«</code>ï¼Œç”¨äºè§£å†³åˆ†ç±»é—®é¢˜ã€‚</p>
<p>è€Œ KNeighborsRegressor æ˜¯æ‰¾åˆ°é™„è¿‘ <code>k</code> ä¸ªæ•°æ®ï¼Œç„¶åå–å¹³å‡å€¼ä½œä¸ºé¢„æµ‹çš„<code>æ•°å€¼</code>ï¼Œç”¨äºè§£å†³å›å½’é—®é¢˜ã€‚</p>
<p><br></p>
<h4 id="1-2ã€scikit-ä¸­çš„å®ç°"><a href="#1-2ã€scikit-ä¸­çš„å®ç°" class="headerlink" title="1.2ã€scikit ä¸­çš„å®ç°"></a>1.2ã€scikit ä¸­çš„å®ç°</h4><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV</span><br><span class="line"></span><br><span class="line">params = {</span><br><span class="line">    <span class="string">"weights"</span> : [<span class="string">"uniform"</span>, <span class="string">"distance"</span>],</span><br><span class="line">    <span class="string">"p"</span> : [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>)],</span><br><span class="line">    <span class="string">"n_neighbors"</span> : [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>)]</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">knn_reg = KNeighborsRegressor()</span><br><span class="line">grid_search=GridSearchCV(knn_reg, params)</span><br><span class="line">%time grid_search.fit(X_train,y_train)</span><br></pre></td></tr></tbody></table></figure>
<p>GridSearchCV ä½¿ç”¨äº¤å‰éªŒè¯æ¥è®­ç»ƒæ•°æ®ï¼Œå³ train-validation-testã€‚å› æ­¤best_score_å¯èƒ½ä¼šæ¯”è¾ƒä½ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">grid_search.best_params_ = {<span class="string">'n_neighbors'</span>: <span class="number">5</span>, <span class="string">'p'</span>: <span class="number">1</span>, <span class="string">'weights'</span>: <span class="string">'distance'</span>}</span><br><span class="line">grid_search.best_score_ = <span class="number">0.6091159004372775</span></span><br><span class="line">grid_search.best_estimator_.score(X_test, y_test) = <span class="number">0.7276418519232821</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h2 id="2ã€äº¤å‰éªŒè¯"><a href="#2ã€äº¤å‰éªŒè¯" class="headerlink" title="2ã€äº¤å‰éªŒè¯"></a>2ã€äº¤å‰éªŒè¯</h2><p>åœ¨ä¹‹å‰æ¨¡å‹çš„è®­ç»ƒä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä»¥æµ‹è¯•æ•°æ®é›†çš„ score æ¥è¡¡é‡æ¨¡å‹çš„å¥½åï¼Œæ¢è¨€ä¹‹å°±æ˜¯æ ¹æ® <code>test_score</code> æ¥è°ƒæ•´è¶…å‚æ•°ï¼Œå¹¶ä»æ‰€æœ‰çš„æ¨¡å‹ä¸­æŒ‘å‡º <code>test_score</code> æœ€é«˜çš„ä½œä¸ºæˆ‘ä»¬çš„é¢„æµ‹æ¨¡å‹ã€‚ä½†è¿™æ ·ä¹Ÿä¼šæš´éœ²å‡ºä¸€ä¸ªé—®é¢˜ï¼Œåœ¨æ¨¡å‹è®­ç»ƒæœŸé—´ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å°±å·²ç»<code>è§è¿‡</code>äº†æµ‹è¯•æ•°æ®é›†ï¼Œå› æ­¤å¯èƒ½ä¼š<code>è¿‡æ‹Ÿåˆ</code>æµ‹è¯•æ•°æ®é›†ï¼</p>
<p>è¿™æ ·è‚¯å®šæ˜¯ä¸å¯¹çš„ï¼Œè¦æ¨¡æ‹ŸçœŸæ­£çš„ç”Ÿäº§ç¯å¢ƒï¼Œé‚£ä¹ˆæµ‹è¯•æ•°æ®é›†å°±ä¸èƒ½å‚ä¸åˆ°æ¨¡å‹çš„è®­ç»ƒå½“ä¸­ã€‚æˆ‘ä»¬åªéœ€è¦å†å¼•å…¥ä¸€ä¸ªéªŒè¯æ•°æ®é›†æ¥<code>ä»£æ›¿</code>ä¹‹å‰æµ‹è¯•æ•°æ®é›†çš„ä½œç”¨å°±è¡Œäº†ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/10/5kvEY4.png" alt=""></p>
<p>ä½†å…¶å®è¿™æ ·ä¹Ÿä¼šæœ‰<code>è¿‡æ‹Ÿåˆ</code>éªŒè¯æ•°æ®é›†çš„é—®é¢˜ï¼Œå› æ­¤å°±æœ‰äº†<code>äº¤å‰éªŒè¯</code>ã€‚å…·ä½“åˆ™æ˜¯å°†è®­ç»ƒæ•°æ®é›†åˆ†æˆ K ä»½ï¼Œä»è¿™ K ä»½å½“ä¸­é€‰æ‹©ä¸€ä»½ä½œä¸ºéªŒè¯æ•°æ®é›†ï¼Œå…¶ä½™ K-1 ä»½ä½œä¸ºè®­ç»ƒæ•°æ®é›†ã€‚ä¸€å…±æœ‰ $C^1_K = K$ ç§åˆ†æ³•ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ° K ä¸ªæ¨¡å‹ï¼Œå› æ­¤è¿™ä¹Ÿè¢«ç§°ä¸º <code>K-folds Cross  Validation</code>ï¼ˆKæŠ˜äº¤å‰éªŒè¯ï¼‰ï¼Œæœ€åå–ä»–ä»¬åœ¨éªŒè¯æ•°æ®é›†ä¸Šçš„å‡å€¼ä½œä¸ºåˆ¤æ–­æ¨¡å‹å¥½åçš„ä¾æ®ã€‚</p>
<p>è¿™é‡Œæä¸€å¥ï¼Œåœ¨ scikit-learn çš„ç½‘æ ¼æœç´¢ä¸­ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯ cv = 5 çš„äº¤å‰éªŒè¯ï¼Œä¹Ÿå°±æ˜¯äº”æŠ˜äº¤å‰éªŒè¯ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/10/5kvFTU.png" alt=""></p>
<p>å½“äº¤å‰éªŒè¯çš„ K = n_samples æ—¶ï¼Œä¼šäº§ç”Ÿ n_samples ä¸ªæ¨¡å‹ï¼Œè¿™æ—¶è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹å®Œå…¨ä¸å—éšæœºçš„å½±å“ï¼Œå°†æœ€æ¥è¿‘æ¨¡å‹çœŸæ­£çš„æ€§èƒ½æŒ‡æ ‡ï¼Œä»£ä»·å°±æ˜¯è®­ç»ƒæ—¶é—´ä¼šæ‰©å¤§ n_samples å€ï¼Œè¿™å°±æ˜¯ <code>LOO-CV</code>ï¼ˆLeave One Out Cross Validtionï¼‰ï¼Œä¹Ÿå°±æ˜¯ç•™ä¸€æ³•ã€‚</p>
<h4 id="2-2ã€ä»£ç å®ç°"><a href="#2-2ã€ä»£ç å®ç°" class="headerlink" title="2.2ã€ä»£ç å®ç°"></a>2.2ã€ä»£ç å®ç°</h4><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># å°†ç¬¬iä»½ä½œä¸ºéªŒè¯é›†</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_k_fold_data</span>(<span class="params">k, i, X, y</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> k &gt; <span class="number">1</span></span><br><span class="line">    fold_size = X.shape[<span class="number">0</span>] // k</span><br><span class="line">    X_train, y_train = <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        idx = <span class="built_in">slice</span>(j * fold_size, (j+<span class="number">1</span>) * fold_size)</span><br><span class="line">        X_part, y_part = X[idx, :], y[idx]</span><br><span class="line">        <span class="comment"># ç¬¬iä»½å³ä¸ºéªŒè¯é›†</span></span><br><span class="line">        <span class="keyword">if</span> j == i:</span><br><span class="line">            X_valid, y_valid = X_part, y_part</span><br><span class="line">        <span class="comment"># é™¤ç¬¬iä»½ä»¥å¤–çš„ç¬¬ä¸€ä»½ä½œä¸ºtrainçš„å¼€å¤´</span></span><br><span class="line">        <span class="keyword">elif</span> X_train <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            X_train, y_train = X_part, y_part</span><br><span class="line">        <span class="comment"># å…¶ä½™æ‹¼æ¥åˆ°åé¢</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            X_train = tf.concat([X_train, X_part], <span class="number">0</span>)</span><br><span class="line">            y_train = tf.concat([y_train, y_part], <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> X_train, y_train, X_valid, y_valid</span><br><span class="line"></span><br><span class="line"><span class="comment"># äº¤å‰éªŒè¯</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">k_fold</span>(<span class="params">k, X_train, y_train, num_epochs, learning_rate, weight_decay, batch_size</span>):</span></span><br><span class="line">    train_loss_sum, valid_loss_sum = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        data = get_k_fold_data(k, i, X_train, y_train)</span><br><span class="line">        net = get_net()</span><br><span class="line">        train_loss, valid_loss = train(net, *data, num_epochs, learning_rate, weight_decay, batch_size)</span><br><span class="line">        train_loss_sum += train_loss[-<span class="number">1</span>]</span><br><span class="line">        valid_loss_sum += valid_loss[-<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f'fold <span class="subst">{i + <span class="number">1</span>}</span>, train log rmse <span class="subst">{<span class="built_in">float</span>(train_loss[-<span class="number">1</span>]):f}</span>, '</span></span><br><span class="line">              <span class="string">f'valid log rmse <span class="subst">{<span class="built_in">float</span>(valid_loss[-<span class="number">1</span>]):f}</span>'</span>)</span><br><span class="line">    <span class="keyword">return</span> train_loss_sum / k, valid_loss_sum / k</span><br></pre></td></tr></tbody></table></figure>
]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
  </entry>
  <entry>
    <title>æ³¨è§£å’Œåå°„</title>
    <url>/2021/10/14/%E6%B3%A8%E8%A7%A3%E5%92%8C%E5%8F%8D%E5%B0%84/</url>
    <content><![CDATA[<h2 id="1ã€æ³¨è§£"><a href="#1ã€æ³¨è§£" class="headerlink" title="1ã€æ³¨è§£"></a>1ã€æ³¨è§£</h2><h4 id="1-1ã€-å†…ç½®æ³¨è§£"><a href="#1-1ã€-å†…ç½®æ³¨è§£" class="headerlink" title="1.1ã€ å†…ç½®æ³¨è§£"></a>1.1ã€ å†…ç½®æ³¨è§£</h4><ul>
<li><p>@Deprecated</p>
<p>è¢«æ³¨è§£çš„å…ƒç´ æ˜¯ä¸é¼“åŠ±ä½¿ç”¨çš„ç¨‹åºå…ƒç´ ï¼Œé€šå¸¸æ˜¯å› ä¸ºå®ƒæ˜¯<code>å±é™©</code>çš„ï¼Œæˆ–è€…å› ä¸ºå­˜åœ¨æ›´å¥½çš„æ›¿ä»£æ–¹æ³•ã€‚</p>
</li>
<li><p>@Override</p>
<p>è¡¨ç¤ºé‡å†™çˆ¶ç±»æ–¹æ³•ã€‚</p>
</li>
<li><p>@SuppressWarning</p>
<p>æŠ‘åˆ¶è­¦å‘Šã€‚</p>
</li>
<li><p>@FunctionaInterface</p>
<p>æŒ‡å®šæ¥å£å¿…é¡»ä¸ºå‡½æ•°å¼æ¥å£ã€‚</p>
</li>
</ul>
<h4 id="1-2ã€å…ƒæ³¨è§£"><a href="#1-2ã€å…ƒæ³¨è§£" class="headerlink" title="1.2ã€å…ƒæ³¨è§£"></a>1.2ã€å…ƒæ³¨è§£</h4><p>å…ƒæ³¨è§£çš„ä½œç”¨å°±æ˜¯è´Ÿè´£<code>æ³¨è§£</code>å…¶å®ƒæ³¨è§£ã€‚</p>
<ul>
<li><p>@Target</p>
<p>ç”¨äºæè¿°æ³¨è§£çš„ä½¿ç”¨èŒƒå›´ã€‚</p>
</li>
<li><p>@Retention</p>
<p>è¡¨ç¤ºéœ€è¦åœ¨ä»€ä¹ˆçº§åˆ«ä¿å­˜è¯¥æ³¨é‡Šä¿¡æ¯ï¼Œç”¨äºæè¿°æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
<ul>
<li>SOURCE &lt; CLASS &lt; RUNTIME</li>
</ul>
</li>
<li><p>@Document</p>
<p>è¯´æ˜è¯¥æ³¨è§£å°†è¢«åŒ…å«åœ¨ javadoc ä¸­ã€‚</p>
</li>
<li><p>@Inherited</p>
<p>è¯´æ˜å­ç±»å¯ä»¥<code>ç»§æ‰¿</code>çˆ¶ç±»ä¸­çš„è¯¥æ³¨é‡Šã€‚</p>
</li>
</ul>
<h2 id="1-3ã€è‡ªå®šä¹‰æ³¨è§£"><a href="#1-3ã€è‡ªå®šä¹‰æ³¨è§£" class="headerlink" title="1.3ã€è‡ªå®šä¹‰æ³¨è§£"></a>1.3ã€è‡ªå®šä¹‰æ³¨è§£</h2><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(ElementType.FIELD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@interface</span> MyAnnotation1{</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">age</span><span class="params">()</span></span>;</span><br><span class="line">    String[] hobby() <span class="keyword">default</span> {<span class="string">"dance"</span>, <span class="string">"sing"</span>};</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(ElementType.FIELD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@interface</span> MyAnnotation2{</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ³¨è§£ä¸­çš„å‚æ•°ä¸€å®šè¦åŠ <code>()</code>ï¼</p>
<p>å½“æ³¨è§£åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œå‚æ•°åå¯ä»¥å®šä¹‰ä¸º <code>value</code>ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™ç›´æ¥èµ‹å€¼å°±è¡Œã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAnnotationTest</span> </span>{</span><br><span class="line">    <span class="meta">@MyAnnotation1(age = 12)</span></span><br><span class="line">    <span class="meta">@MyAnnotation2("value")</span></span><br><span class="line">    String name;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="2ã€åå°„"><a href="#2ã€åå°„" class="headerlink" title="2ã€åå°„"></a>2ã€åå°„</h2><p>Java åå°„å°±æ˜¯åœ¨<code>è¿è¡Œ</code>çŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„æ–¹æ³•å’Œå±æ€§ï¼Œå¹¶ä¸”èƒ½æ”¹å˜å®ƒçš„å±æ€§ã€‚</p>
<h4 id="2-1ã€è·å–-Class-ç±»çš„å®ä¾‹"><a href="#2-1ã€è·å–-Class-ç±»çš„å®ä¾‹" class="headerlink" title="2.1ã€è·å– Class ç±»çš„å®ä¾‹"></a>2.1ã€è·å– Class ç±»çš„å®ä¾‹</h4><ul>
<li><p>é€šè¿‡ç±»çš„ class å±æ€§è·å–ï¼Œå®‰å…¨å¯é ï¼Œæ€§èƒ½æœ€é«˜ã€‚</p>
<p><code>Class clz = Person.class;</code></p>
</li>
<li><p>è°ƒç”¨å®ä¾‹çš„ getClass() æ–¹æ³•ã€‚</p>
<p><code>Class clz = person.getClass();</code></p>
</li>
<li><p>é€šè¿‡ Class.forName() è·å–ã€‚</p>
<p><code>Class clz = Class.forName("com.yqx.Person");</code></p>
</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException </span>{</span><br><span class="line">    Class clz1 = Person.class;</span><br><span class="line">    Class clz2 = <span class="keyword">new</span> Person().getClass();</span><br><span class="line">    Class clz3 = Class.forName(<span class="string">"Person"</span>);</span><br><span class="line">    System.out.println(clz1 == clz2);	<span class="comment">// true</span></span><br><span class="line">    System.out.println(clz2 == clz3);	<span class="comment">// true</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="2-2ã€æ‹¥æœ‰-Class-å¯¹è±¡çš„ç±»å‹"><a href="#2-2ã€æ‹¥æœ‰-Class-å¯¹è±¡çš„ç±»å‹" class="headerlink" title="2.2ã€æ‹¥æœ‰ Class å¯¹è±¡çš„ç±»å‹"></a>2.2ã€æ‹¥æœ‰ Class å¯¹è±¡çš„ç±»å‹</h4><ul>
<li>classï¼šå¤–éƒ¨ç±»ï¼Œæˆå‘˜ï¼Œå±€éƒ¨å†…éƒ¨ç±»ï¼ŒåŒ¿åå†…éƒ¨ç±»ã€‚</li>
<li>interfaceï¼šæ¥å£</li>
<li>[]ï¼šæ•°ç»„</li>
<li>enumï¼šæšä¸¾</li>
<li>annotationï¼šæ³¨è§£ @interface</li>
<li>primitive typeï¼šåŸºæœ¬æ•°æ®ç±»å‹</li>
<li>void</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>{</span><br><span class="line">    Class clz1 = Object.class;</span><br><span class="line">    Class clz2 = Comparable.class;</span><br><span class="line">    Class clz3 = String[].class;</span><br><span class="line">    Class clz4 = String[][].class;</span><br><span class="line">    Class clz5 = Override.class;</span><br><span class="line">    Class clz6 = ElementType.class;</span><br><span class="line">    Class clz7 = Integer.class;</span><br><span class="line">    Class clz8 = <span class="keyword">void</span>.class;</span><br><span class="line">    Class clz9 = Class.class;</span><br><span class="line"></span><br><span class="line">    System.out.println(clz1);</span><br><span class="line">    System.out.println(clz2);</span><br><span class="line">    System.out.println(clz3);</span><br><span class="line">    System.out.println(clz4);</span><br><span class="line">    System.out.println(clz5);</span><br><span class="line">    System.out.println(clz6);</span><br><span class="line">    System.out.println(clz7);</span><br><span class="line">    System.out.println(clz8);</span><br><span class="line">    System.out.println(clz9);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span>[] a = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">int</span>[] b = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">100</span>];</span><br><span class="line">    System.out.println(a.getClass() == b.getClass());</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ‰“å°è¾“å‡º (æ•°ç»„å³ä½¿é•¿åº¦ä¸åŒï¼Œå…¶ Class ç±»ä¹Ÿéƒ½æ˜¯ç›¸åŒçš„)</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Object</span></span></span><br><span class="line"><span class="class"><span class="title">interface</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Comparable</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> [<span class="title">Ljava</span>.<span class="title">lang</span>.<span class="title">String</span></span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> [[<span class="title">Ljava</span>.<span class="title">lang</span>.<span class="title">String</span></span>;</span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Override</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">annotation</span>.<span class="title">ElementType</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Integer</span></span></span><br><span class="line"><span class="class"><span class="title">void</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Class</span></span></span><br><span class="line"><span class="class"><span class="title">true</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">Process</span> <span class="title">finished</span> <span class="title">with</span> <span class="title">exit</span> <span class="title">code</span> 0</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="2-3ã€ç±»çš„åŠ è½½"><a href="#2-3ã€ç±»çš„åŠ è½½" class="headerlink" title="2.3ã€ç±»çš„åŠ è½½"></a>2.3ã€ç±»çš„åŠ è½½</h4><p><img src="https://z3.ax1x.com/2021/10/14/5QnMng.png" alt=""></p>
<p><img src="https://z3.ax1x.com/2021/10/14/5QnIUA.png" alt=""></p>
<h4 id="2-4ã€è·å–ç±»çš„å±æ€§åŠæ–¹æ³•"><a href="#2-4ã€è·å–ç±»çš„å±æ€§åŠæ–¹æ³•" class="headerlink" title="2.4ã€è·å–ç±»çš„å±æ€§åŠæ–¹æ³•"></a>2.4ã€è·å–ç±»çš„å±æ€§åŠæ–¹æ³•</h4><p>åå°„æœºåˆ¶å…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶å–å¾—ä»»ä½•ä¸€ä¸ªå·²çŸ¥åç§°çš„ class çš„å†…éƒ¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬åŒ…æ‹¬å…¶modifiers (ä¿®é¥°ç¬¦)ï¼Œfields (å±æ€§)ï¼Œmethods (æ–¹æ³•)ç­‰ï¼Œå¹¶å¯äºè¿è¡Œæ—¶æ”¹å˜ fields å†…å®¹æˆ–è°ƒç”¨ methodsã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException, IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException, NoSuchFieldException </span>{</span><br><span class="line">        <span class="comment">// è·å– Class å¯¹è±¡</span></span><br><span class="line">        Class c1 = Class.forName(<span class="string">"Person"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºå¯¹è±¡(æ— å‚)</span></span><br><span class="line">        Person person1 = (Person) c1.newInstance();</span><br><span class="line">        System.out.println(person1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€šè¿‡æ„é€ å™¨åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">        Constructor constructor = c1.getDeclaredConstructor(String.class, <span class="keyword">int</span>.class);</span><br><span class="line">        Person person2 = (Person) constructor.newInstance(<span class="string">"yqx"</span>, <span class="number">20</span>);</span><br><span class="line">        System.out.println(person2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åå°„è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">        Method method1 = c1.getDeclaredMethod(<span class="string">"getName"</span>);</span><br><span class="line">        Method method2 = c1.getDeclaredMethod(<span class="string">"setName"</span>, String.class);</span><br><span class="line">        String name1 = (String) method1.invoke(person1);</span><br><span class="line">        method2.invoke(person1, <span class="string">"deflory"</span>);</span><br><span class="line">        String name2 = (String) method1.invoke(person1);</span><br><span class="line">        System.out.println(<span class="string">"Before: "</span> + name1);</span><br><span class="line">        System.out.println(<span class="string">"After: "</span> + name2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åå°„æ“ä½œå±æ€§</span></span><br><span class="line">        Field field = c1.getDeclaredField(<span class="string">"age"</span>);</span><br><span class="line">        field.setAccessible(<span class="keyword">true</span>);  <span class="comment">// è®¾ç½®å¯è®¿é—®çš„</span></span><br><span class="line">        field.set(person1, <span class="number">18</span>);</span><br><span class="line">        System.out.println(person1.getAge());</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>
<p>æ‰“å°å†…å®¹</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Person{name=<span class="string">'null'</span>, age=<span class="number">0</span>}</span><br><span class="line">Person{name=<span class="string">'yqx'</span>, age=<span class="number">20</span>}</span><br><span class="line">Before: <span class="keyword">null</span></span><br><span class="line">After: deflory</span><br><span class="line"><span class="number">18</span></span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="2-5ã€æ€§èƒ½æµ‹è¯•"><a href="#2-5ã€æ€§èƒ½æµ‹è¯•" class="headerlink" title="2.5ã€æ€§èƒ½æµ‹è¯•"></a>2.5ã€æ€§èƒ½æµ‹è¯•</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException </span>{</span><br><span class="line">    <span class="comment">// æ™®é€šæ–¹æ³•</span></span><br><span class="line">    Person person = <span class="keyword">new</span> Person();</span><br><span class="line">    <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1e9</span>;i++){</span><br><span class="line">        person.getAge();</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">"æ™®é€šæ–¹æ³•ç”¨æ—¶ï¼š"</span> + (end - start) + <span class="string">"ms"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åå°„(æ£€æµ‹å¼€å¯)</span></span><br><span class="line">    Method method = Person.class.getDeclaredMethod(<span class="string">"getAge"</span>);</span><br><span class="line">    start = System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1e9</span>;i++){</span><br><span class="line">        method.invoke(person);</span><br><span class="line">    }</span><br><span class="line">    end = System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">"åå°„(æ£€æµ‹å¼€å¯)ç”¨æ—¶ï¼š"</span> + (end - start) + <span class="string">"ms"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åå°„(æ£€æµ‹å…³é—­)</span></span><br><span class="line">    method.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    start = System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1e9</span>;i++){</span><br><span class="line">        method.invoke(person);</span><br><span class="line">    }</span><br><span class="line">    end = System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">"åå°„(æ£€æµ‹å…³é—­)ç”¨æ—¶ï¼š"</span> + (end - start) + <span class="string">"ms"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ‰“å°å†…å®¹</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">æ™®é€šæ–¹æ³•ç”¨æ—¶ï¼š1379ms</span><br><span class="line">åå°„(æ£€æµ‹å¼€å¯)ç”¨æ—¶ï¼š1863ms</span><br><span class="line">åå°„(æ£€æµ‹å…³é—­)ç”¨æ—¶ï¼š1591ms</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="2-6ã€åå°„æ“ä½œæ³›å‹"><a href="#2-6ã€åå°„æ“ä½œæ³›å‹" class="headerlink" title="2.6ã€åå°„æ“ä½œæ³›å‹"></a>2.6ã€åå°„æ“ä½œæ³›å‹</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test5</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchMethodException </span>{</span><br><span class="line">    Method test01 = Person.class.getDeclaredMethod(<span class="string">"test01"</span>, Map.class, List.class);</span><br><span class="line">    Method test02 = Person.class.getDeclaredMethod(<span class="string">"test02"</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"test01(å‚æ•°æ³›å‹)"</span>);</span><br><span class="line">    Type[] genericParameterTypes = test01.getGenericParameterTypes();</span><br><span class="line">    <span class="keyword">for</span>(Type genericParameterType : genericParameterTypes){</span><br><span class="line">        System.out.println(genericParameterType);</span><br><span class="line">        <span class="keyword">if</span> (genericParameterType <span class="keyword">instanceof</span> ParameterizedType){</span><br><span class="line">            Type[] actualTypeArguments = ((ParameterizedType) genericParameterType).getActualTypeArguments();</span><br><span class="line">            <span class="keyword">for</span>(Type actualTypeArgument : actualTypeArguments){</span><br><span class="line">                System.out.println(actualTypeArgument);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"\ntest02(è¿”å›å€¼æ³›å‹)"</span>);</span><br><span class="line">    Type getGenericReturnType = test02.getGenericReturnType();</span><br><span class="line">    System.out.println(getGenericReturnType);</span><br><span class="line">    <span class="keyword">if</span> (getGenericReturnType <span class="keyword">instanceof</span> ParameterizedType){</span><br><span class="line">        Type[] actualTypeArguments = ((ParameterizedType) getGenericReturnType).getActualTypeArguments();</span><br><span class="line">        <span class="keyword">for</span>(Type actualTypeArgument : actualTypeArguments){</span><br><span class="line">            System.out.println(actualTypeArgument);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ‰“å°å†…å®¹</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">test01(å‚æ•°æ³›å‹)</span><br><span class="line">java.util.Map&lt;java.lang.String, java.lang.Integer&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">String</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Integer</span></span></span><br><span class="line"><span class="class"><span class="title">java</span>.<span class="title">util</span>.<span class="title">List</span>&lt;<span class="title">java</span>.<span class="title">lang</span>.<span class="title">Character</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Character</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">test02</span>(è¿”å›å€¼æ³›å‹)</span></span><br><span class="line"><span class="class"><span class="title">java</span>.<span class="title">util</span>.<span class="title">Map</span>&lt;<span class="title">java</span>.<span class="title">lang</span>.<span class="title">String</span>, <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Integer</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">String</span></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">java</span>.<span class="title">lang</span>.<span class="title">Integer</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">Process</span> <span class="title">finished</span> <span class="title">with</span> <span class="title">exit</span> <span class="title">code</span> </span></span><br></pre></td></tr></tbody></table></figure>
]]></content>
  </entry>
  <entry>
    <title>ç¥ç»ç½‘ç»œæƒé‡çš„åˆå§‹åŒ–</title>
    <url>/2021/10/16/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E6%9D%83%E9%87%8D%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96/</url>
    <content><![CDATA[<p>å½“æˆ‘ä»¬åœ¨è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œå‚æ•°çš„éšæœºåˆå§‹åŒ–æ˜¯éå¸¸é‡è¦çš„ï¼Œå¯¹äºé€»è¾‘å›å½’æ¥è¯´ï¼Œå¯ä»¥å°†æƒé‡åˆå§‹åŒ–ä¸º0ã€‚è€Œå¯¹äºç¥ç»ç½‘ç»œè€Œè¨€ï¼Œè¿™æ ·åšå°†ä¼šå¯¼è‡´æ¢¯åº¦ä¸‹é™ç®—æ³•æ— æ³•èµ·ä½œç”¨ã€‚</p>
<h2 id="1-ä¸ºä»€ä¹ˆä½¿ç”¨äºé€»è¾‘å›å½’ï¼Ÿ"><a href="#1-ä¸ºä»€ä¹ˆä½¿ç”¨äºé€»è¾‘å›å½’ï¼Ÿ" class="headerlink" title="1. ä¸ºä»€ä¹ˆä½¿ç”¨äºé€»è¾‘å›å½’ï¼Ÿ"></a>1. ä¸ºä»€ä¹ˆä½¿ç”¨äºé€»è¾‘å›å½’ï¼Ÿ</h2><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…¶ä¸­$X_1$ å’Œ $X_2$ æ˜¯ç‰¹å¾å€¼ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/16/5JSZ2F.png" alt=""></p>
<p><strong>å‰å‘ä¼ æ’­</strong>ï¼š</p>
<p>$a_1 = sigmoid(X_1 <em> W_1 + X_2 </em> W_2 + b)$</p>
<p>$loss = -ylog(a_1) - (1 - y)log(1 - a_1)$</p>
<p><strong>åå‘ä¼ æ’­</strong>ï¼š</p>
<p>$da_1 = -\frac{y}{a_1} + \frac{1 - y}{1 - a_1}$</p>
<p>$dw_1 = da_1 <em> aâ€™_1 </em> X_1 = (a_1 - y) * X_1$</p>
<p>$dw_2 = da_1 <em> aâ€™_1 </em> X_2 = (a_1 - y) * X_2$</p>
<p>$db = da_1 <em> aâ€™_1 </em> 1 = a_1 - y$</p>
<p><strong>å‚æ•°æ›´æ–°</strong>ï¼š</p>
<p>$W_1 = w_1 - Î· * dw_1$</p>
<p>$W_2 = w_2 - Î· * dw_2$</p>
<p>$b = b - Î· * db$</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ $W_1$ å’Œ $W_2$  å¹¶ä¸å½±å“ $dw_1$ å’Œ $dw_2$ çš„å€¼ï¼Œè€Œæ˜¯æ ¹æ® $X_1$ å’Œ $X_2$ çš„ä¸åŒè€Œæ”¹å˜ï¼Œä¸”ä¸ä¸º0ï¼Œæ¨¡å‹çš„æƒé‡èƒ½å¤Ÿå¾—åˆ°æ›´æ–°ã€‚å› æ­¤å³ä½¿æˆ‘ä»¬å°† $W_1$ å’Œ $W_2$ åˆå§‹åŒ–ä¸º0ä¹Ÿæ— æ‰€è°“ã€‚å‚æ•° åŒç†ã€‚</p>
<h2 id="2-ä¸ºä»€ä¹ˆä¸é€‚ç”¨äºç¥ç»ç½‘ç»œ"><a href="#2-ä¸ºä»€ä¹ˆä¸é€‚ç”¨äºç¥ç»ç½‘ç»œ" class="headerlink" title="2. ä¸ºä»€ä¹ˆä¸é€‚ç”¨äºç¥ç»ç½‘ç»œ?"></a>2. ä¸ºä»€ä¹ˆä¸é€‚ç”¨äºç¥ç»ç½‘ç»œ?</h2><p>ç¥ç»ç½‘ç»œç»“æ„å›¾å¦‚ä¸‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/16/5J9qER.png" alt=""></p>
<p><strong>å‰å‘ä¼ æ’­</strong>ï¼š</p>
<p>$a_1 = f(X_1 <em> W_{11} + X_2 </em> W_{21} + b_1)$</p>
<p>$a_2 = f(X_1 <em> W_{12} + X_2 </em> W_{22} + b_2)$</p>
<p>$a_3 = sigmoid(a_1 <em> W_{13} + a_2 </em> W_{23} + b_3)$</p>
<p>$loss = -ylog(a_3) - (1 - y)log(1 - a_3)$</p>
<p><strong>åå‘ä¼ æ’­</strong>ï¼š</p>
<p>$da_3 = -\frac{y}{a_3} + \frac{1 - y}{1 - a_3}$</p>
<p>$dw_{13} = da_3 <em> aâ€™_3 </em> a_1 = (a_3 - y) * a_1$</p>
<p>$dw_{23} = da_3 <em> aâ€™_3 </em> a_2 = (a_3 - y) * a_2$</p>
<p>$db_{3} = da_3 <em> aâ€™_3 </em> 1 = a_3 - y$</p>
<p>$da_1 = da_3 <em> aâ€™_3 </em> W_{13} = (a_3 - y) * W_{13}$</p>
<p>$da_2 = da_3 <em> aâ€™_3 </em> W_{23} = (a_3 - y) * W_{23}$</p>
<p>$dw_{12} = da_2 <em> aâ€™_2 </em> X_1$</p>
<p>$dw_{22} = da_2 <em> aâ€™_2 </em> X_2$</p>
<p>$db_{2} = da_2 * aâ€™_2$</p>
<p>$dw_{11} = da_1 <em> aâ€™_1 </em> X_1$</p>
<p>$dw_{21} = da_1 <em> aâ€™_1 </em> X_2$</p>
<p>$db_{1} = da_1 * aâ€™_1$</p>
<p><strong>å‚æ•°æ›´æ–°</strong>ï¼š</p>
<p>$W_1 = w_1 - Î· * dw_1$</p>
<p>$W_2 = w_2 - Î· * dw_2$</p>
<p>$b = b - Î· * db$</p>
<p>æ ¹æ®ä¸Šè¿°çš„è¯¦ç»†å…¬å¼ï¼Œæˆ‘ä»¬åˆ†æä¸€ä¸‹3ç§æƒ…å†µï¼š</p>
<ul>
<li>æ¨¡å‹æ‰€æœ‰æƒé‡ W åˆå§‹åŒ–ä¸º0ï¼Œæ‰€æœ‰åç½® b åˆå§‹åŒ–ä¸º0</li>
<li>æ¨¡å‹æ‰€æœ‰æƒé‡ W åˆå§‹åŒ–ä¸º0ï¼Œæ‰€æœ‰åç½® b éšæœºåˆå§‹åŒ–</li>
<li>æ¨¡å‹æ‰€æœ‰çš„æƒé‡ W éšæœºåˆå§‹åŒ–ï¼Œæ‰€æœ‰åç½® b åˆå§‹åŒ–ä¸º0</li>
</ul>
<h4 id="2-1-æ¨¡å‹æ‰€æœ‰æƒé‡-W-åˆå§‹åŒ–ä¸º0ï¼Œæ‰€æœ‰åç½®-b-åˆå§‹åŒ–ä¸º0"><a href="#2-1-æ¨¡å‹æ‰€æœ‰æƒé‡-W-åˆå§‹åŒ–ä¸º0ï¼Œæ‰€æœ‰åç½®-b-åˆå§‹åŒ–ä¸º0" class="headerlink" title="2.1 æ¨¡å‹æ‰€æœ‰æƒé‡ W åˆå§‹åŒ–ä¸º0ï¼Œæ‰€æœ‰åç½® b åˆå§‹åŒ–ä¸º0"></a>2.1 æ¨¡å‹æ‰€æœ‰æƒé‡ W åˆå§‹åŒ–ä¸º0ï¼Œæ‰€æœ‰åç½® b åˆå§‹åŒ–ä¸º0</h4><p>åœ¨æ­¤æƒ…å†µä¸‹ï¼Œ ç¬¬ä¸€ä¸ª batch çš„å‰å‘ä¼ æ’­è¿‡ç¨‹æ—¶ï¼Œ$a_1 = f(0), a_2 = f(0), a_3 = sigmoid(0)$ã€‚åœ¨åå‘ä¼ æ’­è¿›è¡Œå‚æ•°æ›´æ–°çš„æ—¶å€™ï¼Œä¼šå‘ç° $a_1 = a_2 = f(0) \ \  =&gt;\ \  dw_{13} = dw_{23}$ï¼Œ$W_{13} = W_{23} = 0 \ \  =&gt; \ \ da_1 = da_2 = 0$ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç¬¬ä¸€ä¸ª batch ä¸­ï¼Œåªæœ‰ $W_{13}$ å’Œ ${W_{23}}$ è¿›è¡Œäº†æ›´æ–°å¹¶ä¸”<code>ç›¸ç­‰</code>ï¼Œè€Œå…¶å®ƒå‚æ•°å‡æ²¡æœ‰æ›´æ–°ã€‚</p>
<p>è€Œå½“ç¬¬äºŒä¸ª batch ä¼ ç»™ç¥ç»ç½‘ç»œæ—¶ï¼Œ$W_{13} = W_{23} \neq 0 \ \  =&gt;\ \  da_1 = da_2 \ \ =&gt; dw_{21} = dw_{22},\ dw_{11} = dw_{12}$ã€‚</p>
<p>ä»¥æ­¤ç±»æ¨ï¼Œæ— è®ºè®­ç»ƒå¤šå°‘æ¬¡ï¼Œæ— è®ºéšè—å±‚ç¥ç»å…ƒæœ‰å¤šå°‘ä¸ªï¼Œç”±äºæƒé‡çš„<code>å¯¹ç§°æ€§</code>ï¼Œéšè—å±‚ç¥ç»å•å…ƒçš„è¾“å‡ºå§‹ç»ˆä¸å˜(æƒé‡ç›¸ç­‰)ã€‚æˆ‘ä»¬å¸Œæœ›ä¸åŒçš„ç¥ç»å…ƒèƒ½å¤Ÿæœ‰ä¸åŒçš„è¾“å‡ºï¼Œè¿™æ ·çš„ç¥ç»ç½‘ç»œæ‰æœ‰æ„ä¹‰ã€‚</p>
<p><strong>æ€»ç»“ï¼šå°†æƒé‡ W åˆå§‹åŒ–ä¸º0ï¼Œä¼šå¯¼è‡´åŒä¸€éšè—å±‚çš„æ‰€æœ‰ç¥ç»å…ƒè¾“å‡ºéƒ½ä¸€è‡´ã€‚å¯¹äºåæœŸä¸åŒçš„ batchï¼Œæ¯ä¸€éšè—å±‚çš„æƒé‡éƒ½èƒ½å¾—åˆ°æ›´æ–°ï¼Œä½†æ˜¯æ¯ä¸€éšè—å±‚ç¥ç»å…ƒçš„æƒé‡éƒ½æ˜¯ä¸€è‡´çš„ï¼Œå¤šä¸ªéšè—ç¥ç»å…ƒçš„ä½œç”¨å°±å¦‚åŒ1ä¸ªç¥ç»å…ƒã€‚</strong></p>
<h4 id="2-2-æ¨¡å‹æ‰€æœ‰æƒé‡-W-åˆå§‹åŒ–ä¸º0ï¼Œæ‰€æœ‰åç½®-b-éšæœºåˆå§‹åŒ–"><a href="#2-2-æ¨¡å‹æ‰€æœ‰æƒé‡-W-åˆå§‹åŒ–ä¸º0ï¼Œæ‰€æœ‰åç½®-b-éšæœºåˆå§‹åŒ–" class="headerlink" title="2.2 æ¨¡å‹æ‰€æœ‰æƒé‡ W åˆå§‹åŒ–ä¸º0ï¼Œæ‰€æœ‰åç½® b éšæœºåˆå§‹åŒ–"></a>2.2 æ¨¡å‹æ‰€æœ‰æƒé‡ W åˆå§‹åŒ–ä¸º0ï¼Œæ‰€æœ‰åç½® b éšæœºåˆå§‹åŒ–</h4><p>åœ¨æ­¤æƒ…å†µä¸‹ï¼Œç¬¬ä¸€ä¸ª batch çš„å‰å‘ä¼ æ’­è¿‡ç¨‹æ—¶ï¼Œ$a_1 = f(b_1), a_2 = f(b_2), a_3 = sigmoid(b_3)$ï¼Œåœ¨åå‘ä¼ æ’­è¿‡ç¨‹æ—¶ï¼Œ$da_1 = da_2 = 0 \ \ =&gt; \ \ dw_{11} = dw_{12} = dw_{21} = dw_{22} = 0$ï¼Œå› æ­¤ç¬¬ä¸€ä¸ª batch ä¸­åªæœ‰ $W_{13}, W_{23}$ å’Œ $B_{3}$ èƒ½å¾—åˆ°æ›´æ–°ã€‚</p>
<p>åŒç†ï¼Œåœ¨ç¬¬äºŒä¸ª batch åå‘ä¼ æ’­çš„è¿‡ç¨‹ä¸­ï¼Œç”±äº $W_{13}$ å’Œ $W_{23}$ ä¸ä¸º0ï¼Œå› æ­¤æ‰€æœ‰çš„å‚æ•°éƒ½èƒ½å¾—åˆ°æ›´æ–°ã€‚<strong>è¿™ç§æ–¹å¼å­˜åœ¨æ›´æ–°è¾ƒæ…¢ã€æ¢¯åº¦æ¶ˆå¤±ã€æ¢¯åº¦çˆ†ç‚¸ç­‰é—®é¢˜ï¼Œåœ¨å®è·µä¸­ï¼Œé€šå¸¸ä¸ä¼šé€‰æ‹©è¯¥æ–¹æ³•ã€‚</strong></p>
<h4 id="2-3-æ¨¡å‹æ‰€æœ‰çš„æƒé‡-W-éšæœºåˆå§‹åŒ–ï¼Œæ‰€æœ‰åç½®-b-åˆå§‹åŒ–ä¸º0"><a href="#2-3-æ¨¡å‹æ‰€æœ‰çš„æƒé‡-W-éšæœºåˆå§‹åŒ–ï¼Œæ‰€æœ‰åç½®-b-åˆå§‹åŒ–ä¸º0" class="headerlink" title="2.3 æ¨¡å‹æ‰€æœ‰çš„æƒé‡ W éšæœºåˆå§‹åŒ–ï¼Œæ‰€æœ‰åç½® b åˆå§‹åŒ–ä¸º0"></a>2.3 æ¨¡å‹æ‰€æœ‰çš„æƒé‡ W éšæœºåˆå§‹åŒ–ï¼Œæ‰€æœ‰åç½® b åˆå§‹åŒ–ä¸º0</h4><p>åœ¨æ­¤æƒ…å†µä¸‹ï¼Œç¬¬ä¸€ä¸ª batch çš„å‰å‘ä¼ æ’­è¿‡ç¨‹æ—¶ï¼Œç”±äº $W_{13}$ å’Œ $W_{23}$ ä¸ä¸º0ï¼Œå› æ­¤æ‰€æœ‰çš„å‚æ•°å¯ä»¥ç›´æ¥å¾—åˆ°æ›´æ–°ã€‚</p>
<h2 id="ç»“è®ºï¼šåœ¨è®­ç»ƒç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œæƒé‡åˆå§‹åŒ–è¦è°¨æ…ï¼Œä¸èƒ½åˆå§‹åŒ–ä¸º0ï¼"><a href="#ç»“è®ºï¼šåœ¨è®­ç»ƒç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œæƒé‡åˆå§‹åŒ–è¦è°¨æ…ï¼Œä¸èƒ½åˆå§‹åŒ–ä¸º0ï¼" class="headerlink" title="ç»“è®ºï¼šåœ¨è®­ç»ƒç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œæƒé‡åˆå§‹åŒ–è¦è°¨æ…ï¼Œä¸èƒ½åˆå§‹åŒ–ä¸º0ï¼"></a><strong>ç»“è®ºï¼šåœ¨è®­ç»ƒç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œæƒé‡åˆå§‹åŒ–è¦è°¨æ…ï¼Œä¸èƒ½åˆå§‹åŒ–ä¸º0ï¼</strong></h2>]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
  </entry>
  <entry>
    <title>çº¿æ€§å›å½’</title>
    <url>/2021/09/13/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/</url>
    <content><![CDATA[<h2 id="ç®—æ³•æ€æƒ³"><a href="#ç®—æ³•æ€æƒ³" class="headerlink" title="ç®—æ³•æ€æƒ³"></a>ç®—æ³•æ€æƒ³</h2><p>ç”¨äºè§£å†³å›å½’é—®é¢˜ï¼Œåšæ³•å°±æ˜¯æ‰¾ä¸€æ¡æœ€èƒ½æ‹Ÿåˆæµ‹è¯•æ•°æ®çš„ç›´çº¿ï¼Œæ±‚è¯¥æ‹Ÿåˆç›´çº¿çš„æ–œç‡å’Œæˆªè·å°±æ˜¯æœ€å€¼é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•è§£å†³ã€‚é¢„æµ‹æ•°æ®ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå°†æ•°æ®ä»£å…¥ç›´çº¿ä¸­æ±‚å‡ºç»“æœå³å¯ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/15/51Iy7R.png" alt=""></p>
<p><br></p>
<h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><p>åœ¨ä¸¾ä¾‹ä¹‹å‰ï¼Œå…ˆä»‹ç»å‡ ç§æ±‚è¯¯å·®çš„æ–¹æ³•ã€‚</p>
<ol>
<li><p>MSE (Mean Square Error) å‡æ–¹è¯¯å·®</p>
<p>$\frac{1}{m}\sum\limits_{n=1}^{m} (y - y_n)^2$</p>
</li>
<li><p>RMSE (Root Mean Square Error) å‡æ–¹æ ¹è¯¯å·®</p>
<p>$\sqrt{\frac{1}{m}\sum\limits_{n=1}^m (y - y_n)^2}$</p>
</li>
<li><p>MAE (Mean Absolute Error) å¹³å‡ç»å¯¹è¯¯å·®</p>
<p>$\frac{1}{m}\sum\limits_{n=1}^{m} |y - y_n|$</p>
<p>ä¸Šè¿°ä¸‰ç§ä¸­ï¼Œå‡æ–¹è¯¯å·®å’Œå‡æ–¹æ ¹è¯¯å·®åªæ˜¯å·®äº†ä¸ªæ ¹å·ï¼Œæœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯æ±‚é¢„æµ‹å€¼ä¸çœŸå®å€¼çš„å¹³æ–¹å·®ã€‚</p>
<p>å› ä¸ºæ˜¯å¹³æ–¹å·®ï¼Œä¼šå¯¹æåº¦åé¢‡çš„æ•°æ®ç‰¹åˆ«æ•æ„Ÿï¼Œå› æ­¤ä¼šç€é‡å»æ‹Ÿåˆè¿™éƒ¨åˆ†æ•°æ®ã€‚</p>
<p>è€Œç»å¯¹å€¼å¯¹æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ²¡æœ‰ä¾§é‡ç‚¹ã€‚</p>
</li>
</ol>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">x = np.arange(-<span class="number">10</span>, <span class="number">10</span>, <span class="number">0.2</span>).reshape([<span class="number">100</span>,<span class="number">1</span>])</span><br><span class="line">y = <span class="number">3.5</span> * x + np.random.normal(<span class="number">0</span>, <span class="number">20</span>, <span class="number">100</span>).reshape([<span class="number">100</span>,<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">plt.scatter(x,y)</span><br><span class="line">plt.plot([-<span class="number">10</span>, <span class="number">10</span>],[-<span class="number">55</span>, <span class="number">55</span>], color = <span class="string">"red"</span>)</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/13/4PSGuR.png" alt=""></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè“è‰²çš„ç¦»æ•£ç‚¹å°±æ˜¯æˆ‘ä»¬çš„æµ‹è¯•æ•°æ®ï¼Œçº¢è‰²æ˜¯è¦æ±‚çš„æ‹Ÿåˆæ›²çº¿ï¼Œæ–¹ç¨‹ä¸º$y = ax + b$ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦è®©è¿™æ¡ç›´çº¿çš„é¢„æµ‹å€¼å’ŒçœŸå®å€¼çš„è¯¯å·®å°½å¯èƒ½å°ï¼Œå› æ­¤æˆæœ¬å‡½æ•°ä¸º</p>
<p>$cost = \frac{1}{m}\sum\limits_{n=1}^{m} (ax_n + b - y_n)^2$     ï¼ˆMSEï¼‰</p>
<p>æ­¤å¤„$x_n$å’Œ$y_n$éƒ½æ˜¯å·²çŸ¥çš„æ•°æ®ï¼Œaå’Œbæ‰æ˜¯æˆ‘ä»¬è¦æ±‚çš„æœªçŸ¥æ•°ã€‚</p>
<p>è¯¥æˆæœ¬å‡½æ•°çš„åå¯¼å‡½æ•°ä¸º</p>
<p>$\frac{dcost}{da} = \frac{2}{m}\sum\limits_{n=1}^{m} x_n(ax_n + b - y_n)$</p>
<p>$\frac{dcost}{db} = \frac{2}{m}\sum\limits_{n=1}^{m} (ax_n + b - y_n)$</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">J</span>(<span class="params">a, b, x, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>/<span class="built_in">len</span>(x) * np.<span class="built_in">sum</span>((a * x + b - y) ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DJ_a</span>(<span class="params">a, b, x, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> / <span class="built_in">len</span>(x) * np.<span class="built_in">sum</span>(x * (a * x + b - y))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DJ_b</span>(<span class="params">a, b, x, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> / <span class="built_in">len</span>(x) * np.<span class="built_in">sum</span>(a * x + b - y)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gradient_descent</span>(<span class="params">a, b, eta, epsilon = <span class="number">1e-6</span></span>):</span></span><br><span class="line">    i_iter = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        last_a = a</span><br><span class="line">        last_b = b</span><br><span class="line">        a = a - eta * DJ_a(a, b, x, y)</span><br><span class="line">        b = b - eta * DJ_b(a, b, x, y)</span><br><span class="line">        <span class="keyword">if</span> np.<span class="built_in">abs</span>(J(last_a, last_b, x, y) - J(a, b, x, y)) &lt; epsilon:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> a, b</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">0</span></span><br><span class="line">eta = <span class="number">0.02</span></span><br><span class="line">epsilon = <span class="number">1e-6</span></span><br><span class="line"></span><br><span class="line">a, b = gradient_descent(a, b, eta, epsilon)</span><br><span class="line"></span><br><span class="line">plt.plot([-<span class="number">10</span>, <span class="number">10</span>],[-<span class="number">10</span> * a + b, <span class="number">10</span> * a + b], color = <span class="string">"red"</span>)</span><br><span class="line">plt.scatter(x,y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/13/4PfaGT.png" alt=""></p>
<p>æ•ˆæœä¹Ÿæ˜¯æŒºä¸é”™çš„ï¼Œä¸è¿‡è¿™æ˜¯ä¸€å…ƒçš„æƒ…å†µï¼Œå¯ä»¥å†™ä¸¤ä¸ªDJ_aå’ŒDJ_bï¼Œä½†å¦‚æœæ˜¯ç™¾å…ƒå‘¢ï¼Ÿ</p>
<p>ä¸‹é¢å°†ä¼šå®ç°ä¸€ç§é€šç”¨çš„æ¢¯åº¦ä¸‹é™æ³•ã€‚</p>
<p><br></p>
<p>å…ˆæ›´æ”¹ä¸€ä¸‹æˆ‘ä»¬çš„æˆæœ¬å‡½æ•°ï¼Œå…¶ä¸­Î¸æ˜¯ç³»æ•°çŸ©é˜µï¼Œå¯¹äºä¸€å…ƒå‡½æ•°ï¼Œå®ƒçš„shapeå°±æ˜¯(2, )ï¼Œxéœ€è¦å†æ·»ä¸€åˆ—ï¼ˆæ•°å€¼ä¸º1ï¼‰ï¼Œè¿™æ ·x <em> a + 1 </em> bå°±æ­£å¥½æ˜¯æˆ‘ä»¬çš„ç›´çº¿æ–¹ç¨‹é¢„æµ‹å€¼ã€‚</p>
<p>$cost = \frac{1}{m}\sum (x.dot(Î¸) - y)^2$     ï¼ˆMSEï¼‰</p>
<p>å¯¼å‡½æ•°</p>
<p>$\frac{dcost}{dÎ¸} = \frac{2}{m} x.t.dot((x.dot(Î¸) - y))$</p>
<p>æ¨å¯¼è¿‡ç¨‹</p>
<p><img src="https://z3.ax1x.com/2021/09/13/4iWVJK.png" alt=""></p>
<p><img src="https://z3.ax1x.com/2021/09/13/4iRJKJ.png" alt=""></p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">J</span>(<span class="params">theta, x, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>/<span class="built_in">len</span>(x) * np.<span class="built_in">sum</span>((x.dot(theta) - y) ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DJ</span>(<span class="params">theta, x, y</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> / <span class="built_in">len</span>(x) * (x.T.dot(x.dot(theta) - y))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gradient_descent</span>(<span class="params">theta, x, y, eta, n_iters = <span class="number">2e5</span>, epsilon = <span class="number">1e-6</span></span>):</span></span><br><span class="line">    i_iter = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> i_iter &lt; n_iters:</span><br><span class="line">        last_theta = theta</span><br><span class="line">        theta = theta - eta * DJ(theta, x, y)</span><br><span class="line">        <span class="keyword">if</span> np.<span class="built_in">abs</span>(J(last_theta, x, y) - J(theta, x, y)) &lt; epsilon:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        i_iter += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> theta</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<p>ç„¶åæˆ‘ä»¬æ¥æ‹Ÿåˆåˆšåˆšéšæœºçš„æ•°æ®</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">x = np.hstack([x, np.ones([<span class="number">100</span>, <span class="number">1</span>])])</span><br><span class="line"></span><br><span class="line">theta = np.zeros([<span class="number">2</span>])</span><br><span class="line">eta = <span class="number">0.02</span></span><br><span class="line">y = y.reshape([<span class="number">100</span>])</span><br><span class="line">theta = gradient_descent(theta, x, y, eta)</span><br><span class="line"></span><br><span class="line">plt.plot([-<span class="number">10</span>, <span class="number">10</span>],[-<span class="number">10</span> * theta[<span class="number">0</span>] + theta[<span class="number">1</span>], <span class="number">10</span> * theta[<span class="number">0</span>] + theta[<span class="number">1</span>]], color = <span class="string">"red"</span>)</span><br><span class="line">plt.scatter(x[:, <span class="number">0</span>],y.reshape([<span class="number">100</span>, <span class="number">1</span>]))</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line">theta 		<span class="comment"># array([3.4686148, -1.06100372])</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/13/4ifDnH.png" alt=""></p>
<p>æ˜¾ç„¶ï¼Œè¿™æ¡ç›´çº¿è¿˜æ˜¯èƒ½è¾ƒå¥½æ‹Ÿåˆè¿™ä¸ªæµ‹è¯•æ•°æ®çš„ã€‚</p>
<p>theta[0] = 3.4686148 â‰ˆ 3.5ï¼Œä¹Ÿå’Œæˆ‘ä»¬é¢„è®¾çš„åŸºæœ¬ä¸€è‡´ã€‚</p>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LinearRegression</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.X = <span class="literal">None</span></span><br><span class="line">        self.y = <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span>(<span class="params">self, X, y</span>):</span></span><br><span class="line">        self.X = X</span><br><span class="line">        self.y = y</span><br><span class="line">        self.<span class="built_in">len</span> = <span class="built_in">len</span>(X)</span><br><span class="line">        self.X_b = np.hstack([self.X, np.ones([self.<span class="built_in">len</span>, <span class="number">1</span>])])</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">J</span>(<span class="params">self, theta</span>):</span></span><br><span class="line">        <span class="keyword">return</span> np.<span class="built_in">sum</span>((self.y - self.X_b.dot(theta)) ** <span class="number">2</span>) / self.<span class="built_in">len</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">DJ</span>(<span class="params">self, theta</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.X_b.T.dot(self.X_b.dot(theta) - y) * <span class="number">2</span> / self.<span class="built_in">len</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span>(<span class="params">self, eta = <span class="number">0.01</span>, n_iters = <span class="number">1e5</span>, epsilon = <span class="number">1e-8</span></span>):</span></span><br><span class="line">        <span class="keyword">assert</span> self.X_b <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> self.y <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>, \</span><br><span class="line">        <span class="string">"must fit before transform"</span></span><br><span class="line">        </span><br><span class="line">        theta = np.zeros(self.X.shape[<span class="number">1</span>] + <span class="number">1</span>)</span><br><span class="line">        i_iter = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i_iter &lt; n_iters:</span><br><span class="line">            last_theta = theta</span><br><span class="line">            theta = theta - eta * self.DJ(theta)</span><br><span class="line">            <span class="keyword">if</span> np.<span class="built_in">abs</span>(self.J(theta) - self.J(last_theta)) &lt; epsilon:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            i_iter += <span class="number">1</span></span><br><span class="line">        self.theta = theta</span><br><span class="line">        self.intercept = self.theta[-<span class="number">1</span>]</span><br><span class="line">        self.coefficient = self.theta[:-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> theta</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span>(<span class="params">self, X</span>):</span></span><br><span class="line">        <span class="keyword">return</span> X.dot(self.coefficient) + self.intercept</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">self, X, y</span>):</span></span><br><span class="line">        y_pred = X.dot(self.coefficient) + self.intercept</span><br><span class="line">        <span class="keyword">return</span> np.<span class="built_in">sum</span>((y_pred - y) ** <span class="number">2</span>) / <span class="built_in">len</span>(X)</span><br></pre></td></tr></tbody></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¬¬28è¡Œä¸­<code>theta = theta - eta * self.DJ(theta)</code>ï¼Œä¸èƒ½å†™æˆ<code>theta -= eta * self.DJ(theta)</code>ï¼Œè¿™æ˜¯å› ä¸ºç°åœ¨last_thetaå’Œthetaéƒ½æŒ‡å‘åŒä¸€å—å†…å­˜å•å…ƒï¼Œ-=æ˜¯åŸåœ°æ“ä½œï¼Œåœ¨æ›´æ”¹äº†thetaçš„åŒæ—¶ï¼Œlast_thetaä¹Ÿè¢«æ›´æ”¹äº†ï¼Œè€Œ=åˆ™æ˜¯é‡æ–°å¼€è¾Ÿä¸€å—æ–°çš„å†…å­˜ç©ºé—´ï¼Œç„¶åå†è®©thetaæŒ‡å‘å®ƒã€‚</p>
<p><br></p>
<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sklearn</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"></span><br><span class="line">boston=datasets.load_boston()</span><br><span class="line">X=boston.data</span><br><span class="line">y=boston.target</span><br><span class="line"></span><br><span class="line">lr = LinearRegression()</span><br><span class="line">lr.fit(X, y)</span><br><span class="line">lr.transform(eta = <span class="number">1e-6</span>, n_iters = <span class="number">1e6</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="string">"""lr.coefficient</span></span><br><span class="line"><span class="string">array([-0.09218218,  0.06825598, -0.00529991,  0.46137796,  0.17983213,</span></span><br><span class="line"><span class="string">        4.30941577,  0.02543425, -0.70440603,  0.17038895, -0.00977886,</span></span><br><span class="line"><span class="string">       -0.09173025,  0.01804173, -0.55937148])</span></span><br><span class="line"><span class="string">       </span></span><br><span class="line"><span class="string">   lr.intercept 	</span></span><br><span class="line"><span class="string">   0.4361364266724813</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></tbody></table></figure>
<p>å› ä¸ºæ•°æ®æ˜¯13ç»´çš„ï¼Œæ²¡æœ‰åŠæ³•å¯è§†åŒ–ï¼Œæˆ‘ä»¬åªèƒ½ä½¿ç”¨MSEæŒ‡æ ‡æ¥è¡¡é‡ï¼Œå…¶ä¸­lr.score(X, y) = 26.11494ã€‚</p>
<p>ä¸ºäº†èƒ½çœ‹å¾—æ¸…æ¥šç‚¹ï¼Œæˆ‘ä»¬åªä½¿ç”¨å…¶ä¸­ä¸€ç»´æ¥è¿›è¡Œé¢„æµ‹ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">X = X[:, <span class="number">5</span>]</span><br><span class="line">plt.scatter(X, y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™é‡Œä¸Šé¢æœ‰ä¸€æ’æ•°å€¼éƒ½ä¸º50ï¼Œè¿™æ˜¯å› ä¸ºåœ¨åšè°ƒæŸ¥çš„æ—¶å€™ï¼Œæœ€é«˜ä¸€ä¸ªæ¡£å°±æ˜¯50ï¼ˆå¤§äº50Wéƒ½åªèƒ½å¡«50Wï¼‰ï¼Œå› æ­¤è¿™éƒ¨åˆ†æ•°æ®æˆ‘ä»¬å½“åšæ— æ•ˆæ•°æ®ï¼Œç›´æ¥ä¸¢å¼ƒæ‰ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/13/4iztpD.png" alt=""></p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">X = X[y &lt; <span class="number">50</span>]</span><br><span class="line">y = y[y &lt; <span class="number">50</span>]</span><br><span class="line"></span><br><span class="line">plt.scatter(X, y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p>åšä¸€ä¸‹ç­›é€‰ï¼Œåªé€‰y&lt;50çš„æ•°æ®å°±è¡Œäº†ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/13/4iz00I.png" alt=""></p>
<p>ç„¶åå¼€å§‹æ•´ä½“ï¼Œè¿›è¡Œé¢„æµ‹ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">lr = LinearRegression()</span><br><span class="line">X = X.reshape([-<span class="number">1</span>, <span class="number">1</span>])</span><br><span class="line">lr.fit(X, y)</span><br><span class="line">theta = lr.transform(eta = <span class="number">1e-6</span>, n_iters = <span class="number">1e6</span>)</span><br><span class="line"></span><br><span class="line">plt.plot(X, lr.predict(X), color=<span class="string">"red"</span>)</span><br><span class="line">plt.scatter(X, y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/13/4izc9S.png" alt=""></p>
<p>lr.score(X, y) = 42.28978618974813</p>
]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
  </entry>
  <entry>
    <title>è½¯ä»¶æµ‹è¯•è€ƒè¯•å¤ä¹ </title>
    <url>/2021/12/25/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E8%80%83%E8%AF%95%E5%A4%8D%E4%B9%A0/</url>
    <content><![CDATA[<h2 id="è®¾è®¡æµç¨‹"><a href="#è®¾è®¡æµç¨‹" class="headerlink" title="è®¾è®¡æµç¨‹"></a>è®¾è®¡æµç¨‹</h2><h4 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h4><p><strong>äº§ç‰©</strong>ï¼šè½¯ä»¶éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦,éœ€è¦ç¡®å®šç”¨æˆ·å¯¹è½¯ä»¶çš„éœ€æ±‚,è¦ä½œåˆ°æ˜ç¡®ã€æ— æ­§ä¹‰ã€‚ä¸æ¶‰åŠå…·ä½“å®ç°æ–¹æ³•ã€‚ç”¨æˆ·èƒ½çœ‹å¾—æ˜ç™½ï¼Œå¼€å‘äººå‘˜ä¹Ÿå¯æ®æ­¤è¿›è¡Œä¸‹é¢çš„å·¥ä½œï¼ˆæ¦‚è¦è®¾è®¡ï¼‰</p>
<h4 id="æ¦‚è¦è®¾è®¡"><a href="#æ¦‚è¦è®¾è®¡" class="headerlink" title="æ¦‚è¦è®¾è®¡"></a>æ¦‚è¦è®¾è®¡</h4><p><strong>äº§ç‰©</strong>ï¼šè½¯ä»¶æ¦‚è¦è®¾è®¡è¯´æ˜ä¹¦ï¼Œè¯´æ˜ç³»ç»Ÿæ¨¡å—åˆ’åˆ†ã€é€‰æ‹©çš„æŠ€æœ¯è·¯çº¿ç­‰ï¼Œæ•´ä½“è¯´æ˜è½¯ä»¶çš„å®ç°æ€è·¯ã€‚å¹¶ä¸”éœ€è¦æŒ‡å‡ºå…³é”®æŠ€æœ¯éš¾ç‚¹ç­‰ã€‚  </p>
<h4 id="è¯¦ç»†è®¾è®¡"><a href="#è¯¦ç»†è®¾è®¡" class="headerlink" title="è¯¦ç»†è®¾è®¡"></a>è¯¦ç»†è®¾è®¡</h4><p><strong>äº§ç‰©</strong>ï¼šè½¯ä»¶è¯¦ç»†è®¾è®¡è¯´æ˜ä¹¦ï¼Œå¯¹æ¦‚è¦è®¾è®¡çš„è¿›ä¸€æ­¥ç»†åŒ–ï¼Œä¸€èˆ¬ç”±å„éƒ¨åˆ†çš„æ‹…å½“äººå‘˜ä¾æ®æ¦‚è¦è®¾è®¡åˆ†åˆ«å®Œæˆï¼Œç„¶ååœ¨é›†æˆï¼Œæ˜¯å…·ä½“çš„å®ç°ç»†èŠ‚ã€‚ç†è®ºä¸Šè¦æ±‚å¯ä»¥ç…§æ­¤ç¼–ç ã€‚</p>
<p>ä¸€èˆ¬è¯´æ¥ï¼Œéœ€æ±‚åˆ†æå±äºè½¯ä»¶å®šä¹‰æ–¹é¢ï¼›è€Œæ¦‚è¦è®¾è®¡ã€è¯¦ç»†è®¾è®¡å±äºè½¯ä»¶å¼€å‘çš„é˜¶æ®µ</p>
<h2 id="è½¯ä»¶æµ‹è¯•çº§åˆ«"><a href="#è½¯ä»¶æµ‹è¯•çº§åˆ«" class="headerlink" title="è½¯ä»¶æµ‹è¯•çº§åˆ«"></a>è½¯ä»¶æµ‹è¯•çº§åˆ«</h2><h4 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h4><p>å•å…ƒæµ‹è¯•æ˜¯å¯¹ç¨‹åºä¸­çš„æŸä¸ªæ¥å£æˆ–è€…æ¨¡å—è¿›è¡Œæµ‹è¯•ï¼Œä¸»è¦ä½¿ç”¨ç™½ç›’æµ‹è¯•ï¼Œç”±ç¼–ç¨‹äººå‘˜ï¼ˆä¸»å¯¼ï¼‰å’Œæµ‹è¯•äººå‘˜å…±åŒå®Œæˆã€‚</p>
<p>å•å…ƒæµ‹è¯•çš„ç›®çš„æ˜¯å¼€å‘äººå‘˜ç¡®å®šè¿™æ®µå­ç¨‹åºåšäº†å®ƒåº”è¯¥åšçš„äº‹ã€‚</p>
<h4 id="é›†æˆæµ‹è¯•"><a href="#é›†æˆæµ‹è¯•" class="headerlink" title="é›†æˆæµ‹è¯•"></a>é›†æˆæµ‹è¯•</h4><p>é›†æˆæµ‹è¯•æ˜¯å•å…ƒæµ‹è¯•çš„é€»è¾‘æ‰©å±•ã€‚å®ƒçš„æœ€ç®€å•çš„å½¢å¼æ˜¯ï¼šä¸¤ä¸ªå·²ç»æµ‹è¯•è¿‡çš„å•å…ƒç»„åˆæˆä¸€ä¸ªç»„ä»¶ï¼Œå¹¶ä¸”æµ‹è¯•å®ƒä»¬ä¹‹é—´çš„æ¥å£ã€‚</p>
<p>é›†æˆæµ‹è¯•çš„ç›®çš„æ—¨åœ¨æµ‹è¯•å„ä¸ªç»„ä»¶é—´æ˜¯å¦èƒ½äº’ç›¸é…åˆï¼Œæ­£å¸¸å·¥ä½œã€‚</p>
<p>é›†æˆæµ‹è¯•åˆåˆ†ä¸ºä¸€æ¬¡æ€§é›†æˆæ–¹å¼å’Œæ¸å¢å¼é›†æˆæ–¹å¼ã€‚</p>
<ul>
<li><p><strong>ä¸€æ¬¡æ€§é›†æˆæ–¹å¼</strong></p>
<p>é¦–å…ˆå¯¹å„ä¸ªå•å…ƒåˆ†åˆ«è¿›è¡Œæµ‹è¯•ï¼Œç„¶åå°†æ‰€æœ‰å•å…ƒç»„è£…åœ¨ä¸€èµ·è¿›è¡Œæµ‹è¯•ï¼Œæœ€ç»ˆå¾—åˆ°è¦æ±‚çš„è½¯ä»¶ç³»ç»Ÿã€‚</p>
</li>
<li><p><strong>æ¸å¢å¼é›†æˆæ–¹å¼</strong></p>
<p>é¦–å…ˆå¯¹æŸä¸¤ä¸‰ä¸ªå•å…ƒè¿›è¡Œæµ‹è¯•ï¼Œç„¶åå°†è¿™äº›å•å…ƒé€æ­¥ç»„è£…æˆè¾ƒå¤§çš„ç³»ç»Ÿã€‚åœ¨ç»„è£…çš„è¿‡ç¨‹ä¸­ï¼Œä¸€è¾¹è¿æ¥ä¸€è¾¹æµ‹è¯•ï¼Œä»¥å‘ç°è¿æ¥è¿æ¥è¿‡ç¨‹ä¸­äº§ç”Ÿçš„é—®é¢˜ï¼Œæœ€åå®Œæˆæ‰€æœ‰å•å…ƒçš„ç»§æ‰¿ï¼Œæ„é€ ä¸ºä¸€ä¸ªå®Œæ•´çš„è½¯ä»¶ç³»ç»Ÿã€‚</p>
</li>
</ul>
<h4 id="ç³»ç»Ÿæµ‹è¯•"><a href="#ç³»ç»Ÿæµ‹è¯•" class="headerlink" title="ç³»ç»Ÿæµ‹è¯•"></a>ç³»ç»Ÿæµ‹è¯•</h4><p>ç³»ç»ŸåŠŸèƒ½æµ‹è¯•éœ€è¦åœ¨é›†æˆæµ‹è¯•å®Œæˆä¹‹åè¿›è¡Œï¼Œé‡‡ç”¨é»‘ç›’æµ‹è¯•ï¼Œåªæ£€æŸ¥ç¨‹åºåŠŸèƒ½æ˜¯å¦æŒ‰ç…§éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦èƒ½å¤Ÿæ­£å¸¸è¢«ä½¿ç”¨ã€‚åŒ…å«ç”¨æˆ·ç•Œé¢ã€å„ç§æ“ä½œã€ä¸åŒçš„æ•°æ®è¾“å…¥è¾“å‡ºå’Œå­˜å‚¨ç­‰çš„æµ‹è¯•ã€‚</p>
<p>ç³»ç»ŸéåŠŸèƒ½æµ‹è¯•æ˜¯åœ¨å®é™…è¿è¡Œç¯å¢ƒæˆ–æ¨¡æ‹Ÿå®é™…è¿è¡Œç¯å¢ƒï¼Œå†…å®¹åŒ…æ‹¬è´Ÿè½½ã€æ€§èƒ½ã€å‹åŠ›ã€ç¾éš¾ç­‰æµ‹è¯•ã€‚</p>
<h4 id="éªŒæ”¶æµ‹è¯•"><a href="#éªŒæ”¶æµ‹è¯•" class="headerlink" title="éªŒæ”¶æµ‹è¯•"></a>éªŒæ”¶æµ‹è¯•</h4><p>éªŒæ”¶æµ‹è¯•ä¸€èˆ¬æ ¹æ®äº§å“éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦ä¸¥æ ¼æ£€æŸ¥äº§å“ï¼Œé€è¡Œé€å­—åœ°å¯¹ç…§è¯´æ˜ä¹¦ä¸Šå¯¹è½¯ä»¶äº§å“æ‰€åšå‡ºçš„å„æ–¹é¢è¦æ±‚ï¼Œç¡®ä¿æ‰€å¼€å‘çš„è½¯ä»¶äº§å“ç¬¦åˆç”¨æˆ·çš„å„é¡¹è¦æ±‚ã€‚</p>
<p>éªŒæ”¶æµ‹è¯•æ–¹æ³•æœ‰æ­£å¼éªŒæ”¶æµ‹è¯•ï¼Œalpha æµ‹è¯•å’Œ beta æµ‹è¯•<strong>ã€‚</strong></p>
<ul>
<li><p>alpha æµ‹è¯•</p>
<p>è½¯ä»¶å¼€å‘å…¬å¸å†…éƒ¨äººå‘˜åœ¨æ¨¡æ‹Ÿå®é™…æ“ä½œç¯å¢ƒä¸‹è¿›è¡Œçš„æµ‹è¯•ã€‚</p>
</li>
<li><p>beta æµ‹è¯•</p>
<p>åœ¨ alpha æµ‹è¯•ä¹‹åï¼Œç”±è½¯ä»¶çš„<strong>æœ€ç»ˆç”¨æˆ·</strong>ä»¬è¿›è¡Œè¯•ç”¨ï¼Œå…¬å¸ä¼šè¦æ±‚ç”¨æˆ·æŠ¥å‘Šå¼‚å¸¸æƒ…å†µï¼Œå†å¯¹ beta ç‰ˆæœ¬è¿›è¡Œä¿®æ­£å’Œå®Œæˆï¼Œæœ€ç»ˆå¾—åˆ°æ­£å¼å‘å¸ƒçš„ç‰ˆæœ¬ã€‚</p>
</li>
</ul>
<h4 id="è½¯ä»¶æµ‹è¯•æ­¥éª¤"><a href="#è½¯ä»¶æµ‹è¯•æ­¥éª¤" class="headerlink" title="è½¯ä»¶æµ‹è¯•æ­¥éª¤"></a>è½¯ä»¶æµ‹è¯•æ­¥éª¤</h4><p>è½¯ä»¶æµ‹è¯•è¦ç»è¿‡çš„æ­¥éª¤æ˜¯ï¼šå•å…ƒæµ‹è¯•â†’é›†æˆæµ‹è¯•â†’ç¡®è®¤æµ‹è¯•â†’ç³»ç»Ÿæµ‹è¯•ã€‚ </p>
<p><strong>å•å…ƒæµ‹è¯•</strong>ï¼šå¯¹æºç¨‹åºä¸­æ¯ä¸€ä¸ªæ¨¡å—å•å…ƒè¿›è¡Œæµ‹è¯•ï¼Œæ£€æŸ¥å„ä¸ªæ¨¡å—æ˜¯å¦æ­£ç¡®å®ç°è§„å®šçš„åŠŸèƒ½ï¼Œä»è€Œå‘ç°æ¨¡å—åœ¨ç¼–ç ä¸­æˆ–ç®—æ³•ä¸­çš„é”™è¯¯ã€‚è¯¥é˜¶æ®µæ¶‰åŠ==ç¼–ç å’Œè¯¦ç»†è®¾è®¡æ–‡æ¡£==ã€‚ </p>
<p><strong>é›†æˆæµ‹è¯•</strong>ï¼šæ˜¯ä¸ºäº†æ£€æŸ¥è½¯ä»¶ä½“ç³»ç»“æ„çš„æœ‰å…³é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯æ£€æŸ¥==æ¦‚è¦è®¾è®¡==æ˜¯å¦åˆç†æœ‰æ•ˆã€‚ </p>
<p><strong>ç¡®è®¤æµ‹è¯•</strong>ï¼šä¸»è¦æ˜¯æ£€æŸ¥å·²å®ç°çš„è½¯ä»¶æ˜¯å¦æ»¡è¶³==éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦==ä¸­çš„å„ç§éœ€æ±‚ã€‚ </p>
<p><strong>ç³»ç»Ÿæµ‹è¯•</strong>ï¼šæ˜¯æŠŠå·²ç¡®è®¤çš„è½¯ä»¶ä¸å…¶ä»–ç³»ç»Ÿå…ƒç´ ï¼ˆå¦‚ç¡¬ä»¶ã€å…¶ä»–æ”¯æŒè½¯ä»¶ã€æ•°æ®ã€äººå·¥ç­‰ï¼‰ç»“åˆåœ¨ä¸€èµ·è¿›è¡Œæµ‹è¯•ã€‚ä»¥ç¡®å®šè½¯ä»¶æ˜¯å¦å¯ä»¥æ”¯ä»˜ä½¿ç”¨ã€‚</p>
<h2 id="é€»è¾‘è¦†ç›–"><a href="#é€»è¾‘è¦†ç›–" class="headerlink" title="é€»è¾‘è¦†ç›–"></a>é€»è¾‘è¦†ç›–</h2><p>é€»è¾‘è¦†ç›–ç‡ï¼šè¯­å¥è¦†ç›– &lt; æ¡ä»¶è¦†ç›– &lt; åˆ¤å®šè¦†ç›– &lt; æ¡ä»¶åˆ¤å®šè¦†ç›– &lt; æ¡ä»¶ç»„åˆè¦†ç›– &lt; è·¯å¾„è¦†ç›–</p>
<h4 id="è¯­å¥è¦†ç›–"><a href="#è¯­å¥è¦†ç›–" class="headerlink" title="è¯­å¥è¦†ç›–"></a>è¯­å¥è¦†ç›–</h4><p>ä½¿ç¨‹åºä¸­æ¯ä¸ª==å¯æ‰§è¡Œè¯­å¥==è‡³å°‘æ‰§è¡Œä¸€æ¬¡</p>
<p><img src="https://s4.ax1x.com/2021/12/25/TdQSLF.png" alt="image"></p>
<p>è¦†ç›–æ¡ä»¶ï¼š</p>
<blockquote>
<p>æ¡ä»¶1ï¼šTï¼Œæ¡ä»¶3ï¼šT</p>
</blockquote>
<h4 id="åˆ¤å®šè¦†ç›–"><a href="#åˆ¤å®šè¦†ç›–" class="headerlink" title="åˆ¤å®šè¦†ç›–"></a>åˆ¤å®šè¦†ç›–</h4><p>ä½¿å¾—ç¨‹åºä¸­æ¯ä¸€ä¸ª==åˆ¤æ–­==è‡³å°‘å–çœŸä¸€æ¬¡å–å‡ä¸€æ¬¡</p>
<p><img src="https://s4.ax1x.com/2021/12/25/Td1taQ.png" alt="image"></p>
<p>è¦†ç›–æ¡ä»¶ï¼š</p>
<blockquote>
<p>æ¡ä»¶1ï¼šTï¼Œæ¡ä»¶3ï¼šF<br>æ¡ä»¶1ï¼šFï¼Œæ¡ä»¶3ï¼šT</p>
</blockquote>
<h4 id="æ¡ä»¶è¦†ç›–"><a href="#æ¡ä»¶è¦†ç›–" class="headerlink" title="æ¡ä»¶è¦†ç›–"></a>æ¡ä»¶è¦†ç›–</h4><p>ä½¿æ¯ä¸ªçš„åˆ¤æ–­ä¸­==æ¯ä¸ªæ¡ä»¶==çš„å¯èƒ½å–å€¼è‡³å°‘æ»¡è¶³ä¸€æ¬¡</p>
<p><img src="https://s4.ax1x.com/2021/12/25/Td3ylt.png" alt="image"></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">åˆ¤æ–­è¡¨è¾¾å¼1ï¼š</span><br><span class="line">è®¾æ¡ä»¶ a&gt;0 ä¸ºçœŸ è®°T1</span><br><span class="line">			å‡ è®°F1</span><br><span class="line">æ¡ä»¶ b&gt;0   ä¸ºçœŸ è®°T2</span><br><span class="line">			å‡ è®°F2 </span><br><span class="line">			</span><br><span class="line">åˆ¤æ–­è¡¨è¾¾å¼3ï¼š</span><br><span class="line">è®¾æ¡ä»¶ a&gt;1 ä¸ºçœŸ è®°T3</span><br><span class="line">			å‡ è®°F3</span><br><span class="line">æ¡ä»¶ c&gt;1   ä¸ºçœŸ è®°T4</span><br><span class="line">			å‡ è®°F4		</span><br></pre></td></tr></tbody></table></figure>
<p>è¦†ç›–æ¡ä»¶ï¼š</p>
<blockquote>
<p>T1ï¼ŒF2ï¼ŒT3ï¼ŒF4<br>F1ï¼ŒT2ï¼ŒF3ï¼ŒT4</p>
</blockquote>
<h4 id="æ¡ä»¶åˆ¤å®šè¦†ç›–"><a href="#æ¡ä»¶åˆ¤å®šè¦†ç›–" class="headerlink" title="æ¡ä»¶åˆ¤å®šè¦†ç›–"></a>æ¡ä»¶åˆ¤å®šè¦†ç›–</h4><p>ä½¿æ¯ä¸ªçš„åˆ¤æ–­ä¸­==æ¯ä¸ªæ¡ä»¶==çš„å¯èƒ½å–å€¼è‡³å°‘æ»¡è¶³ä¸€æ¬¡çš„åŒæ—¶ï¼Œè¿˜éœ€è¦è®©==æ¯ä¸ªåˆ¤å®š==å„çœŸå‡å„ä¸€æ¬¡ï¼Œå³æ¡ä»¶è¦†ç›– + åˆ¤å®šè¦†ç›–ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/26/TdGAK0.png" alt="image"></p>
<p>è¦†ç›–æ¡ä»¶ç”¨ä¾‹ï¼š</p>
<blockquote>
<p>T1,T2,T3,T4<br>F1,F2,F3,F4</p>
</blockquote>
<h4 id="æ¡ä»¶ç»„åˆè¦†ç›–"><a href="#æ¡ä»¶ç»„åˆè¦†ç›–" class="headerlink" title="æ¡ä»¶ç»„åˆè¦†ç›–"></a>æ¡ä»¶ç»„åˆè¦†ç›–</h4><p>ä½¿æ‰€æœ‰å¯èƒ½çš„==æ¡ä»¶å–å€¼==ç»„åˆè‡³å°‘æ‰§è¡Œä¸€æ¬¡</p>
<p><img src="https://s4.ax1x.com/2021/12/26/TdGcdS.png" alt="image"></p>
<p>é‡ç‚¹ï¼š<strong>æ‰€æœ‰æ¡ä»¶å–å€¼çš„ç»„åˆ</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>ç¼–å·</th>
<th>è¦†ç›–æ¡ä»¶å–å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>T1ï¼ŒT2</td>
</tr>
<tr>
<td>2</td>
<td>T1ï¼ŒF2</td>
</tr>
<tr>
<td>3</td>
<td>F1ï¼ŒT2</td>
</tr>
<tr>
<td>4</td>
<td>F1ï¼ŒF2</td>
</tr>
<tr>
<td>5</td>
<td>T3ï¼ŒT4</td>
</tr>
<tr>
<td>6</td>
<td>T3ï¼ŒF4</td>
</tr>
<tr>
<td>7</td>
<td>F3ï¼ŒT4</td>
</tr>
<tr>
<td>8</td>
<td>F3ï¼ŒF4</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th>è¦†ç›–æ¡ä»¶</th>
<th>è¦†ç›–ç»„åˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td>T1ï¼ŒT2 , T3 , T4</td>
<td>1,5</td>
</tr>
<tr>
<td>T1ï¼ŒF2 , T3 , F4</td>
<td>2,6</td>
</tr>
<tr>
<td>F1ï¼ŒT2 , F3 , T4</td>
<td>3,7</td>
</tr>
<tr>
<td>F1ï¼ŒF2 , F3 , F4</td>
<td>4,8</td>
</tr>
</tbody>
</table>
</div>
<h4 id="è·¯å¾„è¦†ç›–"><a href="#è·¯å¾„è¦†ç›–" class="headerlink" title="è·¯å¾„è¦†ç›–"></a>è·¯å¾„è¦†ç›–</h4><p>æ˜¯ç¨‹åºä¸­==æ‰€æœ‰å¯èƒ½==æ‰§è¡Œçš„è·¯å¾„éƒ½æ‰§è¡Œä¸€é</p>
<p><img src="https://s4.ax1x.com/2021/12/26/TdGhzn.png" alt="image"></p>
<p>ç»§ä¸Šé¢çš„çš„æ¡ä»¶å–å€¼è¡¨æ ¼</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>è¦†ç›–è·¯å¾„</th>
<th>è¦†ç›–ç»„åˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td>1-2-4</td>
<td>1,5</td>
</tr>
<tr>
<td>1-2-5</td>
<td>1,8</td>
</tr>
<tr>
<td>1-3-4</td>
<td>4,7</td>
</tr>
<tr>
<td>1-3-5</td>
<td>4,8</td>
</tr>
</tbody>
</table>
</div>
<h2 id="æ€§èƒ½æµ‹è¯•"><a href="#æ€§èƒ½æµ‹è¯•" class="headerlink" title="æ€§èƒ½æµ‹è¯•"></a>æ€§èƒ½æµ‹è¯•</h2><h4 id="è´Ÿè½½æµ‹è¯•ï¼ˆLarge-amount-of-usersï¼‰"><a href="#è´Ÿè½½æµ‹è¯•ï¼ˆLarge-amount-of-usersï¼‰" class="headerlink" title="è´Ÿè½½æµ‹è¯•ï¼ˆLarge amount of usersï¼‰"></a>è´Ÿè½½æµ‹è¯•ï¼ˆLarge amount of usersï¼‰</h4><p>è´Ÿè½½æµ‹è¯•æ˜¯ä¸€ç§æ€§èƒ½æµ‹è¯•ï¼ŒæŒ‡æ•°æ®åœ¨è¶…è´Ÿè·ç¯å¢ƒä¸­è¿è¡Œï¼Œç¨‹åºæ˜¯å¦èƒ½å¤Ÿæ‰¿æ‹…ã€‚ å…³æ³¨ç‚¹ï¼šhow much</p>
<h4 id="å‹åŠ›æµ‹è¯•ï¼ˆToo-many-users-too-much-data-too-little-time-and-too-little-roomï¼‰"><a href="#å‹åŠ›æµ‹è¯•ï¼ˆToo-many-users-too-much-data-too-little-time-and-too-little-roomï¼‰" class="headerlink" title="å‹åŠ›æµ‹è¯•ï¼ˆToo many users, too much data, too little time and too little roomï¼‰"></a>å‹åŠ›æµ‹è¯•ï¼ˆToo many users, too much data, too little time and too little roomï¼‰</h4><p>å‹åŠ›æµ‹è¯•ï¼ˆåˆå«å¼ºåº¦æµ‹è¯•ï¼‰ä¹Ÿæ˜¯ä¸€ç§æ€§èƒ½æµ‹è¯•ï¼Œå®ƒåœ¨ç³»ç»Ÿèµ„æºç‰¹åˆ«ä½çš„æƒ…å†µä¸‹è½¯ä»¶ç³»ç»Ÿè¿è¡Œæƒ…å†µï¼Œç›®çš„æ˜¯æ‰¾åˆ°ç³»ç»Ÿåœ¨å“ªé‡Œå¤±æ•ˆä»¥åŠå¦‚ä½•å¤±æ•ˆçš„åœ°æ–¹ã€‚</p>
<h4 id="å®¹é‡æµ‹è¯•-Large-amounts-of-data"><a href="#å®¹é‡æµ‹è¯•-Large-amounts-of-data" class="headerlink" title="å®¹é‡æµ‹è¯•(Large amounts of data)"></a>å®¹é‡æµ‹è¯•(Large amounts of data)</h4><p>ç¡®å®šç³»ç»Ÿå¯å¤„ç†åŒæ—¶åœ¨çº¿çš„æœ€å¤§ç”¨æˆ·æ•° å…³æ³¨ç‚¹ï¼šhow muchï¼ˆè€Œä¸æ˜¯how fastï¼‰ å®¹é‡æµ‹è¯•ï¼Œé€šå¸¸å’Œæ•°æ®åº“æœ‰å…³ï¼Œå®¹é‡å’Œè´Ÿè½½çš„åŒºåˆ«åœ¨äºï¼šå®¹é‡å…³æ³¨çš„æ˜¯å¤§å®¹é‡ï¼Œè€Œä¸éœ€è¦å…³æ³¨ä½¿ç”¨ä¸­çš„å®é™…è¡¨ç°ã€‚</p>
<p>å…¶ä¸­ï¼Œå®¹é‡æµ‹è¯•ã€è´Ÿè½½æµ‹è¯•ã€å‹åŠ›æµ‹è¯•çš„è‹±æ–‡è§£é‡Šä¸ºï¼š<br> Volume Testing = Large amounts of data<br> Load Testing = Large amount of users<br> Stress Testing = Too many users, too much data, too little time and too little room</p>
<p><strong>è´Ÿè½½æµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•çš„ä¸»è¦åŒºåˆ«åœ¨äºè´Ÿè½½æµ‹è¯•æ—¶ï¼Œç³»ç»Ÿè´Ÿè½½æ˜¯é€æ¸å¢åŠ çš„ï¼Œè€Œä¸æ˜¯ä¸€æ­¥åˆ°ä½ï¼Œè´Ÿè½½æµ‹è¯•éœ€è¦è§‚å¯Ÿç³»ç»Ÿåœ¨å„ç§ä¸åŒçš„è´Ÿè½½æƒ…å†µä¸‹æ˜¯å¦éƒ½èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚</strong></p>
<h2 id="è¾¹ç•Œå€¼æµ‹è¯•"><a href="#è¾¹ç•Œå€¼æµ‹è¯•" class="headerlink" title="è¾¹ç•Œå€¼æµ‹è¯•"></a>è¾¹ç•Œå€¼æµ‹è¯•</h2><h4 id="åŸºæœ¬è¾¹ç•Œå€¼æµ‹è¯•"><a href="#åŸºæœ¬è¾¹ç•Œå€¼æµ‹è¯•" class="headerlink" title="åŸºæœ¬è¾¹ç•Œå€¼æµ‹è¯•"></a>åŸºæœ¬è¾¹ç•Œå€¼æµ‹è¯•</h4><p>æµ‹è¯•ç”¨ä¾‹æ•°ï¼š4n + 1</p>
<p><img src="https://s4.ax1x.com/2021/12/26/TwRIWd.png" alt="image"></p>
<h4 id="å¥å£®è¾¹ç•Œå€¼æµ‹è¯•"><a href="#å¥å£®è¾¹ç•Œå€¼æµ‹è¯•" class="headerlink" title="å¥å£®è¾¹ç•Œå€¼æµ‹è¯•"></a>å¥å£®è¾¹ç•Œå€¼æµ‹è¯•</h4><p>æµ‹è¯•ç”¨ä¾‹æ•°ï¼š6n + 1</p>
<p><img src="https://s4.ax1x.com/2021/12/26/TwRTSA.png" alt="image"></p>
<h4 id="æœ€åæƒ…å†µè¾¹ç•Œå€¼æµ‹è¯•"><a href="#æœ€åæƒ…å†µè¾¹ç•Œå€¼æµ‹è¯•" class="headerlink" title="æœ€åæƒ…å†µè¾¹ç•Œå€¼æµ‹è¯•"></a>æœ€åæƒ…å†µè¾¹ç•Œå€¼æµ‹è¯•</h4><p>æµ‹è¯•ç”¨ä¾‹æ•°ï¼š$5^n$</p>
<p><img src="https://s4.ax1x.com/2021/12/26/TwRHyt.png" alt="image"></p>
<h4 id="å¥å£®æœ€åæƒ…å†µè¾¹ç•Œå€¼æµ‹è¯•"><a href="#å¥å£®æœ€åæƒ…å†µè¾¹ç•Œå€¼æµ‹è¯•" class="headerlink" title="å¥å£®æœ€åæƒ…å†µè¾¹ç•Œå€¼æµ‹è¯•"></a>å¥å£®æœ€åæƒ…å†µè¾¹ç•Œå€¼æµ‹è¯•</h4><p>æµ‹è¯•ç”¨ä¾‹æ•°ï¼š$7^n$</p>
<p><img src="https://s4.ax1x.com/2021/12/26/TwWpSs.png" alt="image"></p>
<h2 id="å› æœå›¾"><a href="#å› æœå›¾" class="headerlink" title="å› æœå›¾"></a>å› æœå›¾</h2><p><img src="https://s4.ax1x.com/2021/12/26/TwoefO.md.png" alt="image"></p>
<p><img src="https://s4.ax1x.com/2021/12/26/TwonpD.png" alt="image"></p>
]]></content>
      <categories>
        <category>exam</category>
      </categories>
  </entry>
  <entry>
    <title>è¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆ</title>
    <url>/2021/09/28/%E8%BF%87%E6%8B%9F%E5%90%88%E5%92%8C%E6%AC%A0%E6%8B%9F%E5%90%88/</url>
    <content><![CDATA[<h2 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h2><p>ç»§ä¹‹å‰çš„<a href="/2021/09/27/å¤šé¡¹å¼å›å½’/">å¤šé¡¹å¼å›å½’</a>ï¼Œå¦‚æœ <code>degree</code> è®¾ç½®è¿‡å¤§æˆ–è€…è¿‡å°ä¼šå‡ºç°ä»€ä¹ˆæ ·çš„é—®é¢˜å‘¢ï¼Ÿ</p>
<p>åœ¨æ­¤ä¹‹å‰ï¼Œå…ˆæ¥è¯´æ˜ä¸€ä¸‹ <a href="/2021/09/14/æ•°æ®å½’ä¸€åŒ–/">å½’ä¸€åŒ–</a> çš„å¿…è¦æ€§ã€‚å¤šé¡¹å¼å›å½’é‡‡ç”¨äº†ç‰¹å¾ç»„åˆçš„æ–¹å¼ï¼Œå½“ <code>degree</code> ä¸º100æ—¶ï¼Œæœ€é«˜æ¬¡å°±æ˜¯100æ¬¡ï¼Œè€Œæœ€ä½æ¬¡åªæ˜¯å¸¸æ•°çº§ï¼Œå„ä¸ªç»´åº¦æ•°å€¼ä¹‹é—´çš„è·¨åº¦éå¸¸å¤§ï¼Œè¿™å°±å¯¼è‡´ <code>eta</code> å¿…é¡»è®¾ç½®å¾—éå¸¸å°ï¼Œå¦åˆ™ç¨å¤§ä¸€ç‚¹ï¼Œå°±ä¼šæ— æ³•æ‹Ÿåˆï¼Œå˜æˆ <code>nan</code> ã€‚</p>
<p>å½“ degree ä¸º10æ—¶ï¼Œ etaå°±å¿…é¡»è®¾ç½®æˆ$10^{-19}$ï¼Œå¾ˆä¸åˆ©äºæˆ‘ä»¬è®­ç»ƒæ¨¡å‹ï¼Œæ‰€ä»¥åœ¨æ•°æ®ä¸è·ç¦»é˜¶æ®µé™¤äº†è¦å¤šé¡¹å¼åŒ–è¿˜å¾—å½’ä¸€åŒ–ï¼</p>
<p><img src="https://z3.ax1x.com/2021/09/28/4feNrT.png" alt=""></p>
<p>æ ¹æ®ä¸Šè¿°è¦æ±‚ï¼Œæ”¹è¿›äº†ä¸€ä¸‹å¤šé¡¹å¼å›å½’çš„ç±»ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PolynomialRegression</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, degree</span>):</span></span><br><span class="line">        self.degree = degree</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fit</span>(<span class="params">self, X, y, eta = <span class="number">0.01</span>, n_iters = <span class="number">1e4</span>, epsilon = <span class="number">1e-6</span></span>):</span></span><br><span class="line">        self.X = self._getPolynomialFeatures(X, <span class="number">0</span>, np.ones([<span class="built_in">len</span>(X), <span class="number">1</span>]), self.degree)</span><br><span class="line">        self.X = self.standardization(self.X)</span><br><span class="line">        </span><br><span class="line">        initial_theta = np.zeros([self.X.shape[<span class="number">1</span>]])</span><br><span class="line">        theta = self._gradient_descent(self.X, y, initial_theta, eta, n_iters, epsilon)</span><br><span class="line">        self.theta = theta</span><br><span class="line">        self.coefficient = theta[<span class="number">1</span>:]</span><br><span class="line">        self.intercept = theta[<span class="number">0</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å½’ä¸€åŒ–</span></span><br><span class="line">    <span class="comment"># ç¬¬ä¸€åˆ—å…¨ä¸º1æ–¹å·®ä¸º0è¦å•ç‹¬å¤„ç†ï¼Œæ”¹æˆç¬¬ä¸€åˆ—å…¨ä¸º0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">standardization</span>(<span class="params">self, X</span>):</span></span><br><span class="line">        <span class="keyword">return</span> np.hstack([np.zeros([<span class="built_in">len</span>(X), <span class="number">1</span>]), (X[:, <span class="number">1</span>:] - np.mean(X[:, <span class="number">1</span>:], axis = <span class="number">0</span>)) / np.std(X[:, <span class="number">1</span>:], axis = <span class="number">0</span>)])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¤šé¡¹å¼åŒ–</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_getPolynomialFeatures</span>(<span class="params">self, X, start, col_val, degree</span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dfs</span>(<span class="params">X, result, start, col_val, degree</span>):</span></span><br><span class="line">            result.append(col_val)</span><br><span class="line">            <span class="keyword">if</span>(degree == <span class="number">0</span>):</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start, X.shape[<span class="number">1</span>]):</span><br><span class="line">                dfs(X, result, start, col_val * X[:, i].reshape([-<span class="number">1</span>, <span class="number">1</span>]), degree - <span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        result = []</span><br><span class="line">        dfs(X, result, <span class="number">0</span>, np.ones([<span class="built_in">len</span>(X), <span class="number">1</span>]), degree)</span><br><span class="line">        <span class="keyword">return</span> np.squeeze(np.array(result), -<span class="number">1</span>).T</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># é¢„æµ‹ä¹Ÿè¦å¤šé¡¹å¼åŒ–å’Œå½’ä¸€åŒ–</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span>(<span class="params">self, X</span>):</span></span><br><span class="line">        X_b = self._getPolynomialFeatures(X, <span class="number">0</span>, np.ones([<span class="built_in">len</span>(X), <span class="number">1</span>]), self.degree)</span><br><span class="line">        X_b = self.standardization(X_b)</span><br><span class="line">        y_pred = X_b.dot(self.theta)</span><br><span class="line">        <span class="keyword">return</span> y_pred</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># MSE</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">score</span>(<span class="params">self, X, y</span>):</span></span><br><span class="line">        y_pred = self.predict(X)</span><br><span class="line">        <span class="keyword">return</span> np.mean((y - y_pred) ** <span class="number">2</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_gradient_descent</span>(<span class="params">self, X_b, y, theta, eta, n_iters, epsilon</span>):</span></span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">J</span>(<span class="params">X_b, y, theta</span>):</span></span><br><span class="line">            <span class="keyword">return</span> np.mean((X_b.dot(theta) - y) ** <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">DJ</span>(<span class="params">X_b, y, theta</span>):</span></span><br><span class="line">            <span class="keyword">return</span> X_b.T.dot((X_b.dot(theta) - y)) * <span class="number">2</span> / <span class="built_in">len</span>(y);</span><br><span class="line">        </span><br><span class="line">        i_iter = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">while</span> i_iter &lt; n_iters:</span><br><span class="line">            gradient = DJ(X_b, y, theta)</span><br><span class="line">            last_theta = theta</span><br><span class="line">            theta = theta - eta * gradient</span><br><span class="line">            <span class="keyword">if</span> np.<span class="built_in">abs</span>(J(X_b, y, theta) - J(X_b, y, last_theta)) &lt; epsilon:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            i_iter += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> theta</span><br></pre></td></tr></tbody></table></figure>
<p>å½“ç„¶ç›´æ¥ä½¿ç”¨ sklearn ä¸­çš„ <code>Pipeline</code> å¯ä»¥æ›´åŠ ç®€ä¾¿çš„å®ç°è¿™ä¸€åˆ‡ã€‚</p>
<p><code>Pipeline</code> å…·ä½“è¿ä½œæœºåˆ¶å°±æ˜¯é€è¡Œè¿è¡Œï¼Œä¸Šä¸€è¡Œçš„è¾“å‡ºå°±æ˜¯ä¸‹ä¸€è¡Œçš„è¾“å…¥ï¼Œå› æ­¤æˆ‘ä»¬å…ˆè¿›è¡Œå¤šé¡¹å¼åŒ–ï¼Œå†å½’ä¸€åŒ–ï¼Œæœ€åæ”¾å…¥çº¿æ€§å›å½’ä¸­è®­ç»ƒæ¨¡å‹ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">PolynomialRegression</span>(<span class="params">X,y,degree</span>):</span></span><br><span class="line">    pipeline = Pipeline([</span><br><span class="line">        (<span class="string">"poly"</span>,PolynomialFeatures(degree = degree)),</span><br><span class="line">        (<span class="string">"std_scaler"</span>,StandardScaler()),</span><br><span class="line">        (<span class="string">"lin_reg"</span>,LinearRegression())</span><br><span class="line">    ])</span><br><span class="line">    pipeline.fit(X,y)</span><br><span class="line">    <span class="keyword">return</span> pipeline.predict(X)</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h2 id="æ•°æ®æ‹Ÿåˆ"><a href="#æ•°æ®æ‹Ÿåˆ" class="headerlink" title="æ•°æ®æ‹Ÿåˆ"></a>æ•°æ®æ‹Ÿåˆ</h2><p>å…ˆå†™ä¸€ä¸ªç»˜åˆ¶æ‹Ÿåˆæ›²çº¿çš„å‡½æ•°ä¾¿äºæˆ‘ä»¬è§‚æµ‹ç»“æœã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_matching_curve</span>(<span class="params">X, y, degree, eta = <span class="number">1e-6</span>, n_iters = <span class="number">1e5</span></span>):</span></span><br><span class="line">    poly_reg = PolynomialRegression(degree)</span><br><span class="line">    poly_reg.fit(X, y, eta, n_iters)</span><br><span class="line">    theta = poly_reg.theta</span><br><span class="line">    pred_y = poly_reg.X.dot(theta)</span><br><span class="line">    plt.scatter(X[:, <span class="number">0</span>], y)</span><br><span class="line">    plt.plot(X[:, <span class="number">0</span>], pred_y, color = <span class="string">"r"</span>)</span><br><span class="line">    plt.show()</span><br><span class="line">    <span class="keyword">return</span> poly_reg</span><br></pre></td></tr></tbody></table></figure>
<p>å½“ degree ä¸º0æ—¶ï¼Œä¹Ÿå°±æ˜¯æœ€é«˜æ¬¡ä¸º0æ¬¡ï¼Œæ‹Ÿåˆæ›²çº¿æˆä¸€æ¡ç›´çº¿ï¼Œè¿™å°±æ˜¯æ¬ æ‹Ÿåˆã€‚</p>
<p>æ¯•ç«Ÿå‡½æ•°åªæœ‰ä¸€ä¸ªå¸¸æ•°å˜›ï¼Œåˆç†ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">plot_matching_curve(x.reshape([-<span class="number">1</span>, <span class="number">1</span>]), y, <span class="number">0</span>)</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/09/28/4fEsRP.png" alt=""></p>
<p>å†æ¥çœ‹çœ‹ degree åˆ†åˆ«ä¸º1ï¼Œ2çš„æƒ…å†µï¼Œæ˜¯ä¸æ˜¯è¶Šæ¥è¶Šæ¥è¿‘æˆ‘ä»¬çš„æ‹Ÿåˆæ›²çº¿äº†ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/28/4fVdyT.png" alt=""></p>
<p><img src="https://z3.ax1x.com/2021/09/28/4fV50e.png" alt=""></p>
<p>å½“ degree ä¸º3æ—¶ï¼Œæ›²çº¿ç»ˆäºæ‹Ÿåˆäº†æˆ‘ä»¬çš„æ•°æ®ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/28/4fZQ91.png" alt=""></p>
<p>é‚£æˆ‘ä»¬å†çœ‹çœ‹ degree ä¸º10ï¼Œ50ï¼Œ100ï¼Œ200çš„æƒ…å†µã€‚</p>
<p>å¾ˆå®¹æ˜“å¯ä»¥è§‚å¯Ÿå‡ºï¼Œæ›²çº¿å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œä¹Ÿè¶Šæ¥è¶Šèƒ½æ‹Ÿåˆæˆ‘ä»¬çš„è®­ç»ƒæ•°æ®ï¼Œè¿™æ˜¯å› ä¸ºéšç€ degree çš„å¢å¤§ï¼Œå‚æ•°æ•°é‡çš„å¢é•¿ä½¿å¾—æˆ‘ä»¬çš„æ¨¡å‹å¯ä»¥å°†è®­ç»ƒçš„æ•°æ®ç»™<code>è®°ä½</code>ï¼Œä½†è¿™çœŸçš„æ˜¯æˆ‘ä»¬æƒ³è¦çš„å—ï¼Ÿ</p>
<p>ä¸ï¼Œæˆ‘ä»¬æƒ³è¦çš„æ˜¯<code>æ³›åŒ–</code>èƒ½åŠ›ï¼Œæ˜¯åœ¨æµ‹è¯•æ•°æ®ä¹ƒè‡³ä¹‹åæ¨¡å‹ä¸Šçº¿åçš„çœŸå®æ•°æ®ä¸Šä¹Ÿèƒ½æœ‰éå¸¸å¥½çš„é¢„æµ‹èƒ½åŠ›ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/28/4f1qaV.png" alt=""></p>
<p><img src="https://z3.ax1x.com/2021/09/28/4f39q1.png" alt=""></p>
<p><img src="https://z3.ax1x.com/2021/09/28/4f3ia6.png" alt=""></p>
<p>ä¹‹å‰ä¹Ÿè¯´è¿‡äº†ï¼Œå¤šé¡¹å¼åŒ–æ˜¯é˜¶ä¹˜å¼åœ°å¢é•¿ï¼Œä¸€æ—¦ <code>degree</code> è¿‡å¤§ï¼Œç›´æ¥å°±ä¼šå¯¼è‡´æ ˆæº¢å‡ºã€‚</p>
<p><img src="https://z3.ax1x.com/2021/09/28/4f3nsA.png" alt=""></p>
<p><br></p>
<h2 id="å­¦ä¹ æ›²çº¿"><a href="#å­¦ä¹ æ›²çº¿" class="headerlink" title="å­¦ä¹ æ›²çº¿"></a>å­¦ä¹ æ›²çº¿</h2><p>é€šè¿‡è§‚å¯Ÿå­¦ä¹ æ›²çº¿ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ¤æ–­å‡ºæ¨¡å‹æ˜¯å¦æœ‰è¿‡æ‹Ÿåˆæˆ–æ¬ æ‹Ÿåˆçš„æƒ…å†µã€‚å®ƒæ˜¯ç»˜åˆ¶æ¨¡å‹åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šçš„æ€§èƒ½å‡½æ•°ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler, PolynomialFeatures</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_poly_reg</span>(<span class="params">degree</span>):</span></span><br><span class="line">    <span class="keyword">return</span> Pipeline([</span><br><span class="line">        (<span class="string">"poly"</span>, PolynomialFeatures(degree = degree)),</span><br><span class="line">        (<span class="string">"std"</span>, StandardScaler()),</span><br><span class="line">        (<span class="string">"reg"</span>, LinearRegression())</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_learning_curve</span>(<span class="params">X, y, degree</span>):</span></span><br><span class="line">    train_mse = []</span><br><span class="line">    test_mse = []</span><br><span class="line">    X_train, X_test, y_train, y_test = train_test_split(X, y)</span><br><span class="line">    poly_reg = get_poly_reg(degree)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">len</span>(X) + <span class="number">1</span>):</span><br><span class="line">        poly_reg.fit(X_train[:i], y_train[:i])</span><br><span class="line">        train_pred = poly_reg.predict(X_train[:i])</span><br><span class="line">        test_pred = poly_reg.predict(X_test)</span><br><span class="line">        train_mse.append(np.mean(np.square(train_pred - y_train[:i])))</span><br><span class="line">        test_mse.append(np.mean(np.square(test_pred - y_test)))</span><br><span class="line">        </span><br><span class="line">    plt.plot(np.arange(<span class="number">2</span>, <span class="built_in">len</span>(X)+<span class="number">1</span>), train_mse, label=<span class="string">"train"</span>)</span><br><span class="line">    plt.plot(np.arange(<span class="number">2</span>, <span class="built_in">len</span>(X)+<span class="number">1</span>), test_mse, label=<span class="string">"test"</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    plt.axis([<span class="number">0</span>,<span class="number">100</span>,<span class="number">0</span>,<span class="number">5</span>])</span><br><span class="line">    plt.show()</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™æ¬¡æˆ‘ä»¬æŠŠç›®æ ‡å‡½æ•°æ¢æˆäºŒæ¬¡å‡½æ•°ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">X = np.random.uniform(-<span class="number">3</span>,<span class="number">3</span>,size=<span class="number">100</span>).reshape(-<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">y = <span class="number">0.5</span> * X**<span class="number">2</span> + X + <span class="number">4</span> + np.random.normal(<span class="number">0</span>,<span class="number">1</span>,size = <span class="number">100</span>).reshape(-<span class="number">1</span>,<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>degree = 1</p>
<p>éšç€æ ·æœ¬æ•°é‡çš„å¢åŠ  test çš„è¯¯å·®åœ¨å‡å°ï¼Œtrain çš„è¯¯å·®åœ¨å¢åŠ ï¼Œè€Œå½“æ ·æœ¬åˆ°äº†ä¸€å®šç¨‹åº¦åï¼Œä¸¤è€…ä¹Ÿæ²¡æœ‰ä¿æŒåœ¨ä¸€ä¸ªè¾ƒå°çš„ç¨‹åº¦ä¸Šã€‚è¿™æ—¶è¯´æ˜æ¨¡å‹æ¬ æ‹Ÿåˆã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/13/5u1WSP.png" alt=""></p>
<p>degree = 2</p>
<p><img src="https://z3.ax1x.com/2021/10/13/5uQx3V.png" alt=""></p>
<p>éšç€æ ·æœ¬æ•°é‡çš„å¢åŠ  test çš„è¯¯å·®åœ¨å‡å°ï¼Œtrain çš„è¯¯å·®åœ¨å¢åŠ ï¼Œè€Œå½“æ ·æœ¬åˆ°äº†ä¸€å®šç¨‹åº¦åï¼Œä¸¤è€…åŸºæœ¬<code>æŒå¹³</code>ï¼Œä¿æŒåœ¨ä¸€ä¸ªè¾ƒå°çš„ç¨‹åº¦ä¸Šã€‚è¿™æ—¶æ¨¡å‹å·²ç»æ‹Ÿåˆã€‚</p>
<p>degree = 10</p>
<p><img src="https://z3.ax1x.com/2021/10/13/5ul2KU.png" alt=""></p>
<p>éšç€æ ·æœ¬çš„å¢åŠ  test çš„è¯¯å·®åœ¨å‡å°ï¼Œtrain çš„è¯¯å·®åœ¨å¢åŠ ï¼Œä½†å½“æ ·æœ¬åˆ°äº†ä¸€å®šç¨‹åº¦åï¼Œåœ¨ train ä¸Šçš„è¯¯å·®è¦æ¯”åœ¨ test ä¸Šçš„è¯¯å·®å°å¾—å¤šï¼Œè¿™æ—¶å°±è¦æ³¨æ„æ˜¯ä¸æ˜¯è¿‡æ‹Ÿåˆäº†ã€‚</p>
<p>degree = 100</p>
<p><img src="https://z3.ax1x.com/2021/10/13/5ulxIA.png" alt=""></p>
<p>æ­¤æ—¶ test ä¸Šçš„è¯¯å·®å·²ç»é£™åˆ°å¤©ä¸Šå»äº†ï¼Œå¦¥å¦¥çš„è¿‡æ‹Ÿåˆã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šè¡¨ç°è‰¯å¥½ï¼Œå´åœ¨æµ‹è¯•æ•°æ®é›†ä¸Šè¡¨ç°å·®åŠ²çš„å°±æ˜¯<code>è¿‡æ‹Ÿåˆ</code>ï¼Œè¿™æ—¶å€™è¦é™ä½å‚æ•°æ•°é‡ã€‚</p>
<p>è€Œåœ¨è®­ç»ƒæ•°æ®é›†ä¸Šè¡¨ç°å°±ä¸å°½äººæ„çš„æœ‰å¯èƒ½æ˜¯<code>æ¬ æ‹Ÿåˆ</code>ï¼ˆä¹Ÿæœ‰å¯èƒ½æ˜¯æ¨¡å‹å‹æ ¹ä¸å¯¹ç­‰é—®é¢˜ï¼‰ï¼Œè¿™æ—¶å€™å¯ä»¥è¯•è¯•å¢å¤§æ¨¡å‹ï¼Œå¢åŠ å‚æ•°æ•°é‡ã€‚</p>
]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
  </entry>
  <entry>
    <title>é™ä½è¿‡æ‹Ÿåˆ</title>
    <url>/2021/10/17/%E9%99%8D%E4%BD%8E%E8%BF%87%E6%8B%9F%E5%90%88/</url>
    <content><![CDATA[<p>åœ¨è®­ç»ƒæ¨¡å‹çš„è¿‡ç¨‹ä¸­ï¼Œè¿‡æ‹Ÿåˆå‡ ä¹æ˜¯ä¸å¯é¿å…çš„ã€‚å› æ­¤å¯ä»¥è¿™ä¹ˆè¯´ï¼Œæ·±åº¦å­¦ä¹ å°±æ˜¯è®­ç»ƒä¸€ä¸ªåºå¤§çš„æ¨¡å‹ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šæˆ‘ä»¬æ¥é™ä½è¿‡æ‹Ÿåˆçš„ç¨‹åº¦ã€‚ç›¸è¾ƒä¹‹ä¸‹ï¼Œå¦‚æœæ¨¡å‹æ¬ æ‹Ÿåˆäº†ï¼Œè²Œä¼¼é™¤äº†æ‰©å¤§æ¨¡å‹å°±æ²¡æœ‰ä»»ä½•æ–¹æ³•äº†ã€‚</p>
<p>ä¸‹é¢ä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„é™ä½è¿‡æ‹Ÿåˆçš„æ–¹æ³•ã€‚</p>
<h2 id="ä¸€ã€æ­£åˆ™åŒ–"><a href="#ä¸€ã€æ­£åˆ™åŒ–" class="headerlink" title="ä¸€ã€æ­£åˆ™åŒ–"></a>ä¸€ã€æ­£åˆ™åŒ–</h2><h4 id="1-ä»€ä¹ˆæ˜¯æ­£åˆ™åŒ–ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯æ­£åˆ™åŒ–ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯æ­£åˆ™åŒ–ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯æ­£åˆ™åŒ–ï¼Ÿ</h4><p>æ­£åˆ™åŒ–çš„æ€æƒ³ï¼Œå³é€šè¿‡<code>é™åˆ¶</code>å‚æ•°å€¼çš„é€‰æ‹©èŒƒå›´æ¥æ§åˆ¶æ¨¡å‹å®¹é‡ã€‚è€Œæ­£åˆ™åŒ–åˆåˆ†ä¸ºå²­å›å½’ï¼ˆæƒé‡è¡°é€€ï¼‰ã€LASSO å›å½’å’Œå¼¹æ€§ç½‘ç»œç­‰ã€‚ä¸‹é¢æˆ‘ç€é‡è¯´æ˜çš„æ˜¯å²­å›å½’ã€‚</p>
<p>é¦–å…ˆï¼Œå…ˆæ¥çœ‹ä¸€å¼ æåº¦è¿‡æ‹Ÿåˆçš„å›¾åƒã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/17/5tSi5t.png" alt=""></p>
<p>è¿™æ˜¯ä¸Šè¿°å›¾åƒçš„éƒ¨åˆ†æƒé‡ï¼Œæ— ä¸€ä¾‹å¤–ï¼Œæ¯ä¸ª $W_i$ éƒ½æå…¶çš„å¤§ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†å›¾åƒååˆ†çš„<code>é™¡å³­</code>ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">array([-<span class="number">4.09493627e+11</span>,  <span class="number">5.76349998e+12</span>,  <span class="number">1.71369179e+11</span>, -<span class="number">9.99031499e+12</span>,</span><br><span class="line">        <span class="number">9.23500127e+11</span>,  <span class="number">9.26094018e+12</span>, -<span class="number">1.94635409e+12</span>, -<span class="number">5.40895631e+10</span>,</span><br><span class="line">        <span class="number">7.94601628e+11</span>, -<span class="number">7.85418293e+12</span>,  <span class="number">1.63904594e+12</span>,  <span class="number">1.67984971e+12</span>,</span><br><span class="line">       -<span class="number">9.87156668e+11</span>,  <span class="number">6.88721582e+12</span>, -<span class="number">1.64914180e+12</span>,  <span class="number">3.50775793e+11</span>,</span><br><span class="line">        <span class="number">2.60751888e+11</span>, -<span class="number">5.87372086e+12</span>,  <span class="number">1.66748622e+12</span>, -<span class="number">3.77434047e+12</span>,</span><br><span class="line">        <span class="number">1.00605169e+12</span>,  <span class="number">2.34190394e+12</span>, -<span class="number">8.57867266e+11</span>,  <span class="number">5.39077331e+12</span>,</span><br><span class="line">       -<span class="number">1.60621032e+12</span>,  <span class="number">2.95930952e+12</span>, -<span class="number">9.52432067e+11</span>, -<span class="number">1.74889800e+12</span>])</span><br></pre></td></tr></tbody></table></figure>
<p>å› æ­¤å¾ˆè‡ªç„¶è€Œç„¶åœ°å°±èƒ½æƒ³åˆ°ï¼Œé‚£æˆ‘é™åˆ¶ $W_i$ çš„é€‰æ‹©èŒƒå›´å°±è¡Œäº†å˜›ã€‚ä»æ¨¡å‹çš„è§’åº¦æ¥è¯´ï¼Œå‚æ•°æ•°é‡ä¸å˜ï¼Œä½†å‚æ•°çš„é€‰æ‹©èŒƒå›´å°äº†ï¼Œé‚£æ¨¡å‹è‡ªç„¶ä¹Ÿå˜å°äº†ã€‚</p>
<p>äºæ˜¯å°±æœ‰äº†ä½¿ç”¨å‡æ–¹èŒƒæ•°ä½œä¸º<code>ç¡¬æ€§</code>é™åˆ¶ï¼Œå°çš„ Î¸ æ„å‘³ç€æ›´å¼ºçš„æ­£åˆ™é¡¹ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåç½® <strong>b</strong> å¹¶æ²¡æœ‰åŠ å…¥åˆ°æ­£åˆ™åŒ–ä¸­æ¥ï¼Œæ¯•ç«Ÿæˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®©æ›²çº¿æ›´åŠ çš„<code>å¹³ç¼“</code>ï¼Œè·Ÿåç½® <strong>b</strong> æ²¡æœ‰ä»€ä¹ˆå…³ç³»ã€‚</p>
<p>$min l(w,b) \quad subject\ to \quad ||W||^2 \le Î¸,\quad\quad ||W||^2 = \sum W^2$</p>
<p>ä½†ç¡¬æ€§é™åˆ¶ä¼˜åŒ–æ±‚å¯¼æ¯”è¾ƒéº»çƒ¦ï¼Œç»“æœä¹Ÿä¼šæ¯”è¾ƒ<code>ç¡¬</code>ï¼Œä¸€èˆ¬ä½¿ç”¨å‡æ–¹èŒƒæ•°ä½œä¸º<code>æŸ”æ€§</code>é™åˆ¶ã€‚</p>
<p>$loss = l(w, b) + \frac{Î»}{2}||W||^2$</p>
<p>å…¶ä¸­è¶…å‚æ•° Î» æ§åˆ¶äº†æ­£åˆ™é¡¹çš„é‡è¦ç¨‹åº¦</p>
<ul>
<li>Î» = 0ï¼Œå³æ— æ­£åˆ™åŒ–ï¼Œå’Œæ™®é€šçš„æŸå¤±å‡½æ•°æ²¡æœ‰åŒºåˆ«ã€‚</li>
<li>Î» â†’ $\infty$ï¼Œæ­¤æ—¶ W â†’ <strong>0</strong></li>
</ul>
<h4 id="2-å¦‚ä½•å½±å“æŸå¤±å‡½æ•°ï¼Ÿ"><a href="#2-å¦‚ä½•å½±å“æŸå¤±å‡½æ•°ï¼Ÿ" class="headerlink" title="2. å¦‚ä½•å½±å“æŸå¤±å‡½æ•°ï¼Ÿ"></a>2. å¦‚ä½•å½±å“æŸå¤±å‡½æ•°ï¼Ÿ</h4><p>å¯ä»¥çœ‹åˆ°ï¼ŒåŸå…ˆçš„æå€¼ç‚¹ $\widetilde{W}^*$ åœ¨ç»¿è‰²æ¤­åœ†çš„åœ†å¿ƒï¼Œä½†åœ¨åŠ å…¥æ­£åˆ™åŒ–é¡¹ä¹‹åï¼Œæå€¼ç‚¹åœ¨ä¸¤è€…ä¹‹é—´åšäº†ä¸€ä¸ªæƒè¡¡ï¼Œå–åœ¨äº†åˆ‡ç‚¹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/17/5tFpqS.png" alt=""></p>
<h4 id="3-å‚æ•°æ›´æ–°æ³•åˆ™"><a href="#3-å‚æ•°æ›´æ–°æ³•åˆ™" class="headerlink" title="3. å‚æ•°æ›´æ–°æ³•åˆ™"></a>3. å‚æ•°æ›´æ–°æ³•åˆ™</h4><ul>
<li><p>è®¡ç®—æ¢¯åº¦</p>
<p>$\frac{\partial}{\partial W}(l(W, b) + \frac{Î»}{2}||W||^2) = \frac{\partial l(W, b)}{\partial W} + Î»W$</p>
</li>
<li><p>æ›´æ–°å‚æ•°</p>
<p>$Wâ€™ = W - Î·(\frac{\partial l(W, b)}{\partial W} + Î»W) = (1 - Î·Î»)W - Î·\frac{\partial l(W, b)}{\partial W}$</p>
</li>
</ul>
<p>é€šå¸¸ Î·Î» &lt; 1ï¼Œå› æ­¤æ¯æ¬¡åœ¨å‚æ•°æ›´æ–°æ—¶ï¼Œéƒ½ä¼šå¯¹ W è¿›è¡Œ<code>ç¼©å°</code>ï¼Œä¹Ÿå°±æ˜¯æƒé‡è¡°é€€è¿™ä¸ªåå­—çš„ç”±æ¥ã€‚</p>
<h4 id="4-å²­å›å½’"><a href="#4-å²­å›å½’" class="headerlink" title="4. å²­å›å½’"></a>4. å²­å›å½’</h4><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RidgeRegression</span>(<span class="params">degree,alpha</span>):</span></span><br><span class="line">    pipeline = Pipeline([</span><br><span class="line">        (<span class="string">"poly"</span>,PolynomialFeatures(degree = degree)),</span><br><span class="line">        (<span class="string">"std_scaler"</span>,StandardScaler()),</span><br><span class="line">        (<span class="string">"ridge_reg"</span>,Ridge(alpha=alpha))</span><br><span class="line">    ])</span><br><span class="line">    <span class="keyword">return</span> pipeline</span><br></pre></td></tr></tbody></table></figure>
<p>alpha = 0ï¼Œå³æ™®é€šå¤šé¡¹å¼å›å½’ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/18/5UMrqJ.png" alt=""></p>
<p>alpha = 1e-4ï¼Œæ›²çº¿ä¸€ä¸‹å­å°±æŸ”å’Œäº†ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/18/5UQeL4.png" alt=""></p>
<p>alpha = 100ï¼Œæœ‰ç‚¹åƒäºŒæ¬¡æ›²çº¿äº†ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/18/5UQJyD.png" alt=""></p>
<p>alpha â†’ $\infty$ï¼Œä¸ºäº†æ§åˆ¶æŸå¤±å‡½æ•°ï¼Œåªèƒ½å°†æƒé‡è®¾ä¸º0ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/18/5UQhYq.png" alt=""></p>
<h4 id="5-Tensorflow-å²­å›å½’å®ç°"><a href="#5-Tensorflow-å²­å›å½’å®ç°" class="headerlink" title="5. Tensorflow å²­å›å½’å®ç°"></a>5. Tensorflow å²­å›å½’å®ç°</h4><p>ä¸ºäº†èƒ½å¤Ÿè¿‡æ‹Ÿåˆï¼Œåªè®¾ç½®äº†20ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æœ‰ 200 ä¸ªç‰¹å¾ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">n_train = <span class="number">20</span></span><br><span class="line">n_test = <span class="number">100</span></span><br><span class="line">num_inputs = <span class="number">200</span></span><br><span class="line">batch_size = <span class="number">5</span></span><br><span class="line">num_outputs = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">true_w, true_b = tf.ones([num_inputs, <span class="number">1</span>]) * <span class="number">0.01</span>, <span class="number">0.05</span></span><br><span class="line">train_data = d2l.synthetic_data(true_w, true_b, n_train)</span><br><span class="line">test_data = d2l.synthetic_data(true_w, true_b, n_test)</span><br><span class="line">train_iter = d2l.load_array(train_data, batch_size)</span><br><span class="line">test_iter = d2l.load_array(test_data, batch_size, is_train=<span class="literal">False</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>å‚æ•°åˆå§‹åŒ–ï¼Œçº¿æ€§æ¨¡å‹æ²¡é‚£ä¹ˆå¤šè®²ç©¶ï¼Œåˆå§‹åŒ–ä¸º0ä¹Ÿè¡Œã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_params</span>(<span class="params">num_inputs, num_outputs</span>):</span></span><br><span class="line">    W = tf.Variable(tf.random.normal(mean=<span class="number">1</span>, shape=(num_inputs, <span class="number">1</span>)))</span><br><span class="line">    b = tf.Variable(tf.zeros(num_outputs))</span><br><span class="line">    <span class="keyword">return</span> [W, b]</span><br><span class="line"></span><br><span class="line">W, b = init_params(num_inputs, num_outputs)</span><br></pre></td></tr></tbody></table></figure>
<p>ç½‘ç»œæ¨¡å‹</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># çº¿æ€§æ¨¡å‹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">net</span>(<span class="params">X</span>):</span></span><br><span class="line">    <span class="keyword">return</span> X @ W + b</span><br><span class="line"></span><br><span class="line"><span class="comment"># L2æ­£åˆ™åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">l2_penalty</span>(<span class="params">W</span>):</span></span><br><span class="line">    <span class="keyword">return</span> tf.reduce_sum(tf.<span class="built_in">pow</span>(W, <span class="number">2</span>)) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MSEæŸå¤±å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loss</span>(<span class="params">y, y_hat</span>):</span></span><br><span class="line">    <span class="keyword">return</span> tf.reduce_mean(tf.square(y - y_hat))</span><br></pre></td></tr></tbody></table></figure>
<p>è®­ç»ƒå‡½æ•°</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">train</span>(<span class="params">lambd, epochs = <span class="number">100</span>, lr = <span class="number">0.003</span></span>):</span></span><br><span class="line">    animator = d2l.Animator(xlabel=<span class="string">'epochs'</span>, ylabel=<span class="string">'loss'</span>, yscale=<span class="string">'log'</span>,</span><br><span class="line">                            xlim=[<span class="number">5</span>, epochs], legend=[<span class="string">'train'</span>, <span class="string">'test'</span>])</span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line">        <span class="keyword">for</span> X, y <span class="keyword">in</span> train_iter:</span><br><span class="line">            <span class="keyword">with</span> tf.GradientTape() <span class="keyword">as</span> tape:</span><br><span class="line">                <span class="comment"># æœ€ç»ˆæŸå¤±å‡½æ•°æ·»åŠ æ­£åˆ™åŒ–é¡¹</span></span><br><span class="line">                l = loss(y, net(X)) + lambd * l2_penalty(W)</span><br><span class="line">            grads = tape.gradient(l, [W, b])</span><br><span class="line">            <span class="keyword">for</span> param, grad <span class="keyword">in</span> <span class="built_in">zip</span>([W, b], grads):</span><br><span class="line">                param.assign_sub(grad * lr)</span><br><span class="line">        <span class="keyword">if</span> (epoch + <span class="number">1</span>) % <span class="number">5</span> == <span class="number">0</span>:</span><br><span class="line">            animator.add(epoch +<span class="number">1</span>, (d2l.evaluate_loss(net, train_iter, loss),</span><br><span class="line">                                   (d2l.evaluate_loss(net, test_iter, loss))))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Wçš„L2èŒƒæ•°æ˜¯"</span>, tf.norm(W).numpy())</span><br></pre></td></tr></tbody></table></figure>
<p>train(lambd = 0)</p>
<p>æ¨¡å‹æ²¡æœ‰æ³›åŒ–ï¼Œå…‰æ˜¯è®­ç»ƒè¯¯å·®å‡å°ï¼Œå…¸å‹çš„è¿‡æ‹Ÿåˆã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/17/5t4RR1.png" alt=""></p>
<p>train(lambd = 3)</p>
<p>è®­ç»ƒå’Œæµ‹è¯•è¯¯å·®éƒ½åœ¨åŒæ­¥é™ä½ï¼Œä¸”ä¸¤è€…å·®è·è¾ƒä¸Šè¿°è¿‡æ‹Ÿåˆä¹‹ä¸‹å‡å°äº†ä¸å°‘ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/17/5tIZ9A.png" alt=""></p>
<p>train(lambd = 20)</p>
<p>åŒä¸Šï¼Œæ•ˆæœæ›´å¥½äº†ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/17/5tIKnf.png" alt=""></p>
<p>train(lambd = 100)</p>
<p>è™½ç„¶å›¾å½¢ååˆ†æ›²æŠ˜ï¼Œä½†æ€»ä½“è¶‹åŠ¿æ˜¯åœ¨ä¸‹é™ä¸”æŸå¤±æ›´ä½äº†ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/17/5tIJ9s.png" alt=""></p>
<h4 id="6-LASSO-å›å½’"><a href="#6-LASSO-å›å½’" class="headerlink" title="6. LASSO å›å½’"></a>6. LASSO å›å½’</h4><p>å’Œå²­å›å½’ç±»ä¼¼ï¼Œä½†æ­£åˆ™é¡¹ä½¿ç”¨çš„æ˜¯ L1 èŒƒæ•°ã€‚ä½†ç»å¯¹å€¼å°±æ„å‘³ç€ä¸å¯å¯¼ï¼Œä¸å¥½ä¼˜åŒ–ã€‚</p>
<p>$loss = l(w, b) + Î»||W||,\quad\quad ||W|| = \sum |W|$</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Lasso</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">LassoRegression</span>(<span class="params">degree,alpha</span>):</span></span><br><span class="line">    pipeline = Pipeline([</span><br><span class="line">        (<span class="string">"poly"</span>,PolynomialFeatures(degree = degree)),</span><br><span class="line">        (<span class="string">"std_scaler"</span>,StandardScaler()),</span><br><span class="line">        (<span class="string">"lasso_reg"</span>,Lasso(alpha=alpha))</span><br><span class="line">    ])</span><br><span class="line">    <span class="keyword">return</span> pipeline</span><br></pre></td></tr></tbody></table></figure>
<p>alpha = 0</p>
<p><img src="https://z3.ax1x.com/2021/10/18/5UlPne.png" alt=""></p>
<p>alpha = 0.1</p>
<p><img src="https://z3.ax1x.com/2021/10/18/5UlEtI.png" alt=""></p>
<p>alpha = 1</p>
<p><img src="https://z3.ax1x.com/2021/10/18/5Ulm1f.png" alt=""></p>
<p>alpha = 10</p>
<p><img src="https://z3.ax1x.com/2021/10/18/5UlMng.png" alt=""></p>
<p>é€šè¿‡å¯¹æ¯”ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„äº‹æƒ…ã€‚Ridge å›å½’åœ¨å¢å¤§ alpha æ—¶ï¼Œæ›²çº¿è¿˜æ˜¯<code>å¼¯æ›²çš„</code>ï¼Œä½†æ²¡é‚£ä¹ˆé™¡å³­ï¼Œå› ä¸ºæƒé‡éƒ½æ¯”è¾ƒå°ã€‚è€Œ LASSO å›å½’åœ¨å¢å¤§ alpha æ—¶ï¼Œå¹¶æ²¡æœ‰é‚£ä¹ˆå¤šå¼¯æ›²çš„åœ°æ–¹ï¼Œå› æ­¤å®ƒçš„æƒé‡å¤§éƒ¨åˆ†éƒ½æ˜¯0ã€‚</p>
<p>è‡³äºä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿè¿™ä¹Ÿå’Œä»–ä»¬æ­£åˆ™åŒ–é¡¹çš„å¼å­æœ‰å…³ã€‚</p>
<h4 id="7-Ridge-å’Œ-LASSO-åŒºåˆ«"><a href="#7-Ridge-å’Œ-LASSO-åŒºåˆ«" class="headerlink" title="7. Ridge å’Œ LASSO åŒºåˆ«"></a>7. Ridge å’Œ LASSO åŒºåˆ«</h4><p><strong>Ridge å›å½’</strong> çš„æ¢¯åº¦æ˜¯ä¼šéšç€ç¦»æå€¼ç‚¹è¶Šè¿‘è€Œæ¸æ¸<code>å˜å°</code>çš„ï¼Œå› æ­¤æ‰€æœ‰çš„å‚æ•°æ˜¯åŒæ­¥åœ¨æ›´æ–°ï¼Œä»å›¾åƒä¸Šæ¥çœ‹å°±æ˜¯æ²¿ç€æ¢¯åº¦æ…¢æ…¢æƒ³æå€¼ç‚¹é æ‹¢ï¼Œå› æ­¤ä¸ä¼šæœ‰å¾ˆå¤šæƒé‡è¢«è®¾ä¸º0ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/18/5UlxEj.png" alt=""></p>
<p><strong>LASSO å›å½’</strong> çš„æ¢¯åº¦æ˜¯ä¸€ä¸ªå®šå€¼ï¼Œåªèƒ½ç”± Î· æ¥æ§åˆ¶å¤§å°ï¼Œè¿™æ ·å°±ä¼šé€ æˆéƒ¨åˆ†æƒé‡ä¼šæ—©æ—©åœåœ¨é›¶ç‚¹ï¼Œè¿™å¯ä»¥èµ·åˆ°ä¸€å®šçš„ç‰¹å¾ç­›é€‰çš„ä½œç”¨ï¼Œè™½ç„¶ä¹Ÿæœ‰å¯èƒ½å°†æœ‰ç”¨çš„ç‰¹å¾ä¹Ÿç­›é€‰æ‰ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/18/5U3pee.png" alt=""></p>
<h4 id="8-å¼¹æ€§ç½‘ç»œ"><a href="#8-å¼¹æ€§ç½‘ç»œ" class="headerlink" title="8. å¼¹æ€§ç½‘ç»œ"></a>8. å¼¹æ€§ç½‘ç»œ</h4><p>é¡¾åæ€ä¹‰ï¼Œæ˜¯ä¸ªå¼¹æ€§(æŠ˜ä¸­)çš„ç½‘ç»œï¼Œå®ƒç»“åˆå²­å›å½’å’Œ LASSO å›å½’çš„æ€æƒ³ã€‚</p>
<p>$loss = l(w, b) + Î³Î»||W|| + \frac{(1-Î³)}{2}Î»||W||^2,\quad\quad Î³âˆˆ[0,1]$</p>
<p>Î³ ä»£è¡¨ä¸€ç§æ¯”ç‡ï¼Œå–å€¼ä¸º 0% ~ 100%ï¼Œå½“Î³ = 0æ—¶ï¼Œè¯¥å¼¹æ€§ç½‘ç»œä¸ºå²­å›å½’ï¼›å½“Î³ = 1æ—¶ï¼Œè¯¥å¼¹æ€§ç½‘ç»œä¸º LASSO å›å½’ã€‚</p>
<h2 id="äºŒã€ä¸¢å¼ƒæ³•"><a href="#äºŒã€ä¸¢å¼ƒæ³•" class="headerlink" title="äºŒã€ä¸¢å¼ƒæ³•"></a>äºŒã€ä¸¢å¼ƒæ³•</h2><h4 id="1-ä»€ä¹ˆæ˜¯ä¸¢å¼ƒæ³•ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯ä¸¢å¼ƒæ³•ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯ä¸¢å¼ƒæ³•ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯ä¸¢å¼ƒæ³•ï¼Ÿ</h4><p>ä¸¢å¼ƒæ³•ï¼Œåˆç§° <strong>DropOut</strong>ï¼Œå…·ä½“åšæ³•æ˜¯åœ¨æ¯ä¸€å±‚è¾“å‡ºåï¼Œéšæœºå°†ä¸€å®šé‡çš„è¾“å‡ºç½®ä¸º0ã€‚é‚£ä¹ˆè¿™ä¹ˆåšçš„ç›®çš„æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>ä¸€ä¸ªå¥½çš„æ¨¡å‹éœ€è¦å¯¹è¾“å…¥æ•°æ®çš„æ‰°åŠ¨<strong>é²æ£’</strong>ã€‚</p>
<ul>
<li>ä½¿ç”¨æœ‰å™ªéŸ³çš„æ•°æ®ç­‰ä»·äºæ­£åˆ™åŒ–ã€‚</li>
<li>ä¸¢å¼ƒæ³•åˆ™æ˜¯åœ¨å±‚ä¹‹é—´åŠ å…¥å™ªéŸ³ï¼ŒåŒæ—¶ä¹Ÿé™ä½äº†æ¨¡å‹çš„å®¹é‡ã€‚</li>
</ul>
<p><img src="https://z3.ax1x.com/2021/10/18/5admbq.png" alt=""></p>
<p>è¯¶ï¼Œé‚£ä¹ˆè¿™æ—¶æœ‰äººè¦é—®äº†ï¼Œä½ è¿™éšæœºç½®ä¸º0ï¼Œå¯¹xçš„æœŸæœ›éƒ½å˜æ‰äº†ã€‚ä¸ºäº†é˜²æ­¢è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬ä¸å•å•æ˜¯å¯¹æ•°æ®ç½®0ï¼Œå¯¹å¦ä¸€éƒ¨åˆ†çš„æ•°æ®ä¹Ÿè¦æ”¹åŠ¨ï¼Œä¿è¯æœŸæœ›ä¸å˜ã€‚</p>
<p>æ³¨ï¼šp æ˜¯ä¸€ä¸ªæ¦‚ç‡å€¼ï¼Œå°†ç¥ç»å…ƒç½®ä¸º0çš„æ¯”ç‡ï¼Œ$pâˆˆ[0,1]$ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/18/5awNlQ.png" alt=""></p>
<script type="math/tex; mode=display">
Ex_i' = p * X_i * 0 + (1-p) \frac{x_i}{1-p} = x_i</script><p>å·¦è¾¹æ²¡æœ‰ Dropoutï¼Œå³è¾¹æœ‰ Dropoutã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/18/5a0N4K.png" alt=""></p>
<h4 id="2-æ€»ç»“"><a href="#2-æ€»ç»“" class="headerlink" title="2.æ€»ç»“"></a>2.æ€»ç»“</h4><ul>
<li>ä¸¢å¼ƒæ³•å°†ä¸€äº›è¾“å‡ºé¡¹éšæœºç½®0æ¥æ§åˆ¶æ¨¡å‹å¤æ‚åº¦ã€‚</li>
<li>å¸¸ä½œç”¨åœ¨å¤šå±‚æ„ŸçŸ¥æœºçš„éšè—å±‚è¾“å‡ºä¸Šã€‚</li>
<li>ä¸¢å¼ƒæ¦‚ç‡æ˜¯æ§åˆ¶æ¨¡å‹å¤æ‚åº¦çš„è¶…å‚æ•°ã€‚</li>
</ul>
<h4 id="3-Tensorflow-å®ç°"><a href="#3-Tensorflow-å®ç°" class="headerlink" title="3. Tensorflow å®ç°"></a>3. Tensorflow å®ç°</h4><p>dropoutå±‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dropout_layer</span>(<span class="params">X, dropout</span>):</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="number">0</span> &lt;= dropout &lt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> dropout == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> tf.zeros_like(X)</span><br><span class="line">    <span class="keyword">if</span> dropout == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> X</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># uniform å‡åŒ€åˆ†å¸ƒ</span></span><br><span class="line">    mask = tf.random.uniform(X.shape, minval = <span class="number">0</span>, maxval = <span class="number">1</span>) &lt; (<span class="number">1</span> - dropout)</span><br><span class="line">    <span class="comment"># ä¸ç”¨ X[mask] æ˜¯å› ä¸ºä¹˜æ³•è¿ç®—æ¯”åŒ¹é…è¿ç®—å¿«</span></span><br><span class="line">    <span class="keyword">return</span> tf.cast(mask, dtype=tf.float32) * X / (<span class="number">1.0</span> - dropout)</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯• dropout</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># æµ‹è¯• Dropout</span></span><br><span class="line">X = tf.reshape(tf.<span class="built_in">range</span>(<span class="number">16</span>, dtype=tf.float32), [<span class="number">2</span>,<span class="number">8</span>])</span><br><span class="line"><span class="built_in">print</span>(X)</span><br><span class="line"><span class="built_in">print</span>(dropout_layer(X, <span class="number">0</span>))</span><br><span class="line"><span class="built_in">print</span>(dropout_layer(X, <span class="number">0.5</span>))</span><br><span class="line"><span class="built_in">print</span>(dropout_layer(X, <span class="number">1</span>))</span><br></pre></td></tr></tbody></table></figure>
<p>æ¨¡å‹å®šä¹‰</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">num_outputs = <span class="number">10</span></span><br><span class="line">num_hidden1 = <span class="number">256</span></span><br><span class="line">num_hidden2 = <span class="number">256</span></span><br><span class="line"></span><br><span class="line">dropout1 = <span class="number">0.5</span></span><br><span class="line">dropout2 = <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Net</span>(<span class="params">tf.keras.Model</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, num_outputs, num_hidden1, num_hidden2</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.input_layer = keras.layers.Flatten()</span><br><span class="line">        self.hidden1 = keras.layers.Dense(num_hidden1, activation = <span class="string">"relu"</span>)</span><br><span class="line">        self.hidden2 = keras.layers.Dense(num_hidden2, activation = <span class="string">"relu"</span>)</span><br><span class="line">        self.output_layer = keras.layers.Dense(num_outputs, activation = <span class="string">"softmax"</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span>(<span class="params">self, inputs, training=<span class="literal">None</span></span>):</span></span><br><span class="line">        X = self.input_layer(inputs)</span><br><span class="line">        X = self.hidden1(X)</span><br><span class="line">        <span class="keyword">if</span> training:</span><br><span class="line">            X = dropout_layer(X, dropout1)</span><br><span class="line">        X = self.hidden2(X)</span><br><span class="line">        <span class="keyword">if</span> training:</span><br><span class="line">            X = dropout_layer(X, dropout2)</span><br><span class="line">        X = self.output_layer(X)</span><br><span class="line">        <span class="keyword">return</span> X</span><br><span class="line">    </span><br><span class="line">net = Net(num_outputs, num_hidden1, num_hidden2)</span><br></pre></td></tr></tbody></table></figure>
<p>è®­ç»ƒ</p>
<p>è¿™é‡Œè¯´æ˜ä¸€ä¸‹æŸå¤±å‡½æ•°çš„ä½¿ç”¨æƒ…å†µï¼Œæˆ‘ä¹‹å‰ä¹Ÿä¸€ç›´æ²¡æœ‰æ³¨æ„è¿‡ã€‚</p>
<ul>
<li>SparseCategoricalCrossentropy ä¼šç»™ label åšä¸€ä¸ª one-hot ç¼–ç ã€‚</li>
<li>CategoricalCrossentropy ä¸ä¼šç»™ labelåš one-hot ç¼–ç ã€‚</li>
<li>from_logits = True ç”¨äºæœ€åè¾“å‡ºå±‚æ²¡æœ‰ç»è¿‡ softmax çš„æƒ…å†µï¼Œä¼šç»™ç»“æœè¡¥åšä¸€ä¸ª softmaxã€‚</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">epochs = <span class="number">10</span></span><br><span class="line">lr = <span class="number">0.5</span></span><br><span class="line">batch_size = <span class="number">256</span></span><br><span class="line"><span class="comment"># è‹¥è¾“å‡ºæ²¡æœ‰ç»è¿‡ softmax,éœ€ä½¿ç”¨ keras.losses.SparseCategoricalCrossentropy(from_logits=True)</span></span><br><span class="line">loss = keras.losses.SparseCategoricalCrossentropy()</span><br><span class="line">train_iter, test_iter = d2l.load_data_fashion_mnist(batch_size)</span><br><span class="line">trainer = keras.optimizers.SGD(learning_rate = lr)</span><br><span class="line">d2l.train_ch3(net, train_iter, test_iter, loss, epochs, trainer)</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/10/19/5woMBn.png" alt=""></p>
]]></content>
      <categories>
        <category>Deep Learning</category>
      </categories>
  </entry>
  <entry>
    <title>æ•°æ®åº“è¿æ¥æ± </title>
    <url>/2021/11/21/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/</url>
    <content><![CDATA[<h1 id="è¿æ¥æ± "><a href="#è¿æ¥æ± " class="headerlink" title="è¿æ¥æ± "></a>è¿æ¥æ± </h1><p>å¯ä»¥çœ‹åˆ°åœ¨ mybatis-config.xml ä¸­æœ‰ä¸€ä¸ªæ ‡ç­¾å«åš <code>datasource</code>ï¼ˆæ•°æ®æºï¼‰ï¼Œå…¶ä¸­çš„ <code>type</code> ä¸º <code>pooled</code>ï¼Œå³æ± åŒ–ï¼Œå¼•å…¥äº†æ•°æ®åº“è¿æ¥æ± çš„æ¦‚å¿µã€‚</p>
<h2 id="1ã€ä»€ä¹ˆæ˜¯è¿æ¥æ± "><a href="#1ã€ä»€ä¹ˆæ˜¯è¿æ¥æ± " class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯è¿æ¥æ± "></a>1ã€ä»€ä¹ˆæ˜¯è¿æ¥æ± </h2><p>æ•°æ®åº“è¿æ¥æ± è´Ÿè´£åˆ†é…ã€ç®¡ç†å’Œé‡Šæ”¾æ•°æ®åº“è¿æ¥ï¼Œå®ƒå…è®¸åº”ç”¨ç¨‹åºé‡å¤ä½¿ç”¨ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“è¿æ¥ï¼Œè€Œä¸æ˜¯å†é‡æ–°å»ºç«‹ä¸€ä¸ªã€‚</p>
<h2 id="2ã€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿æ¥æ± "><a href="#2ã€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿æ¥æ± " class="headerlink" title="2ã€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿æ¥æ± "></a>2ã€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è¿æ¥æ± </h2><p>æ•°æ®åº“è¿æ¥æ˜¯ä¸€ç§å…³é”®çš„<strong>æœ‰é™</strong>çš„<strong>æ˜‚è´µ</strong>çš„èµ„æºï¼Œè¿™ä¸€ç‚¹åœ¨å¤šç”¨æˆ·çš„ç½‘é¡µåº”ç”¨ç¨‹åºä¸­ä½“ç°å¾—å°¤ä¸ºçªå‡ºã€‚ ä¸€ä¸ªæ•°æ®åº“è¿æ¥å¯¹è±¡å‡å¯¹åº”ä¸€ä¸ªç‰©ç†æ•°æ®åº“è¿æ¥ï¼Œ<strong>æ¯æ¬¡æ“ä½œéƒ½æ‰“å¼€ä¸€ä¸ªç‰©ç†è¿æ¥ï¼Œä½¿ç”¨å®Œéƒ½å…³é—­è¿æ¥</strong>ï¼Œè¿™æ ·é€ æˆç³»ç»Ÿçš„<code>æ€§èƒ½ä½ä¸‹</code>ã€‚</p>
<p> æ•°æ®åº“è¿æ¥æ± çš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶å»ºç«‹è¶³å¤Ÿçš„æ•°æ®åº“è¿æ¥ï¼Œå¹¶è®²è¿™äº›è¿æ¥ç»„æˆä¸€ä¸ªè¿æ¥æ± (ç®€å•è¯´ï¼šåœ¨ä¸€ä¸ªâ€œæ± â€é‡Œæ”¾äº†å¥½å¤šåŠæˆå“çš„æ•°æ®åº“è”æ¥å¯¹è±¡)ï¼Œç”±åº”ç”¨ç¨‹åºåŠ¨æ€åœ°å¯¹æ± ä¸­çš„è¿æ¥è¿›è¡Œç”³è¯·ã€ä½¿ç”¨å’Œé‡Šæ”¾ã€‚å¯¹äºå¤šäºè¿æ¥æ± ä¸­è¿æ¥æ•°çš„å¹¶å‘è¯·æ±‚ï¼Œåº”è¯¥åœ¨è¯·æ±‚é˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…ã€‚å¹¶ä¸”åº”ç”¨ç¨‹åºå¯ä»¥æ ¹æ®æ± ä¸­è¿æ¥çš„ä½¿ç”¨ç‡ï¼ŒåŠ¨æ€å¢åŠ æˆ–å‡å°‘æ± ä¸­çš„è¿æ¥æ•°ã€‚ è¿æ¥æ± æŠ€æœ¯å°½å¯èƒ½å¤šåœ°é‡ç”¨äº†æ¶ˆè€—å†…å­˜åœ°èµ„æºï¼Œå¤§å¤§èŠ‚çœäº†å†…å­˜ï¼Œæé«˜äº†æœåŠ¡å™¨åœ°æœåŠ¡æ•ˆç‡ï¼Œèƒ½å¤Ÿæ”¯æŒæ›´å¤šçš„å®¢æˆ·æœåŠ¡ã€‚é€šè¿‡ä½¿ç”¨è¿æ¥æ± ï¼Œå°†å¤§å¤§æé«˜ç¨‹åºè¿è¡Œæ•ˆç‡ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…¶è‡ªèº«çš„ç®¡ç†æœºåˆ¶æ¥ç›‘è§†æ•°æ®åº“è¿æ¥çš„æ•°é‡ã€ä½¿ç”¨æƒ…å†µç­‰ã€‚ </p>
<h2 id="3ã€ä¼ ç»Ÿçš„è¿æ¥æœºåˆ¶ä¸æ•°æ®åº“è¿æ¥æ± çš„è¿è¡Œæœºåˆ¶åŒºåˆ«"><a href="#3ã€ä¼ ç»Ÿçš„è¿æ¥æœºåˆ¶ä¸æ•°æ®åº“è¿æ¥æ± çš„è¿è¡Œæœºåˆ¶åŒºåˆ«" class="headerlink" title="3ã€ä¼ ç»Ÿçš„è¿æ¥æœºåˆ¶ä¸æ•°æ®åº“è¿æ¥æ± çš„è¿è¡Œæœºåˆ¶åŒºåˆ«"></a>3ã€ä¼ ç»Ÿçš„è¿æ¥æœºåˆ¶ä¸æ•°æ®åº“è¿æ¥æ± çš„è¿è¡Œæœºåˆ¶åŒºåˆ«</h2><h4 id="3-1ã€ä¸ä½¿ç”¨è¿æ¥æ± æ‰§è¡Œä¸€æ¡-SQL-å‘½ä»¤"><a href="#3-1ã€ä¸ä½¿ç”¨è¿æ¥æ± æ‰§è¡Œä¸€æ¡-SQL-å‘½ä»¤" class="headerlink" title="3.1ã€ä¸ä½¿ç”¨è¿æ¥æ± æ‰§è¡Œä¸€æ¡ SQL å‘½ä»¤"></a>3.1ã€ä¸ä½¿ç”¨è¿æ¥æ± æ‰§è¡Œä¸€æ¡ SQL å‘½ä»¤</h4><p><img src="https://z3.ax1x.com/2021/11/21/IjEE0f.png" alt=""></p>
<ol>
<li>TCPå»ºç«‹è¿æ¥çš„ä¸‰æ¬¡æ¡æ‰‹</li>
<li>MySQLè®¤è¯çš„ä¸‰æ¬¡æ¡æ‰‹</li>
<li>çœŸæ­£çš„SQLæ‰§è¡Œ</li>
<li>MySQLçš„å…³é—­</li>
<li>TCPçš„å››æ¬¡æŒ¥æ‰‹å…³é—­</li>
</ol>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸ºäº†æ‰§è¡Œä¸€æ¡SQLï¼Œå´å¤šäº†éå¸¸å¤šæˆ‘ä»¬ä¸å…³å¿ƒçš„ç½‘ç»œäº¤äº’ã€‚</p>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å®ç°ç®€å•</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ç½‘ç»œ IO è¾ƒå¤š</li>
<li>æ•°æ®åº“çš„è´Ÿè½½è¾ƒé«˜</li>
<li>å“åº”æ—¶é—´è¾ƒé•¿åŠ QPS è¾ƒä½</li>
<li>åº”ç”¨é¢‘ç¹çš„åˆ›å»ºè¿æ¥å’Œå…³é—­è¿æ¥ï¼Œå¯¼è‡´ä¸´æ—¶å¯¹è±¡å¢å¤šï¼ŒGC é¢‘ç¹</li>
<li>åœ¨å…³é—­è¿æ¥åï¼Œä¼šå‡ºå¤§é‡ TIME_WAIT çš„ TCP çŠ¶æ€ï¼ˆåœ¨ä¸¤ä¸ª MSL ä¹‹åå…³é—­ï¼‰</li>
</ul>
<h4 id="3-2ã€ä½¿ç”¨è¿æ¥æ± æ‰§è¡Œä¸€æ¡-SQL-å‘½ä»¤"><a href="#3-2ã€ä½¿ç”¨è¿æ¥æ± æ‰§è¡Œä¸€æ¡-SQL-å‘½ä»¤" class="headerlink" title="3.2ã€ä½¿ç”¨è¿æ¥æ± æ‰§è¡Œä¸€æ¡ SQL å‘½ä»¤"></a>3.2ã€ä½¿ç”¨è¿æ¥æ± æ‰§è¡Œä¸€æ¡ SQL å‘½ä»¤</h4><p><img src="https://z3.ax1x.com/2021/11/21/IjVCUU.png" alt=""></p>
<p>ç¬¬ä¸€æ¬¡è®¿é—®çš„æ—¶å€™ï¼Œéœ€è¦å»ºç«‹è¿æ¥ã€‚ ä½†æ˜¯ä¹‹åçš„è®¿é—®ï¼Œå‡ä¼š<strong>å¤ç”¨</strong>ä¹‹å‰åˆ›å»ºçš„è¿æ¥ï¼Œç›´æ¥æ‰§è¡ŒSQLè¯­å¥ï¼ˆå›¾ä¸­é»„è‰²çš„éƒ¨åˆ†ï¼‰ã€‚</p>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li><p>è¾ƒå°‘äº†ç½‘ç»œå¼€é”€</p>
</li>
<li><p>ç³»ç»Ÿçš„æ€§èƒ½ä¼šæœ‰ä¸€ä¸ªå®è´¨çš„æå‡</p>
</li>
<li><p>æ²¡äº†éº»çƒ¦çš„TIME_WAITçŠ¶æ€</p>
</li>
</ul>
<h2 id="4ã€æ•°æ®åº“è¿æ¥æ± çš„å·¥ä½œåŸç†"><a href="#4ã€æ•°æ®åº“è¿æ¥æ± çš„å·¥ä½œåŸç†" class="headerlink" title="4ã€æ•°æ®åº“è¿æ¥æ± çš„å·¥ä½œåŸç†"></a>4ã€æ•°æ®åº“è¿æ¥æ± çš„å·¥ä½œåŸç†</h2><p>è¿æ¥æ± çš„å·¥ä½œåŸç†ä¸»è¦ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«ä¸º</p>
<ul>
<li><p>è¿æ¥æ± çš„å»ºç«‹</p>
</li>
<li><p>è¿æ¥æ± ä¸­è¿æ¥çš„ä½¿ç”¨ç®¡ç†</p>
</li>
<li><p>è¿æ¥æ± çš„å…³é—­</p>
</li>
</ul>
<p> <strong>è¿æ¥æ± çš„å»ºç«‹</strong>ï¼š</p>
<p>â€‹        ä¸€èˆ¬åœ¨ç³»ç»Ÿåˆå§‹åŒ–æ—¶ï¼Œè¿æ¥æ± ä¼šæ ¹æ®ç³»ç»Ÿé…ç½®å»ºç«‹ï¼Œå¹¶åœ¨æ± ä¸­åˆ›å»ºäº†å‡ ä¸ªè¿æ¥å¯¹è±¡ï¼Œä»¥ä¾¿ä½¿ç”¨æ—¶èƒ½ä»è¿æ¥æ± ä¸­è·å–ã€‚è¿æ¥æ± ä¸­çš„è¿æ¥ä¸èƒ½éšæ„åˆ›å»ºå’Œå…³é—­ï¼Œè¿™æ ·é¿å…äº†è¿æ¥éšæ„å»ºç«‹å’Œå…³é—­é€ æˆçš„ç³»ç»Ÿå¼€é”€ã€‚Javaä¸­æä¾›äº†å¾ˆå¤šå®¹å™¨ç±»å¯ä»¥æ–¹ä¾¿çš„æ„å»ºè¿æ¥æ± ï¼Œä¾‹å¦‚Vectorã€Stackç­‰ã€‚</p>
<p><strong>è¿æ¥æ± çš„ç®¡ç†</strong>ï¼š</p>
<p>â€‹        è¿æ¥æ± ç®¡ç†ç­–ç•¥æ˜¯<strong>è¿æ¥æ± æœºåˆ¶çš„æ ¸å¿ƒ</strong>ï¼Œè¿æ¥æ± å†…è¿æ¥çš„åˆ†é…å’Œé‡Šæ”¾å¯¹ç³»ç»Ÿçš„æ€§èƒ½æœ‰å¾ˆå¤§çš„å½±å“ã€‚å…¶ç®¡ç†ç­–ç•¥æ˜¯ï¼š</p>
<p>â€‹        å½“å®¢æˆ·<strong>è¯·æ±‚</strong>æ•°æ®åº“è¿æ¥æ—¶ï¼Œé¦–å…ˆæŸ¥çœ‹è¿æ¥æ± ä¸­æ˜¯å¦æœ‰ç©ºé—²è¿æ¥ï¼Œå¦‚æœå­˜åœ¨ç©ºé—²è¿æ¥ï¼Œåˆ™å°†è¿æ¥åˆ†é…ç»™å®¢æˆ·ä½¿ç”¨ï¼›å¦‚æœæ²¡æœ‰ç©ºé—²è¿æ¥ï¼Œåˆ™æŸ¥çœ‹å½“å‰æ‰€å¼€çš„è¿æ¥æ•°æ˜¯å¦å·²ç»è¾¾åˆ°æœ€å¤§è¿æ¥æ•°ï¼Œå¦‚æœæ²¡è¾¾åˆ°å°±é‡æ–°åˆ›å»ºä¸€ä¸ªè¿æ¥ç»™è¯·æ±‚çš„å®¢æˆ·ï¼›å¦‚æœè¾¾åˆ°å°±æŒ‰è®¾å®šçš„æœ€å¤§ç­‰å¾…æ—¶é—´è¿›è¡Œç­‰å¾…ï¼Œå¦‚æœè¶…å‡ºæœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ç»™å®¢æˆ·ã€‚</p>
<p>â€‹        å½“å®¢æˆ·<strong>é‡Šæ”¾</strong>æ•°æ®åº“è¿æ¥æ—¶ï¼Œå…ˆåˆ¤æ–­è¯¥è¿æ¥çš„å¼•ç”¨æ¬¡æ•°æ˜¯å¦è¶…è¿‡äº†è§„å®šå€¼ï¼Œå¦‚æœè¶…è¿‡å°±ä»è¿æ¥æ± ä¸­åˆ é™¤è¯¥è¿æ¥ï¼Œå¦åˆ™ä¿ç•™ä¸ºå…¶ä»–å®¢æˆ·æœåŠ¡ã€‚</p>
<p>â€‹        è¯¥ç­–ç•¥ä¿è¯äº†æ•°æ®åº“è¿æ¥çš„æœ‰æ•ˆå¤ç”¨ï¼Œé¿å…é¢‘ç¹çš„å»ºç«‹ã€é‡Šæ”¾è¿æ¥æ‰€å¸¦æ¥çš„ç³»ç»Ÿèµ„æºå¼€é”€ã€‚</p>
<p><strong>è¿æ¥æ± çš„å…³é—­</strong>ï¼š</p>
<p>å½“åº”ç”¨ç¨‹åºé€€å‡ºæ—¶ï¼Œå…³é—­è¿æ¥æ± ä¸­æ‰€æœ‰çš„è¿æ¥ï¼Œé‡Šæ”¾è¿æ¥æ± ç›¸å…³çš„èµ„æºï¼Œè¯¥è¿‡ç¨‹æ­£å¥½ä¸åˆ›å»ºç›¸åã€‚</p>
<h2 id="5ã€è¿æ¥æ± éœ€è¦æ³¨æ„çš„ç‚¹"><a href="#5ã€è¿æ¥æ± éœ€è¦æ³¨æ„çš„ç‚¹" class="headerlink" title="5ã€è¿æ¥æ± éœ€è¦æ³¨æ„çš„ç‚¹"></a>5ã€è¿æ¥æ± éœ€è¦æ³¨æ„çš„ç‚¹</h2><h4 id="5-1ã€å¹¶å‘é—®é¢˜"><a href="#5-1ã€å¹¶å‘é—®é¢˜" class="headerlink" title="5.1ã€å¹¶å‘é—®é¢˜"></a>5.1ã€<strong><font size="5px">å¹¶å‘é—®é¢˜</font></strong></h4><p>ã€€ã€€ä¸ºäº†ä½¿è¿æ¥ç®¡ç†æœåŠ¡å…·æœ‰æœ€å¤§çš„é€šç”¨æ€§ï¼Œå¿…é¡»è€ƒè™‘å¤šçº¿ç¨‹ç¯å¢ƒï¼Œå³å¹¶å‘é—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜ç›¸å¯¹æ¯”è¾ƒå¥½è§£å†³ï¼Œå› ä¸ºå„ä¸ªè¯­è¨€è‡ªèº«æä¾›äº†å¯¹å¹¶å‘ç®¡ç†çš„æ”¯æŒåƒjava,c#ç­‰ç­‰ï¼Œä½¿ç”¨synchronized(java)ã€lock(C#)å…³é”®å­—å³å¯ç¡®ä¿çº¿ç¨‹æ˜¯åŒæ­¥çš„ã€‚</p>
<h4 id="5-2ã€äº‹åŠ¡å¤„ç†"><a href="#5-2ã€äº‹åŠ¡å¤„ç†" class="headerlink" title="5.2ã€äº‹åŠ¡å¤„ç†"></a>5.2ã€<strong><font size="5px">äº‹åŠ¡å¤„ç†</font></strong></h4><p>â€‹        æˆ‘ä»¬çŸ¥é“ï¼Œäº‹åŠ¡å…·æœ‰åŸå­æ€§ï¼Œæ­¤æ—¶è¦æ±‚å¯¹æ•°æ®åº“çš„æ“ä½œç¬¦åˆâ€œALL-OR-NOTHINGâ€åŸåˆ™,å³å¯¹äºä¸€ç»„SQLè¯­å¥è¦ä¹ˆå…¨åšï¼Œè¦ä¹ˆå…¨ä¸åšã€‚<br>ã€€ã€€æˆ‘ä»¬çŸ¥é“å½“2ä¸ªçº¿ç¨‹å…±ç”¨ä¸€ä¸ªè¿æ¥Connectionå¯¹è±¡ï¼Œè€Œä¸”å„è‡ªéƒ½æœ‰è‡ªå·±çš„äº‹åŠ¡è¦å¤„ç†æ—¶å€™ï¼Œå¯¹äºè¿æ¥æ± æ˜¯ä¸€ä¸ªå¾ˆå¤´ç–¼çš„é—®é¢˜ï¼Œå› ä¸ºå³ä½¿Connectionç±»æä¾›äº†ç›¸åº”çš„äº‹åŠ¡æ”¯æŒï¼Œå¯æ˜¯æˆ‘ä»¬ä»ç„¶ä¸èƒ½ç¡®å®šé‚£ä¸ªæ•°æ®åº“æ“ä½œæ˜¯å¯¹åº”é‚£ä¸ªäº‹åŠ¡çš„ï¼Œè¿™æ˜¯ç”±äºæˆ‘ä»¬æœ‰ï¼’ä¸ªçº¿ç¨‹éƒ½åœ¨è¿›è¡Œäº‹åŠ¡æ“ä½œè€Œå¼•èµ·çš„ã€‚ä¸ºæ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¯ä¸€ä¸ªäº‹åŠ¡ç‹¬å ä¸€ä¸ªè¿æ¥æ¥å®ç°ï¼Œè™½ç„¶è¿™ç§æ–¹æ³•æœ‰ç‚¹æµªè´¹è¿æ¥æ± èµ„æºä½†æ˜¯å¯ä»¥å¤§å¤§é™ä½äº‹åŠ¡ç®¡ç†çš„å¤æ‚æ€§ã€‚ </p>
<h4 id="5-3è¿æ¥æ± çš„åˆ†é…ä¸é‡Šæ”¾"><a href="#5-3è¿æ¥æ± çš„åˆ†é…ä¸é‡Šæ”¾" class="headerlink" title="5.3è¿æ¥æ± çš„åˆ†é…ä¸é‡Šæ”¾"></a>5.3<strong><font size="5px">è¿æ¥æ± çš„åˆ†é…ä¸é‡Šæ”¾</font></strong></h4><p>â€‹        è¿æ¥æ± çš„åˆ†é…ä¸é‡Šæ”¾ï¼Œå¯¹ç³»ç»Ÿçš„æ€§èƒ½æœ‰å¾ˆå¤§çš„å½±å“ã€‚åˆç†çš„åˆ†é…ä¸é‡Šæ”¾ï¼Œå¯ä»¥æé«˜è¿æ¥çš„å¤ç”¨åº¦ï¼Œä»è€Œé™ä½å»ºç«‹æ–°è¿æ¥çš„å¼€é”€ï¼ŒåŒæ—¶è¿˜å¯ä»¥åŠ å¿«ç”¨æˆ·çš„è®¿é—®é€Ÿåº¦ã€‚<br>ã€€ã€€å¯¹äºè¿æ¥çš„ç®¡ç†å¯ä½¿ç”¨ä¸€ä¸ªListã€‚å³æŠŠå·²ç»åˆ›å»ºçš„è¿æ¥éƒ½æ”¾å…¥Listä¸­å»ç»Ÿä¸€ç®¡ç†ã€‚æ¯å½“ç”¨æˆ·è¯·æ±‚ä¸€ä¸ªè¿æ¥æ—¶ï¼Œç³»ç»Ÿæ£€æŸ¥è¿™ä¸ªListä¸­æœ‰æ²¡æœ‰å¯ä»¥åˆ†é…çš„è¿æ¥ã€‚å¦‚æœæœ‰å°±æŠŠé‚£ä¸ªæœ€åˆé€‚çš„è¿æ¥åˆ†é…ç»™ä»–ï¼›å¦‚æœæ²¡æœ‰å°±æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ç»™ç”¨æˆ·ï¼ŒListä¸­è¿æ¥æ˜¯å¦å¯ä»¥è¢«åˆ†é…ç”±ä¸€ä¸ªçº¿ç¨‹æ¥ä¸“é—¨ç®¡ç†ã€‚</p>
<h4 id="5-4ã€è¿æ¥æ± çš„é…ç½®ä¸ç»´æŠ¤"><a href="#5-4ã€è¿æ¥æ± çš„é…ç½®ä¸ç»´æŠ¤" class="headerlink" title="5.4ã€è¿æ¥æ± çš„é…ç½®ä¸ç»´æŠ¤"></a>5.4ã€<strong><font size="5px">è¿æ¥æ± çš„é…ç½®ä¸ç»´æŠ¤</font></strong></h4><p>â€‹        è¿æ¥æ± ä¸­åˆ°åº•åº”è¯¥æ”¾ç½®å¤šå°‘è¿æ¥ï¼Œæ‰èƒ½ä½¿ç³»ç»Ÿçš„æ€§èƒ½æœ€ä½³ï¼Ÿç³»ç»Ÿå¯é‡‡å–è®¾ç½®æœ€å°è¿æ¥æ•°ï¼ˆminConnectionï¼‰å’Œæœ€å¤§è¿æ¥æ•°ï¼ˆmaxConnectionï¼‰ç­‰å‚æ•°æ¥æ§åˆ¶è¿æ¥æ± ä¸­çš„è¿æ¥ã€‚æ¯”æ–¹è¯´ï¼Œæœ€å°è¿æ¥æ•°æ˜¯ç³»ç»Ÿå¯åŠ¨æ—¶è¿æ¥æ± æ‰€åˆ›å»ºçš„è¿æ¥æ•°ã€‚å¦‚æœåˆ›å»ºè¿‡å¤šï¼Œåˆ™ç³»ç»Ÿå¯åŠ¨å°±æ…¢ï¼Œä½†åˆ›å»ºåç³»ç»Ÿçš„å“åº”é€Ÿåº¦ä¼šå¾ˆå¿«ï¼›å¦‚æœåˆ›å»ºè¿‡å°‘ï¼Œåˆ™ç³»ç»Ÿå¯åŠ¨çš„å¾ˆå¿«ï¼Œå“åº”èµ·æ¥å´æ…¢ã€‚è¿™æ ·ï¼Œå¯ä»¥åœ¨å¼€å‘æ—¶ï¼Œè®¾ç½®è¾ƒå°çš„æœ€å°è¿æ¥æ•°ï¼Œå¼€å‘èµ·æ¥ä¼šå¿«ï¼Œè€Œåœ¨ç³»ç»Ÿå®é™…ä½¿ç”¨æ—¶è®¾ç½®è¾ƒå¤§çš„ï¼Œå› ä¸ºè¿™æ ·å¯¹è®¿é—®å®¢æˆ·æ¥è¯´é€Ÿåº¦ä¼šå¿«äº›ã€‚æœ€å¤§è¿æ¥æ•°æ˜¯è¿æ¥æ± ä¸­å…è®¸è¿æ¥çš„æœ€å¤§æ•°ç›®ï¼Œå…·ä½“è®¾ç½®å¤šå°‘ï¼Œè¦çœ‹ç³»ç»Ÿçš„è®¿é—®é‡ï¼Œå¯é€šè¿‡è½¯ä»¶éœ€æ±‚ä¸Šå¾—åˆ°ã€‚<br>ã€€ã€€å¦‚ä½•ç¡®ä¿è¿æ¥æ± ä¸­çš„æœ€å°è¿æ¥æ•°å‘¢ï¼Ÿæœ‰åŠ¨æ€å’Œé™æ€ä¸¤ç§ç­–ç•¥ã€‚åŠ¨æ€å³æ¯éš”ä¸€å®šæ—¶é—´å°±å¯¹è¿æ¥æ± è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœå‘ç°è¿æ¥æ•°é‡å°äºæœ€å°è¿æ¥æ•°ï¼Œåˆ™è¡¥å……ç›¸åº”æ•°é‡çš„æ–°è¿æ¥ï¼Œä»¥ä¿è¯è¿æ¥æ± çš„æ­£å¸¸è¿è½¬ã€‚é™æ€æ˜¯å‘ç°ç©ºé—²è¿æ¥ä¸å¤Ÿæ—¶å†å»æ£€æŸ¥ã€‚</p>
<h2 id="6ã€ä¸»æµæ•°æ®æºå¯¹æ¯”"><a href="#6ã€ä¸»æµæ•°æ®æºå¯¹æ¯”" class="headerlink" title="6ã€ä¸»æµæ•°æ®æºå¯¹æ¯”"></a>6ã€ä¸»æµæ•°æ®æºå¯¹æ¯”</h2><p>åŒºåˆ†ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± æ˜¯å±äºç¬¬ä¸€ä»£äº§å“è¿˜æ˜¯ä»£äºŒä»£äº§å“æœ‰ä¸€ä¸ªæœ€é‡è¦çš„ç‰¹å¾å°±æ˜¯çœ‹å®ƒåœ¨æ¶æ„å’Œè®¾è®¡æ—¶é‡‡ç”¨çš„çº¿ç¨‹æ¨¡å‹ï¼Œå› ä¸ºè¿™ç›´æ¥å½±å“çš„æ˜¯<strong>å¹¶å‘ç¯å¢ƒä¸‹å­˜å–æ•°æ®åº“è¿æ¥çš„æ€§èƒ½</strong>ã€‚</p>
<p>ä¸€èˆ¬æ¥è®²é‡‡ç”¨å•çº¿ç¨‹åŒæ­¥çš„æ¶æ„è®¾è®¡éƒ½å±äºç¬¬ä¸€ä»£è¿æ¥æ± ï¼ŒäºŒé‡‡ç”¨<strong>å¤šçº¿ç¨‹å¼‚æ­¥æ¶æ„</strong>çš„åˆ™å±äºç¬¬äºŒä»£ã€‚æ¯”è¾ƒæœ‰ä»£è¡¨æ€§çš„å°±æ˜¯Apache Commons DBCPï¼Œåœ¨1.xç‰ˆæœ¬ä¸­ï¼Œä¸€ç›´å»¶ç»­ç€å•çº¿ç¨‹è®¾è®¡æ¨¡å¼ï¼Œåˆ°2.xæ‰é‡‡ç”¨å¤šçº¿ç¨‹æ¨¡å‹ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th><strong>æ•°æ®åº“è¿æ¥æ± </strong></th>
<th><strong>æœ€æ–°ç‰ˆæœ¬</strong></th>
<th><strong>å‘å¸ƒæ—¶é—´</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>C3P0</td>
<td>c3p0-0.9.5.2</td>
<td>on 9 Dec 2015</td>
</tr>
<tr>
<td>DBCP</td>
<td>2.2.0</td>
<td>27 December 2017</td>
</tr>
<tr>
<td>Druid</td>
<td>0.11.0</td>
<td>Dec 4 2017</td>
</tr>
<tr>
<td>HikariCP</td>
<td>2.7.6</td>
<td>2018-01-14</td>
</tr>
</tbody>
</table>
</div>
<p>ä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼ŒC3P0å·²ç»å¾ˆä¹…æ²¡æœ‰æ›´æ–°äº†ã€‚DBCPæ›´æ–°é€Ÿåº¦å¾ˆæ…¢ï¼ŒåŸºæœ¬å¤„äºä¸æ´»è·ƒçŠ¶æ€ï¼Œè€ŒDruidå’ŒHikariCPå¤„äºæ´»è·ƒçŠ¶æ€çš„æ›´æ–°ä¸­ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¯´çš„äºŒä»£äº§å“äº†ã€‚</p>
<p>äºŒä»£äº§å“å¯¹ä¸€ä»£äº§å“çš„è¶…è¶Šæ˜¯é¢ è¦†æ€§çš„ï¼Œé™¤äº†ä¸€äº›â€œå†å²åŸå› â€ï¼Œä½ å¾ˆéš¾å†æ‰¾åˆ°ç¬¬äºŒæ¡ç†ç”±è¯´æœè‡ªå·±ä¸é€‰æ‹©äºŒä»£äº§å“ï¼Œä½†ä»»ä½•æˆåŠŸéƒ½ä¸æ˜¯å¶ç„¶çš„ï¼ŒäºŒä»£äº§å“çš„æˆåŠŸå¾ˆå¤§ç¨‹åº¦ä¸Šå¾—ç›Šäºå‰ä»£äº§å“ä»¬æ‰“ä¸‹çš„åŸºç¡€ï¼Œç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œæ–°ä¸€ä»£çš„è¿æ¥æ± çš„è®¾è®¡å¸ˆä»¬å°†è¿™ä¸€é¡¹â€œå·¥å…·åŒ–â€çš„äº§å“ï¼Œæ¨å‘äº†æè‡´ã€‚å…¶ä¸­ï¼Œæœ€å…·ä»£è¡¨æ€§çš„ä¸¤æ¬¾äº§å“æ˜¯ï¼š</p>
<ul>
<li>HikariCP</li>
<li>Druid</li>
</ul>
<h4 id="6-1ã€å½»åº•æ­»æ‰çš„-C3P0"><a href="#6-1ã€å½»åº•æ­»æ‰çš„-C3P0" class="headerlink" title="6.1ã€å½»åº•æ­»æ‰çš„ C3P0"></a>6.1ã€<strong><font size="5px">å½»åº•æ­»æ‰çš„ C3P0</font></strong></h4><p>åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…ï¼ŒC3P0 ä¸€ç›´æ˜¯Javaé¢†åŸŸå†…æ•°æ®åº“è¿æ¥æ± çš„ä»£åè¯ï¼Œå½“å¹´ç››æä¸€æ—¶çš„Hibernate éƒ½å°†å…¶ä½œä¸ºå†…ç½®çš„æ•°æ®åº“è¿æ¥æ± ï¼Œå¯ä»¥ä¸šå†…å¯¹å®ƒçš„ç¨³å®šæ€§è¿˜æ˜¯è®¤å¯çš„ã€‚C3P0 åŠŸèƒ½ç®€å•æ˜“ç”¨ï¼Œç¨³å®šæ€§å¥½è¿™æ˜¯å®ƒçš„ä¼˜ç‚¹ï¼Œ<strong>ä½†æ˜¯æ€§èƒ½ä¸Šçš„ç¼ºç‚¹å´è®©å®ƒå½»åº•è¢«æ‰“å…¥å†·å®«</strong>ã€‚C3P0 çš„æ€§èƒ½å¾ˆå·®ï¼Œå·®åˆ°å³ä¾¿æ˜¯åŒæ—¶ä»£çš„äº§å“ç›¸æ¯”å®ƒä¹Ÿæ˜¯å«åº•çš„ï¼Œæ›´ä¸ç”¨å’Œ Druidã€HikariCP ç­‰ç›¸æ¯”äº†ã€‚æ­£å¸¸æ¥è®²ï¼Œæœ‰é—®é¢˜å¾ˆæ­£å¸¸ï¼Œæ”¹å°±æ˜¯äº†ï¼Œ<strong>ä½†c3p0æœ€è‡´å‘½çš„é—®é¢˜å°±æ˜¯æ¶æ„è®¾è®¡è¿‡äºå¤æ‚ï¼Œè®©é‡æ„å˜æˆäº†ä¸€é¡¹ä¸å¯èƒ½å®Œæˆçš„ä»»åŠ¡</strong>ã€‚éšç€å›½å†…äº’è”ç½‘å¤§æ½®çš„æ¶Œèµ·ï¼Œæ€§èƒ½æœ‰ç¡¬ä¼¤çš„c3p0å½»åº•çš„é€€å‡ºäº†å†å²èˆå°ï¼Œå›¾è¡¨å¦‚ä¸‹ï¼ˆå·¦ä¾§ä¸ºå“åº”æ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼‰ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/21/Ijm324.png" alt=""></p>
<h4 id="6-2ã€å’¸é±¼ç¿»èº«çš„-DBCP"><a href="#6-2ã€å’¸é±¼ç¿»èº«çš„-DBCP" class="headerlink" title="6.2ã€å’¸é±¼ç¿»èº«çš„ DBCP"></a>6.2ã€<strong><font size="5px">å’¸é±¼ç¿»èº«çš„ DBCP</font></strong></h4><p>DBCPï¼ˆDataBase Connection Poolï¼‰å±äº Apache é¡¶çº§é¡¹ç›® Commons ä¸­çš„æ ¸å¿ƒå­é¡¹ç›®ï¼ˆæœ€æ—©åœ¨Jakarta Commonsé‡Œå°±æœ‰ï¼‰,åœ¨ Apache çš„ç”Ÿæ€åœˆä¸­çš„å½±å“é‡Œååˆ†å¹¿æ³›ï¼Œæ¯”å¦‚æœ€ä¸ºå¤§å®¶æ‰€ç†ŸçŸ¥çš„ Tomcat å°±åœ¨å†…éƒ¨é›†æˆäº† DBCPï¼Œå®ç° JPA è§„èŒƒçš„ OpenJPA ï¼Œä¹Ÿæ˜¯é»˜è®¤é›†æˆ DBCP çš„ã€‚ä½† <strong>DBCP å¹¶ä¸æ˜¯ç‹¬ç«‹å®ç°è¿æ¥æ± åŠŸèƒ½çš„ï¼Œå®ƒå†…éƒ¨ä¾èµ–äº Commons ä¸­çš„å¦ä¸€ä¸ªå­é¡¹ç›® Poolï¼Œè¿æ¥æ± æœ€æ ¸å¿ƒçš„â€œæ± â€ï¼Œå°±æ˜¯ç”± Pool ç»„ä»¶æä¾›çš„</strong>ï¼Œå› æ­¤ï¼ŒDBCP çš„æ€§èƒ½å®é™…ä¸Šå°±æ˜¯ Pool çš„æ€§èƒ½ï¼ŒDBCP å’Œ Pool çš„ä¾èµ–å…³ç³»å¦‚ä¸‹è¡¨ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th><strong>Apache Commons DBCP</strong></th>
<th><strong>Apache Commons Pool</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>v1.2.2</td>
<td>v1.3</td>
</tr>
<tr>
<td>v1.3</td>
<td>v1.5.4</td>
</tr>
<tr>
<td>v1.4</td>
<td>v1.5.4</td>
</tr>
<tr>
<td>v2.0.x</td>
<td>v2.2</td>
</tr>
<tr>
<td>v2.1.x</td>
<td>v2.4.2</td>
</tr>
<tr>
<td>v2.2.x</td>
<td>v2.5.0</td>
</tr>
</tbody>
</table>
</div>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå› ä¸ºæ ¸å¿ƒåŠŸèƒ½ä¾èµ–äº Poolï¼Œæ‰€ä»¥ DBCP æœ¬èº«åªèƒ½åšå°ç‰ˆæœ¬çš„æ›´æ–°ï¼ŒçœŸæ­£å¤§ç‰ˆæœ¬çš„æ›´è¿­åˆ™å®Œå…¨ä¾æ‰˜äº poolã€‚æœ‰å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œpool éƒ½è¿˜æ˜¯åœç•™åœ¨1.xç‰ˆæœ¬ï¼Œè¿™ç›´æ¥å¯¼è‡´ DBCP ä¹Ÿæ›´æ–°ä¹åŠ›ã€‚å¾ˆå¤šä¾èµ– DBCP çš„åº”ç”¨åœ¨é‡åˆ°æ€§èƒ½ç“¶é¢ˆä¹‹åï¼Œåˆ«æ— é€‰æ‹©ï¼Œåªèƒ½å°†å…¶æ›¿æ¢æ‰ï¼ŒDBCPå¿ å®çš„æ‹¥è¶¸ tomcat å°±åœ¨å…¶ tomcat 7.0 ç‰ˆæœ¬ä¸­ï¼Œè‡ªå·±é‡æ–°è®¾è®¡å¼€å‘å‡ºäº†ä¸€å¥—è¿æ¥æ± ï¼ˆTomcat JDBC Poolï¼‰ã€‚å¥½åœ¨ï¼Œåœ¨2013å¹´äº‹æƒ…ç»ˆäºè¿æ¥è½¬æœºï¼Œ13å¹´9æœˆ Commons-Pool 2.0 ç‰ˆæœ¬å‘å¸ƒï¼Œ14å¹´2æœˆä»½ï¼ŒDBCPä¹Ÿç»ˆäºè¿æ¥äº†è‡ªå·±çš„2.0ç‰ˆæœ¬ï¼ŒåŸºäºæ–°çš„çº¿ç¨‹æ¨¡å‹å…¨æ–°è®¾è®¡çš„â€œæ± â€è®© DBCP é‡ç„•é’æ˜¥ï¼Œè™½ç„¶å’Œæ–°ä¸€ä»£çš„è¿æ¥æ± ç›¸æ¯”ä»æœ‰ä¸€å®šå·®è·ï¼Œä½†å·®è·å¹¶ä¸å¤§ï¼ŒDBCP2.x ç‰ˆæœ¬å·²ç»ç¨³ç¨³è¾¾åˆ°äº†å’Œæ–°ä¸€ä»£äº§å“åŒçº§åˆ«çš„æ€§èƒ½æŒ‡æ ‡ï¼ˆè§ä¸‹å›¾ï¼‰ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/21/IjmrxH.png" alt=""></p>
<p>DBCP ç»ˆäºé  Pool å’¸é±¼ç¿»èº«ï¼Œæ‰“äº†ä¸€ä¸ªæ¼‚äº®çš„ç¿»èº«ä»—ï¼Œä½†é•¿æ—¶é—´çš„ç­‰å¾…å·²ç»å®Œå…¨æ¶ˆç£¨äº†ç”¨æˆ·çš„è€å¿ƒï¼Œä¸æ–°ä¸€ä»£çš„äº§å“é¡¹ç›®ç›¸æ¯”ï¼ŒDBCP æ²¡æœ‰ä»»ä½•ä¼˜åŠ¿ï¼Œè¯•é—®ï¼Œè°ä¼šåœ¨æœ‰é€‰æ‹©çš„å‰æä¸‹ï¼Œå»é€‰æ‹©é‚£ä¸ªå¹¶ä¸ä¼˜ç§€çš„å‘¢ï¼Ÿä¹Ÿè®¸ï¼Œç°åœ¨è¿˜é€‰æ‹© DBCP2 çš„å”¯ä¸€ç†ç”±ï¼Œå°±æ˜¯æƒ…æ€€å§ã€‚</p>
<h4 id="6-3ã€æ€§èƒ½æ— æ•Œçš„-HikariCP"><a href="#6-3ã€æ€§èƒ½æ— æ•Œçš„-HikariCP" class="headerlink" title="6.3ã€æ€§èƒ½æ— æ•Œçš„ HikariCP"></a>6.3ã€<strong><font size="5px">æ€§èƒ½æ— æ•Œçš„ HikariCP</font></strong></h4><p>HikariCP å·ç§°â€œæ€§èƒ½æ€æ‰‹â€ï¼ˆItâ€™s Fasterï¼‰ï¼Œå®ƒçš„è¡¨ç°ç©¶ç«Ÿå¦‚ä½•å‘¢ï¼Œå…ˆæ¥çœ‹ä¸‹å®˜ç½‘æä¾›çš„æ•°æ®ï¼š</p>
<p><img src="https://z3.ax1x.com/2021/11/21/Ijn9y9.png" alt=""></p>
<p>ä¸å…‰æ€§èƒ½å¼ºåŠ²ï¼Œç¨³å®šæ€§ä¹Ÿä¸å·®ï¼š</p>
<p><img src="https://z3.ax1x.com/2021/11/21/IjnKOA.png" alt=""></p>
<p>é‚£å®ƒæ˜¯æ€ä¹ˆåšåˆ°å¦‚æ­¤å¼ºåŠ²çš„å‘¢ï¼Ÿå®˜ç½‘ç»™å‡ºçš„è¯´æ˜å¦‚ä¸‹ï¼š</p>
<ul>
<li>å­—èŠ‚ç ç²¾ç®€ï¼šä¼˜åŒ–ä»£ç ï¼Œç›´åˆ°ç¼–è¯‘åçš„å­—èŠ‚ç æœ€å°‘ï¼Œè¿™æ ·ï¼ŒCPUç¼“å­˜å¯ä»¥åŠ è½½æ›´å¤šçš„ç¨‹åºä»£ç ï¼›</li>
<li>ä¼˜åŒ–ä»£ç†å’Œæ‹¦æˆªå™¨ï¼šå‡å°‘ä»£ç ï¼Œä¾‹å¦‚HikariCPçš„Statement proxyåªæœ‰100è¡Œä»£ç ï¼›</li>
<li>è‡ªå®šä¹‰æ•°ç»„ç±»å‹ï¼ˆFastStatementListï¼‰ä»£æ›¿ArrayListï¼šé¿å…æ¯æ¬¡get()è°ƒç”¨éƒ½è¦è¿›è¡Œrange checkï¼Œé¿å…è°ƒç”¨remove()æ—¶çš„ä»å¤´åˆ°å°¾çš„æ‰«æï¼›</li>
<li>è‡ªå®šä¹‰é›†åˆç±»å‹ï¼ˆConcurrentBagï¼‰ï¼šæé«˜å¹¶å‘è¯»å†™çš„æ•ˆç‡ï¼›</li>
<li>å…¶ä»–ç¼ºé™·çš„ä¼˜åŒ–ï¼Œæ¯”å¦‚å¯¹äºè€—æ—¶è¶…è¿‡ä¸€ä¸ªCPUæ—¶é—´ç‰‡çš„æ–¹æ³•è°ƒç”¨çš„ç ”ç©¶ï¼ˆä½†æ²¡è¯´å…·ä½“æ€ä¹ˆä¼˜åŒ–ï¼‰ã€‚</li>
</ul>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸Šè¿°è¿™å‡ ç‚¹ä¼˜åŒ–ï¼Œå’Œç°åœ¨èƒ½æ‰¾åˆ°çš„èµ„æ–™æ¥çœ‹ï¼ŒHakariCP åœ¨æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿åº”è¯¥æ˜¯å¾—åˆ°å…±è¯†çš„ï¼Œå†åŠ ä¸Šå®ƒè‡ªèº«å°å·§çš„èº«å½¢ï¼Œåœ¨å½“å‰çš„â€œäº‘æ—¶ä»£ã€å¾®æœåŠ¡â€çš„èƒŒæ™¯ä¸‹ï¼ŒHakariCP ä¸€å®šä¼šå¾—åˆ°æ›´å¤šäººçš„é’çã€‚</p>
<h4 id="6-4ã€åŠŸèƒ½å…¨é¢çš„-Druid"><a href="#6-4ã€åŠŸèƒ½å…¨é¢çš„-Druid" class="headerlink" title="6.4ã€åŠŸèƒ½å…¨é¢çš„ Druid"></a>6.4ã€<strong><font size="5px">åŠŸèƒ½å…¨é¢çš„ Druid</font></strong></h4><p>è¿‘å‡ å¹´ï¼Œé˜¿é‡Œåœ¨å¼€æºé¡¹ç›®ä¸ŠåŠ¨ä½œé¢‘é¢‘ï¼Œé™¤äº†æœ‰åƒfastJsonã€dubboè¿™ç±»é¡¹ç›®ï¼Œæ›´æœ‰åƒAliSQLè¿™ç±»çš„å¤§å‹è½¯ä»¶ï¼Œä»Šå¤©è¯´çš„Druidï¼Œå°±æ˜¯é˜¿é‡Œä¼—å¤šä¼˜ç§€å¼€æºé¡¹ç›®ä¸­çš„ä¸€ä¸ªã€‚å®ƒé™¤äº†æä¾›æ€§èƒ½å“è¶Šçš„è¿æ¥æ± åŠŸèƒ½å¤–ï¼Œè¿˜é›†æˆäº†SQLç›‘æ§ï¼Œé»‘åå•æ‹¦æˆªç­‰åŠŸèƒ½ï¼Œç”¨å®ƒè‡ªå·±çš„è¯è¯´ï¼ŒDruidæ˜¯â€œä¸ºç›‘æ§è€Œç”Ÿâ€ã€‚å€ŸåŠ©äºé˜¿é‡Œè¿™ä¸ªå¹³å°çš„å·å¬åŠ›ï¼Œäº§å“ä¸€ç»å‘å¸ƒå°±èµ¢å¾—äº†å¤§æ‰¹ç”¨æˆ·çš„æ‹¥è¶¸ï¼Œä»ç”¨æˆ·ä½¿ç”¨çš„åé¦ˆæ¥çœ‹ï¼ŒDruidä¹Ÿç¡®å®æ²¡è®©ç”¨æˆ·å¤±æœ›ã€‚</p>
<p>ç›¸è¾ƒäºå…¶ä»–äº§å“ï¼ŒDruidå¦ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ä¼˜åŠ¿ï¼Œå°±æ˜¯ä¸­æ–‡æ–‡æ¡£æ¯”è¾ƒå…¨é¢ï¼ˆæ¯•ç«Ÿæ˜¯å›½äººçš„é¡¹ç›®ä¹ˆï¼‰ï¼Œåœ¨githubçš„wikié¡µé¢ï¼Œåˆ—ä¸¾äº†æ—¥å¸¸ä½¿ç”¨ä¸­å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼Œå¯¹ä¸€ä¸ªæ–°ç”¨æˆ·æ¥è®²ï¼Œä¸Šé¢æä¾›çš„å†…å®¹å·²ç»è¶³å¤ŸæŒ‡å¯¼å®ƒå®Œæˆäº§å“çš„é…ç½®å’Œä½¿ç”¨äº†ã€‚</p>
<p>ä¸‹å›¾ä¸ºDruidè‡ªå·±æä¾›çš„æ€§èƒ½æµ‹è¯•æ•°æ®ï¼š</p>
<p><img src="https://z3.ax1x.com/2021/11/21/Ijuph8.png" alt=""></p>
<p><strong>Druid ç›¸å¯¹äºå…¶ä»–æ•°æ®åº“è¿æ¥æ± çš„ä¼˜ç‚¹</strong></p>
<ul>
<li><p>å¼ºå¤§çš„ç›‘æ§ç‰¹æ€§ï¼Œé€šè¿‡Druidæä¾›çš„ç›‘æ§åŠŸèƒ½ï¼Œå¯ä»¥æ¸…æ¥šçŸ¥é“è¿æ¥æ± å’ŒSQLçš„å·¥ä½œæƒ…å†µã€‚</p>
<ul>
<li>ç›‘æ§SQLçš„æ‰§è¡Œæ—¶é—´ã€ResultSetæŒæœ‰æ—¶é—´ã€è¿”å›è¡Œæ•°ã€æ›´æ–°è¡Œæ•°ã€é”™è¯¯æ¬¡æ•°ã€é”™è¯¯å †æ ˆä¿¡æ¯ï¼›</li>
<li>SQLæ‰§è¡Œçš„è€—æ—¶åŒºé—´åˆ†å¸ƒã€‚ä»€ä¹ˆæ˜¯è€—æ—¶åŒºé—´åˆ†å¸ƒå‘¢ï¼Ÿæ¯”å¦‚è¯´ï¼ŒæŸä¸ªSQLæ‰§è¡Œäº†1000æ¬¡ï¼Œå…¶ä¸­0~1æ¯«ç§’åŒºé—´50æ¬¡ï¼Œ1~10æ¯«ç§’800æ¬¡ï¼Œ10~100æ¯«ç§’100æ¬¡ï¼Œ100~1000æ¯«ç§’30æ¬¡ï¼Œ1~10ç§’15æ¬¡ï¼Œ10ç§’ä»¥ä¸Š5æ¬¡ã€‚é€šè¿‡è€—æ—¶åŒºé—´åˆ†å¸ƒï¼Œèƒ½å¤Ÿéå¸¸æ¸…æ¥šçŸ¥é“SQLçš„æ‰§è¡Œè€—æ—¶æƒ…å†µï¼›</li>
<li>ç›‘æ§è¿æ¥æ± çš„ç‰©ç†è¿æ¥åˆ›å»ºå’Œé”€æ¯æ¬¡æ•°ã€é€»è¾‘è¿æ¥çš„ç”³è¯·å’Œå…³é—­æ¬¡æ•°ã€éç©ºç­‰å¾…æ¬¡æ•°ã€PSCacheå‘½ä¸­ç‡ç­‰ã€‚</li>
</ul>
</li>
<li><p>æ–¹ä¾¿æ‰©å±•ã€‚Druidæä¾›äº†Filter-Chainæ¨¡å¼çš„æ‰©å±•APIï¼Œå¯ä»¥è‡ªå·±ç¼–å†™Filteræ‹¦æˆªJDBCä¸­çš„ä»»ä½•æ–¹æ³•ï¼Œå¯ä»¥åœ¨ä¸Šé¢åšä»»ä½•äº‹æƒ…ï¼Œæ¯”å¦‚è¯´æ€§èƒ½ç›‘æ§ã€SQLå®¡è®¡ã€ç”¨æˆ·åå¯†ç åŠ å¯†ã€æ—¥å¿—ç­‰ç­‰ã€‚</p>
</li>
<li>Druidé›†åˆäº†å¼€æºå’Œå•†ä¸šæ•°æ®åº“è¿æ¥æ± çš„ä¼˜ç§€ç‰¹æ€§ï¼Œå¹¶ç»“åˆé˜¿é‡Œå·´å·´å¤§è§„æ¨¡è‹›åˆ»ç”Ÿäº§ç¯å¢ƒçš„ä½¿ç”¨ç»éªŒè¿›è¡Œä¼˜åŒ–ã€‚</li>
</ul>
<h2 id="7ã€å°ç»“"><a href="#7ã€å°ç»“" class="headerlink" title="7ã€å°ç»“"></a>7ã€å°ç»“</h2><p>æ—¶è‡³ä»Šæ—¥ï¼Œè™½ç„¶æ¯ä¸ªåº”ç”¨ï¼ˆéœ€è¦ RDBMS çš„ï¼‰éƒ½ç¦»ä¸å¼€è¿æ¥æ± ï¼Œä½†åœ¨å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œè¿æ¥æ± å·²ç»å¯ä»¥åšåˆ°â€œéšå½¢â€äº†ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿æ¥æ± å®Œæˆé¡¹ç›®åˆå§‹åŒ–é…ç½®ä¹‹åï¼Œå°±å†ä¸éœ€è¦å†åšä»»ä½•æ”¹åŠ¨äº†ã€‚ä¸è®ºä½ æ˜¯é€‰æ‹© Druid æˆ–æ˜¯ HikariCPï¼Œç”šè‡³æ˜¯ DBCPï¼Œå®ƒä»¬éƒ½è¶³å¤Ÿç¨³å®šä¸”é«˜æ•ˆï¼ä¹‹å‰è®¨è®ºäº†å¾ˆå¤šå…³äºè¿æ¥æ± çš„æ€§èƒ½çš„é—®é¢˜ï¼Œä½†è¿™äº›æ€§èƒ½ä¸Šçš„å·®å¼‚ï¼Œæ˜¯ç›¸è¾ƒäºå…¶ä»–è¿æ¥æ± è€Œè¨€çš„ï¼Œå¯¹æ•´ä¸ªç³»ç»Ÿåº”ç”¨æ¥è¯´ï¼Œç¬¬äºŒä»£è¿æ¥æ± åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä½“ä¼šåˆ°çš„å·®åˆ«æ˜¯å¾®ä¹å…¶å¾®çš„ï¼ŒåŸºæœ¬ä¸Šä¸å­˜åœ¨å› ä¸ºè¿æ¥æ± çš„è‡ªèº«çš„é…é¥°å’Œä½¿ç”¨å¯¼è‡´ç³»ç»Ÿæ€§èƒ½ä¸‹é™çš„æƒ…å†µï¼Œé™¤éæ˜¯åœ¨å•ç‚¹åº”ç”¨çš„æ•°æ®åº“è´Ÿè½½è¶³å¤Ÿé«˜çš„æ—¶å€™ï¼ˆå‹åŠ›æµ‹è¯•çš„æ—¶å€™ï¼‰ï¼Œä½†å³ä¾¿æ˜¯å¦‚æ­¤ï¼Œé€šç”¨çš„ä¼˜åŒ–çš„æ–¹å¼ä¹Ÿæ˜¯å•ç‚¹æ”¹é›†ç¾¤ï¼Œè€Œä¸æ˜¯åœ¨å•ç‚¹çš„è¿æ¥æ± ä¸Šæ­»æ‰£ã€‚</p>
]]></content>
      <categories>
        <category>DataBase System</category>
      </categories>
  </entry>
  <entry>
    <title>ç®—æ³•ï¼ˆç¬¬4ç‰ˆï¼‰è¯»ä¹¦ç¬”è®°</title>
    <url>/2021/11/29/%E7%AE%97%E6%B3%95%EF%BC%88%E7%AC%AC4%E7%89%88%EF%BC%89%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h2 id="æ•°æ®ç»“æ„å®ç°"><a href="#æ•°æ®ç»“æ„å®ç°" class="headerlink" title="æ•°æ®ç»“æ„å®ç°"></a>æ•°æ®ç»“æ„å®ç°</h2><h4 id="å®Œæ•´çš„æ ˆå®ç°"><a href="#å®Œæ•´çš„æ ˆå®ç°" class="headerlink" title="å®Œæ•´çš„æ ˆå®ç°"></a>å®Œæ•´çš„æ ˆå®ç°</h4><p>è®°å¾—åˆšå­¦ java çš„æ—¶å€™å°±æœ‰å®ç°è¿‡ä¸€ä¸ª <strong>stack</strong>ï¼Œå½“ç„¶é‚£æ—¶å†™ä»£ç ä¸ä¼šè€ƒè™‘é‚£ä¹ˆå¤šï¼Œè¿™ä¸€æ¬¡æ·»åŠ äº†æ³›å‹å’Œæ•°ç»„æ‰©å®¹ï¼Œæé«˜äº†å¯æ‰©å±•æ€§ï¼Œè¿˜å®ç°äº† <strong>Iterable</strong> å¯è¿­ä»£æ¥å£ï¼Œè¿™æ · MyStack ç±»å°±å¯ä»¥ä½¿ç”¨ <strong>foreach</strong> å¾ªç¯äº†ã€‚</p>
<p>å¦å¤–ï¼Œç”±äº Java çš„åƒåœ¾æ”¶é›†ç­–ç•¥æ˜¯å›æ”¶æ‰€æœ‰æ— æ³•è¢«è®¿é—®çš„å¯¹è±¡çš„å†…å­˜ï¼Œè€Œä½†æˆ‘ä»¬è¿›è¡Œ pop æ“ä½œæ—¶ï¼Œè™½ç„¶ä½¿ç”¨è€…å·²ç»ä¸å¯èƒ½å†è®¿é—®è¿™ä¸ªè¢«å¼¹å‡ºçš„å…ƒç´ äº†ï¼Œä½†æ˜¯å®ƒçš„å¼•ç”¨è¿˜å­˜åœ¨ä¸æ•°ç»„ä¹‹ä¸­ï¼Œå› æ­¤ Java çš„åƒåœ¾æ”¶é›†å™¨å¹¶ä¸ä¼šå»å›æ”¶è¿™ä¸ªå…ƒç´ ï¼ï¼ï¼é™¤éåç»­å°†è¯¥å¼•ç”¨<strong>è¦†ç›–</strong>ã€‚å³ä½¿ç”¨ä¾‹å·²ç»ä¸å†éœ€è¦è¿™ä¸ªå…ƒç´ äº†ï¼Œæ•°ç»„ä¸­çš„å¼•ç”¨ä»ç„¶å¯ä»¥è®©å®ƒç»§ç»­å­˜åœ¨ï¼Œè¿™ç§æƒ…å†µï¼ˆä¿å­˜ä¸€ä¸ªä¸éœ€è¦çš„å¯¹è±¡çš„å¼•ç”¨ï¼‰å°±è¢«ç§°ä½œ<code>æ¸¸ç¦»</code>ã€‚ä¸€èˆ¬å¯ä»¥é€šè¿‡æ˜¾å¼ä½¿ç”¨ <strong>null</strong> æ¥è¦†ç›–ä¸éœ€è¦çš„å¯¹è±¡å³å¯ï¼ˆè§37è¡Œï¼‰ï¼</p>
<p><strong>æ ˆçš„æ•°ç»„å®ç°</strong></p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyStack</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">Iterable</span>&lt;<span class="title">T</span>&gt;</span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> T[] arr;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyStack</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>(<span class="number">10</span>);   <span class="comment">// ç»™äºˆæœ‰å‚æ„é€ å‡½æ•°é»˜è®¤å‚æ•°</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyStack</span><span class="params">(<span class="keyword">int</span> size)</span> </span>{</span><br><span class="line">        arr = (T[]) <span class="keyword">new</span> Object[size];   <span class="comment">// javaä¸æ”¯æŒæ³›å‹æ•°ç»„ï¼Œåªèƒ½å¼ºè½¬æˆ–æ˜¯ä½¿ç”¨é›†åˆç±»å‹</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isFull</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> arr.length == count;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> count == <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(T item)</span></span>{</span><br><span class="line">        <span class="keyword">if</span> (isFull()){</span><br><span class="line">            resizingArray(count * <span class="number">2</span>);</span><br><span class="line">        }</span><br><span class="line">        arr[count++] = item;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">pop</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()){</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArrayIndexOutOfBoundsException();</span><br><span class="line">        }</span><br><span class="line">        T item = arr[--count];</span><br><span class="line">        arr[count] = <span class="keyword">null</span>;  <span class="comment">// è§£å†³æ¸¸ç¦»é—®é¢˜</span></span><br><span class="line">        <span class="keyword">if</span>(count == arr.length / <span class="number">4</span>){  <span class="comment">// ä¿è¯æ•°ç»„çš„ä½¿ç”¨ç‡å§‹ç»ˆå¤§äº1/4</span></span><br><span class="line">            resizingArray(arr.length / <span class="number">2</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ›´æ”¹æ•°ç»„å¤§å°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">resizingArray</span><span class="params">(<span class="keyword">int</span> size)</span></span>{</span><br><span class="line">        T[] newArr = (T[]) <span class="keyword">new</span> Object[size];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;count;i++){</span><br><span class="line">            newArr[i] = arr[i];</span><br><span class="line">        }</span><br><span class="line">        arr = newArr;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;T&gt; <span class="title">iterator</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Iterator&lt;T&gt;() {</span><br><span class="line">            <span class="keyword">int</span> i = count;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>{</span><br><span class="line">                <span class="keyword">return</span> i &gt; <span class="number">0</span>;</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> T <span class="title">next</span><span class="params">()</span> </span>{</span><br><span class="line">                <span class="keyword">return</span> arr[--i];</span><br><span class="line">            }</span><br><span class="line">        };</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ ˆçš„é“¾è¡¨å®ç°</strong></p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyLinkedStack</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">Iterable</span>&lt;<span class="title">T</span>&gt;</span>{</span><br><span class="line">    <span class="keyword">private</span> Node head;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyLinkedStack</span><span class="params">()</span> </span>{</span><br><span class="line">        head = <span class="keyword">new</span> Node();</span><br><span class="line">        count = <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> head.next == <span class="keyword">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(T item)</span></span>{</span><br><span class="line">        Node node = <span class="keyword">new</span> Node();</span><br><span class="line">        node.item = item;</span><br><span class="line">        node.next = head.next;</span><br><span class="line">        head.next = node;</span><br><span class="line">        count++;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">peek</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()){</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> head.next.item;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">pop</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">if</span> (isEmpty()){</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArrayIndexOutOfBoundsException(<span class="string">"æ ˆç©ºï¼ï¼ï¼"</span>);</span><br><span class="line">        }</span><br><span class="line">        T item = head.next.item;</span><br><span class="line">        head.next = head.next.next;</span><br><span class="line">        count--;</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">// åŒºåˆ«äºæ•°ç»„å®ç°çš„è¿­ä»£å™¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterator&lt;T&gt; <span class="title">iterator</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Iterator&lt;T&gt;() {</span><br><span class="line">            Node tmp = head;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasNext</span><span class="params">()</span> </span>{</span><br><span class="line">                <span class="keyword">return</span> tmp.next != <span class="keyword">null</span>;</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> T <span class="title">next</span><span class="params">()</span> </span>{</span><br><span class="line">                tmp = tmp.next;</span><br><span class="line">                <span class="keyword">return</span> tmp.item;</span><br><span class="line">            }</span><br><span class="line">        };</span><br><span class="line">    }</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// ç§æœ‰å†…éƒ¨ç±» Nodeï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¤–éƒ¨çš„æ³›å‹ç±»å‹ï¼ï¼ï¼</span></span><br><span class="line">    <span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>{</span><br><span class="line">        Node next;</span><br><span class="line">        T item;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="ç®—æ³•å®ç°"><a href="#ç®—æ³•å®ç°" class="headerlink" title="ç®—æ³•å®ç°"></a>ç®—æ³•å®ç°</h2><h4 id="å¹¶æŸ¥é›†"><a href="#å¹¶æŸ¥é›†" class="headerlink" title="å¹¶æŸ¥é›†"></a>å¹¶æŸ¥é›†</h4><p>å…ˆå®šä¹‰ç®—æ³•çš„ api</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IUnionFind</span> </span>{</span><br><span class="line">    <span class="comment">// è¿æ¥ä¸¤ç‚¹</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span></span>;</span><br><span class="line">    <span class="comment">// æŸ¥æ‰¾æŸç‚¹çš„æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> p)</span></span>;</span><br><span class="line">    <span class="comment">// è¿”å›ä¸¤ç‚¹æ˜¯å¦è¿æ¥</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">connected</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span></span>;</span><br><span class="line">    <span class="comment">// è¿”å›è¿é€šåˆ†é‡çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>QuickFind</strong>ï¼Œå¿«é€ŸæŸ¥è¯¢ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickFind</span> <span class="keyword">implements</span> <span class="title">IUnionFind</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] links;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">QuickFind</span><span class="params">(<span class="keyword">int</span> num)</span> </span>{</span><br><span class="line">        links = <span class="keyword">new</span> <span class="keyword">int</span>[num];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;num;i++){</span><br><span class="line">            links[i] = i;</span><br><span class="line">        }</span><br><span class="line">        count = num;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> p)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> links[p];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">connected</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> find(p) == find(q);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">count</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span></span>{</span><br><span class="line">        <span class="keyword">int</span> pID = find(p);</span><br><span class="line">        <span class="keyword">int</span> qID = find(q);</span><br><span class="line">        <span class="keyword">if</span> (pID == qID){</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;links.length;i++){</span><br><span class="line">            <span class="keyword">if</span>(pID == links[i]){</span><br><span class="line">                links[i] = qID;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        count--;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸Šè¿°ä»£ç ï¼Œè™½è¯´æŸ¥è¯¢æ ¹èŠ‚ç‚¹é€Ÿåº¦å¾ˆå¿«ï¼Œä½†ç”±äºè¿æ¥çš„æ—¶å€™éœ€è¦å°†æ‰€æœ‰çš„è¿é€šèŠ‚ç‚¹éƒ½æ”¹ä¸ºåŒä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œå› æ­¤æ•ˆç‡å¾ˆå·®ã€‚</p>
<p><strong>QuickUnion</strong>ï¼Œå¿«é€Ÿåˆå¹¶ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickUnion</span> <span class="keyword">implements</span> <span class="title">IUnionFind</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] links;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">QuickUnion</span><span class="params">(<span class="keyword">int</span> num)</span> </span>{</span><br><span class="line">        count = num;</span><br><span class="line">        links = <span class="keyword">new</span> <span class="keyword">int</span>[num];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;num;i++){</span><br><span class="line">            links[i] = i;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (connected(p, q)){</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">int</span> pID = find(p);</span><br><span class="line">        <span class="keyword">int</span> qID = find(q);</span><br><span class="line">        links[qID] = pID;</span><br><span class="line">        count--;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> p)</span> </span>{</span><br><span class="line">        <span class="keyword">while</span>(links[p] != p){</span><br><span class="line">            p = links[p];</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">connected</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> find(p) == find(q);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">count</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è€Œ <strong>QuickUnion</strong> åœ¨è¿æ¥çš„æ—¶å€™åªä¿®æ”¹æ ¹èŠ‚ç‚¹çš„å€¼ï¼Œè§£å†³äº†è¿æ¥é€Ÿåº¦æ…¢çš„é—®é¢˜ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œåœ¨æŸ¥æ‰¾çš„æ—¶å€™ä¸èƒ½ç›´æ¥è¿”å›æŸç‚¹çš„æ ¹èŠ‚ç‚¹äº†ã€‚</p>
<p><strong>WeightedQuickUnion</strong>ï¼ŒåŠ æƒå¿«é€Ÿåˆå¹¶ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WeightedQuickUnion</span> <span class="keyword">implements</span> <span class="title">IUnionFind</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] links;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] weights;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WeightedQuickUnion</span><span class="params">(<span class="keyword">int</span> num)</span> </span>{</span><br><span class="line">        count = num;</span><br><span class="line">        links = <span class="keyword">new</span> <span class="keyword">int</span>[num];</span><br><span class="line">        weights = <span class="keyword">new</span> <span class="keyword">int</span>[num];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;num;i++){</span><br><span class="line">            links[i] = i;</span><br><span class="line">            weights[i] =<span class="number">1</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (connected(p, q)){</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">int</span> pID = find(p);</span><br><span class="line">        <span class="keyword">int</span> qID = find(q);</span><br><span class="line">        <span class="keyword">if</span>(weights[pID] &lt; weights[qID]){</span><br><span class="line">            weights[qID] += weights[pID];</span><br><span class="line">            links[pID] = qID;</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            weights[pID] += weights[qID];</span><br><span class="line">            links[qID] = pID;</span><br><span class="line">        }</span><br><span class="line">        count--;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> p)</span> </span>{</span><br><span class="line">        <span class="keyword">while</span>(links[p] != p){</span><br><span class="line">            p = links[p];</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">connected</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> find(p) == find(q);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">count</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>QuickUnion</strong> æœ€åæƒ…å†µä¸‹ä¼šåƒæœ‰åºæ•°ç»„ç”ŸæˆäºŒå‰æ’åºæ ‘é‚£æ ·ï¼Œå˜æˆç±»ä¼¼é“¾è¡¨çš„æ•°æ®ç»“æ„ï¼Œè¿™ä¼šå¤§å¤§é™ä½æŸ¥è¯¢å’Œè¿æ¥çš„é€Ÿåº¦ï¼Œè€Œ <strong>WeightedQuickUnion</strong> é€šè¿‡å°†å°æ ‘è¿æ¥åˆ°å¤§æ ‘è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼</p>
<p><strong>PathCompressedWeightedQuickUnion</strong>ï¼Œè·¯å¾„å‹ç¼©çš„åŠ æƒå¿«é€Ÿåˆå¹¶ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PathCompressedWeightedQuickUnion</span> <span class="keyword">implements</span> <span class="title">IUnionFind</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> count;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] links;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] weights;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PathCompressedWeightedQuickUnion</span><span class="params">(<span class="keyword">int</span> num)</span> </span>{</span><br><span class="line">        count = num;</span><br><span class="line">        links = <span class="keyword">new</span> <span class="keyword">int</span>[num];</span><br><span class="line">        weights = <span class="keyword">new</span> <span class="keyword">int</span>[num];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;num;i++){</span><br><span class="line">            links[i] = i;</span><br><span class="line">            weights[i] =<span class="number">1</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">union</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (connected(p, q)){</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">int</span> pID = find(p);</span><br><span class="line">        <span class="keyword">int</span> qID = find(q);</span><br><span class="line">        <span class="keyword">if</span>(weights[pID] &lt; weights[qID]){</span><br><span class="line">            weights[qID] += weights[pID];</span><br><span class="line">            links[pID] = qID;</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            weights[pID] += weights[qID];</span><br><span class="line">            links[qID] = pID;</span><br><span class="line">        }</span><br><span class="line">        count--;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> p)</span> </span>{</span><br><span class="line">        <span class="keyword">while</span>(links[p] != p){</span><br><span class="line">            <span class="keyword">return</span> links[p] = find(links[p]);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">connected</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> q)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> find(p) == find(q);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">count</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸Šè¯‰ä»£ç ï¼Œåœ¨æŸ¥è¯¢æ ¹èŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡é€’å½’å°†æ‰€æœ‰å­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ç›´æ¥ä¿®æ”¹ä¸ºäº†æ ¹èŠ‚ç‚¹ï¼Œå°†æ•´æ£µæ ‘çš„é«˜åº¦é”å®šåœ¨äº†2ï¼</p>
<p><strong>æ•ˆç‡å¯¹æ¯”</strong></p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EfficiencyTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Scanner sc1 = FileUtils.getFileScanner(<span class="string">"tinyUF.txt"</span>);</span><br><span class="line">        Scanner sc2 = FileUtils.getFileScanner(<span class="string">"tinyUF.txt"</span>);</span><br><span class="line">        Scanner sc3 = FileUtils.getFileScanner(<span class="string">"tinyUF.txt"</span>);</span><br><span class="line">        Scanner sc4 = FileUtils.getFileScanner(<span class="string">"tinyUF.txt"</span>);</span><br><span class="line">        QuickFind uf1 = <span class="keyword">new</span> QuickFind(sc1.nextInt());</span><br><span class="line">        QuickFind uf2 = <span class="keyword">new</span> QuickFind(sc2.nextInt());</span><br><span class="line">        QuickFind uf3 = <span class="keyword">new</span> QuickFind(sc3.nextInt());</span><br><span class="line">        QuickFind uf4 = <span class="keyword">new</span> QuickFind(sc4.nextInt());</span><br><span class="line">        System.out.println(<span class="string">"==============================tiny=============================="</span>);</span><br><span class="line">        System.out.println(<span class="string">"QuickFind:"</span> + test(uf1, sc1) + <span class="string">"ms"</span> + <span class="string">"\n"</span> + <span class="string">"components: "</span> + uf1.count());</span><br><span class="line">        System.out.println(<span class="string">"QuickUnion:"</span> + test(uf2, sc2) + <span class="string">"ms"</span> + <span class="string">"\n"</span> + <span class="string">"components: "</span> + uf2.count());</span><br><span class="line">        System.out.println(<span class="string">"WeightedQuickUnion:"</span> + test(uf3, sc3) + <span class="string">"ms"</span> + <span class="string">"\n"</span> + <span class="string">"components: "</span> + uf3.count());</span><br><span class="line">        System.out.println(<span class="string">"PathCompressedWeightedQuickUnion:"</span> + test(uf4, sc4) + <span class="string">"ms"</span> + <span class="string">"\n"</span> + <span class="string">"components: "</span> + uf4.count());</span><br><span class="line">        System.out.println(<span class="string">"==============================medium=============================="</span>);</span><br><span class="line">        sc1 = FileUtils.getFileScanner(<span class="string">"mediumUF.txt"</span>);</span><br><span class="line">        sc2 = FileUtils.getFileScanner(<span class="string">"mediumUF.txt"</span>);</span><br><span class="line">        sc3 = FileUtils.getFileScanner(<span class="string">"mediumUF.txt"</span>);</span><br><span class="line">        sc4 = FileUtils.getFileScanner(<span class="string">"mediumUF.txt"</span>);</span><br><span class="line">        uf1 = <span class="keyword">new</span> QuickFind(sc1.nextInt());</span><br><span class="line">        uf2 = <span class="keyword">new</span> QuickFind(sc2.nextInt());</span><br><span class="line">        uf3 = <span class="keyword">new</span> QuickFind(sc3.nextInt());</span><br><span class="line">        uf4 = <span class="keyword">new</span> QuickFind(sc4.nextInt());</span><br><span class="line">        System.out.println(<span class="string">"QuickFind:"</span> + test(uf1, sc1) + <span class="string">"ms"</span> + <span class="string">"\n"</span> + <span class="string">"components: "</span> + uf1.count());</span><br><span class="line">        System.out.println(<span class="string">"QuickUnion:"</span> + test(uf2, sc2) + <span class="string">"ms"</span> + <span class="string">"\n"</span> + <span class="string">"components: "</span> + uf2.count());</span><br><span class="line">        System.out.println(<span class="string">"WeightedQuickUnion:"</span> + test(uf3, sc3) + <span class="string">"ms"</span> + <span class="string">"\n"</span> + <span class="string">"components: "</span> + uf3.count());</span><br><span class="line">        System.out.println(<span class="string">"PathCompressedWeightedQuickUnion:"</span> + test(uf4, sc4) + <span class="string">"ms"</span> + <span class="string">"\n"</span> + <span class="string">"components: "</span> + uf4.count());</span><br><span class="line">        System.out.println(<span class="string">"==============================large=============================="</span>);</span><br><span class="line">        <span class="comment">// å…¶ä½™ä¸‰ä¸ªé€Ÿåº¦å¤ªæ…¢ï¼Œè¿™é‡Œå°±ä¸æµ‹è¯•äº†</span></span><br><span class="line">        sc4 = FileUtils.getFileScanner(<span class="string">"largeUF.txt"</span>);</span><br><span class="line">        uf4 = <span class="keyword">new</span> QuickFind(sc4.nextInt());</span><br><span class="line">        System.out.println(<span class="string">"PathCompressedWeightedQuickUnion:"</span> + test(uf4, sc4) + <span class="string">"ms"</span> + <span class="string">"\n"</span> + <span class="string">"components: "</span> + uf4.count());</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">==============================tiny==============================</span><br><span class="line">QuickFind:0ms</span><br><span class="line">components: <span class="number">2</span></span><br><span class="line">QuickUnion:0ms</span><br><span class="line">components: <span class="number">2</span></span><br><span class="line">WeightedQuickUnion:1ms</span><br><span class="line">components: <span class="number">2</span></span><br><span class="line">PathCompressedWeightedQuickUnion:2ms</span><br><span class="line">components: <span class="number">2</span></span><br><span class="line">==============================medium==============================</span><br><span class="line">QuickFind:17ms</span><br><span class="line">components: <span class="number">3</span></span><br><span class="line">QuickUnion:11ms</span><br><span class="line">components: <span class="number">3</span></span><br><span class="line">WeightedQuickUnion:6ms</span><br><span class="line">components: <span class="number">3</span></span><br><span class="line">PathCompressedWeightedQuickUnion:4ms</span><br><span class="line">components: <span class="number">3</span></span><br><span class="line">==============================large==============================</span><br><span class="line">PathCompressedWeightedQuickUnion:798220ms</span><br><span class="line">components: <span class="number">6</span></span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<p>å¯ä»¥å‘ç°ï¼Œåœ¨ tiny å°æ•°æ®é›†ä¸Šï¼Œæœ€ä¼˜çš„é‚£ä¸ªç®—æ³•åè€Œæœ€æ…¢ï¼Œä½†å½“æ•°æ®é‡æ…¢æ…¢å¢å¤§æ—¶ï¼Œå®ƒçš„ä¼˜åŠ¿å°±æ˜¾ç°å‡ºæ¥äº†ã€‚</p>
<h2 id="æ’åºç®—æ³•"><a href="#æ’åºç®—æ³•" class="headerlink" title="æ’åºç®—æ³•"></a>æ’åºç®—æ³•</h2><h4 id="æ’åºå·¥å…·ç±»"><a href="#æ’åºå·¥å…·ç±»" class="headerlink" title="æ’åºå·¥å…·ç±»"></a>æ’åºå·¥å…·ç±»</h4><p>åœ¨å®ç°å„ç§æ’åºç®—æ³•çš„è¿‡ç¨‹ä¸­ï¼Œä¸å…ä¼šä½¿ç”¨ä¸€äº›åŸºç¡€çš„æ“ä½œï¼ˆäº¤æ¢ï¼Œæ¯”è¾ƒç­‰ï¼‰ï¼Œè¿™é‡Œå°±å•ç‹¬å°è£…åœ¨ä¸€ä¸ªæ’åºçš„å·¥å…·ç±»ä¸­äº†ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SortUtil</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">less</span><span class="params">(Comparable a, Comparable b)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> a.compareTo(b) &lt; <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(Comparable[] arr, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (i == j) {</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        }</span><br><span class="line">        Comparable tmp = arr[i];</span><br><span class="line">        arr[i] = arr[j];</span><br><span class="line">        arr[j] = tmp;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">(Comparable[] arr)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (Comparable comparable : arr) {</span><br><span class="line">            System.out.print(comparable + <span class="string">" "</span>);</span><br><span class="line">        }</span><br><span class="line">        System.out.println();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isSorted</span><span class="params">(Comparable[] arr)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = arr.length - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i--) {</span><br><span class="line">            <span class="keyword">if</span> (less(arr[i], arr[i - <span class="number">1</span>])) {</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="é€‰æ‹©æ’åº"><a href="#é€‰æ‹©æ’åº" class="headerlink" title="é€‰æ‹©æ’åº"></a>é€‰æ‹©æ’åº</h4><p>ä¸€ç§æœ€ç®€å•çš„æ’åºç®—æ³•æ˜¯è¿™æ ·çš„:é¦–å…ˆï¼Œæ‰¾åˆ°æ•°ç»„ä¸­æœ€å°çš„é‚£ä¸ªå…ƒç´ ï¼Œå…¶æ¬¡ï¼Œå°†å®ƒå’Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ äº¤æ¢ä½ç½®ï¼ˆå¦‚æœç¬¬ä¸€ä¸ªå…ƒç´ å°±æ˜¯æœ€å°å…ƒç´ é‚£ä¹ˆå®ƒå°±å’Œè‡ªå·±äº¤æ¢ï¼‰ã€‚å†æ¬¡ï¼Œåœ¨å‰©ä¸‹çš„å…ƒç´ ä¸­æ‰¾åˆ°æœ€å°çš„å…ƒç´ ï¼Œå°†å®ƒä¸æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ äº¤æ¢ä½ç½®ã€‚å¦‚æ­¤å¾€å¤ï¼Œç›´åˆ°å°†æ•´ä¸ªæ•°ç»„æ’åºã€‚è¿™ç§æ–¹æ³•å«åšé€‰æ‹©æ’åºï¼Œå› ä¸ºå®ƒåœ¨ä¸æ–­åœ°é€‰æ‹©å‰©ä½™å…ƒç´ ä¹‹ä¸­çš„æœ€å°è€…ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Selection</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(Comparable[] arr)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length-<span class="number">1</span>; i++) {</span><br><span class="line">            <span class="keyword">int</span> min = i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; arr.length; j++) {</span><br><span class="line">                <span class="keyword">if</span> (SortUtil.less(arr[j], arr[min])) {</span><br><span class="line">                    min = j;</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            SortUtil.swap(arr, i, min);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å¯¹äºé•¿åº¦ä¸º <strong>N</strong> çš„æ•°ç»„ï¼Œé€‰æ‹©æ’åºéœ€è¦ ~$\frac{N^2}{2}$ æ¬¡æ¯”è¾ƒä»¥åŠ ~$N$ æ¬¡äº¤æ¢ã€‚</p>
<h4 id="æ’å…¥æ’åº"><a href="#æ’å…¥æ’åº" class="headerlink" title="æ’å…¥æ’åº"></a>æ’å…¥æ’åº</h4><p>é€šå¸¸äººä»¬æ•´ç†æ¡¥ç‰Œçš„æ–¹æ³•æ˜¯ä¸€å¼ ä¸€å¼ çš„æ¥,å°†æ¯ä¸€å¼ ç‰Œæ’å…¥åˆ°å…¶ä»–å·²ç»æœ‰åºçš„ç‰Œä¸­çš„é€‚å½“ä½ç½®ã€‚åœ¨è®¡ç®—æœºçš„å®ç°ä¸­ï¼Œä¸ºäº†ç»™è¦æ’å…¥çš„å…ƒç´ è…¾å‡ºç©ºé—´ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶ä½™æ‰€æœ‰å…ƒç´ åœ¨æ’å…¥ä¹‹å‰éƒ½å‘å³ç§»åŠ¨ä¸€ä½ã€‚è¿™ç§ç®—æ³•è¢«ç§°ä½œæ’å…¥æ’åºã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Insertion</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(Comparable[] arr)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt; arr.length;i++){</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=i;j&gt;<span class="number">0</span>;j--){</span><br><span class="line">                <span class="keyword">if</span> (SortUtil.less(arr[j], arr[j-<span class="number">1</span>])){</span><br><span class="line">                    SortUtil.swap(arr, j, j-<span class="number">1</span>);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å¯¹äºé•¿åº¦ä¸º <strong>N</strong> çš„æ•°ç»„ï¼Œæ’å…¥æ’åºå¹³å‡éœ€è¦è¿›è¡Œ ~$\frac{N^2}{4}$ æ¬¡æ¯”è¾ƒä»¥åŠ ~$\frac{N^2}{4}$ æ¬¡äº¤æ¢ï¼Œæœ€å¥½æƒ…å†µä¸‹éœ€è¦è¿›è¡Œ N-1 æ¬¡æ¯”è¾ƒä»¥åŠ0æ¬¡äº¤æ¢ï¼Œè€Œåœ¨æœ€åæƒ…å†µä¸‹ï¼Œéœ€è¦è¿›è¡Œ  ~$\frac{N^2}{2}$ æ¬¡æ¯”è¾ƒä»¥åŠ ~$\frac{N^2}{2}$ æ¬¡äº¤æ¢ï¼ˆå³å¯¹è§’çº¿ä¸‹æ–¹å…ƒç´ éƒ½éœ€è¦è¿›è¡Œäº¤æ¢ä¸æ¯”è¾ƒï¼‰ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/08/oRh1OA.png" alt="image"></p>
<p>ä¸é€‰æ‹©æ’åºä¸€æ ·ï¼Œå½“å‰ç´¢å¼•å·¦è¾¹çš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯æœ‰åºçš„ï¼Œä½†å®ƒä»¬çš„æœ€ç»ˆä½ç½®è¿˜ä¸ç¡®å®šï¼Œä¸ºäº†ç»™æ›´å°çš„å…ƒç´ è…¾å‡ºç©ºé—´ï¼Œå®ƒä»¬å¯èƒ½ä¼šè¢«ç§»åŠ¨ã€‚ä½†æ˜¯å½“ç´¢å¼•åˆ°è¾¾æ•°ç»„çš„å³ç«¯æ—¶ï¼Œæ•°ç»„æ’åºå°±å®Œæˆäº†ã€‚<br>å’Œé€‰æ‹©æ’åºä¸åŒçš„æ˜¯ï¼Œæ’å…¥æ’åºæ‰€éœ€çš„æ—¶é—´å–å†³äºè¾“å…¥ä¸­å…ƒç´ çš„åˆå§‹é¡ºåºã€‚ä¾‹å¦‚ï¼Œå¯¹ä¸€ä¸ªå¾ˆå¤§ä¸”å…¶ä¸­çš„å…ƒç´ å·²ç»æœ‰åºï¼ˆæˆ–æ¥è¿‘æœ‰åºï¼‰çš„æ•°ç»„è¿›è¡Œæ’åºå°†ä¼šæ¯”å¯¹éšæœºé¡ºåºçš„æ•°ç»„æˆ–æ˜¯é€†åºæ•°ç»„è¿›è¡Œæ’åºè¦å¿«å¾—å¤šã€‚</p>
<p><br></p>
<p><strong>æ’å…¥æ’åºï¼ˆä¿®æ”¹ï¼‰</strong></p>
<p>è¦å¤§å¹…æé«˜æ’äººæ’åºçš„é€Ÿåº¦å¹¶ä¸éš¾ï¼Œåªéœ€è¦åœ¨å†…å¾ªç¯ä¸­å°†è¾ƒå¤§çš„å…ƒç´ éƒ½å‘å³ç§»åŠ¨è€Œä¸æ€»æ˜¯äº¤æ¢</p>
<p>ä¸¤ä¸ªå…ƒç´ ï¼ˆè¿™æ ·è®¿é—®æ•°ç»„çš„æ¬¡æ•°å°±èƒ½å‡åŠï¼‰ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sortByMoving</span><span class="params">(Comparable[] arr)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; arr.length; i++) {</span><br><span class="line">            Comparable tmp = arr[i];</span><br><span class="line">            <span class="keyword">int</span> j = i - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (; j &gt;= <span class="number">0</span>; j--) {</span><br><span class="line">                <span class="keyword">if</span> (SortUtil.less(tmp, arr[j])) {</span><br><span class="line">                    arr[j + <span class="number">1</span>] = arr[j];</span><br><span class="line">                } <span class="keyword">else</span> {</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            arr[j + <span class="number">1</span>] = tmp;</span><br><span class="line">        }</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>
<h4 id="å¸Œå°”æ’åº"><a href="#å¸Œå°”æ’åº" class="headerlink" title="å¸Œå°”æ’åº"></a>å¸Œå°”æ’åº</h4><p>å¸Œå°”æ’åºä¸€ç§åŸºäºæ’äººæ’åºçš„å¿«é€Ÿçš„æ’åºç®—æ³•ã€‚å¯¹äºå¤§è§„æ¨¡ä¹±åºæ•°ç»„æ’å…¥æ’åºå¾ˆæ…¢ï¼Œå› ä¸ºå®ƒåªä¼šäº¤æ¢ç›¸é‚»çš„å…ƒç´ ï¼Œå› æ­¤å…ƒç´ åªèƒ½ä¸€ç‚¹ä¸€ç‚¹åœ°ä»æ•°ç»„ çš„ä¸€ç«¯ç§»åŠ¨åˆ°å¦ä¸€ç«¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸»é”®æœ€å°çš„å…ƒç´ æ­£å¥½åœ¨æ•°ç»„çš„å°½å¤´ï¼Œè¦å°†å®ƒæŒªåˆ°æ­£ç¡®çš„ä½ç½®å°±éœ€è¦ N-1 æ¬¡ç§»åŠ¨ã€‚å¸Œå°”æ’åºä¸ºäº†åŠ å¿«é€Ÿåº¦ç®€å•åœ°æ”¹è¿›äº†æ’å…¥æ’åºï¼Œäº¤æ¢ä¸ç›¸é‚»çš„å…ƒç´ ä»¥å¯¹æ•°ç»„çš„å±€éƒ¨è¿›è¡Œæ’åºï¼Œå¹¶æœ€ç»ˆç”¨æ’å…¥æ’åºå°†å±€éƒ¨æœ‰åºçš„æ•°ç»„æ’åºã€‚</p>
<p>å¸Œå°”æ’åºçš„æ€æƒ³æ˜¯ä½¿æ•°ç»„ä¸­ä»»æ„é—´éš”ä¸º h çš„å…ƒç´ éƒ½æ˜¯æœ‰åºçš„ã€‚è¿™æ ·çš„æ•°ç»„è¢«ç§°ä¸º h æœ‰åºæ•°ç»„ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ª h æœ‰åºæ•°ç»„å°±æ˜¯ h ä¸ªäº’ç›¸ç‹¬ç«‹çš„æœ‰åºæ•°ç»„ç¼–ç»‡åœ¨ä¸€èµ·ç»„æˆçš„ä¸€ä¸ªæ•°ç»„ã€‚åœ¨è¿›è¡Œæ’åºæ—¶ï¼Œå¦‚æœ h å¾ˆå¤§ï¼Œæˆ‘ä»¬å°±èƒ½å°†å…ƒç´ ç§»åŠ¨åˆ°å¾ˆè¿œçš„åœ°æ–¹ï¼Œä¸ºå®ç°æ›´å°çš„ h æœ‰åºåˆ›é€ æ–¹ä¾¿ã€‚ç”¨è¿™ç§æ–¹å¼ï¼Œå¯¹äºä»»æ„ä»¥1ç»“å°¾çš„ h åºåˆ—ï¼Œæˆ‘ä»¬éƒ½èƒ½å¤Ÿå°†æ•°ç»„æ’åºã€‚è¿™å°±æ˜¯å¸Œå°”æ’åºã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/08/oRonHA.png" alt="image"></p>
<p>ä¸‹é¢ç®—æ³•å®ç°ä½¿ç”¨äº†åºåˆ— $3n+1$ï¼Œä»N/3å¼€å§‹é€’å‡è‡³1ã€‚æˆ‘ä»¬æŠŠè¿™ä¸ªåºåˆ—ç§°ä¸ºé€’å¢åºåˆ—ã€‚ä¸€ç§æ–¹å¼æ˜¯å®æ—¶è®¡ç®—å®ƒçš„é€’å¢åºåˆ—ï¼Œå¦â€”ç§æ–¹å¼åˆ™æ˜¯å°†é€’å¢åºåˆ—å­˜å‚¨åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(Comparable[] arr)</span> </span>{</span><br><span class="line">    <span class="keyword">int</span> n = arr.length;</span><br><span class="line">    <span class="comment">// è®¡ç®—åºåˆ—ç¬¬ä¸€é¡¹</span></span><br><span class="line">    <span class="keyword">int</span> h = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (h &lt; n / <span class="number">3</span>) {</span><br><span class="line">        h = h * <span class="number">3</span> + <span class="number">1</span>;  <span class="comment">// 1, 4, 13, 40, 121...</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (h &gt; <span class="number">0</span>) {</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = h; i &lt; n; i++) {</span><br><span class="line">            Comparable tmp = arr[i];</span><br><span class="line">            <span class="keyword">int</span> j = i;</span><br><span class="line">            <span class="keyword">for</span> (; j &gt;= h; j -= h) {</span><br><span class="line">                <span class="keyword">if</span> (SortUtil.less(tmp, arr[j - h])) {</span><br><span class="line">                    arr[j] = arr[j - h];</span><br><span class="line">                }<span class="keyword">else</span> {</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            arr[j] = tmp;</span><br><span class="line">        }</span><br><span class="line">        h = (h - <span class="number">1</span>) / <span class="number">3</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è‡³äºä¸Šè¿°å¸Œå°”æ’åºçš„æ€§èƒ½ï¼ˆæ ¹æ® h åºåˆ—çš„å–å€¼ï¼Œæ’åºçš„æ—¶é—´å¤æ‚åº¦ä¼šæœ‰æ‰€ä¸åŒï¼‰ï¼Œ ç›®å‰æœ€é‡è¦çš„ç»“è®ºæ˜¯å®ƒçš„è¿è¡Œæ—¶é—´è¾¾ä¸åˆ°å¹³æ–¹çº§åˆ«ã€‚</p>
<p>ä¸è¿‡ï¼Œå·²çŸ¥åœ¨æœ€åçš„æƒ…å†µä¸‹æ¯”è¾ƒæ¬¡æ•°å’Œ $N^{3/2}$ æˆæ­£æ¯”ã€‚</p>
<h2 id="ç¥å¥‡çš„ç”¨æ³•"><a href="#ç¥å¥‡çš„ç”¨æ³•" class="headerlink" title="ç¥å¥‡çš„ç”¨æ³•"></a>ç¥å¥‡çš„ç”¨æ³•</h2><h4 id="ä¸ä¼šæŠ¥é”™çš„é™¤é›¶è¿ç®—"><a href="#ä¸ä¼šæŠ¥é”™çš„é™¤é›¶è¿ç®—" class="headerlink" title="ä¸ä¼šæŠ¥é”™çš„é™¤é›¶è¿ç®—"></a>ä¸ä¼šæŠ¥é”™çš„é™¤é›¶è¿ç®—</h4><p>ä¸‹è¿°ä»£ç å¹¶ä¸ä¼šåƒ<code>1 / 0</code> ä¸€æ ·æŠ¥é™¤é›¶å¼‚å¸¸ï¼Œè€Œæ˜¯ä¼šè¿”å› <code>Infinity</code></p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>{</span><br><span class="line">    System.out.println(<span class="number">1.0</span> / <span class="number">0.0</span>);	<span class="comment">// Infinity</span></span><br><span class="line">    System.out.println(<span class="number">1.0</span> / <span class="number">0.0</span> &gt; <span class="number">1e9</span>); <span class="comment">// true</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="å¯ä»¥â€œä¿®æ”¹â€çš„-final-å˜é‡"><a href="#å¯ä»¥â€œä¿®æ”¹â€çš„-final-å˜é‡" class="headerlink" title="å¯ä»¥â€œä¿®æ”¹â€çš„ final å˜é‡"></a>å¯ä»¥â€œä¿®æ”¹â€çš„ final å˜é‡</h4><p>è¢« <code>final</code> æ‰€ä¿®é¥°çš„å˜é‡æ— æ³•è¢«ä¿®æ”¹ï¼Œä¸‹è¿°ä»£ç ä¸­ <strong>arr</strong> æ˜¯ <code>final</code> å˜é‡ï¼Œå› æ­¤åœ¨ç¬¬5è¡Œæƒ³ç»™å®ƒèµ‹äºˆä¸€ä¸ªæ–°çš„å€¼æ—¶æŠ¥é”™äº†ï¼š <strong>Cannot assign a value to final variable â€˜arrâ€™</strong>ã€‚</p>
<p>è™½ç„¶å®ä¾‹å˜é‡çš„å€¼æ— æ³•è¢«ä¿®æ”¹ï¼Œä½†æ˜¯å¯¹è±¡çš„å€¼æœ¬èº«æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ï¼ˆè¯·çœ‹ç¬¬4è¡Œï¼‰ï¼</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        A a = <span class="keyword">new</span> A();</span><br><span class="line">        a.arr[<span class="number">0</span>] = <span class="number">20</span>;</span><br><span class="line">        <span class="comment">// a.arr = new int[10]; Cannot assign a value to final variable 'arr'</span></span><br><span class="line">        System.out.println(a.arr[<span class="number">0</span>]);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>{</span><br><span class="line">    <span class="comment">// å¸¸é‡arr</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span>[] arr;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">A</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">this</span>.arr = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="å·§å¦™å‹ç¼©æ—¥æœŸæ ¼å¼"><a href="#å·§å¦™å‹ç¼©æ—¥æœŸæ ¼å¼" class="headerlink" title="å·§å¦™å‹ç¼©æ—¥æœŸæ ¼å¼"></a>å·§å¦™å‹ç¼©æ—¥æœŸæ ¼å¼</h4><p>å¸¸è§„æ–¹æ³•ï¼Œä½¿ç”¨ä¸‰ä¸ªå˜é‡æ¥åˆ†åˆ«å­˜å‚¨å¹´æœˆæ—¥ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDate</span></span>{</span><br><span class="line">    <span class="keyword">int</span> day;	<span class="comment">// æ—¥</span></span><br><span class="line">    <span class="keyword">int</span> month;	<span class="comment">// æœˆ</span></span><br><span class="line">    <span class="keyword">int</span> year;	<span class="comment">// å¹´</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyDate</span><span class="params">(<span class="keyword">int</span> year, <span class="keyword">int</span> month, <span class="keyword">int</span> day)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.day = day;</span><br><span class="line">        <span class="keyword">this</span>.month = month;</span><br><span class="line">        <span class="keyword">this</span>.year = year;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"ç°åœ¨æ˜¯"</span> + year + <span class="string">"å¹´"</span> + month + <span class="string">"æœˆ"</span> + day + <span class="string">"æ—¥"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å‹ç¼©æ–¹æ³•ï¼Œåªä½¿ç”¨ä¸€ä¸ªå˜é‡æ¥å­˜å‚¨å¹´æœˆæ—¥ã€‚</p>
<p>å¹´æœˆæ—¥æˆ‘ä»¬å¯ä»¥æŠŠå®ƒè½¬æ¢ä¸º<code>ç‰¹æ®Šè¿›åˆ¶</code>çš„æ•° <strong>YMD</strong>ï¼Œè¿™ä¸ª<code>ç‰¹æ®Šè¿›åˆ¶</code>æ¯ä¸€ä½çš„æƒé‡å¹¶ä¸ç›¸åŒï¼Œç”±äºä¸€ä¸ªæœˆæœ€å¤šæœ‰31å¤©ï¼Œä¸€å¹´æœ‰12æœˆï¼Œå› æ­¤ <strong>D</strong> æ˜¯32è¿›åˆ¶çš„ï¼Œè€Œ <strong>M</strong> æ˜¯13è¿›åˆ¶çš„ï¼Œ<strong>Y</strong> åˆ™æ²¡æœ‰è¿›åˆ¶ï¼Œå¯ä»¥ä¸€ç›´å¾€ä¸ŠåŠ ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æ˜¯ x å¹´ y æœˆ z æ—¥ï¼Œé‚£ä¹ˆ <strong>YMD</strong> å°±åº”è¯¥ç­‰äº z + 32 <em> y + 32 </em> 13 * xã€‚</p>
<p>å½“ç„¶ï¼Œè¿™ä¸ª <strong>YMD</strong> åªèƒ½ç®—æ˜¯å‹ç¼©ï¼Œæ˜¯ä¸å¯èƒ½ç”¨äºæœ€åè¾“å‡ºçš„ï¼ˆæ¯•ç«Ÿåˆ«äººä¸çŸ¥é“è¿™æ˜¯<code>ç‰¹æ®Šè¿›åˆ¶</code>ï¼‰ï¼Œå› æ­¤è¿˜éœ€è¦è§£å‹ã€‚</p>
<p>æ ¹æ® date = z + 32 <em> y + 32 </em> 13 * xï¼Œæ˜“å¾— x = date / 416ï¼Œz = date % 32ï¼Œè€Œ y å¯ä»¥å…ˆæ±‚å‡ºä¸€å…±æœ‰å¤šå°‘æœˆ months = date / 32ï¼Œç„¶åå†é€šè¿‡ months % 13 å°±èƒ½ç®—å‡ºæ¥ y äº†ï¼</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDateCompressed</span></span>{</span><br><span class="line">    <span class="keyword">int</span> date;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyDateCompressed</span><span class="params">(<span class="keyword">int</span> year, <span class="keyword">int</span> month, <span class="keyword">int</span> day)</span> </span>{</span><br><span class="line">        date = day + <span class="number">32</span> * month + <span class="number">416</span> * year;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"ç°åœ¨æ˜¯"</span> + date / <span class="number">416</span> + <span class="string">"å¹´"</span> + date / <span class="number">32</span> % <span class="number">13</span> + <span class="string">"æœˆ"</span> + date % <span class="number">32</span> + <span class="string">"æ—¥"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
]]></content>
      <categories>
        <category>notes</category>
      </categories>
  </entry>
  <entry>
    <title>Mybatis</title>
    <url>/2021/10/18/Mybatis/</url>
    <content><![CDATA[<h2 id="1ã€ç®€ä»‹"><a href="#1ã€ç®€ä»‹" class="headerlink" title="1ã€ç®€ä»‹"></a>1ã€ç®€ä»‹</h2><h4 id="1-1ã€ä»€ä¹ˆæ˜¯Mybatis"><a href="#1-1ã€ä»€ä¹ˆæ˜¯Mybatis" class="headerlink" title="1.1ã€ä»€ä¹ˆæ˜¯Mybatis"></a>1.1ã€ä»€ä¹ˆæ˜¯Mybatis</h4><ul>
<li>MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ã€‚</li>
<li>å®ƒæ”¯æŒè‡ªå®šä¹‰ SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚</li>
<li>MyBatis å…é™¤äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç ä»¥åŠè®¾ç½®å‚æ•°å’Œè·å–ç»“æœé›†çš„å·¥ä½œã€‚</li>
<li>MyBatis å¯ä»¥é€šè¿‡ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸå§‹ç±»å‹ã€æ¥å£å’Œ Java POJOï¼ˆPlain Old Java Objectsï¼Œæ™®é€šè€å¼ Java å¯¹è±¡ï¼‰ä¸ºæ•°æ®åº“ä¸­çš„è®°å½•ã€‚</li>
<li>MyBatis æœ¬æ˜¯apacheçš„ä¸€ä¸ªå¼€æºé¡¹ç›® iBatisã€‚</li>
<li>2010å¹´è¿™ä¸ªé¡¹ç›®ç”± apache software foundation è¿ç§»åˆ°äº† google codeï¼Œå¹¶ä¸”æ”¹åä¸ºMyBatisã€‚</li>
<li>2013å¹´11æœˆè¿ç§»åˆ° Githubã€‚</li>
</ul>
<p>å¦‚ä½•è·å– Mybatisï¼Ÿ</p>
<ul>
<li><p>maven ä»“åº“ï¼š</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>Githubï¼š<a href="https://github.com/search?q=Mybatis">https://github.com/search?q=Mybatis</a></p>
</li>
<li><p>ä¸­æ–‡æ–‡æ¡£ï¼š<a href="https://mybatis.net.cn/">https://mybatis.net.cn/</a></p>
</li>
</ul>
<span id="more"></span>
<h4 id="1-2ã€æŒä¹…åŒ–"><a href="#1-2ã€æŒä¹…åŒ–" class="headerlink" title="1.2ã€æŒä¹…åŒ–"></a>1.2ã€æŒä¹…åŒ–</h4><p>æ•°æ®æŒä¹…åŒ–</p>
<ul>
<li>æŒä¹…åŒ–å°±æ˜¯å°†ç¨‹åºçš„æ•°æ®åœ¨æŒä¹…çŠ¶æ€å’Œç¬æ—¶çŠ¶æ€è½¬åŒ–çš„è¿‡ç¨‹ã€‚</li>
<li>å†…å­˜<strong>æ–­ç”µå³å¤±</strong></li>
</ul>
<p>ä¸ºä»€ä¹ˆéœ€è¦æŒä¹…åŒ–ï¼Ÿ</p>
<ul>
<li>æœ‰ä¸€äº›å¯¹è±¡ä¸èƒ½è®©ä»–ä¸¢æ‰ã€‚</li>
<li>å†…å­˜å¤ªè´µäº†ã€‚</li>
</ul>
<h4 id="1-3ã€æŒä¹…å±‚"><a href="#1-3ã€æŒä¹…å±‚" class="headerlink" title="1.3ã€æŒä¹…å±‚"></a>1.3ã€æŒä¹…å±‚</h4><p>Dao å±‚ã€Service å±‚ã€Controller å±‚â€¦â€¦</p>
<ul>
<li>å®ŒæˆæŒä¹…åŒ–å·¥ä½œçš„ä»£ç å—</li>
<li>å±‚ç•Œé™ååˆ†æ˜æ˜¾ã€‚</li>
</ul>
<h4 id="1-4ã€ä¸ºä»€ä¹ˆéœ€è¦Mybatisï¼Ÿ"><a href="#1-4ã€ä¸ºä»€ä¹ˆéœ€è¦Mybatisï¼Ÿ" class="headerlink" title="1.4ã€ä¸ºä»€ä¹ˆéœ€è¦Mybatisï¼Ÿ"></a>1.4ã€ä¸ºä»€ä¹ˆéœ€è¦Mybatisï¼Ÿ</h4><ul>
<li>ä¼ ç»Ÿ JDBC ä»£ç è¿‡äºå¤æ‚å†—ä½™ï¼Œè€ŒMybatis ç®€æ´äº†å¾ˆå¤šã€‚</li>
<li>æ–¹ä¾¿ç®€æ´è‡ªåŠ¨åŒ–ï¼Œæ¡†æ¶åœ¨èƒŒåå¸®æˆ‘ä»¬åšäº†å¾ˆå¤šäº‹æƒ…ã€‚</li>
</ul>
<h2 id="2ã€ç¬¬ä¸€ä¸ª-Mybatis-ç¨‹åº"><a href="#2ã€ç¬¬ä¸€ä¸ª-Mybatis-ç¨‹åº" class="headerlink" title="2ã€ç¬¬ä¸€ä¸ª Mybatis ç¨‹åº"></a>2ã€ç¬¬ä¸€ä¸ª Mybatis ç¨‹åº</h2><p>æ·»åŠ  maven ä¾èµ–</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mybatis--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--test--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mysql--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>mybatis é…ç½®æ–‡ä»¶</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ³¨å†Œmapperæ–‡ä»¶--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/yqx/mapper/UserMapper.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>pojo å®ä½“ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User{"</span> +</span><br><span class="line">                <span class="string">"id="</span> + id +</span><br><span class="line">                <span class="string">", name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", age="</span> + age +</span><br><span class="line">                <span class="string">'}'</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>{</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(<span class="keyword">int</span> id, String name, <span class="keyword">int</span> age)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>mapper.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.yqx.mapper.UserMapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserById"</span> <span class="attr">resultType</span>=<span class="string">"com.yqx.pojo.User"</span>&gt;</span></span><br><span class="line">        select * from mybatis.user where id = #{id}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>mapper.xml æ”¾åœ¨ java ç±»ä¸­ã€‚ä¸ä¼šè¢« maven è¯»å–ï¼Œéœ€è¦åœ¨ pom.xml ä¸­æ˜¾å¼å®šä¹‰è·¯å¾„ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>mapper ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yqx.pojo.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>{</span><br><span class="line">     <span class="function">User <span class="title">findUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>SqlSession å·¥å…·ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisUtil</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sqlSessionFactory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> {</span><br><span class="line">        String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">        InputStream inputStream = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">        } <span class="keyword">catch</span> (IOException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">        sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSession</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactory.openSession();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Test æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yqx.utils.MyBatisUtil;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapperTest</span> </span>{</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>{</span><br><span class="line">        SqlSession sqlSession = MyBatisUtil.getSession();</span><br><span class="line">        UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">        System.out.println(mapper.findUserById(<span class="number">5</span>));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id=""><a href="#" class="headerlink" title=" "></a> </h4><h2 id="3ã€CRUD"><a href="#3ã€CRUD" class="headerlink" title="3ã€CRUD"></a>3ã€CRUD</h2><h4 id="3-1ã€namespace"><a href="#3-1ã€namespace" class="headerlink" title="3.1ã€namespace"></a>3.1ã€namespace</h4><p>namespace ä¸­çš„ç±»åè¦å’Œ Dao/Mapper æ¥å£åä¸€è‡´ï¼</p>
<h4 id="3-2ã€sqlè¯­å¥"><a href="#3-2ã€sqlè¯­å¥" class="headerlink" title="3.2ã€sqlè¯­å¥"></a>3.2ã€sqlè¯­å¥</h4><ul>
<li><p>idï¼šå¯¹åº” namespace ä¸­çš„æ–¹æ³•åã€‚</p>
</li>
<li><p>resultTypeï¼šsql è¯­å¥æ‰§è¡Œçš„è¿”å›å€¼ã€‚</p>
</li>
<li><p>parameterTypeï¼šå‚æ•°ç±»å‹ã€‚</p>
</li>
</ul>
<p><strong>mapper</strong></p>
<p>å¢åˆ æ”¹ä¼šè¿”å›ä¿®æ”¹çš„è®°å½•æ•°ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>{</span><br><span class="line">     <span class="function">User <span class="title">findUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">     <span class="function">List&lt;User&gt; <span class="title">findAllUsers</span><span class="params">()</span></span>;</span><br><span class="line">     <span class="function"><span class="keyword">int</span> <span class="title">deleteUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">     <span class="function"><span class="keyword">int</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">     <span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>å¯¹äº mapper ä¸­çš„ sql è¯­å¥ï¼Œéœ€è¦éµå®ˆä»¥ä¸‹è§„åˆ™ã€‚</strong></p>
<ul>
<li>è¿”å›å€¼ä¸ºåŸºæœ¬ç±»å‹æ—¶å¯ä»¥ä¸å†™ã€‚</li>
<li>å‚æ•°åˆ—è¡¨åªæœ‰ä¸€ä¸ªæ—¶ï¼Œ#{} ä¸­çš„å½¢å‚åå¯ä»¥éšä¾¿å†™ã€‚</li>
<li>ä¼ å…¥å®ä½“ç±»æ—¶ï¼Œå½¢å‚åè¦å’Œå®ä½“ç±»ä¸­çš„å±æ€§åä¸€è‡´ã€‚</li>
</ul>
<p><strong>select</strong></p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">&lt;select id=<span class="string">"findUserById"</span> resultType=<span class="string">"com.yqx.pojo.User"</span>&gt;</span><br><span class="line">    select * from mybatis.user where id = #{id}</span><br><span class="line">&lt;/select&gt;</span><br><span class="line">    </span><br><span class="line">&lt;select id=<span class="string">"findAllUsers"</span> resultType=<span class="string">"com.yqx.pojo.User"</span>&gt;</span><br><span class="line">    select * from mybatis.user</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>delete</strong></p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">&lt;delete id=<span class="string">"deleteUserById"</span>&gt;</span><br><span class="line">    delete from mybatis.user where id = #{id}</span><br><span class="line">&lt;/delete&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>update</strong></p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">&lt;update id=<span class="string">"updateUser"</span>&gt;</span><br><span class="line">    update mybatis.user set name = #{name}, age = #{age} where id = #{id}</span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>insert</strong></p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">&lt;insert id=<span class="string">"addUser"</span>&gt;</span><br><span class="line">    insert into mybatis.user (name, age) values(#{name}, #{age})</span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>æ³¨ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨ <code>#{}</code> å‚æ•°è¯­æ³•æ—¶ï¼ŒMyBatis ä¼šåˆ›å»º <code>PreparedStatement</code> å‚æ•°å ä½ç¬¦ï¼Œå¹¶é€šè¿‡å ä½ç¬¦å®‰å…¨åœ°è®¾ç½®å‚æ•°ï¼ˆå°±åƒä½¿ç”¨ ? ä¸€æ ·ï¼‰ã€‚ è¿™æ ·åšæ›´å®‰å…¨ï¼Œæ›´è¿…é€Ÿï¼Œé€šå¸¸ä¹Ÿæ˜¯é¦–é€‰åšæ³•ã€‚</p>
<h4 id="3-3ã€ä¸‡èƒ½Map"><a href="#3-3ã€ä¸‡èƒ½Map" class="headerlink" title="3.3ã€ä¸‡èƒ½Map"></a>3.3ã€ä¸‡èƒ½Map</h4><p>æ™®é€šçš„ update æ–¹æ³•éœ€è¦ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå³ä¾¿åªéœ€è¦æ”¹ä¸€ä¸ªå­—æ®µã€‚è€Œ map æ–¹æ³•å¯ä»¥æŒ‡å®šä¼ å…¥çš„å†…å®¹ï¼Œä»è€Œè¾¾æˆæ›´æ”¹æŒ‡å®šçš„å­—æ®µã€‚</p>
<p>mapper æ¥å£æ·»åŠ æ–¹æ³•</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">updateUserName</span><span class="params">(Map map)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p>mapper.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUserName"</span>&gt;</span></span><br><span class="line">    update mybatis.user set name = #{user_name} where id = #{user_id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>test</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test6</span><span class="params">()</span></span>{</span><br><span class="line">    SqlSession sqlSession = MyBatisUtil.getSession();</span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">"user_id"</span>, <span class="number">5</span>);</span><br><span class="line">    map.put(<span class="string">"user_name"</span>, <span class="string">"é¾™å‚²å¤©"</span>);</span><br><span class="line">    System.out.println(mapper.updateUserName(map));</span><br><span class="line">    System.out.println(mapper.findAllUsers());</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="3-4ã€æ¨¡ç³ŠæŸ¥è¯¢"><a href="#3-4ã€æ¨¡ç³ŠæŸ¥è¯¢" class="headerlink" title="3.4ã€æ¨¡ç³ŠæŸ¥è¯¢"></a>3.4ã€æ¨¡ç³ŠæŸ¥è¯¢</h4><p>mapper æ¥å£æ·»åŠ æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">List&lt;User&gt; findUserLike(String value);</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ–¹æ³•ä¸€</strong></p>
<p>mapper.xml</p>
<p>ä¸€å®šè¦ç”¨<code>åŒå¼•å·</code>è€Œä¸æ˜¯å•å¼•å·ï¼Œä¼šæŠ¥é”™ï¼</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserLike"</span> <span class="attr">resultType</span>=<span class="string">"com.yqx.pojo.User"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where name like "%"#{value}"%"</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>test</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test7</span><span class="params">()</span></span>{</span><br><span class="line">    SqlSession sqlSession = MyBatisUtil.getSession();</span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    System.out.println(mapper.findUserLike(<span class="string">"å¤©"</span>));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ–¹æ³•äºŒ</strong></p>
<p>ä¹Ÿå¯ä»¥å°† <strong>%</strong> æ”¾åœ¨å‚æ•°é‡Œ</p>
<p> mapper.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserLike"</span> <span class="attr">resultType</span>=<span class="string">"com.yqx.pojo.User"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user where name like #{value}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>test</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test7</span><span class="params">()</span></span>{</span><br><span class="line">    SqlSession sqlSession = MyBatisUtil.getSession();</span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    System.out.println(mapper.findUserLike(<span class="string">"%å¤©%"</span>));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="4ã€é…ç½®"><a href="#4ã€é…ç½®" class="headerlink" title="4ã€é…ç½®"></a>4ã€é…ç½®</h2><h4 id="4-1ã€æ ¸å¿ƒé…ç½®å±æ€§"><a href="#4-1ã€æ ¸å¿ƒé…ç½®å±æ€§" class="headerlink" title="4.1ã€æ ¸å¿ƒé…ç½®å±æ€§"></a>4.1ã€æ ¸å¿ƒé…ç½®å±æ€§</h4><ul>
<li>mybatis-config.xml</li>
<li>Mybatis çš„é…ç½®æ–‡ä»¶åŒ…å«äº†ä¼šæ·±æ·±å½±å“ Mybatis è¡Œä¸ºçš„è®¾ç½®å’Œå±æ€§ä¿¡æ¯ã€‚</li>
<li>å†™çš„æ—¶å€™æŒ‰ç…§ä¸‹é¢çš„<code>é¡ºåº</code>ï¼Œæœ‰<code>é¡ºåº</code>ä¹‹åˆ†ï¼ï¼ï¼</li>
</ul>
<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">configurationï¼ˆé…ç½®ï¼‰</span><br><span class="line">propertiesï¼ˆå±æ€§ï¼‰</span><br><span class="line">settingsï¼ˆè®¾ç½®ï¼‰</span><br><span class="line">typeAliasesï¼ˆç±»å‹åˆ«åï¼‰</span><br><span class="line">typeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰</span><br><span class="line">objectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰</span><br><span class="line">pluginsï¼ˆæ’ä»¶ï¼‰</span><br><span class="line">environmentsï¼ˆç¯å¢ƒé…ç½®ï¼‰</span><br><span class="line">environmentï¼ˆç¯å¢ƒå˜é‡ï¼‰</span><br><span class="line">transactionManagerï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰</span><br><span class="line">dataSourceï¼ˆæ•°æ®æºï¼‰</span><br><span class="line">databaseIdProviderï¼ˆæ•°æ®åº“å‚å•†æ ‡è¯†ï¼‰</span><br><span class="line">mappersï¼ˆæ˜ å°„å™¨ï¼‰</span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-2ã€ç¯å¢ƒé…ç½®ï¼ˆenvironmentï¼‰"><a href="#4-2ã€ç¯å¢ƒé…ç½®ï¼ˆenvironmentï¼‰" class="headerlink" title="4.2ã€ç¯å¢ƒé…ç½®ï¼ˆenvironmentï¼‰"></a>4.2ã€ç¯å¢ƒé…ç½®ï¼ˆenvironmentï¼‰</h4><p>Mybatis å¯ä»¥é…ç½®å¤šå¥—ç¯å¢ƒï¼Œä½†æ¯ä¸ª SqlSessionFactory å®ä¾‹åªèƒ½é€‰æ‹©ä¸€ç§ç¯å¢ƒã€‚</p>
<p>Mybatis é»˜è®¤çš„äº‹åŠ¡ç®¡ç†å™¨å°±æ˜¯ <strong>JDBC</strong>ï¼Œè¿æ¥æ±  <strong>POOLED</strong>ã€‚</p>
<h4 id="4-3ã€å±æ€§ï¼ˆpropertiesï¼‰"><a href="#4-3ã€å±æ€§ï¼ˆpropertiesï¼‰" class="headerlink" title="4.3ã€å±æ€§ï¼ˆpropertiesï¼‰"></a>4.3ã€å±æ€§ï¼ˆpropertiesï¼‰</h4><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <strong>properties</strong> å±æ€§æ¥å¼•ç”¨é…ç½®æ–‡ä»¶ã€‚</p>
<p>è¿™äº›å±æ€§å¯ä»¥åœ¨å¤–éƒ¨è¿›è¡Œé…ç½®ï¼Œå¹¶å¯ä»¥è¿›è¡ŒåŠ¨æ€æ›¿æ¢ã€‚ä½ æ—¢å¯ä»¥åœ¨å…¸å‹çš„ Java å±æ€§æ–‡ä»¶ä¸­é…ç½®è¿™äº›å±æ€§ï¼Œä¹Ÿå¯ä»¥åœ¨ properties å…ƒç´ çš„å­å…ƒç´ ä¸­è®¾ç½®ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sql_driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sql_url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>db.properties</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">username</span> = <span class="string">root</span></span><br><span class="line"><span class="attr">pwd</span> = <span class="string">123456</span></span><br></pre></td></tr></tbody></table></figure>
<p><code>è‹¥æœ‰ä¸¤è€…æœ‰å†²çªï¼Œä¼šä¼˜å…ˆä½¿ç”¨ properties æ–‡ä»¶ä¸­çš„å€¼ã€‚</code></p>
<p>è®¾ç½®å®Œåå¯ä»¥åœ¨æ•´ä¸ªé…ç½®æ–‡ä»¶ä¸­æ›¿æ¢éœ€è¦åŠ¨æ€é…ç½®çš„å±æ€§å€¼ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"${sql_driver}"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"${sql_url}"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"${username}"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"${pwd}"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-3ã€ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰"><a href="#4-3ã€ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰" class="headerlink" title="4.3ã€ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰"></a>4.3ã€ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰</h4><p>ç±»å‹åˆ«åå¯ä¸º Java ç±»å‹è®¾ç½®ä¸€ä¸ªç¼©å†™åå­—ã€‚ å®ƒä»…ç”¨äº XML é…ç½®ï¼Œæ„åœ¨é™ä½å†—ä½™çš„å…¨é™å®šç±»åä¹¦å†™ã€‚</p>
<p><strong>æ–¹æ³•ä¸€ï¼šç›´æ¥è®¾ç½®åˆ«å</strong></p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">type</span>=<span class="string">"com.yqx.pojo.User"</span> <span class="attr">alias</span>=<span class="string">"User"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>å½“è¿™æ ·é…ç½®æ—¶ï¼Œ<code>User</code> å¯ä»¥ç”¨åœ¨ä»»ä½•ä½¿ç”¨ <code>com.yqx.pojo.User</code> çš„åœ°æ–¹ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAllUsers"</span> <span class="attr">resultType</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ–¹æ³•äºŒï¼šæ‰«æåŒ…</strong></p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.yqx.pojo"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>é»˜è®¤åˆ«åæ˜¯ç±»åã€‚ï¼ˆå¤§å°å†™æ— æ‰€è°“ï¼‰</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAllUsers"</span> <span class="attr">resultType</span>=<span class="string">"uSer"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>å¯ä»¥æ·»åŠ æ³¨è§£ @Alias æ¥æ›´æ”¹åˆ«åã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Alias("userAlias")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAllUsers"</span> <span class="attr">resultType</span>=<span class="string">"userAlias"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-4ã€è®¾ç½®ï¼ˆsettingsï¼‰"><a href="#4-4ã€è®¾ç½®ï¼ˆsettingsï¼‰" class="headerlink" title="4.4ã€è®¾ç½®ï¼ˆsettingsï¼‰"></a>4.4ã€è®¾ç½®ï¼ˆsettingsï¼‰</h4><p>è®¾ç½®å†…å®¹å¾ˆå¤šï¼Œè¿™é‡ŒåªæŒ‘é‡è¦çš„è®°å½•ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">è®¾ç½®å</th>
<th style="text-align:left">æè¿°</th>
<th style="text-align:left">æœ‰æ•ˆå€¼</th>
<th style="text-align:left">é»˜è®¤å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">cacheEnabled</td>
<td style="text-align:left">å…¨å±€æ€§åœ°å¼€å¯æˆ–å…³é—­æ‰€æœ‰æ˜ å°„å™¨é…ç½®æ–‡ä»¶ä¸­å·²é…ç½®çš„ä»»ä½•ç¼“å­˜ã€‚</td>
<td style="text-align:left">true \</td>
<td style="text-align:left">false</td>
<td>true</td>
</tr>
<tr>
<td style="text-align:left">lazyLoadingEnabled</td>
<td style="text-align:left">å»¶è¿ŸåŠ è½½çš„å…¨å±€å¼€å…³ã€‚å½“å¼€å¯æ—¶ï¼Œæ‰€æœ‰å…³è”å¯¹è±¡éƒ½ä¼šå»¶è¿ŸåŠ è½½ã€‚ ç‰¹å®šå…³è”å…³ç³»ä¸­å¯é€šè¿‡è®¾ç½® <code>fetchType</code> å±æ€§æ¥è¦†ç›–è¯¥é¡¹çš„å¼€å…³çŠ¶æ€ã€‚</td>
<td style="text-align:left">true \</td>
<td style="text-align:left">false</td>
<td>false</td>
</tr>
<tr>
<td style="text-align:left">logImpl</td>
<td style="text-align:left">æŒ‡å®š MyBatis æ‰€ç”¨æ—¥å¿—çš„å…·ä½“å®ç°ï¼ŒæœªæŒ‡å®šæ—¶å°†è‡ªåŠ¨æŸ¥æ‰¾ã€‚</td>
<td style="text-align:left">SLF4J \</td>
<td style="text-align:left">LOG4J \</td>
<td>LOG4J2 \</td>
<td>JDK_LOGGING \</td>
<td>COMMONS_LOGGING \</td>
<td>STDOUT_LOGGING \</td>
<td>NO_LOGGING</td>
<td>æœªè®¾ç½®</td>
</tr>
</tbody>
</table>
</div>
<h4 id="4-5ã€æ˜ å°„å™¨ï¼ˆmappersï¼‰"><a href="#4-5ã€æ˜ å°„å™¨ï¼ˆmappersï¼‰" class="headerlink" title="4.5ã€æ˜ å°„å™¨ï¼ˆmappersï¼‰"></a>4.5ã€æ˜ å°„å™¨ï¼ˆmappersï¼‰</h4><p>æ—¢ç„¶ MyBatis çš„è¡Œä¸ºå·²ç»ç”±ä¸Šè¿°å…ƒç´ é…ç½®å®Œäº†ï¼Œæˆ‘ä»¬ç°åœ¨å°±è¦æ¥å®šä¹‰ SQL æ˜ å°„è¯­å¥äº†ã€‚ ä½†é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰ MyBatis åˆ°å“ªé‡Œå»æ‰¾åˆ°è¿™äº›è¯­å¥ã€‚</p>
<p><strong>1. ä½¿ç”¨ç›¸å¯¹äºç±»è·¯å¾„çš„èµ„æºå¼•ç”¨</strong></p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/yqx/mapper/AuthorMapper.xml"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/yqx/mapper/BlogMapper.xml"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"com/yqx/mapper/PostMapper.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>2. ä½¿ç”¨æ˜ å°„å™¨æ¥å£å®ç°ç±»çš„å®Œå…¨é™å®šç±»åï¼‰</strong></p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.yqx.mapper.AuthorMapper"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.yqx.mapper.BlogMapper"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">class</span>=<span class="string">"com.yqx.mapper.PostMapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>3. å°†åŒ…å†…çš„æ˜ å°„å™¨æ¥å£å®ç°å…¨éƒ¨æ³¨å†Œä¸ºæ˜ å°„å™¨</strong></p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.yqx.mapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ³¨ï¼šç¬¬2ã€3ç§æ–¹æ³•å¿…é¡»éµå®ˆä¸‹è¿°è§„èŒƒ</p>
<ul>
<li>æ¥å£å’Œ mapper é…ç½®æ–‡ä»¶å¿…é¡»åŒåï¼</li>
<li>æ¥å£å’Œ mapper é…ç½®æ–‡ä»¶å¿…é¡»åœ¨åŒä¸€ä¸ªåŒ…ä¸‹ï¼</li>
</ul>
<h2 id="5ã€ç”Ÿå‘½å‘¨æœŸ"><a href="#5ã€ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="5ã€ç”Ÿå‘½å‘¨æœŸ"></a>5ã€ç”Ÿå‘½å‘¨æœŸ</h2><p><img src="https://z3.ax1x.com/2021/10/19/50esmQ.png" alt=""></p>
<p>ä¸åŒä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸç±»åˆ«æ˜¯è‡³å…³é‡è¦çš„ï¼Œå› ä¸ºé”™è¯¯çš„ä½¿ç”¨ä¼šå¯¼è‡´éå¸¸ä¸¥é‡çš„<code>å¹¶å‘</code>é—®é¢˜ã€‚</p>
<p><strong>SqlSessionFactoryBuilder</strong></p>
<ul>
<li>ä¸€æ—¦åˆ›å»ºäº† SqlSessionFactroyï¼Œå°±ä¸å†éœ€è¦å®ƒäº†ã€‚ï¼ˆå¦¥å¦¥çš„å·¥å…·äººï¼‰</li>
<li>å±€éƒ¨å˜é‡</li>
</ul>
<p><strong>SqlSessionFactory</strong></p>
<ul>
<li>å¯ä»¥ç†è§£ä¸ºæ•°æ®åº“è¿æ¥æ± ã€‚</li>
<li>ä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´<code>å­˜åœ¨</code>ï¼Œæ²¡æœ‰ä»»ä½•ç†ç”±ä¸¢å¼ƒå®ƒæˆ–é‡æ–°åˆ›å»ºå¦ä¸€ä¸ªå®ä¾‹ã€‚</li>
<li>æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸï¼ˆapplicationï¼‰ã€‚</li>
<li>å»ºè®®ä½¿ç”¨<code>å•ä¾‹æ¨¡å¼</code>æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼ã€‚</li>
</ul>
<p><strong>SqlSession</strong></p>
<ul>
<li>æ¯ä¸ªçº¿ç¨‹éƒ½åº”è¯¥æœ‰å®ƒè‡ªå·±çš„ SqlSession å®ä¾‹ã€‚</li>
<li>SqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„ï¼Œæ‰€ä»¥å®ƒçš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸã€‚</li>
<li>ç”¨å®Œä¹‹åå¿…é¡»å…³é—­ï¼Œå¦åˆ™èµ„æºä¼šè¢«å ç”¨ï¼</li>
</ul>
<h2 id="6ã€ç»“æœé›†æ˜ å°„ï¼ˆResultMapï¼‰"><a href="#6ã€ç»“æœé›†æ˜ å°„ï¼ˆResultMapï¼‰" class="headerlink" title="6ã€ç»“æœé›†æ˜ å°„ï¼ˆResultMapï¼‰"></a>6ã€ç»“æœé›†æ˜ å°„ï¼ˆResultMapï¼‰</h2><p>ç”¨äºè§£å†³å®ä½“ç±»å­—æ®µå’Œ Sql å­—æ®µä¸åŒ¹é…çš„é—®é¢˜ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/19/50QuYd.png" alt=""></p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ­£å¸¸sql--&gt;</span></span><br><span class="line">select * from mybatis.user</span><br><span class="line"><span class="comment">&lt;!--å®Œæ•´sql--&gt;</span></span><br><span class="line">select id, name, age from mybatis.user</span><br></pre></td></tr></tbody></table></figure>
<p>å¯æ˜¯ User çš„å±æ€§åªæœ‰ id,userName å’Œ userAgeï¼Œå› æ­¤å†è¿”å›ç»“æœçš„æ—¶å€™å°±ä¼šå‡ºç°å±æ€§æ— æ³•åŒ¹é…è€Œæ˜¯ç”¨é»˜è®¤å€¼çš„é—®é¢˜ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°æŸ¥è¯¢å‡ºæ¥çš„ User æ²¡æœ‰ userName å’Œ userAge çš„å€¼ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">[User{id=<span class="number">5</span>, userName=<span class="string">'null'</span>, userAge=<span class="number">0</span>}, User{id=<span class="number">7</span>, userName=<span class="string">'null'</span>, userAge=<span class="number">0</span>}, User{id=<span class="number">34</span>, userName=<span class="string">'null'</span>, userAge=<span class="number">0</span>}, User{id=<span class="number">4</span>, userName=<span class="string">'null'</span>, userAge=<span class="number">0</span>}, User{id=<span class="number">35</span>, userName=<span class="string">'null'</span>, userAge=<span class="number">0</span>}, User{id=<span class="number">33</span>, userName=<span class="string">'null'</span>, userAge=<span class="number">0</span>}]</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<p>è§£å†³æ–¹æ³•æœ‰äºŒã€‚</p>
<p><strong>å…¶ä¸€ï¼šä½¿ç”¨æŒ‡å®šåˆ—å</strong></p>
<p>è¿™æ ·å°±èƒ½å’Œå®ä½“ç±»çš„å­—æ®µåå¯¹åº”èµ·æ¥äº†ã€‚</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> id, name userName, age userAge <span class="keyword">from</span> mybatis.user</span><br></pre></td></tr></tbody></table></figure>
<p><strong>å…¶äºŒï¼šResultMap</strong></p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--åˆ›å»ºresultMap,åªéœ€è¦æ˜ å°„å’Œsqlå­—æ®µä¸åŒå±æ€§å³å¯--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"userMap"</span> <span class="attr">type</span>=<span class="string">"userAlias"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"name"</span> <span class="attr">property</span>=<span class="string">"userName"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"age"</span> <span class="attr">property</span>=<span class="string">"userAge"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--å¼•ç”¨resultMap--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAllUsers"</span> <span class="attr">resultType</span>=<span class="string">"userAlias"</span> <span class="attr">resultMap</span>=<span class="string">"userMap"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><p><code>resultMap</code> å…ƒç´ æ˜¯ MyBatis ä¸­æœ€é‡è¦æœ€å¼ºå¤§çš„å…ƒç´ ã€‚</p>
</li>
<li><p>ResultMap çš„è®¾è®¡æ€æƒ³æ˜¯ï¼Œå¯¹ç®€å•çš„è¯­å¥åšåˆ°é›¶é…ç½®ï¼Œå¯¹äºå¤æ‚ä¸€ç‚¹çš„è¯­å¥ï¼Œåªéœ€è¦æè¿°è¯­å¥ä¹‹é—´çš„å…³ç³»å°±è¡Œäº†ã€‚</p>
</li>
</ul>
<h2 id="7ã€æ—¥å¿—"><a href="#7ã€æ—¥å¿—" class="headerlink" title="7ã€æ—¥å¿—"></a>7ã€æ—¥å¿—</h2><p>Mybatis é€šè¿‡ä½¿ç”¨å†…ç½®çš„æ—¥å¿—å·¥å‚æä¾›æ—¥å¿—åŠŸèƒ½ã€‚å†…ç½®æ—¥å¿—å·¥å‚å°†ä¼šæŠŠæ—¥å¿—å·¥ä½œå§”æ‰˜ç»™ä¸‹é¢çš„å®ç°ä¹‹ä¸€ã€‚</p>
<ul>
<li><p>SLF4J</p>
</li>
<li><p>Apache Commons Logging</p>
</li>
<li><p>Log4j 2</p>
</li>
<li><p>Log4j   ã€æŒæ¡ã€‘</p>
</li>
<li><p>JDK logging</p>
</li>
<li><p>STDOUT_LOGGING   ã€æŒæ¡ã€‘</p>
</li>
</ul>
<p>åœ¨ mybatis-config.xml çš„ <code>setting</code> ä¸­è®¾ç½®ã€‚</p>
<p>å¯é€‰çš„å€¼æœ‰ï¼šSLF4Jã€LOG4Jã€LOG4J2ã€JDK_LOGGINGã€COMMONS_LOGGINGã€STDOUT_LOGGINGã€NO_LOGGINGï¼Œæˆ–è€…æ˜¯å®ç°äº† <code>org.apache.ibatis.logging.Log</code> æ¥å£ï¼Œä¸”æ„é€ æ–¹æ³•ä»¥å­—ç¬¦ä¸²ä¸ºå‚æ•°çš„ç±»å®Œå…¨é™å®šåã€‚</p>
<p>ä¸€å®šè¦<code>ä¸¥æ ¼æŒ‰ç…§</code>ä¸Šè¿°å¯é€‰å€¼ï¼Œå¤§å°å†™é”™è¯¯äº¦æˆ–æ˜¯å¤šäº†ç©ºæ ¼éƒ½ä¼šæŠ¥é”™ï¼</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"LOG4J"</span>/&gt;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="7-1ã€STDOUT-LOGGING"><a href="#7-1ã€STDOUT-LOGGING" class="headerlink" title="7.1ã€STDOUT_LOGGING"></a>7.1ã€STDOUT_LOGGING</h4><p>æ ‡å‡†æ—¥å¿—ï¼Œä¸ªäººå¼ºæ¨ï¼ååˆ†æ–¹ä¾¿ï¼Œé…ç½®å®Œäº†å°±å¯ä»¥ä½¿ç”¨ã€‚æ•ˆæœå¦‚ä¸‹ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"STDOUT_LOGGING"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/10/19/508uHf.png" alt=""></p>
<h4 id="7-2ã€Log4j"><a href="#7-2ã€Log4j" class="headerlink" title="7.2ã€Log4j"></a>7.2ã€Log4j</h4><p><strong>ä»€ä¹ˆæ˜¯Log4j ï¼Ÿ</strong></p>
<ul>
<li>å¯ä»¥æ§åˆ¶æ—¥å¿—ä¿¡æ¯è¾“é€çš„ç›®çš„åœ°æ˜¯æ§åˆ¶å°ã€æ–‡ä»¶ã€GUIç»„ä»¶ï¼Œç”šè‡³æ˜¯å¥—æ¥å£æœåŠ¡å™¨ã€NTçš„äº‹ä»¶è®°å½•å™¨ã€UNIX Syslogå®ˆæŠ¤è¿›ç¨‹ç­‰ã€‚</li>
<li>å¯ä»¥æ§åˆ¶æ¯ä¸€æ¡æ—¥å¿—çš„è¾“å‡ºæ ¼å¼ã€‚</li>
<li>é€šè¿‡å®šä¹‰æ¯ä¸€æ¡æ—¥å¿—ä¿¡æ¯çš„çº§åˆ«ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ ç»†è‡´åœ°æ§åˆ¶æ—¥å¿—çš„ç”Ÿæˆè¿‡ç¨‹ã€‚</li>
<li>å¯ä»¥é€šè¿‡ä¸€ä¸ªé…ç½®æ–‡ä»¶æ¥çµæ´»åœ°è¿›è¡Œé…ç½®ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹åº”ç”¨çš„ä»£ç ã€‚</li>
</ul>
<p>å…ˆå¯¼å…¥ä¾èµ–ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>è®¾ç½®æ—¥å¿—å®ç°ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"logImpl"</span> <span class="attr">value</span>=<span class="string">"LOG4J"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>åˆ›å»º <code>log4j.properties</code>ï¼Œå¯å®šåˆ¶åŒ–æ‰“å°å†…å®¹ã€‚</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">#å°†ç­‰çº§ä¸ºDEBUGçš„æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°consoleå’Œfileè¿™ä¸¤ä¸ªç›®çš„åœ°ï¼Œconsoleå’Œfileçš„å®šä¹‰åœ¨ä¸‹é¢çš„ä»£ç </span></span><br><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">DEBUG,console,file</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#æ§åˆ¶å°è¾“å‡ºçš„ç›¸å…³è®¾ç½®</span></span><br><span class="line"><span class="meta">log4j.appender.console</span> = <span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.console.Target</span> = <span class="string">System.out</span></span><br><span class="line"><span class="meta">log4j.appender.console.Threshold</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout.ConversionPattern</span>=<span class="string">[%c]-%m%n</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#æ–‡ä»¶è¾“å‡ºçš„ç›¸å…³è®¾ç½®</span></span><br><span class="line"><span class="meta">log4j.appender.file</span> = <span class="string">org.apache.log4j.RollingFileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.file.File</span>=<span class="string">./log/kuang.log</span></span><br><span class="line"><span class="meta">log4j.appender.file.MaxFileSize</span>=<span class="string">10mb</span></span><br><span class="line"><span class="meta">log4j.appender.file.Threshold</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout.ConversionPattern</span>=<span class="string">[%p][%d{yy-MM-dd}][%c]%m%n</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#æ—¥å¿—è¾“å‡ºçº§åˆ«</span></span><br><span class="line"><span class="meta">log4j.logger.org.mybatis</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.Statement</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.ResultSet</span>=<span class="string">DEBUG</span></span><br><span class="line"><span class="meta">log4j.logger.java.sql.PreparedStatement</span>=<span class="string">DEBUG</span></span><br></pre></td></tr></tbody></table></figure>
<p>ä¹‹åä¾¿èƒ½ä½¿ç”¨äº†ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/20/508jIS.png" alt=""></p>
<p>ä¹Ÿå¯ä»¥åˆ›å»º <code>Logger</code> å¯¹è±¡ï¼Œæ‰‹åŠ¨æ‰“å°ä¿¡æ¯ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MapperTest</span></span>{</span><br><span class="line">    <span class="keyword">static</span> Logger logger = Logger.getLogger(MapperTest.class);</span><br><span class="line">    </span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span></span>{</span><br><span class="line">        logger.info(<span class="string">"æˆ‘æ˜¯æç¤ºä¿¡æ¯ã€‚"</span>);</span><br><span class="line">        logger.debug(<span class="string">"æˆ‘æ˜¯æµ‹è¯•ä¿¡æ¯ã€‚"</span>);</span><br><span class="line">        logger.warn(<span class="string">"æˆ‘æ˜¯è­¦å‘Šä¿¡æ¯ï¼"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="8ã€åˆ†é¡µ"><a href="#8ã€åˆ†é¡µ" class="headerlink" title="8ã€åˆ†é¡µ"></a>8ã€åˆ†é¡µ</h2><h4 id="8-1ã€Limit-åˆ†é¡µï¼ˆå»ºè®®ï¼‰"><a href="#8-1ã€Limit-åˆ†é¡µï¼ˆå»ºè®®ï¼‰" class="headerlink" title="8.1ã€Limit åˆ†é¡µï¼ˆå»ºè®®ï¼‰"></a>8.1ã€Limit åˆ†é¡µï¼ˆå»ºè®®ï¼‰</h4><p>æ·»åŠ æ¥å£æ–¹æ³•</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function">List&lt;User&gt; <span class="title">findUserLimit</span><span class="params">(Map map)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸ºè¯¥æ–¹æ³•è®¾ç½® sql è¯­å¥</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserLimit"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user limit #{start}, #{offset}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>{</span><br><span class="line">    SqlSession sqlSession = MyBatisUtil.getSession();</span><br><span class="line">    UserMapper mapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line">    Map&lt;String, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">"start"</span>, <span class="number">1</span>);</span><br><span class="line">    map.put(<span class="string">"offset"</span>, <span class="number">3</span>);</span><br><span class="line">    System.out.println(mapper.findUserLimit(map));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="8-2ã€RowBounds-åˆ†é¡µ"><a href="#8-2ã€RowBounds-åˆ†é¡µ" class="headerlink" title="8.2ã€RowBounds åˆ†é¡µ"></a>8.2ã€RowBounds åˆ†é¡µ</h4><p>æ·»åŠ æ¥å£æ–¹æ³•</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function">List&lt;User&gt; <span class="title">findUserRowBounds</span><span class="params">(Map map)</span></span>;</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸ºè¯¥æ–¹æ³•è®¾ç½® sql è¯­å¥</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserRowBounds"</span> <span class="attr">resultType</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">    select * from mybatis.user</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>{</span><br><span class="line">    SqlSession sqlSession = MyBatisUtil.getSession();</span><br><span class="line">    List&lt;User&gt; userList = sqlSession.selectList(<span class="string">"com.yqx.mapper.UserMapper.findUserRowBounds"</span>, </span><br><span class="line">                                                <span class="keyword">null</span>, </span><br><span class="line">                                                <span class="keyword">new</span> RowBounds(<span class="number">1</span>, <span class="number">3</span>));</span><br><span class="line">    System.out.println(userList);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="9ã€æ³¨è§£"><a href="#9ã€æ³¨è§£" class="headerlink" title="9ã€æ³¨è§£"></a>9ã€æ³¨è§£</h2><p>ä½¿ç”¨æ³¨è§£å¯ä»¥çœå» <code>mapper.xml</code> è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ‰€æœ‰ sql è¯­å¥éƒ½å†™åœ¨æ³¨è§£ä¸­å³å¯ï¼Œä½†æ— æ³•èƒœä»»å¤æ‚çš„ sql è¯­å¥ä¹Ÿä¸èƒ½ä½¿ç”¨ <code>ResultMap</code> ç­‰åŠŸèƒ½ã€‚</p>
<h4 id="9-1ã€-CRUD"><a href="#9-1ã€-CRUD" class="headerlink" title="9.1ã€ CRUD"></a>9.1ã€ CRUD</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yqx.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.*;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>{</span><br><span class="line">    <span class="meta">@Select("select * from mybatis.user")</span></span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">findAllUsers</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select("select * from user where id = #{id}")</span></span><br><span class="line">    <span class="function">User <span class="title">findUserById</span><span class="params">(<span class="meta">@Param("id")</span> <span class="keyword">int</span> user_id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Delete("delete from user where id = #{id}")</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">deleteUserById</span><span class="params">(<span class="meta">@Param("id")</span> <span class="keyword">int</span> user_id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Update("update user set name = #{name}, age = #{age} where id = #{id}")</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">updateUser</span><span class="params">(User user)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Insert("insert into user(name, age) values(#{name}, #{age})")</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>@Param å¯ä»¥æŒ‡å®šè¾“å…¥å‚æ•°åå­—ã€‚</p>
          </div>
<h4 id="9-2ã€æ³¨æ„"><a href="#9-2ã€æ³¨æ„" class="headerlink" title="9.2ã€æ³¨æ„"></a>9.2ã€æ³¨æ„</h4><p>åœ¨ <code>mybatis-config.xml</code> ä¸­ï¼Œä¸èƒ½ä½¿ç”¨ <code>resource</code> æ¥å¼•å…¥ mapper.xml æ–‡ä»¶ï¼Œæ¯•ç«Ÿæ²¡æœ‰äº†å˜›ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ä¸‹è¿°ä»»é€‰å…¶ä¸€--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;mapper class="com.yqx.mapper.UserMapper"/&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.yqx.mapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="10ã€Mybatis-çš„å·¥ä½œåŸç†"><a href="#10ã€Mybatis-çš„å·¥ä½œåŸç†" class="headerlink" title="10ã€Mybatis çš„å·¥ä½œåŸç†"></a>10ã€Mybatis çš„å·¥ä½œåŸç†</h2><p><img src="https://z3.ax1x.com/2021/10/30/5vOd81.png" alt=""></p>
<p>ï¼ˆ1ï¼‰è¯»å– MyBatis é…ç½®æ–‡ä»¶ mybatis-config.xmlã€‚mybatis-config.xml ä½œä¸ºMyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ï¼Œé…ç½®äº†MyBatis çš„è¿è¡Œç¯å¢ƒç­‰ä¿¡æ¯ï¼Œå…¶ä¸­ä¸»è¦å†…å®¹æ˜¯<code>è·å–æ•°æ®åº“è¿æ¥</code>ã€‚</p>
<p>ï¼ˆ2ï¼‰åŠ è½½æ˜ å°„æ–‡ä»¶Mapper.xmlã€‚Mapper.xml æ–‡ä»¶å³SQLæ˜ å°„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸­é…ç½®äº†æ“ä½œæ•°æ®åº“çš„SQLè¯­å¥ï¼Œéœ€è¦åœ¨mybatis-config.xml ä¸­åŠ è½½æ‰èƒ½æ‰§è¡Œã€‚mybatis-config.xml å¯ä»¥åŠ è½½å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œæ¯ä¸ªé…ç½®æ–‡ä»¶å¯¹åº”æ•°æ®åº“ä¸­çš„ä¸€å¼ è¡¨ã€‚</p>
<p>ï¼ˆ3ï¼‰æ„å»ºä¼šè¯å·¥å‚ã€‚é€šè¿‡MyBatisçš„ç¯å¢ƒç­‰é…ç½®ä¿¡æ¯æ„å»ºä¼šè¯å·¥å‚SqlSessionFactoryã€‚</p>
<p>ï¼ˆ4ï¼‰åˆ›å»ºSqlSessionå¯¹è±¡ã€‚ç”±ä¼šè¯å·¥å‚åˆ›å»º SqlSessionå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­åŒ…å«äº†æ‰§è¡Œ SQLçš„æ‰€æœ‰æ–¹æ³•ã€‚</p>
<p>ï¼ˆ5ï¼‰MyBatisåº•å±‚å®šä¹‰äº†ä¸€ä¸ªExecutor æ¥å£æ¥æ“ä½œæ•°æ®åº“ï¼Œå®ƒä¼šæ ¹æ®SqlSessionä¼ é€’çš„å‚æ•°<strong>åŠ¨æ€åœ°ç”Ÿæˆéœ€è¦æ‰§è¡Œçš„SQLè¯­å¥</strong>ï¼ŒåŒæ—¶è´Ÿè´£æŸ¥è¯¢ç¼“å­˜çš„ç»´æŠ¤ã€‚</p>
<p>ï¼ˆ6ï¼‰åœ¨Executoræ¥å£çš„æ‰§è¡Œæ–¹æ³•ä¸­ï¼ŒåŒ…å«ä¸€ä¸ª MappedStatementç±»å‹çš„å‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯<strong>å¯¹æ˜ å°„ä¿¡æ¯çš„å°è£…</strong>ï¼Œç”¨äºå­˜å‚¨è¦æ˜ å°„çš„SOLè¯­å¥çš„idã€å‚æ•°ç­‰ã€‚Mapper.xmI æ–‡ä»¶ä¸­ä¸€ä¸ªSQLå¯¹åº”ä¸€ä¸ªMappedStatementå¯¹è±¡,SOLçš„idå³æ˜¯MappedStatement çš„idã€‚</p>
<p>ï¼ˆ7ï¼‰è¾“å…¥å‚æ•°æ˜ å°„ã€‚åœ¨æ‰§è¡Œæ–¹æ³•æ—¶ï¼ŒMappedStatementå¯¹è±¡ä¼šå¯¹ç”¨æˆ·æ‰§è¡Œ SQLè¯­å¥çš„è¾“å…¥å‚æ•°è¿›è¡Œå®šä¹‰(å¯ä»¥å®šä¹‰ä¸ºMapã€Listç±»å‹ã€åŸºæœ¬ç±»å‹å’ŒPOJOç±»å‹)ï¼ŒExecutoræ‰§è¡Œå™¨ä¼šé€šè¿‡MappedStatementå¯¹è±¡åœ¨æ‰§è¡ŒSQLå‰ï¼Œ<strong>å°†è¾“å…¥çš„Javaå¯¹è±¡æ˜ å°„åˆ°SQLè¯­å¥ä¸­</strong>ã€‚è¿™é‡Œå¯¹è¾“å…¥å‚æ•°çš„æ˜ å°„è¿‡ç¨‹å°±ç±»ä¼¼äºJDBC ç¼–ç¨‹ä¸­å¯¹preparedStatementå¯¹è±¡è®¾ç½®å‚æ•°çš„è¿‡ç¨‹ã€‚</p>
<p>ï¼ˆ8ï¼‰è¾“å‡ºç»“æœæ˜ å°„ã€‚åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œå®ŒSQLè¯­å¥åï¼ŒMappedStatementå¯¹è±¡ä¼šå¯¹SQLæ‰§è¡Œè¾“å‡ºçš„ç»“æœè¿›è¡Œå®šä¹‰(å¯ä»¥å®šä¹‰ä¸ºMapå’ŒListç±»å‹ã€åŸºæœ¬ç±»å‹ã€POJOç±»å‹)ï¼ŒExecutor æ‰§è¡Œå™¨ä¼šé€šè¿‡MappedStatementå¯¹è±¡åœ¨æ‰§è¡ŒSQLè¯­å¥åï¼Œ<strong>å°†è¾“å‡ºç»“æœæ˜ å°„è‡³Javaå¯¹è±¡ä¸­</strong>ã€‚è¿™ç§å°†è¾“å‡ºç»“æœæ˜ å°„åˆ°Javaå¯¹è±¡çš„è¿‡ç¨‹å°±ç±»ä¼¼äºJDBCç¼–ç¨‹ä¸­å¯¹ç»“æœçš„è§£æå¤„ç†è¿‡ç¨‹ã€‚</p>
<h2 id="11ã€å¤šå¯¹ä¸€æŸ¥è¯¢"><a href="#11ã€å¤šå¯¹ä¸€æŸ¥è¯¢" class="headerlink" title="11ã€å¤šå¯¹ä¸€æŸ¥è¯¢"></a>11ã€å¤šå¯¹ä¸€æŸ¥è¯¢</h2><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å­¦ä¼šäº†æ•°æ®åº“çš„åŸºç¡€æŸ¥è¯¢ï¼Œä½†é‚£å„¿ä¹Ÿåªæ˜¯ä¸ªå¼€å§‹ï¼ŒçœŸå®çš„æƒ…å†µè¿œè¿œå¯æ¯”å•è¡¨æŸ¥è¯¢å¤æ‚å¾—å¤šã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/30/5xuxQx.png" alt=""></p>
<ul>
<li>å¤šä¸ªå­¦ç”Ÿï¼Œå¯¹åº”ä¸€ä¸ªè€å¸ˆ</li>
<li>å¯¹äºå­¦ç”Ÿï¼Œ<code>å…³è”</code>ï¼Œå¤šä¸ªå­¦ç”Ÿï¼Œå…³è”å¤šä¸ªå­¦ç”Ÿ  ã€å¤šå¯¹ä¸€ã€‘</li>
<li>å¯¹äºè€å¸ˆï¼Œ<code>é›†åˆ</code>ï¼Œä¸€ä¸ªè€å¸ˆï¼Œæ‹¥æœ‰å¾ˆå¤šå­¦ç”Ÿ  ã€ä¸€å¯¹å¤šã€‘</li>
</ul>
<p>å…ˆåˆ›å»ºæ•°æ®è¡¨</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `teacher` (</span><br><span class="line">  `id` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `name` <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> teacher(`id`, `name`) <span class="keyword">VALUES</span> (<span class="number">1</span>, ç§¦è€å¸ˆ); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> teacher(`id`, `name`) <span class="keyword">VALUES</span> (<span class="number">2</span>, ä½™è€å¸ˆ); </span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `student` (</span><br><span class="line">  `id` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `name` <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `tid` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  KEY `fktid` (`tid`),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> `fktid` <span class="keyword">FOREIGN</span> KEY (`tid`) <span class="keyword">REFERENCES</span> `teacher` (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="number">1</span>, å°æ˜, <span class="number">1</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="number">2</span>, å°çº¢, <span class="number">2</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="number">3</span>, å°å¼ , <span class="number">1</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="number">4</span>, å°æ, <span class="number">2</span>); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student` (`id`, `name`, `tid`) <span class="keyword">VALUES</span> (<span class="number">5</span>, å°ç‹, <span class="number">1</span>);</span><br></pre></td></tr></tbody></table></figure>
<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¦æŸ¥è¯¢ä¸€ä¸ªå­¦ç”Ÿçš„ idï¼Œname å’Œ è€å¸ˆçš„ name éœ€è¦å¤šè¡¨æŸ¥è¯¢ã€‚</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> s.id, s.name, t.name</span><br><span class="line"><span class="keyword">from</span> student s, teacher t</span><br><span class="line"><span class="keyword">where</span> s.id <span class="operator">=</span> t.id</span><br></pre></td></tr></tbody></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">id</th>
<th style="text-align:center">s.name</th>
<th style="text-align:center">t.name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">å°æ˜</td>
<td style="text-align:center">ç§¦è€å¸ˆ</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">å°çº¢</td>
<td style="text-align:center">ä½™è€å¸ˆ</td>
</tr>
</tbody>
</table>
</div>
<p>ä½†å¾ˆæ˜¾ç„¶ï¼ŒMybatis ä¸èƒ½ç›´æ¥è¿™ä¹ˆå†™ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹æ³•è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
<h4 id="11-1ã€æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"><a href="#11-1ã€æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†" class="headerlink" title="11.1ã€æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>11.1ã€æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†</h4><p>å°†å¯¹ teacher è¡¨çš„æŸ¥è¯¢ç»“æœä½œä¸º Student çš„<code>å±æ€§</code>  teacherã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ–¹å¼1 åµŒå¥—æŸ¥è¯¢--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findStudentById1"</span> <span class="attr">resultMap</span>=<span class="string">"StudentMap"</span>&gt;</span></span><br><span class="line">    select * from mybatis.student where id = #{id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"StudentMap"</span> <span class="attr">type</span>=<span class="string">"Student"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"teacher"</span> <span class="attr">column</span>=<span class="string">"tid"</span> <span class="attr">javaType</span>=<span class="string">"Teacher"</span> <span class="attr">select</span>=<span class="string">"getTeacher"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getTeacher"</span> <span class="attr">resultType</span>=<span class="string">"Teacher"</span>&gt;</span></span><br><span class="line">    select * from mybatis.teacher where id = #{tid}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>ç»“æœ</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Student(id=<span class="number">1</span>, name=å°æ˜, teacher=Teacher(id=<span class="number">1</span>, name=ç§¦è€å¸ˆ))</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="11-2ã€æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"><a href="#11-2ã€æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†" class="headerlink" title="11.2ã€æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†"></a>11.2ã€æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†</h4><p>å°†æŸ¥è¯¢å‡ºæ¥çš„ tname ä½œä¸ºå±æ€§ç›´æ¥ä¼ ç»™ Teacher å¯¹è±¡ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ–¹æ³•2 è”è¡¨æŸ¥è¯¢--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findStudentById2"</span> <span class="attr">resultMap</span>=<span class="string">"StudentMap2"</span>&gt;</span></span><br><span class="line">    select s.id sid , s.name sname, t.name tname from student s, teacher t where s.tid = t.id and s.id = #{id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"StudentMap2"</span> <span class="attr">type</span>=<span class="string">"Student"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"sid"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"sname"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"teacher"</span> <span class="attr">javaType</span>=<span class="string">"Teacher"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"tname"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>è¦ç»™æŸ¥è¯¢åˆ—å–åˆ«åï¼Œä¸ç„¶ resultMap æ— æ³•è·å–åˆ°</p>
          </div>
<h2 id="12ã€ä¸€å¯¹å¤šæŸ¥è¯¢"><a href="#12ã€ä¸€å¯¹å¤šæŸ¥è¯¢" class="headerlink" title="12ã€ä¸€å¯¹å¤šæŸ¥è¯¢"></a>12ã€ä¸€å¯¹å¤šæŸ¥è¯¢</h2><h4 id="12-1ã€æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"><a href="#12-1ã€æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†" class="headerlink" title="12.1ã€æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>12.1ã€æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æŒ‰ç…§æ¡ä»¶åµŒå¥—æŸ¥è¯¢--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findTeacherById2"</span> <span class="attr">resultMap</span>=<span class="string">"teacherMap2"</span>&gt;</span></span><br><span class="line">    select * from mybatis.teacher where id = #{id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"teacherMap2"</span> <span class="attr">type</span>=<span class="string">"Teacher"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"students"</span> <span class="attr">javaType</span>=<span class="string">"ArrayList"</span> <span class="attr">ofType</span>=<span class="string">"Student"</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">select</span>=<span class="string">"findStudentByTid"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findStudentByTid"</span> <span class="attr">resultType</span>=<span class="string">"Student"</span>&gt;</span></span><br><span class="line">    select * from mybatis.student where tid = #{id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="12-2ã€æŒ‰ç…§ç»“æœåµŒå¥—æŸ¥è¯¢"><a href="#12-2ã€æŒ‰ç…§ç»“æœåµŒå¥—æŸ¥è¯¢" class="headerlink" title="12.2ã€æŒ‰ç…§ç»“æœåµŒå¥—æŸ¥è¯¢"></a>12.2ã€æŒ‰ç…§ç»“æœåµŒå¥—æŸ¥è¯¢</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findTeacherById"</span> <span class="attr">resultMap</span>=<span class="string">"teacherMap"</span>&gt;</span></span><br><span class="line">    select t.id tid, t.name tname, s.name sname, s.id sid</span><br><span class="line">    from student s, teacher t</span><br><span class="line">    where s.tid = t.id and t.id = #{id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"teacherMap"</span> <span class="attr">type</span>=<span class="string">"Teacher"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"tid"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"tname"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"students"</span> <span class="attr">ofType</span>=<span class="string">"Student"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"sname"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"sid"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>ofType æ˜¯æ³›å‹çš„ç±»å‹ï¼Œè¡¨ç¤ºé›†åˆä¸­çš„å…ƒç´ ç±»å‹</p>
          </div>
<h2 id="13ã€åŠ¨æ€SQL"><a href="#13ã€åŠ¨æ€SQL" class="headerlink" title="13ã€åŠ¨æ€SQL"></a>13ã€åŠ¨æ€SQL</h2><p>åŠ¨æ€ SQL æ˜¯ MyBatis çš„å¼ºå¤§ç‰¹æ€§ä¹‹ä¸€ã€‚åœ¨ JDBC æˆ–å…¶å®ƒç±»ä¼¼çš„æ¡†æ¶ä¸­ï¼Œå¼€å‘äººå‘˜é€šå¸¸éœ€è¦æ‰‹åŠ¨æ‹¼æ¥ SQL è¯­å¥ã€‚æ ¹æ®ä¸åŒçš„æ¡ä»¶æ‹¼æ¥ SQL è¯­å¥æ˜¯ä¸€ä»¶æå…¶ç—›è‹¦çš„å·¥ä½œã€‚</p>
<p>åŠ¨æ€ SQL å¤§å¤§å‡å°‘äº†ç¼–å†™ä»£ç çš„å·¥ä½œé‡ï¼Œæ›´ä½“ç°äº† MyBatis çš„çµæ´»æ€§ã€é«˜åº¦å¯é…ç½®æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>å…ƒç´ </th>
<th>ä½œç”¨</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>if</td>
<td>åˆ¤æ–­è¯­å¥</td>
<td>å•æ¡ä»¶åˆ†æ”¯åˆ¤æ–­</td>
</tr>
<tr>
<td>chooseï¼ˆwhenã€otherwiseï¼‰</td>
<td>ç›¸å½“äº Java ä¸­çš„ switch case è¯­å¥</td>
<td>å¤šæ¡ä»¶åˆ†æ”¯åˆ¤æ–­</td>
</tr>
<tr>
<td>trimã€where</td>
<td>è¾…åŠ©å…ƒç´ </td>
<td>ç”¨äºå¤„ç†ä¸€äº›SQLæ‹¼è£…é—®é¢˜</td>
</tr>
<tr>
<td>foreach</td>
<td>å¾ªç¯è¯­å¥</td>
<td>åœ¨inè¯­å¥ç­‰åˆ—ä¸¾æ¡ä»¶å¸¸ç”¨</td>
</tr>
<tr>
<td>bind</td>
<td>è¾…åŠ©å…ƒç´ </td>
<td>æ‹¼æ¥å‚æ•°</td>
</tr>
</tbody>
</table>
</div>
<h4 id="13-1ã€If"><a href="#13-1ã€If" class="headerlink" title="13.1ã€If"></a>13.1ã€If</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getBolg"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog where 1=1</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"id != null"</span>&gt;</span></span><br><span class="line">        and id = #{id}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"author != null"</span>&gt;</span></span><br><span class="line">        and author = #{author}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">        and title = #{title}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>å‚æ•°åˆ—è¡¨ä½¿ç”¨çš„æ˜¯ mapï¼Œä¾¿äºæ§åˆ¶æŸ¥è¯¢å¯¹è±¡ï¼›where 1=1 æ˜¯ä¸ºäº†mainä¾¿äºæ‹¼æ¥ã€‚</p>
          </div>
<h4 id="13-2ã€where"><a href="#13-2ã€where" class="headerlink" title="13.2ã€where"></a>13.2ã€where</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getBolg"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"id != null"</span>&gt;</span></span><br><span class="line">            and id = #{id}</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"author != null"</span>&gt;</span></span><br><span class="line">            and author = #{author}</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">            and title = #{title}</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>åœ¨ if çš„å¤–ä¾§å¥—ä¸€å±‚ where æ ‡ç­¾å°±å¯ä»¥çœå» where 1=1 è¿™ä¸ª sql äº†ã€‚</p>
<h4 id="13-3ã€chooseï¼ˆwhenã€otherwiseï¼‰"><a href="#13-3ã€chooseï¼ˆwhenã€otherwiseï¼‰" class="headerlink" title="13.3ã€chooseï¼ˆwhenã€otherwiseï¼‰"></a>13.3ã€chooseï¼ˆwhenã€otherwiseï¼‰</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getBlogWithSwitch"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"id != null"</span>&gt;</span></span><br><span class="line">                and id = #{id}</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"author != null"</span>&gt;</span></span><br><span class="line">                and author = #{author}</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">                and title = #{title}</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">                and views = 9999</span><br><span class="line">            <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>choose ç­‰åŒäº switchï¼Œwhen ç­‰åŒäº caseï¼Œotherwise ç­‰åŒäº defaultã€‚</p>
<p>å½“æœ‰ä¸€ä¸ª when æˆç«‹æ—¶ï¼Œä¾¿ä¸ä¼šæ‰§è¡Œåé¢çš„ when è¯­å¥ã€‚è‹¥éƒ½ä¸æ»¡è¶³ï¼Œåˆ™ä¼šæ‰§è¡Œ otherwiseã€‚</p>
<h4 id="13-4ã€set"><a href="#13-4ã€set" class="headerlink" title="13.4ã€set"></a>13.4ã€set</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateBlog"</span>&gt;</span></span><br><span class="line">    update mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name != null"</span>&gt;</span>name = #{name},<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"author != null"</span>&gt;</span>author = #{author},<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span>title = #{title},<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    where id = #{id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>set æ ‡ç­¾ä¼šå»æ‰å¤šä½™<code>,</code>ï¼Œä½†ä¸ä¼šæ·»åŠ <code>,</code>ï¼Œå› æ­¤åœ¨æ¯ä¸ª sql åéƒ½åŠ ä¸ª<code>,</code>å°±å¯ä»¥äº†ã€‚</p>
<h4 id="13-5ã€trim"><a href="#13-5ã€trim" class="headerlink" title="13.5ã€trim"></a>13.5ã€trim</h4><p>trim ä¸€èˆ¬ç”¨äºå»é™¤ SQL è¯­å¥ä¸­å¤šä½™çš„ AND å…³é”®å­—ã€é€—å·<code>ï¼Œ</code>æˆ–è€…ç»™ SQL è¯­å¥å‰æ‹¼æ¥ whereã€set ç­‰åç¼€ï¼Œå¯ç”¨äºé€‰æ‹©æ€§æ’å…¥ã€æ›´æ–°ã€åˆ é™¤æˆ–è€…æ¡ä»¶æŸ¥è¯¢ç­‰æ“ä½œã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>prefix</td>
<td>ç»™SQLè¯­å¥æ‹¼æ¥çš„å‰ç¼€ï¼Œä¸º trim åŒ…å«çš„å†…å®¹åŠ ä¸Šå‰ç¼€</td>
</tr>
<tr>
<td>suffix</td>
<td>ç»™SQLè¯­å¥æ‹¼æ¥çš„åç¼€ï¼Œä¸º trim åŒ…å«çš„å†…å®¹åŠ ä¸Šåç¼€</td>
</tr>
<tr>
<td>prefixOverrides</td>
<td>å»é™¤ SQL è¯­å¥å‰é¢çš„å…³é”®å­—æˆ–å­—ç¬¦ï¼Œè¯¥å…³é”®å­—æˆ–è€…å­—ç¬¦ç”± prefixOverrides å±æ€§æŒ‡å®šã€‚</td>
</tr>
<tr>
<td>suffixOverrides</td>
<td>å»é™¤ SQL è¯­å¥åé¢çš„å…³é”®å­—æˆ–è€…å­—ç¬¦ï¼Œè¯¥å…³é”®å­—æˆ–è€…å­—ç¬¦ç”± suffixOverrides å±æ€§æŒ‡å®šã€‚</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateBlogWithTrim"</span>&gt;</span></span><br><span class="line">    update mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">"set"</span> <span class="attr">suffixOverrides</span>=<span class="string">","</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"name != null"</span>&gt;</span>name = #{name},<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"author != null"</span>&gt;</span>author = #{author},<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span>title = #{title},<span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span></span><br><span class="line">    where id = #{id}</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="13-6ã€foreach"><a href="#13-6ã€foreach" class="headerlink" title="13.6ã€foreach"></a>13.6ã€foreach</h4><p>Mybatis foreach æ ‡ç­¾ç”¨äºå¾ªç¯è¯­å¥ï¼Œå®ƒå¾ˆå¥½çš„æ”¯æŒäº†æ•°æ®å’Œ Listã€set æ¥å£çš„é›†åˆï¼Œå¹¶å¯¹æ­¤æä¾›éå†çš„åŠŸèƒ½ã€‚è¯­æ³•æ ¼å¼å¦‚ä¸‹ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">item</span>=<span class="string">"item"</span> <span class="attr">index</span>=<span class="string">"index"</span> <span class="attr">collection</span>=<span class="string">"list|array|map key"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></span><br><span class="line">    å‚æ•°å€¼</span><br><span class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>foreach æ ‡ç­¾ä¸»è¦æœ‰ä»¥ä¸‹å±æ€§ï¼Œè¯´æ˜å¦‚ä¸‹ã€‚</p>
<ul>
<li>itemï¼šè¡¨ç¤ºé›†åˆä¸­æ¯ä¸€ä¸ªå…ƒç´ è¿›è¡Œè¿­ä»£æ—¶çš„åˆ«åã€‚</li>
<li>indexï¼šæŒ‡å®šä¸€ä¸ªåå­—ï¼Œè¡¨ç¤ºåœ¨è¿­ä»£è¿‡ç¨‹ä¸­æ¯æ¬¡è¿­ä»£åˆ°çš„ä½ç½®ã€‚</li>
<li>openï¼šè¡¨ç¤ºè¯¥è¯­å¥ä»¥ä»€ä¹ˆå¼€å§‹ï¼ˆæ—¢ç„¶æ˜¯ in æ¡ä»¶è¯­å¥ï¼Œæ‰€ä»¥å¿…ç„¶ä»¥<code>(</code>å¼€å§‹ï¼‰ã€‚</li>
<li>separatorï¼šè¡¨ç¤ºåœ¨æ¯æ¬¡è¿›è¡Œè¿­ä»£ä¹‹é—´ä»¥ä»€ä¹ˆç¬¦å·ä½œä¸ºåˆ†éš”ç¬¦ï¼ˆæ—¢ç„¶æ˜¯ in æ¡ä»¶è¯­å¥ï¼Œæ‰€ä»¥å¿…ç„¶ä»¥<code>,</code>ä½œä¸ºåˆ†éš”ç¬¦ï¼‰ã€‚</li>
<li>closeï¼šè¡¨ç¤ºè¯¥è¯­å¥ä»¥ä»€ä¹ˆç»“æŸï¼ˆæ—¢ç„¶æ˜¯ in æ¡ä»¶è¯­å¥ï¼Œæ‰€ä»¥å¿…ç„¶ä»¥<code>)</code>å¼€å§‹ï¼‰ã€‚</li>
</ul>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getBolgWithForeach"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog where id in</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">item</span>=<span class="string">"item"</span> <span class="attr">index</span>=<span class="string">"index"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></span><br><span class="line">        #{item}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•ä»£ç </p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test5</span><span class="params">()</span></span>{</span><br><span class="line">    SqlSession session = MyBatisUtil.getSession();</span><br><span class="line">    BlogMapper mapper = session.getMapper(BlogMapper.class);</span><br><span class="line">    List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    list.add(<span class="string">"1"</span>);</span><br><span class="line">    list.add(<span class="string">"3"</span>);</span><br><span class="line">    list.add(<span class="string">"4"</span>);</span><br><span class="line">    System.out.println(mapper.getBolgWithForeach(list));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="13-7ã€SQL-ç‰‡æ®µ"><a href="#13-7ã€SQL-ç‰‡æ®µ" class="headerlink" title="13.7ã€SQL ç‰‡æ®µ"></a>13.7ã€SQL ç‰‡æ®µ</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"sqlSegment"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"id != null"</span>&gt;</span></span><br><span class="line">        and id = #{id}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"author != null"</span>&gt;</span></span><br><span class="line">        and author = #{author}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"title != null"</span>&gt;</span></span><br><span class="line">        and title = #{title}</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getBolg"</span> <span class="attr">resultType</span>=<span class="string">"Blog"</span>&gt;</span></span><br><span class="line">    select * from mybatis.blog</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"sqlSegment"</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>é¡¾åæ€ä¹‰ï¼Œå°†æŸä¸€æ®µ sql è¯­å¥æå–å‡ºæ¥ï¼Œä»¥ä¾¿åç»­å¤ç”¨ï¼</p>
<h2 id="14ã€Mybatis-ç¼“å­˜"><a href="#14ã€Mybatis-ç¼“å­˜" class="headerlink" title="14ã€Mybatis ç¼“å­˜"></a>14ã€Mybatis ç¼“å­˜</h2><p>ç¼“å­˜å¯ä»¥å°†æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œæ˜¯äº’è”ç½‘ç³»ç»Ÿå¸¸å¸¸ç”¨åˆ°çš„ã€‚ç›®å‰æµè¡Œçš„ç¼“å­˜æœåŠ¡å™¨æœ‰ MongoDBã€Redisã€Ehcache ç­‰ã€‚ç¼“å­˜æ˜¯åœ¨è®¡ç®—æœºå†…å­˜ä¸Šä¿å­˜çš„æ•°æ®ï¼Œè¯»å–æ—¶æ— éœ€å†ä»ç£ç›˜è¯»å…¥ï¼Œå› æ­¤å…·å¤‡å¿«é€Ÿè¯»å–å’Œä½¿ç”¨çš„ç‰¹ç‚¹ã€‚</p>
<p>å’Œå¤§å¤šæ•°æŒä¹…åŒ–æ¡†æ¶ä¸€æ ·ï¼ŒMyBatis æä¾›äº†ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜çš„æ”¯æŒã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMyBatis åªå¼€å¯ä¸€çº§ç¼“å­˜ã€‚</p>
<h4 id="14-1ã€ä¸€çº§ç¼“å­˜"><a href="#14-1ã€ä¸€çº§ç¼“å­˜" class="headerlink" title="14.1ã€ä¸€çº§ç¼“å­˜"></a>14.1ã€ä¸€çº§ç¼“å­˜</h4><p>ä¸€çº§ç¼“å­˜æ˜¯åŸºäº PerpetualCacheï¼ˆMyBatisè‡ªå¸¦ï¼‰çš„ HashMap æœ¬åœ°ç¼“å­˜ï¼Œä½œç”¨èŒƒå›´ä¸º <code>session</code> åŸŸå†…ã€‚å½“ session flushï¼ˆåˆ·æ–°ï¼‰æˆ–è€… closeï¼ˆå…³é—­ï¼‰ä¹‹åï¼Œè¯¥ session ä¸­æ‰€æœ‰çš„ cacheï¼ˆç¼“å­˜ï¼‰å°±ä¼šè¢«æ¸…ç©ºã€‚</p>
<p>åœ¨å‚æ•°å’Œ SQL å®Œå…¨ä¸€æ ·çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨åŒä¸€ä¸ª SqlSession å¯¹è±¡è°ƒç”¨åŒä¸€ä¸ª mapper çš„æ–¹æ³•ï¼Œå¾€å¾€åªæ‰§è¡Œä¸€æ¬¡ SQLã€‚å› ä¸ºä½¿ç”¨ SqlSession ç¬¬ä¸€æ¬¡æŸ¥è¯¢åï¼ŒMyBatis ä¼šå°†å…¶æ”¾åœ¨ç¼“å­˜ä¸­ï¼Œå†æ¬¡æŸ¥è¯¢æ—¶ï¼Œå¦‚æœæ²¡æœ‰åˆ·æ–°ï¼Œå¹¶ä¸”ç¼“å­˜æ²¡æœ‰è¶…æ—¶çš„æƒ…å†µä¸‹ï¼ŒSqlSession ä¼šå–å‡ºå½“å‰ç¼“å­˜çš„æ•°æ®ï¼Œè€Œä¸ä¼šå†æ¬¡å‘é€ SQL åˆ°æ•°æ®åº“ã€‚</p>
<p>æŸ¥è¯¢ä¸åŒ blog</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>{</span><br><span class="line">    SqlSession session = MyBatisUtil.getSession();</span><br><span class="line">    BlogMapper mapper = session.getMapper(BlogMapper.class);</span><br><span class="line">    System.out.println(mapper.getBlogById(<span class="number">1</span>));</span><br><span class="line">    System.out.println(<span class="string">"===================================="</span>);</span><br><span class="line">    System.out.println(mapper.getBlogById(<span class="number">2</span>));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">==&gt;  Preparing: select * from mybatis.blog where id = ? </span><br><span class="line">==&gt; Parameters: <span class="number">1</span>(Integer)</span><br><span class="line">&lt;==    Columns: id, title, author, create_time, views</span><br><span class="line">&lt;==        Row: <span class="number">1</span>, ç´«æ¢¦æ²é¦™, DeFlory, <span class="number">2021</span>-<span class="number">02</span>-09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46.0</span>, <span class="number">9999</span></span><br><span class="line">&lt;==      Total: <span class="number">1</span></span><br><span class="line">Blog(id=<span class="number">1</span>, title=ç´«æ¢¦æ²é¦™, author=DeFlory, createTime=Tue Feb 09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46</span> CST <span class="number">2021</span>, views=<span class="number">9999</span>)</span><br><span class="line">====================================</span><br><span class="line">==&gt;  Preparing: select * from mybatis.blog where id = ? </span><br><span class="line">==&gt; Parameters: <span class="number">2</span>(Integer)</span><br><span class="line">&lt;==    Columns: id, title, author, create_time, views</span><br><span class="line">&lt;==        Row: <span class="number">2</span>, åŠ¨æ€sql, ç‹‚ç¥è¯´, <span class="number">2021</span>-<span class="number">02</span>-09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46.0</span>, <span class="number">9999</span></span><br><span class="line">&lt;==      Total: <span class="number">1</span></span><br><span class="line">Blog(id=<span class="number">2</span>, title=åŠ¨æ€sql, author=ç‹‚ç¥è¯´, createTime=Tue Feb 09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46</span> CST <span class="number">2021</span>, views=<span class="number">9999</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>æŸ¥è¯¢ç›¸åŒ blog</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>{</span><br><span class="line">    SqlSession session = MyBatisUtil.getSession();</span><br><span class="line">    BlogMapper mapper = session.getMapper(BlogMapper.class);</span><br><span class="line">    System.out.println(mapper.getBlogById(<span class="number">1</span>));</span><br><span class="line">    System.out.println(<span class="string">"===================================="</span>);</span><br><span class="line">    System.out.println(mapper.getBlogById(<span class="number">1</span>));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">==&gt;  Preparing: select * from mybatis.blog where id = ? </span><br><span class="line">==&gt; Parameters: <span class="number">1</span>(Integer)</span><br><span class="line">&lt;==    Columns: id, title, author, create_time, views</span><br><span class="line">&lt;==        Row: <span class="number">1</span>, ç´«æ¢¦æ²é¦™, DeFlory, <span class="number">2021</span>-<span class="number">02</span>-09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46.0</span>, <span class="number">9999</span></span><br><span class="line">&lt;==      Total: <span class="number">1</span></span><br><span class="line">Blog(id=<span class="number">1</span>, title=ç´«æ¢¦æ²é¦™, author=DeFlory, createTime=Tue Feb 09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46</span> CST <span class="number">2021</span>, views=<span class="number">9999</span>)</span><br><span class="line">====================================</span><br><span class="line">Blog(id=<span class="number">1</span>, title=ç´«æ¢¦æ²é¦™, author=DeFlory, createTime=Tue Feb 09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46</span> CST <span class="number">2021</span>, views=<span class="number">9999</span>)</span><br></pre></td></tr></tbody></table></figure>
<div class="note info">
            <p>æ˜¾è€Œæ˜“è§ï¼Œå½“è¿è¡ŒåŒæ ·çš„æŸ¥è¯¢è¯­å¥æ—¶ï¼Œåªä¼šè¿”å›ç»“æœï¼Œè€Œä¸ä¼šåˆ°æ•°æ®åº“ä¸­æŸ¥è¯¢ã€‚</p>
          </div>
<h4 id="14-2ã€äºŒçº§ç¼“å­˜"><a href="#14-2ã€äºŒçº§ç¼“å­˜" class="headerlink" title="14.2ã€äºŒçº§ç¼“å­˜"></a>14.2ã€äºŒçº§ç¼“å­˜</h4><p>äºŒçº§ç¼“å­˜æ˜¯å…¨å±€ç¼“å­˜ï¼Œä½œç”¨åŸŸè¶…å‡º session èŒƒå›´ä¹‹å¤–ï¼Œå¯ä»¥è¢«æ‰€æœ‰ SqlSession å…±äº«ã€‚</p>
<p>ä¸€çº§ç¼“å­˜ç¼“å­˜çš„æ˜¯ SQL è¯­å¥ï¼ŒäºŒçº§ç¼“å­˜ç¼“å­˜çš„æ˜¯ç»“æœå¯¹è±¡ã€‚</p>
<p><strong>äºŒçº§ç¼“å­˜çš„é…ç½®</strong></p>
<p>ï¼ˆ1ï¼‰MyBatis çš„å…¨å±€ç¼“å­˜é…ç½®éœ€è¦åœ¨ mybatis-config.xml çš„ settings å…ƒç´ ä¸­è®¾ç½®ï¼Œä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰åœ¨ mapper æ–‡ä»¶ä¸­è®¾ç½®ç¼“å­˜ï¼Œé»˜è®¤ä¸å¼€å¯ç¼“å­˜ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒäºŒçº§ç¼“å­˜çš„ä½œç”¨åŸŸæ˜¯é’ˆå¯¹ mapper çš„ namescape è€Œè¨€ï¼Œå³åªæœ‰å†æ¬¡åœ¨ namescape å†…çš„æŸ¥è¯¢æ‰èƒ½å…±äº«è¿™ä¸ªç¼“å­˜ï¼Œä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namescape</span>=<span class="string">"net.biancheng.WebsiteMapper"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- cacheé…ç½® --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cache</span></span></span><br><span class="line"><span class="tag">        <span class="attr">eviction</span>=<span class="string">"FIFO"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">flushInterval</span>=<span class="string">"60000"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">size</span>=<span class="string">"512"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">readOnly</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">		ä¹Ÿå¯ä»¥ä½¿ç”¨&lt;cache/&gt;ï¼Œå‚æ•°å…¨é»˜è®¤ã€‚	</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>eviction</td>
<td>ä»£è¡¨çš„æ˜¯ç¼“å­˜å›æ”¶ç­–ç•¥ï¼Œç›®å‰ MyBatis æä¾›ä»¥ä¸‹ç­–ç•¥ã€‚LRUï¼šä½¿ç”¨è¾ƒå°‘ï¼Œç§»é™¤æœ€é•¿æ—¶é—´ä¸ç”¨çš„å¯¹è±¡ï¼›FIFOï¼šå…ˆè¿›å…ˆå‡ºï¼ŒæŒ‰å¯¹è±¡è¿›å…¥ç¼“å­˜çš„é¡ºåºæ¥ç§»é™¤å®ƒä»¬ï¼›SOFTï¼šè½¯å¼•ç”¨ï¼Œç§»é™¤åŸºäºåƒåœ¾å›æ”¶å™¨çŠ¶æ€å’Œè½¯å¼•ç”¨è§„åˆ™çš„å¯¹è±¡ï¼›WEAKï¼šå¼±å¼•ç”¨ï¼Œæ›´ç§¯æåœ°ç§»é™¤åŸºäºåƒåœ¾æ”¶é›†å™¨çŠ¶æ€å’Œå¼±å¼•ç”¨è§„åˆ™çš„å¯¹è±¡ã€‚</td>
</tr>
<tr>
<td>flushInterval</td>
<td>åˆ·æ–°é—´éš”æ—¶é—´ï¼Œå•ä½ä¸ºæ¯«ç§’ï¼Œè¿™é‡Œé…ç½®çš„æ˜¯ 60 ç§’åˆ·æ–°ï¼Œå¦‚æœçœç•¥è¯¥é…ç½®ï¼Œé‚£ä¹ˆåªæœ‰å½“ SQL è¢«æ‰§è¡Œçš„æ—¶å€™æ‰ä¼šåˆ·æ–°ç¼“å­˜ã€‚</td>
</tr>
<tr>
<td>size</td>
<td>å¼•ç”¨æ•°ç›®ï¼Œæ­£æ•´æ•°ï¼Œä»£è¡¨ç¼“å­˜æœ€å¤šå¯ä»¥å­˜å‚¨å¤šå°‘ä¸ªå¯¹è±¡ï¼Œä¸å®œè®¾ç½®è¿‡å¤§ã€‚è®¾ç½®è¿‡å¤§ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚è¿™é‡Œé…ç½®çš„æ˜¯ 512 ä¸ªå¯¹è±¡ã€‚</td>
</tr>
<tr>
<td>readOnly</td>
<td>åªè¯»ï¼Œé»˜è®¤å€¼ä¸º falseï¼Œæ„å‘³ç€ç¼“å­˜æ•°æ®åªèƒ½è¯»å–è€Œä¸èƒ½ä¿®æ”¹ï¼Œè¿™æ ·è®¾ç½®çš„å¥½å¤„æ˜¯å¯ä»¥å¿«é€Ÿè¯»å–ç¼“å­˜ï¼Œç¼ºç‚¹æ˜¯æ²¡æœ‰åŠæ³•ä¿®æ”¹ç¼“å­˜ã€‚</td>
</tr>
</tbody>
</table>
</div>
<p>ï¼ˆ3ï¼‰åœ¨ mapper æ–‡ä»¶é…ç½®æ”¯æŒ cache åï¼Œå¦‚æœéœ€è¦å¯¹ä¸ªåˆ«æŸ¥è¯¢è¿›è¡Œè°ƒæ•´ï¼Œå¯ä»¥å•ç‹¬è®¾ç½® cacheï¼Œä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getWebsiteList"</span> <span class="attr">resultType</span>=<span class="string">"net.biancheng.po.Website"</span> <span class="attr">usecache</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•ä»£ç </p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>{</span><br><span class="line">    SqlSession session = MyBatisUtil.getSession();</span><br><span class="line">    BlogMapper mapper = session.getMapper(BlogMapper.class);</span><br><span class="line">    System.out.println(mapper.getBlogById(<span class="number">1</span>));</span><br><span class="line">    session.close();</span><br><span class="line">    System.out.println(<span class="string">"===================================="</span>);</span><br><span class="line">    session = MyBatisUtil.getSession();</span><br><span class="line">    mapper = session.getMapper(BlogMapper.class);</span><br><span class="line">    System.out.println(mapper.getBlogById(<span class="number">1</span>));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸å¼€å¯äºŒçº§ç¼“å­˜ï¼ŒæŸ¥è¯¢äº†ä¸¤æ¬¡ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Opening JDBC Connection</span><br><span class="line">Created connection <span class="number">233996206.</span></span><br><span class="line">Setting autocommit to <span class="keyword">false</span> on JDBC Connection [com.mysql.jdbc.JDBC4Connection<span class="meta">@df27fae</span>]</span><br><span class="line">==&gt;  Preparing: select * from mybatis.blog where id = ? </span><br><span class="line">==&gt; Parameters: <span class="number">1</span>(Integer)</span><br><span class="line">&lt;==    Columns: id, title, author, create_time, views</span><br><span class="line">&lt;==        Row: <span class="number">1</span>, ç´«æ¢¦æ²é¦™, DeFlory, <span class="number">2021</span>-<span class="number">02</span>-09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46.0</span>, <span class="number">9999</span></span><br><span class="line">&lt;==      Total: <span class="number">1</span></span><br><span class="line">Blog(id=<span class="number">1</span>, title=ç´«æ¢¦æ²é¦™, author=DeFlory, createTime=Tue Feb 09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46</span> CST <span class="number">2021</span>, views=<span class="number">9999</span>)</span><br><span class="line">Resetting autocommit to <span class="keyword">true</span> on JDBC Connection [com.mysql.jdbc.JDBC4Connection<span class="meta">@df27fae</span>]</span><br><span class="line">Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection<span class="meta">@df27fae</span>]</span><br><span class="line">Returned connection <span class="number">233996206</span> to pool.</span><br><span class="line">====================================</span><br><span class="line">Opening JDBC Connection</span><br><span class="line">Checked out connection <span class="number">233996206</span> from pool.</span><br><span class="line">Setting autocommit to <span class="keyword">false</span> on JDBC Connection [com.mysql.jdbc.JDBC4Connection<span class="meta">@df27fae</span>]</span><br><span class="line">==&gt;  Preparing: select * from mybatis.blog where id = ? </span><br><span class="line">==&gt; Parameters: <span class="number">1</span>(Integer)</span><br><span class="line">&lt;==    Columns: id, title, author, create_time, views</span><br><span class="line">&lt;==        Row: <span class="number">1</span>, ç´«æ¢¦æ²é¦™, DeFlory, <span class="number">2021</span>-<span class="number">02</span>-09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46.0</span>, <span class="number">9999</span></span><br><span class="line">&lt;==      Total: <span class="number">1</span></span><br><span class="line">Blog(id=<span class="number">1</span>, title=ç´«æ¢¦æ²é¦™, author=DeFlory, createTime=Tue Feb 09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46</span> CST <span class="number">2021</span>, views=<span class="number">9999</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>å¼€å¯ç¼“å­˜ï¼ŒåªæŸ¥è¯¢äº†ä¸€æ¬¡ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Opening JDBC Connection</span><br><span class="line">Created connection <span class="number">1843289228.</span></span><br><span class="line">Setting autocommit to <span class="keyword">false</span> on JDBC Connection [com.mysql.jdbc.JDBC4Connection@6dde5c8c]</span><br><span class="line">==&gt;  Preparing: select * from mybatis.blog where id = ? </span><br><span class="line">==&gt; Parameters: <span class="number">1</span>(Integer)</span><br><span class="line">&lt;==    Columns: id, title, author, create_time, views</span><br><span class="line">&lt;==        Row: <span class="number">1</span>, ç´«æ¢¦æ²é¦™, DeFlory, <span class="number">2021</span>-<span class="number">02</span>-09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46.0</span>, <span class="number">9999</span></span><br><span class="line">&lt;==      Total: <span class="number">1</span></span><br><span class="line">Blog(id=<span class="number">1</span>, title=ç´«æ¢¦æ²é¦™, author=DeFlory, createTime=Tue Feb 09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46</span> CST <span class="number">2021</span>, views=<span class="number">9999</span>)</span><br><span class="line">Resetting autocommit to <span class="keyword">true</span> on JDBC Connection [com.mysql.jdbc.JDBC4Connection@6dde5c8c]</span><br><span class="line">Closing JDBC Connection [com.mysql.jdbc.JDBC4Connection@6dde5c8c]</span><br><span class="line">Returned connection <span class="number">1843289228</span> to pool.</span><br><span class="line">====================================</span><br><span class="line">Cache Hit Ratio [com.yqx.mapper.BlogMapper]: <span class="number">0.5</span></span><br><span class="line">Blog(id=<span class="number">1</span>, title=ç´«æ¢¦æ²é¦™, author=DeFlory, createTime=Tue Feb 09 <span class="number">20</span>:<span class="number">16</span>:<span class="number">46</span> CST <span class="number">2021</span>, views=<span class="number">9999</span>)</span><br></pre></td></tr></tbody></table></figure>
<div class="note danger">
            <p>éœ€è¦å°†å®ä½“ç±»åºåˆ—åŒ–ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼</p>
          </div>
<h4 id="14-3ã€ç¼“å­˜è¯»å–é¡ºåº"><a href="#14-3ã€ç¼“å­˜è¯»å–é¡ºåº" class="headerlink" title="14.3ã€ç¼“å­˜è¯»å–é¡ºåº"></a>14.3ã€ç¼“å­˜è¯»å–é¡ºåº</h4><ol>
<li>å…ˆæŸ¥è¯¢äºŒçº§ç¼“å­˜</li>
<li>åœ¨æŸ¥è¯¢ä¸€çº§ç¼“å­˜</li>
<li>æŸ¥è¯¢æ•°æ®åº“</li>
</ol>
<p>å¯¹äº MyBatis ç¼“å­˜<code>ä»…ä½œäº†è§£</code>å³å¯ï¼Œå› ä¸ºé¢å¯¹ä¸€å®šè§„æ¨¡çš„æ•°æ®é‡ï¼Œå†…ç½®çš„ Cache æ–¹å¼å°±æ´¾ä¸ä¸Šç”¨åœºäº†ï¼Œå¹¶ä¸”å¯¹æŸ¥è¯¢ç»“æœé›†åšç¼“å­˜å¹¶ä¸æ˜¯ MyBatis æ‰€æ“…é•¿çš„ï¼Œå®ƒä¸“å¿ƒåšçš„åº”è¯¥æ˜¯ SQL æ˜ å°„ã€‚å¯¹äºç¼“å­˜ï¼Œé‡‡ç”¨ OSCacheã€Memcached ç­‰ä¸“é—¨çš„ç¼“å­˜æœåŠ¡å™¨æ¥åšæ›´ä¸ºåˆç†ã€‚</p>
]]></content>
      <categories>
        <category>SSM</category>
      </categories>
  </entry>
  <entry>
    <title>Pandasç†ŠçŒ«å…»æ®–</title>
    <url>/2021/10/23/Pandas%E7%86%8A%E7%8C%AB%E5%85%BB%E6%AE%96/</url>
    <content><![CDATA[<h2 id="ä¸€ã€Pandas-æ¦‚è§ˆ"><a href="#ä¸€ã€Pandas-æ¦‚è§ˆ" class="headerlink" title="ä¸€ã€Pandas æ¦‚è§ˆ"></a>ä¸€ã€Pandas æ¦‚è§ˆ</h2><h4 id="1ã€ä»‹ç»"><a href="#1ã€ä»‹ç»" class="headerlink" title="1ã€ä»‹ç»"></a>1ã€ä»‹ç»</h4><p><strong>Pandas</strong> æ˜¯ Python çš„æ ¸å¿ƒæ•°æ®åˆ†ææ”¯æŒåº“ï¼Œæä¾›äº†å¿«é€Ÿã€çµæ´»ã€æ˜ç¡®çš„æ•°æ®ç»“æ„ï¼Œæ—¨åœ¨ç®€å•ã€ç›´è§‚åœ°å¤„ç†å…³ç³»å‹ã€æ ‡è®°å‹æ•°æ®ã€‚</p>
<p>Pandas é€‚ç”¨äºå¤„ç†ä»¥ä¸‹ç±»å‹çš„æ•°æ®ï¼š</p>
<ul>
<li>ä¸ SQL æˆ– Excel è¡¨ç±»ä¼¼çš„ï¼Œå«å¼‚æ„åˆ—çš„è¡¨æ ¼æ•°æ®;</li>
<li>æœ‰åºå’Œæ— åºï¼ˆéå›ºå®šé¢‘ç‡ï¼‰çš„æ—¶é—´åºåˆ—æ•°æ®;</li>
<li>å¸¦è¡Œåˆ—æ ‡ç­¾çš„çŸ©é˜µæ•°æ®ï¼ŒåŒ…æ‹¬åŒæ„æˆ–å¼‚æ„å‹æ•°æ®;</li>
<li>ä»»æ„å…¶å®ƒå½¢å¼çš„è§‚æµ‹ã€ç»Ÿè®¡æ•°æ®é›†, æ•°æ®è½¬å…¥ Pandas æ•°æ®ç»“æ„æ—¶ä¸å¿…äº‹å…ˆæ ‡è®°ã€‚</li>
</ul>
<span id="more"></span>
<h4 id="2ã€æ•°æ®ç»“æ„"><a href="#2ã€æ•°æ®ç»“æ„" class="headerlink" title="2ã€æ•°æ®ç»“æ„"></a>2ã€æ•°æ®ç»“æ„</h4><div class="table-container">
<table>
<thead>
<tr>
<th>ç»´æ•°</th>
<th>åç§°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Series</td>
<td>å¸¦æ ‡ç­¾çš„ä¸€ç»´åŒæ„æ•°ç»„</td>
</tr>
<tr>
<td>2</td>
<td>DataFrame</td>
<td>å¸¦æ ‡ç­¾çš„ï¼Œå¤§å°å¯å˜çš„ï¼ŒäºŒç»´å¼‚æ„è¡¨æ ¼</td>
</tr>
</tbody>
</table>
</div>
<h4 id="3ã€ä¸ºä»€ä¹ˆæœ‰å¤šä¸ªæ•°æ®ç»“æ„ï¼Ÿ"><a href="#3ã€ä¸ºä»€ä¹ˆæœ‰å¤šä¸ªæ•°æ®ç»“æ„ï¼Ÿ" class="headerlink" title="3ã€ä¸ºä»€ä¹ˆæœ‰å¤šä¸ªæ•°æ®ç»“æ„ï¼Ÿ"></a>3ã€ä¸ºä»€ä¹ˆæœ‰å¤šä¸ªæ•°æ®ç»“æ„ï¼Ÿ</h4><p>Pandas æ•°æ®ç»“æ„å°±åƒæ˜¯ä½ç»´æ•°æ®çš„å®¹å™¨ã€‚æ¯”å¦‚ï¼ŒDataFrame æ˜¯ Series çš„å®¹å™¨ï¼ŒSeries åˆ™æ˜¯æ ‡é‡çš„å®¹å™¨ã€‚ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå¯ä»¥åœ¨å®¹å™¨ä¸­ä»¥å­—å…¸çš„å½¢å¼æ’å…¥æˆ–åˆ é™¤å¯¹è±¡ã€‚</p>
<p>ä¸€è¨€ä»¥è”½ä¹‹ï¼Œ<code>Series</code> å­˜å‚¨ä¸€ç»´æ•°æ®ï¼Œ<code>DataFrame</code> å­˜å‚¨äºŒç»´æ•°æ®ã€‚</p>
<h4 id="4ã€å¤§å°å¯å˜ä¸æ•°æ®å¤åˆ¶"><a href="#4ã€å¤§å°å¯å˜ä¸æ•°æ®å¤åˆ¶" class="headerlink" title="4ã€å¤§å°å¯å˜ä¸æ•°æ®å¤åˆ¶"></a>4ã€å¤§å°å¯å˜ä¸æ•°æ®å¤åˆ¶</h4><p>Pandas æ‰€æœ‰æ•°æ®ç»“æ„çš„å€¼éƒ½æ˜¯å¯å˜çš„ï¼Œä½†æ•°æ®ç»“æ„çš„å¤§å°å¹¶ééƒ½æ˜¯å¯å˜çš„ï¼Œæ¯”å¦‚ï¼ŒSeries çš„é•¿åº¦ä¸å¯æ”¹å˜ï¼Œä½† DataFrame é‡Œå°±å¯ä»¥æ’å…¥åˆ—ã€‚</p>
<p>Pandas é‡Œï¼Œç»å¤§å¤šæ•°æ–¹æ³•éƒ½ä¸æ”¹å˜åŸå§‹çš„è¾“å…¥æ•°æ®ï¼Œè€Œæ˜¯å¤åˆ¶æ•°æ®ï¼Œç”Ÿæˆæ–°çš„å¯¹è±¡ã€‚ ä¸€èˆ¬æ¥è¯´ï¼ŒåŸå§‹è¾“å…¥æ•°æ®<code>ä¸å˜</code>æ›´ç¨³å¦¥ã€‚</p>
<h2 id="äºŒã€Pandas-ä½¿ç”¨"><a href="#äºŒã€Pandas-ä½¿ç”¨" class="headerlink" title="äºŒã€Pandas ä½¿ç”¨"></a>äºŒã€Pandas ä½¿ç”¨</h2><h4 id="1ã€ç”Ÿæˆå¯¹è±¡"><a href="#1ã€ç”Ÿæˆå¯¹è±¡" class="headerlink" title="1ã€ç”Ÿæˆå¯¹è±¡"></a>1ã€ç”Ÿæˆå¯¹è±¡</h4><p>ï¼ˆ1ï¼‰ç”¨å€¼åˆ—è¡¨ç”Ÿæˆ Series æ—¶ï¼ŒPandas é»˜è®¤è‡ªåŠ¨ç”Ÿæˆæ•´æ•°ç´¢å¼•</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">3</span>]: s = pd.Series([<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, np.nan, <span class="number">6</span>, <span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">4</span>]: s</span><br><span class="line">Out[<span class="number">4</span>]: </span><br><span class="line"><span class="number">0</span>    <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>    <span class="number">3.0</span></span><br><span class="line"><span class="number">2</span>    <span class="number">5.0</span></span><br><span class="line"><span class="number">3</span>    NaN</span><br><span class="line"><span class="number">4</span>    <span class="number">6.0</span></span><br><span class="line"><span class="number">5</span>    <span class="number">8.0</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰ç”¨å«æ—¥æœŸæ—¶é—´ç´¢å¼•ä¸æ ‡ç­¾çš„ Numpy æ•°ç»„ç”Ÿæˆ DataFrame</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">5</span>]: dates = pd.date_range(<span class="string">'20130101'</span>, periods=<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: dates</span><br><span class="line">Out[<span class="number">6</span>]: </span><br><span class="line">DatetimeIndex([<span class="string">'2013-01-01'</span>, <span class="string">'2013-01-02'</span>, <span class="string">'2013-01-03'</span>, <span class="string">'2013-01-04'</span>,</span><br><span class="line">               <span class="string">'2013-01-05'</span>, <span class="string">'2013-01-06'</span>],</span><br><span class="line">              dtype=<span class="string">'datetime64[ns]'</span>, freq=<span class="string">'D'</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">7</span>]: df = pd.DataFrame(np.random.randn(<span class="number">6</span>, <span class="number">4</span>), index=dates, columns=<span class="built_in">list</span>(<span class="string">'ABCD'</span>))</span><br><span class="line"></span><br><span class="line">In [<span class="number">8</span>]: df</span><br><span class="line">Out[<span class="number">8</span>]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span></span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span></span><br><span class="line"><span class="number">2013</span>-01-06 -<span class="number">0.673690</span>  <span class="number">0.113648</span> -<span class="number">1.478427</span>  <span class="number">0.524988</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ3ï¼‰ç”¨ Series å­—å…¸å¯¹è±¡ç”Ÿæˆ DataFrame</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">9</span>]: df2 = pd.DataFrame({<span class="string">'A'</span>: <span class="number">1.</span>,</span><br><span class="line">   ...:                     <span class="string">'B'</span>: pd.Timestamp(<span class="string">'20130102'</span>),</span><br><span class="line">   ...:                     <span class="string">'C'</span>: pd.Series(<span class="number">1</span>, index=<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">4</span>)), dtype=<span class="string">'float32'</span>),</span><br><span class="line">   ...:                     <span class="string">'D'</span>: np.array([<span class="number">3</span>] * <span class="number">4</span>, dtype=<span class="string">'int32'</span>),</span><br><span class="line">   ...:                     <span class="string">'E'</span>: pd.Categorical([<span class="string">"test"</span>, <span class="string">"train"</span>, <span class="string">"test"</span>, <span class="string">"train"</span>]),</span><br><span class="line">   ...:                     <span class="string">'F'</span>: <span class="string">'foo'</span>})</span><br><span class="line">   ...: </span><br><span class="line"></span><br><span class="line">In [<span class="number">10</span>]: df2</span><br><span class="line">Out[<span class="number">10</span>]: </span><br><span class="line">     A          B    C  D      E    F</span><br><span class="line"><span class="number">0</span>  <span class="number">1.0</span> <span class="number">2013</span>-01-02  <span class="number">1.0</span>  <span class="number">3</span>   test  foo</span><br><span class="line"><span class="number">1</span>  <span class="number">1.0</span> <span class="number">2013</span>-01-02  <span class="number">1.0</span>  <span class="number">3</span>  train  foo</span><br><span class="line"><span class="number">2</span>  <span class="number">1.0</span> <span class="number">2013</span>-01-02  <span class="number">1.0</span>  <span class="number">3</span>   test  foo</span><br><span class="line"><span class="number">3</span>  <span class="number">1.0</span> <span class="number">2013</span>-01-02  <span class="number">1.0</span>  <span class="number">3</span>  train  foo</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ4ï¼‰DataFrame çš„åˆ—æœ‰ä¸åŒçš„æ•°æ®ç±»å‹</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">11</span>]: df2.dtypes</span><br><span class="line">Out[<span class="number">11</span>]: </span><br><span class="line">A           float64</span><br><span class="line">B    datetime64[ns]</span><br><span class="line">C           float32</span><br><span class="line">D             int32</span><br><span class="line">E          category</span><br><span class="line">F            <span class="built_in">object</span></span><br><span class="line">dtype: <span class="built_in">object</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="2ã€æŸ¥çœ‹æ•°æ®"><a href="#2ã€æŸ¥çœ‹æ•°æ®" class="headerlink" title="2ã€æŸ¥çœ‹æ•°æ®"></a>2ã€æŸ¥çœ‹æ•°æ®</h4><p>ï¼ˆ1ï¼‰æŸ¥çœ‹ DataFrame å¤´å°¾æ•°æ®ï¼Œé»˜è®¤é•¿åº¦ä¸º 5</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">13</span>]: df.head()</span><br><span class="line">Out[<span class="number">13</span>]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span></span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">14</span>]: df.tail(<span class="number">3</span>)</span><br><span class="line">Out[<span class="number">14</span>]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span></span><br><span class="line"><span class="number">2013</span>-01-06 -<span class="number">0.673690</span>  <span class="number">0.113648</span> -<span class="number">1.478427</span>  <span class="number">0.524988</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰æ˜¾ç¤ºç´¢å¼•ä¸åˆ—å</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">15</span>]: df.index</span><br><span class="line">Out[<span class="number">15</span>]: </span><br><span class="line">DatetimeIndex([<span class="string">'2013-01-01'</span>, <span class="string">'2013-01-02'</span>, <span class="string">'2013-01-03'</span>, <span class="string">'2013-01-04'</span>,</span><br><span class="line">               <span class="string">'2013-01-05'</span>, <span class="string">'2013-01-06'</span>],</span><br><span class="line">              dtype=<span class="string">'datetime64[ns]'</span>, freq=<span class="string">'D'</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">16</span>]: df.columns</span><br><span class="line">Out[<span class="number">16</span>]: Index([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>], dtype=<span class="string">'object'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ3ï¼‰å°† DataFrame è½¬æ¢ä¸º numpy</p>
<div class="note success">
            <p>æ³¨æ„ï¼ŒDataFrame çš„åˆ—ç”±<code>å¤šç§æ•°æ®ç±»å‹</code>ç»„æˆæ—¶ï¼Œè¯¥æ“ä½œ<code>è€—è´¹</code>ç³»ç»Ÿèµ„æºè¾ƒå¤§ã€‚</p><p>è¿™ä¹Ÿæ˜¯ Pandas å’Œ NumPy çš„æœ¬è´¨åŒºåˆ«ï¼š<strong>NumPy æ•°ç»„åªæœ‰ä¸€ç§æ•°æ®ç±»å‹ï¼ŒDataFrame æ¯åˆ—çš„æ•°æ®ç±»å‹å„ä¸ç›¸åŒ</strong>ã€‚</p><p>è°ƒç”¨ DataFrame.to_numpy()æ—¶ï¼ŒPandas æŸ¥æ‰¾æ”¯æŒ DataFrame é‡Œæ‰€æœ‰æ•°æ®ç±»å‹çš„ NumPy æ•°æ®ç±»å‹ã€‚è¿˜æœ‰ä¸€ç§æ•°æ®ç±»å‹æ˜¯ <code>object</code>ï¼Œå¯ä»¥æŠŠ DataFrame åˆ—é‡Œçš„å€¼å¼ºåˆ¶è½¬æ¢ä¸º Python å¯¹è±¡ã€‚</p>
          </div>
<p>ä¸‹é¢è¿™ä¸ª DataFrame ä¸­çš„å€¼éƒ½æ˜¯æµ®ç‚¹æ•°ï¼Œ å› æ­¤ DataFrame.to_numpy() ä¼šå¾ˆå¿«ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">17</span>]: df.to_numpy()</span><br><span class="line">Out[<span class="number">17</span>]: </span><br><span class="line">array([[ <span class="number">0.4691</span>, -<span class="number">0.2829</span>, -<span class="number">1.5091</span>, -<span class="number">1.1356</span>],</span><br><span class="line">       [ <span class="number">1.2121</span>, -<span class="number">0.1732</span>,  <span class="number">0.1192</span>, -<span class="number">1.0442</span>],</span><br><span class="line">       [-<span class="number">0.8618</span>, -<span class="number">2.1046</span>, -<span class="number">0.4949</span>,  <span class="number">1.0718</span>],</span><br><span class="line">       [ <span class="number">0.7216</span>, -<span class="number">0.7068</span>, -<span class="number">1.0396</span>,  <span class="number">0.2719</span>],</span><br><span class="line">       [-<span class="number">0.425</span> ,  <span class="number">0.567</span> ,  <span class="number">0.2762</span>, -<span class="number">1.0874</span>],</span><br><span class="line">       [-<span class="number">0.6737</span>,  <span class="number">0.1136</span>, -<span class="number">1.4784</span>,  <span class="number">0.525</span> ]])</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸‹é¢è¿™ä¸ª DataFrame ä¸­åŒ…å«äº†å¤šç§ç±»å‹ï¼Œå› æ­¤ DataFrame.to_numpy() æ“ä½œä¼šè€—è´¹è¾ƒå¤šèµ„æºã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">18</span>]: df2.to_numpy()</span><br><span class="line">Out[<span class="number">18</span>]: </span><br><span class="line">array([[<span class="number">1.0</span>, Timestamp(<span class="string">'2013-01-02 00:00:00'</span>), <span class="number">1.0</span>, <span class="number">3</span>, <span class="string">'test'</span>, <span class="string">'foo'</span>],</span><br><span class="line">       [<span class="number">1.0</span>, Timestamp(<span class="string">'2013-01-02 00:00:00'</span>), <span class="number">1.0</span>, <span class="number">3</span>, <span class="string">'train'</span>, <span class="string">'foo'</span>],</span><br><span class="line">       [<span class="number">1.0</span>, Timestamp(<span class="string">'2013-01-02 00:00:00'</span>), <span class="number">1.0</span>, <span class="number">3</span>, <span class="string">'test'</span>, <span class="string">'foo'</span>],</span><br><span class="line">       [<span class="number">1.0</span>, Timestamp(<span class="string">'2013-01-02 00:00:00'</span>), <span class="number">1.0</span>, <span class="number">3</span>, <span class="string">'train'</span>, <span class="string">'foo'</span>]], dtype=<span class="built_in">object</span>)</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ•ˆç‡å¯¹æ¯”ï¼šå·®äº†è¿‘ç™¾å€ã€‚</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">19</span>]: %timeit df.to_numpy()</span><br><span class="line">		 %timeit df2.to_numpy()</span><br><span class="line">Out[<span class="number">19</span>]:</span><br><span class="line"><span class="number">6.08</span> Âµs Â± <span class="number">273</span> ns per loop (mean Â± std. dev. of <span class="number">7</span> runs, <span class="number">100000</span> loops each)</span><br><span class="line"><span class="number">428</span> Âµs Â± <span class="number">22</span> Âµs per loop (mean Â± std. dev. of <span class="number">7</span> runs, <span class="number">1000</span> loops each)</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ4ï¼‰æŸ¥çœ‹æ•°æ®çš„ç»Ÿè®¡æ‘˜è¦</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">19</span>]: df.describe()</span><br><span class="line">Out[<span class="number">19</span>]: </span><br><span class="line">              A         B         C         D</span><br><span class="line">count  <span class="number">6.000000</span>  <span class="number">6.000000</span>  <span class="number">6.000000</span>  <span class="number">6.000000</span></span><br><span class="line">mean   <span class="number">0.073711</span> -<span class="number">0.431125</span> -<span class="number">0.687758</span> -<span class="number">0.233103</span></span><br><span class="line">std    <span class="number">0.843157</span>  <span class="number">0.922818</span>  <span class="number">0.779887</span>  <span class="number">0.973118</span></span><br><span class="line"><span class="built_in">min</span>   -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span></span><br><span class="line"><span class="number">25</span>%   -<span class="number">0.611510</span> -<span class="number">0.600794</span> -<span class="number">1.368714</span> -<span class="number">1.076610</span></span><br><span class="line"><span class="number">50</span>%    <span class="number">0.022070</span> -<span class="number">0.228039</span> -<span class="number">0.767252</span> -<span class="number">0.386188</span></span><br><span class="line"><span class="number">75</span>%    <span class="number">0.658444</span>  <span class="number">0.041933</span> -<span class="number">0.034326</span>  <span class="number">0.461706</span></span><br><span class="line"><span class="built_in">max</span>    <span class="number">1.212112</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span>  <span class="number">1.071804</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ5ï¼‰è½¬ç½®æ•°æ®</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">20</span>]: df.T</span><br><span class="line">Out[<span class="number">20</span>]: </span><br><span class="line">   <span class="number">2013</span>-01-01  <span class="number">2013</span>-01-02  <span class="number">2013</span>-01-03  <span class="number">2013</span>-01-04  <span class="number">2013</span>-01-05  <span class="number">2013</span>-01-06</span><br><span class="line">A    <span class="number">0.469112</span>    <span class="number">1.212112</span>   -<span class="number">0.861849</span>    <span class="number">0.721555</span>   -<span class="number">0.424972</span>   -<span class="number">0.673690</span></span><br><span class="line">B   -<span class="number">0.282863</span>   -<span class="number">0.173215</span>   -<span class="number">2.104569</span>   -<span class="number">0.706771</span>    <span class="number">0.567020</span>    <span class="number">0.113648</span></span><br><span class="line">C   -<span class="number">1.509059</span>    <span class="number">0.119209</span>   -<span class="number">0.494929</span>   -<span class="number">1.039575</span>    <span class="number">0.276232</span>   -<span class="number">1.478427</span></span><br><span class="line">D   -<span class="number">1.135632</span>   -<span class="number">1.044236</span>    <span class="number">1.071804</span>    <span class="number">0.271860</span>   -<span class="number">1.087401</span>    <span class="number">0.524988</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ6ï¼‰æŒ‰è½´æ’åº</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">21</span>]: df.sort_index(axis=<span class="number">1</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">Out[<span class="number">21</span>]: </span><br><span class="line">                   D         C         B         A</span><br><span class="line"><span class="number">2013</span>-01-01 -<span class="number">1.135632</span> -<span class="number">1.509059</span> -<span class="number">0.282863</span>  <span class="number">0.469112</span></span><br><span class="line"><span class="number">2013</span>-01-02 -<span class="number">1.044236</span>  <span class="number">0.119209</span> -<span class="number">0.173215</span>  <span class="number">1.212112</span></span><br><span class="line"><span class="number">2013</span>-01-03  <span class="number">1.071804</span> -<span class="number">0.494929</span> -<span class="number">2.104569</span> -<span class="number">0.861849</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.271860</span> -<span class="number">1.039575</span> -<span class="number">0.706771</span>  <span class="number">0.721555</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">1.087401</span>  <span class="number">0.276232</span>  <span class="number">0.567020</span> -<span class="number">0.424972</span></span><br><span class="line"><span class="number">2013</span>-01-06  <span class="number">0.524988</span> -<span class="number">1.478427</span>  <span class="number">0.113648</span> -<span class="number">0.673690</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ7ï¼‰æŒ‰å€¼æ’åº</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">22</span>]: df.sort_values(by=<span class="string">'B'</span>)</span><br><span class="line">Out[<span class="number">22</span>]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span></span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></span><br><span class="line"><span class="number">2013</span>-01-06 -<span class="number">0.673690</span>  <span class="number">0.113648</span> -<span class="number">1.478427</span>  <span class="number">0.524988</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="3ã€é€‰æ‹©"><a href="#3ã€é€‰æ‹©" class="headerlink" title="3ã€é€‰æ‹©"></a>3ã€é€‰æ‹©</h4><h6 id="3-1ã€è·å–æ•°æ®"><a href="#3-1ã€è·å–æ•°æ®" class="headerlink" title="3.1ã€è·å–æ•°æ®"></a>3.1ã€è·å–æ•°æ®</h6><p>ï¼ˆ1ï¼‰è·å–å•åˆ—ï¼Œäº§ç”Ÿ <code>Series</code>ï¼Œä¸ <code>df.A</code> ç­‰ä»·</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">23</span>]: df[<span class="string">'A'</span>]</span><br><span class="line">Out[<span class="number">23</span>]: </span><br><span class="line"><span class="number">2013</span>-01-01    <span class="number">0.469112</span></span><br><span class="line"><span class="number">2013</span>-01-02    <span class="number">1.212112</span></span><br><span class="line"><span class="number">2013</span>-01-03   -<span class="number">0.861849</span></span><br><span class="line"><span class="number">2013</span>-01-04    <span class="number">0.721555</span></span><br><span class="line"><span class="number">2013</span>-01-05   -<span class="number">0.424972</span></span><br><span class="line"><span class="number">2013</span>-01-06   -<span class="number">0.673690</span></span><br><span class="line">Freq: D, Name: A, dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰ç”¨ [ ] åˆ‡ç‰‡</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">24</span>]: df[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">Out[<span class="number">24</span>]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span></span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">25</span>]: df[<span class="string">'20130102'</span>:<span class="string">'20130104'</span>]</span><br><span class="line">Out[<span class="number">25</span>]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></span><br></pre></td></tr></tbody></table></figure>
<h6 id="3-2ã€æŒ‰æ ‡ç­¾é€‰æ‹©ï¼ˆlocï¼‰"><a href="#3-2ã€æŒ‰æ ‡ç­¾é€‰æ‹©ï¼ˆlocï¼‰" class="headerlink" title="3.2ã€æŒ‰æ ‡ç­¾é€‰æ‹©ï¼ˆlocï¼‰"></a>3.2ã€æŒ‰æ ‡ç­¾é€‰æ‹©ï¼ˆlocï¼‰</h6><p>ï¼ˆ1ï¼‰ç”¨æ ‡ç­¾æå–ä¸€è¡Œæ•°æ®</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">26</span>]: df.loc[dates[<span class="number">0</span>]]</span><br><span class="line">Out[<span class="number">26</span>]: </span><br><span class="line">A    <span class="number">0.469112</span></span><br><span class="line">B   -<span class="number">0.282863</span></span><br><span class="line">C   -<span class="number">1.509059</span></span><br><span class="line">D   -<span class="number">1.135632</span></span><br><span class="line">Name: <span class="number">2013</span>-01-01 <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>, dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰ç”¨æ ‡ç­¾æå–å¤šåˆ—æ•°æ®</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">27</span>]: df.loc[:, [<span class="string">'A'</span>, <span class="string">'B'</span>]]</span><br><span class="line">Out[<span class="number">27</span>]: </span><br><span class="line">                   A         B</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.469112</span> -<span class="number">0.282863</span></span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span>  <span class="number">0.567020</span></span><br><span class="line"><span class="number">2013</span>-01-06 -<span class="number">0.673690</span>  <span class="number">0.113648</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ3ï¼‰ç”¨æ ‡ç­¾åˆ‡ç‰‡ï¼Œ<code>å·¦é—­å³é—­</code></p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">28</span>]: df.loc[<span class="string">'20130102'</span>:<span class="string">'20130104'</span>, [<span class="string">'A'</span> : <span class="string">'B'</span>]]</span><br><span class="line">Out[<span class="number">28</span>]: </span><br><span class="line">                   A         B</span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ4ï¼‰è¿”å›å¯¹è±¡é™ç»´ï¼ˆæœ‰ä¸€ç»´ä½¿ç”¨åˆ—åç›´æ¥é€‰æ‹©ï¼‰</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">29</span>]: df.loc[<span class="string">'20130102'</span>, [<span class="string">'A'</span>, <span class="string">'B'</span>]]</span><br><span class="line">Out[<span class="number">29</span>]: </span><br><span class="line">A    <span class="number">1.212112</span></span><br><span class="line">B   -<span class="number">0.173215</span></span><br><span class="line">Name: <span class="number">2013</span>-01-02 <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>, dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ5ï¼‰æå–æ ‡é‡å€¼ï¼ˆå…¨éƒ¨ç»´åº¦éƒ½æ˜¯ç”¨åˆ—åç›´æ¥é€‰æ‹©ï¼‰</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">30</span>]: df.loc[dates[<span class="number">0</span>], <span class="string">'A'</span>]</span><br><span class="line">Out[<span class="number">30</span>]: <span class="number">0.46911229990718628</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ6ï¼‰å¿«é€Ÿè®¿é—®æ ‡é‡å€¼</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">31</span>]: df.at[dates[<span class="number">0</span>], <span class="string">'A'</span>]</span><br><span class="line">Out[<span class="number">31</span>]: <span class="number">0.46911229990718628</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ€§èƒ½å¯¹æ¯”ï¼šç›¸å·®25%ï¼Œè¿˜å¯ä»¥æ¥å—</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">31</span>]: %timeit df.loc[dates[<span class="number">0</span>], <span class="string">'A'</span>]</span><br><span class="line">         %timeit df.at[dates[<span class="number">0</span>], <span class="string">'A'</span>]</span><br><span class="line">Out[<span class="number">31</span>]:</span><br><span class="line"><span class="number">32.3</span> Âµs Â± <span class="number">764</span> ns per loop (mean Â± std. dev. of <span class="number">7</span> runs, <span class="number">10000</span> loops each)</span><br><span class="line"><span class="number">24.7</span> Âµs Â± <span class="number">580</span> ns per loop (mean Â± std. dev. of <span class="number">7</span> runs, <span class="number">10000</span> loops each)</span><br></pre></td></tr></tbody></table></figure>
<h6 id="3-3ã€æŒ‰ä½ç½®é€‰æ‹©ï¼ˆilocï¼‰ã€é‡ç‚¹ã€‘"><a href="#3-3ã€æŒ‰ä½ç½®é€‰æ‹©ï¼ˆilocï¼‰ã€é‡ç‚¹ã€‘" class="headerlink" title="3.3ã€æŒ‰ä½ç½®é€‰æ‹©ï¼ˆilocï¼‰ã€é‡ç‚¹ã€‘"></a>3.3ã€æŒ‰ä½ç½®é€‰æ‹©ï¼ˆilocï¼‰ã€é‡ç‚¹ã€‘</h6><p>ï¼ˆ1ï¼‰ç”¨æ•´æ•°ä½ç½®é€‰æ‹©</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">32</span>]: df.iloc[<span class="number">3</span>]</span><br><span class="line">Out[<span class="number">32</span>]: </span><br><span class="line">A    <span class="number">0.721555</span></span><br><span class="line">B   -<span class="number">0.706771</span></span><br><span class="line">C   -<span class="number">1.039575</span></span><br><span class="line">D    <span class="number">0.271860</span></span><br><span class="line">Name: <span class="number">2013</span>-01-04 <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>, dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰ç”¨æ•´æ•°åˆ‡ç‰‡ï¼Œ<code>å·¦é—­å³å¼€</code></p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">33</span>]: df.iloc[<span class="number">3</span>:<span class="number">5</span>, <span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">Out[<span class="number">33</span>]: </span><br><span class="line">                   A         B</span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span>  <span class="number">0.567020</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ3ï¼‰ç”¨æ•´æ•°åˆ—è¡¨æŒ‰ä½ç½®åˆ‡ç‰‡</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">34</span>]: df.iloc[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>], [<span class="number">0</span>, <span class="number">2</span>]]</span><br><span class="line">Out[<span class="number">34</span>]: </span><br><span class="line">                   A         C</span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span>  <span class="number">0.119209</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">0.494929</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span>  <span class="number">0.276232</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ4ï¼‰ æ˜¾å¼æ•´è¡Œåˆ‡ç‰‡</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">34</span>]: df.iloc[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>], [<span class="number">0</span>, <span class="number">2</span>]]</span><br><span class="line">Out[<span class="number">34</span>]: </span><br><span class="line">                   A         C</span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span>  <span class="number">0.119209</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">0.494929</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span>  <span class="number">0.276232</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ5ï¼‰æ˜¾å¼æ•´åˆ—åˆ‡ç‰‡</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">36</span>]: df.iloc[:, <span class="number">1</span>:<span class="number">3</span>]</span><br><span class="line">Out[<span class="number">36</span>]: </span><br><span class="line">                   B         C</span><br><span class="line"><span class="number">2013</span>-01-01 -<span class="number">0.282863</span> -<span class="number">1.509059</span></span><br><span class="line"><span class="number">2013</span>-01-02 -<span class="number">0.173215</span>  <span class="number">0.119209</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">2.104569</span> -<span class="number">0.494929</span></span><br><span class="line"><span class="number">2013</span>-01-04 -<span class="number">0.706771</span> -<span class="number">1.039575</span></span><br><span class="line"><span class="number">2013</span>-01-05  <span class="number">0.567020</span>  <span class="number">0.276232</span></span><br><span class="line"><span class="number">2013</span>-01-06  <span class="number">0.113648</span> -<span class="number">1.478427</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ6ï¼‰æ˜¾å¼æå–å€¼</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">37</span>]: df.iloc[<span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">Out[<span class="number">37</span>]: -<span class="number">0.17321464905330858</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ7ï¼‰å¿«é€Ÿè®¿é—®æ ‡é‡</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">38</span>]: df.iat[<span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">Out[<span class="number">38</span>]: -<span class="number">0.17321464905330858</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ€§èƒ½å¯¹æ¯”ï¼šç›¸å·®æ— å‡ ï¼Œ10%å·¦å³</strong>ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">39</span>]: %timeit df.iloc[<span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">         %timeit df.iat[<span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">Out[<span class="number">39</span>]:</span><br><span class="line"><span class="number">33.1</span> Âµs Â± <span class="number">578</span> ns per loop (mean Â± std. dev. of <span class="number">7</span> runs, <span class="number">10000</span> loops each)</span><br><span class="line"><span class="number">29</span> Âµs Â± <span class="number">911</span> ns per loop (mean Â± std. dev. of <span class="number">7</span> runs, <span class="number">10000</span> loops each)</span><br></pre></td></tr></tbody></table></figure>
<h6 id="3-4ã€å¸ƒå°”ç´¢å¼•"><a href="#3-4ã€å¸ƒå°”ç´¢å¼•" class="headerlink" title="3.4ã€å¸ƒå°”ç´¢å¼•"></a>3.4ã€å¸ƒå°”ç´¢å¼•</h6><p>ï¼ˆ1ï¼‰ç”¨å•åˆ—çš„å€¼é€‰æ‹©æ•°æ®</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">39</span>]: df[df.A &gt; <span class="number">0</span>]</span><br><span class="line">Out[<span class="number">39</span>]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span></span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰é€‰æ‹© DataFrame é‡Œæ»¡è¶³æ¡ä»¶çš„å€¼</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">40</span>]: df[df &gt; <span class="number">0</span>]</span><br><span class="line">Out[<span class="number">40</span>]: </span><br><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.469112</span>       NaN       NaN       NaN</span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span>       NaN  <span class="number">0.119209</span>       NaN</span><br><span class="line"><span class="number">2013</span>-01-03       NaN       NaN       NaN  <span class="number">1.071804</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span>       NaN       NaN  <span class="number">0.271860</span></span><br><span class="line"><span class="number">2013</span>-01-05       NaN  <span class="number">0.567020</span>  <span class="number">0.276232</span>       NaN</span><br><span class="line"><span class="number">2013</span>-01-06       NaN  <span class="number">0.113648</span>       NaN  <span class="number">0.524988</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ3ï¼‰ä½¿ç”¨ isin() ç­›é€‰</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">41</span>]: df2 = df.copy()</span><br><span class="line"></span><br><span class="line">In [<span class="number">42</span>]: df2[<span class="string">'E'</span>] = [<span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>, <span class="string">'three'</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">43</span>]: df2</span><br><span class="line">Out[<span class="number">43</span>]: </span><br><span class="line">                   A         B         C         D      E</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span>    one</span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span>    one</span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span>    two</span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span>  three</span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span>   four</span><br><span class="line"><span class="number">2013</span>-01-06 -<span class="number">0.673690</span>  <span class="number">0.113648</span> -<span class="number">1.478427</span>  <span class="number">0.524988</span>  three</span><br><span class="line"></span><br><span class="line">In [<span class="number">44</span>]: df2[df2[<span class="string">'E'</span>].isin([<span class="string">'two'</span>, <span class="string">'four'</span>])]</span><br><span class="line">Out[<span class="number">44</span>]: </span><br><span class="line">                   A         B         C         D     E</span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span>   two</span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span>  four</span><br></pre></td></tr></tbody></table></figure>
<h6 id="3-5ã€èµ‹å€¼"><a href="#3-5ã€èµ‹å€¼" class="headerlink" title="3.5ã€èµ‹å€¼"></a>3.5ã€èµ‹å€¼</h6><p>df</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">                   A         B         C         D</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.469112</span> -<span class="number">0.282863</span> -<span class="number">1.509059</span> -<span class="number">1.135632</span></span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span> -<span class="number">1.044236</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">1.071804</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">0.271860</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span> -<span class="number">1.087401</span></span><br><span class="line"><span class="number">2013</span>-01-06 -<span class="number">0.673690</span>  <span class="number">0.113648</span> -<span class="number">1.478427</span>  <span class="number">0.524988</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ1ï¼‰ç”¨ç´¢å¼•è‡ªåŠ¨å¯¹é½æ–°å¢åˆ—çš„æ•°æ®</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">45</span>]: s1 = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], index=pd.date_range(<span class="string">'20130102'</span>, periods=<span class="number">6</span>))</span><br><span class="line"></span><br><span class="line">In [<span class="number">46</span>]: s1</span><br><span class="line">Out[<span class="number">46</span>]: </span><br><span class="line"><span class="number">2013</span>-01-02    <span class="number">1</span></span><br><span class="line"><span class="number">2013</span>-01-03    <span class="number">2</span></span><br><span class="line"><span class="number">2013</span>-01-04    <span class="number">3</span></span><br><span class="line"><span class="number">2013</span>-01-05    <span class="number">4</span></span><br><span class="line"><span class="number">2013</span>-01-06    <span class="number">5</span></span><br><span class="line"><span class="number">2013</span>-01-07    <span class="number">6</span></span><br><span class="line">Freq: D, dtype: int64</span><br><span class="line"></span><br><span class="line">In [<span class="number">47</span>]: df[<span class="string">'F'</span>] = s1</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰æŒ‰æ ‡ç­¾èµ‹å€¼</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">48</span>]: df.at[dates[<span class="number">0</span>], <span class="string">'A'</span>] = <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ3ï¼‰æŒ‰ä½ç½®èµ‹å€¼</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">49</span>]: df.iat[<span class="number">0</span>, <span class="number">1</span>] = <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ4ï¼‰æŒ‰ Numpy èµ‹å€¼</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">50</span>]: df.loc[:, <span class="string">'D'</span>] = np.array([<span class="number">5</span>] * <span class="built_in">len</span>(df))</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸Šè¿°ç»“æœ</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">51</span>]: df</span><br><span class="line">Out[<span class="number">51</span>]: </span><br><span class="line">                   A         B         C  D    F</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.000000</span>  <span class="number">0.000000</span> -<span class="number">1.509059</span>  <span class="number">5</span>  NaN</span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span>  <span class="number">5</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">5</span>  <span class="number">2.0</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">5</span>  <span class="number">3.0</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span>  <span class="number">0.567020</span>  <span class="number">0.276232</span>  <span class="number">5</span>  <span class="number">4.0</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ5ï¼‰ä½¿ç”¨ <code>where</code> æ¡ä»¶èµ‹å€¼</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">52</span>]: df2 = df.copy()</span><br><span class="line"></span><br><span class="line">In [<span class="number">53</span>]: df2[df2 &gt; <span class="number">0</span>] = -df2</span><br><span class="line"></span><br><span class="line">In [<span class="number">54</span>]: df2</span><br><span class="line">Out[<span class="number">54</span>]: </span><br><span class="line">                   A         B         C  D    F</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.000000</span>  <span class="number">0.000000</span> -<span class="number">1.509059</span> -<span class="number">5</span>  NaN</span><br><span class="line"><span class="number">2013</span>-01-02 -<span class="number">1.212112</span> -<span class="number">0.173215</span> -<span class="number">0.119209</span> -<span class="number">5</span> -<span class="number">1.0</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span> -<span class="number">5</span> -<span class="number">2.0</span></span><br><span class="line"><span class="number">2013</span>-01-04 -<span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span> -<span class="number">5</span> -<span class="number">3.0</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">0.424972</span> -<span class="number">0.567020</span> -<span class="number">0.276232</span> -<span class="number">5</span> -<span class="number">4.0</span></span><br><span class="line"><span class="number">2013</span>-01-06 -<span class="number">0.673690</span> -<span class="number">0.113648</span> -<span class="number">1.478427</span> -<span class="number">5</span> -<span class="number">5.0</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="4ã€ç¼ºå¤±å€¼"><a href="#4ã€ç¼ºå¤±å€¼" class="headerlink" title="4ã€ç¼ºå¤±å€¼"></a>4ã€ç¼ºå¤±å€¼</h4><p>Pandas ä¸»è¦ç”¨ <code>np.nan</code> è¡¨ç¤ºç¼ºå¤±æ•°æ®ã€‚ è®¡ç®—æ—¶ï¼Œé»˜è®¤ä¸åŒ…å«ç©ºå€¼ã€‚</p>
<p>ï¼ˆ1ï¼‰é‡å»ºç´¢å¼•ï¼ˆreindexï¼‰</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">55</span>]: df1 = df.reindex(index=dates[<span class="number">0</span>:<span class="number">4</span>], columns=<span class="built_in">list</span>(df.columns) + [<span class="string">'E'</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">56</span>]: df1.loc[dates[<span class="number">0</span>]:dates[<span class="number">1</span>], <span class="string">'E'</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">57</span>]: df1</span><br><span class="line">Out[<span class="number">57</span>]: </span><br><span class="line">                   A         B         C  D    F    E</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.000000</span>  <span class="number">0.000000</span> -<span class="number">1.509059</span>  <span class="number">5</span>  NaN  <span class="number">1.0</span></span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span>  <span class="number">5</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">5</span>  <span class="number">2.0</span>  NaN</span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">5</span>  <span class="number">3.0</span>  NaN</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰åˆ é™¤æ‰€æœ‰å«ç¼ºå¤±å€¼çš„è¡Œ</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">58</span>]: df1.dropna(how=<span class="string">'any'</span>)</span><br><span class="line">Out[<span class="number">58</span>]: </span><br><span class="line">                   A         B         C  D    F    E</span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span>  <span class="number">5</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ3ï¼‰å¡«å……ç¼ºå¤±å€¼</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">59</span>]: df1.fillna(value=<span class="number">5</span>)</span><br><span class="line">Out[<span class="number">59</span>]: </span><br><span class="line">                   A         B         C  D    F    E</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.000000</span>  <span class="number">0.000000</span> -<span class="number">1.509059</span>  <span class="number">5</span>  <span class="number">5.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span>  <span class="number">0.119209</span>  <span class="number">5</span>  <span class="number">1.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">0.861849</span> -<span class="number">2.104569</span> -<span class="number">0.494929</span>  <span class="number">5</span>  <span class="number">2.0</span>  <span class="number">5.0</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">0.721555</span> -<span class="number">0.706771</span> -<span class="number">1.039575</span>  <span class="number">5</span>  <span class="number">3.0</span>  <span class="number">5.0</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ4ï¼‰è·å– <code>nan</code> å€¼çš„å¸ƒå°”æ©ç </p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">60</span>]: pd.isna(df1)</span><br><span class="line">Out[<span class="number">60</span>]: </span><br><span class="line">                A      B      C      D      F      E</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>   <span class="literal">True</span>  <span class="literal">False</span></span><br><span class="line"><span class="number">2013</span>-01-02  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span></span><br><span class="line"><span class="number">2013</span>-01-03  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>   <span class="literal">True</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>  <span class="literal">False</span>   <span class="literal">True</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="5ã€è¿ç®—"><a href="#5ã€è¿ç®—" class="headerlink" title="5ã€è¿ç®—"></a>5ã€è¿ç®—</h4><h6 id="5-1ã€ç»Ÿè®¡"><a href="#5-1ã€ç»Ÿè®¡" class="headerlink" title="5.1ã€ç»Ÿè®¡"></a>5.1ã€ç»Ÿè®¡</h6><p>æµ‹è¯•æ•°æ®</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">                   A	       B            C	D	  F</span><br><span class="line"><span class="number">2013</span>-01-01	<span class="number">0.000000</span>	<span class="number">0.000000</span>	-<span class="number">0.051685</span>	<span class="number">5</span>	NaN</span><br><span class="line"><span class="number">2013</span>-01-02	-<span class="number">1.009592</span>	<span class="number">0.141643</span>	<span class="number">1.249475</span>	<span class="number">5</span>	<span class="number">1.0</span></span><br><span class="line"><span class="number">2013</span>-01-03	<span class="number">1.347492</span>	<span class="number">0.366389</span>	<span class="number">0.202027</span>	<span class="number">5</span>	<span class="number">2.0</span></span><br><span class="line"><span class="number">2013</span>-01-04	-<span class="number">2.973315</span>	<span class="number">1.455753</span>	<span class="number">0.257986</span>	<span class="number">5</span>	<span class="number">3.0</span></span><br><span class="line"><span class="number">2013</span>-01-05	<span class="number">0.792836</span>	<span class="number">0.896040</span>	-<span class="number">0.443788</span>	<span class="number">5</span>	<span class="number">4.0</span></span><br><span class="line"><span class="number">2013</span>-01-06	-<span class="number">1.452124</span>	<span class="number">0.465876</span>	<span class="number">0.698220</span>	<span class="number">5</span>	<span class="number">5.0</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ1ï¼‰ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿ç®—æ—¶<code>æ’é™¤</code>ç¼ºå¤±å€¼</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">61</span>]: df.mean()</span><br><span class="line">Out[<span class="number">61</span>]: </span><br><span class="line">A   -<span class="number">0.004474</span></span><br><span class="line">B   -<span class="number">0.383981</span></span><br><span class="line">C   -<span class="number">0.687758</span></span><br><span class="line">D    <span class="number">5.000000</span></span><br><span class="line">F    <span class="number">3.000000</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰æŒ‡å®šè½´è¿›è¡Œè¿ç®—</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">62</span>]: df.mean(<span class="number">1</span>)</span><br><span class="line">Out[<span class="number">62</span>]: </span><br><span class="line"><span class="number">2013</span>-01-01    <span class="number">0.872735</span></span><br><span class="line"><span class="number">2013</span>-01-02    <span class="number">1.431621</span></span><br><span class="line"><span class="number">2013</span>-01-03    <span class="number">0.707731</span></span><br><span class="line"><span class="number">2013</span>-01-04    <span class="number">1.395042</span></span><br><span class="line"><span class="number">2013</span>-01-05    <span class="number">1.883656</span></span><br><span class="line"><span class="number">2013</span>-01-06    <span class="number">1.592306</span></span><br><span class="line">Freq: D, dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ3ï¼‰ä¸åŒç»´åº¦å¯¹è±¡è¿ç®—æ—¶ï¼Œè¦å…ˆå¯¹é½ã€‚æ­¤å¤–ï¼ŒPandas è‡ªåŠ¨æ²¿æŒ‡å®šç»´åº¦<code>å¹¿æ’­</code></p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">63</span>]: s = pd.Series([<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, np.nan, <span class="number">6</span>, <span class="number">8</span>], index=dates).shift(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">64</span>]: s</span><br><span class="line">Out[<span class="number">64</span>]: </span><br><span class="line"><span class="number">2013</span>-01-01    NaN</span><br><span class="line"><span class="number">2013</span>-01-02    NaN</span><br><span class="line"><span class="number">2013</span>-01-03    <span class="number">1.0</span></span><br><span class="line"><span class="number">2013</span>-01-04    <span class="number">3.0</span></span><br><span class="line"><span class="number">2013</span>-01-05    <span class="number">5.0</span></span><br><span class="line"><span class="number">2013</span>-01-06    NaN</span><br><span class="line">Freq: D, dtype: float64</span><br><span class="line"></span><br><span class="line">In [<span class="number">65</span>]: df.sub(s, axis=<span class="string">'index'</span>)</span><br><span class="line">Out[<span class="number">65</span>]: </span><br><span class="line">                   A         B         C    D    F</span><br><span class="line"><span class="number">2013</span>-01-01       NaN       NaN       NaN  NaN  NaN</span><br><span class="line"><span class="number">2013</span>-01-02       NaN       NaN       NaN  NaN  NaN</span><br><span class="line"><span class="number">2013</span>-01-03 -<span class="number">1.861849</span> -<span class="number">3.104569</span> -<span class="number">1.494929</span>  <span class="number">4.0</span>  <span class="number">1.0</span></span><br><span class="line"><span class="number">2013</span>-01-04 -<span class="number">2.278445</span> -<span class="number">3.706771</span> -<span class="number">4.039575</span>  <span class="number">2.0</span>  <span class="number">0.0</span></span><br><span class="line"><span class="number">2013</span>-01-05 -<span class="number">5.424972</span> -<span class="number">4.432980</span> -<span class="number">4.723768</span>  <span class="number">0.0</span> -<span class="number">1.0</span></span><br><span class="line"><span class="number">2013</span>-01-06       NaN       NaN       NaN  NaN  NaN</span><br></pre></td></tr></tbody></table></figure>
<h6 id="5-2ã€Apply-æ˜ å°„å‡½æ•°"><a href="#5-2ã€Apply-æ˜ å°„å‡½æ•°" class="headerlink" title="5.2ã€Apply æ˜ å°„å‡½æ•°"></a>5.2ã€Apply æ˜ å°„å‡½æ•°</h6><p>å¯ä»¥å¯¹æ‰€æœ‰è¡Œ/åˆ—è¿›è¡Œç»Ÿä¸€æ˜ å°„æ“ä½œï¼Œé»˜è®¤ä¸ºåˆ—</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">66</span>]: df.apply(np.cumsum)</span><br><span class="line">Out[<span class="number">66</span>]: </span><br><span class="line">                   A         B         C   D     F</span><br><span class="line"><span class="number">2013</span>-01-01  <span class="number">0.000000</span>  <span class="number">0.000000</span> -<span class="number">1.509059</span>   <span class="number">5</span>   NaN</span><br><span class="line"><span class="number">2013</span>-01-02  <span class="number">1.212112</span> -<span class="number">0.173215</span> -<span class="number">1.389850</span>  <span class="number">10</span>   <span class="number">1.0</span></span><br><span class="line"><span class="number">2013</span>-01-03  <span class="number">0.350263</span> -<span class="number">2.277784</span> -<span class="number">1.884779</span>  <span class="number">15</span>   <span class="number">3.0</span></span><br><span class="line"><span class="number">2013</span>-01-04  <span class="number">1.071818</span> -<span class="number">2.984555</span> -<span class="number">2.924354</span>  <span class="number">20</span>   <span class="number">6.0</span></span><br><span class="line"><span class="number">2013</span>-01-05  <span class="number">0.646846</span> -<span class="number">2.417535</span> -<span class="number">2.648122</span>  <span class="number">25</span>  <span class="number">10.0</span></span><br><span class="line"><span class="number">2013</span>-01-06 -<span class="number">0.026844</span> -<span class="number">2.303886</span> -<span class="number">4.126549</span>  <span class="number">30</span>  <span class="number">15.0</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">67</span>]: df.apply(<span class="keyword">lambda</span> x: x.<span class="built_in">max</span>() - x.<span class="built_in">min</span>())</span><br><span class="line">Out[<span class="number">67</span>]: </span><br><span class="line">A    <span class="number">2.073961</span></span><br><span class="line">B    <span class="number">2.671590</span></span><br><span class="line">C    <span class="number">1.785291</span></span><br><span class="line">D    <span class="number">0.000000</span></span><br><span class="line">F    <span class="number">4.000000</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<h6 id="5-3ã€ç»Ÿè®¡å‡½æ•°ï¼ˆvalue-countsï¼‰"><a href="#5-3ã€ç»Ÿè®¡å‡½æ•°ï¼ˆvalue-countsï¼‰" class="headerlink" title="5.3ã€ç»Ÿè®¡å‡½æ•°ï¼ˆvalue_countsï¼‰"></a>5.3ã€ç»Ÿè®¡å‡½æ•°ï¼ˆvalue_countsï¼‰</h6><p>ç»Ÿè®¡æ¯ä¸ªå€¼å‡ºç°çš„æ¬¡æ•°</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">68</span>]: s = pd.Series(np.random.randint(<span class="number">0</span>, <span class="number">7</span>, size=<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line">In [<span class="number">69</span>]: s</span><br><span class="line">Out[<span class="number">69</span>]: </span><br><span class="line"><span class="number">0</span>    <span class="number">4</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2</span></span><br><span class="line"><span class="number">2</span>    <span class="number">1</span></span><br><span class="line"><span class="number">3</span>    <span class="number">2</span></span><br><span class="line"><span class="number">4</span>    <span class="number">6</span></span><br><span class="line"><span class="number">5</span>    <span class="number">4</span></span><br><span class="line"><span class="number">6</span>    <span class="number">4</span></span><br><span class="line"><span class="number">7</span>    <span class="number">6</span></span><br><span class="line"><span class="number">8</span>    <span class="number">4</span></span><br><span class="line"><span class="number">9</span>    <span class="number">4</span></span><br><span class="line">dtype: int64</span><br><span class="line"></span><br><span class="line">In [<span class="number">70</span>]: s.value_counts()</span><br><span class="line">Out[<span class="number">70</span>]: </span><br><span class="line"><span class="number">4</span>    <span class="number">5</span></span><br><span class="line"><span class="number">6</span>    <span class="number">2</span></span><br><span class="line"><span class="number">2</span>    <span class="number">2</span></span><br><span class="line"><span class="number">1</span>    <span class="number">1</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></tbody></table></figure>
<h6 id="5-4ã€å­—ç¬¦ä¸²æ–¹æ³•"><a href="#5-4ã€å­—ç¬¦ä¸²æ–¹æ³•" class="headerlink" title="5.4ã€å­—ç¬¦ä¸²æ–¹æ³•"></a>5.4ã€å­—ç¬¦ä¸²æ–¹æ³•</h6><p>Series çš„ <code>str</code> å±æ€§åŒ…å«ä¸€ç»„å­—ç¬¦ä¸²å¤„ç†åŠŸèƒ½ã€‚æ³¨æ„ï¼Œ<code>str</code> çš„æ¨¡å¼åŒ¹é…é»˜è®¤ä½¿ç”¨çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">71</span>]: s = pd.Series([<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'Aaba'</span>, <span class="string">'Baca'</span>, np.nan, <span class="string">'CABA'</span>, <span class="string">'dog'</span>, <span class="string">'cat'</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">72</span>]: s.<span class="built_in">str</span>.lower()</span><br><span class="line">Out[<span class="number">72</span>]: </span><br><span class="line"><span class="number">0</span>       a</span><br><span class="line"><span class="number">1</span>       b</span><br><span class="line"><span class="number">2</span>       c</span><br><span class="line"><span class="number">3</span>    aaba</span><br><span class="line"><span class="number">4</span>    baca</span><br><span class="line"><span class="number">5</span>     NaN</span><br><span class="line"><span class="number">6</span>    caba</span><br><span class="line"><span class="number">7</span>     dog</span><br><span class="line"><span class="number">8</span>     cat</span><br><span class="line">dtype: <span class="built_in">object</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="6ã€åˆå¹¶ï¼ˆMergeï¼‰"><a href="#6ã€åˆå¹¶ï¼ˆMergeï¼‰" class="headerlink" title="6ã€åˆå¹¶ï¼ˆMergeï¼‰"></a>6ã€åˆå¹¶ï¼ˆMergeï¼‰</h4><p>Pandas æä¾›äº†å¤šç§å°† Seriesã€DataFrame å¯¹è±¡ç»„åˆåœ¨ä¸€èµ·çš„åŠŸèƒ½ï¼Œç”¨ç´¢å¼•ä¸å…³è”ä»£æ•°åŠŸèƒ½çš„å¤šç§è®¾ç½®é€»è¾‘å¯æ‰§è¡Œè¿æ¥ï¼ˆjoinï¼‰ä¸åˆå¹¶ï¼ˆmergeï¼‰æ“ä½œã€‚</p>
<h6 id="6-1ã€ç»“åˆï¼ˆConcatï¼‰"><a href="#6-1ã€ç»“åˆï¼ˆConcatï¼‰" class="headerlink" title="6.1ã€ç»“åˆï¼ˆConcatï¼‰"></a>6.1ã€ç»“åˆï¼ˆConcatï¼‰</h6><p>ç”¨äºè¿æ¥ pandas å¯¹è±¡</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">73</span>]: df = pd.DataFrame(np.random.randn(<span class="number">10</span>, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">In [<span class="number">74</span>]: df</span><br><span class="line">Out[<span class="number">74</span>]: </span><br><span class="line">          <span class="number">0</span>         <span class="number">1</span>         <span class="number">2</span>         <span class="number">3</span></span><br><span class="line"><span class="number">0</span> -<span class="number">0.548702</span>  <span class="number">1.467327</span> -<span class="number">1.015962</span> -<span class="number">0.483075</span></span><br><span class="line"><span class="number">1</span>  <span class="number">1.637550</span> -<span class="number">1.217659</span> -<span class="number">0.291519</span> -<span class="number">1.745505</span></span><br><span class="line"><span class="number">2</span> -<span class="number">0.263952</span>  <span class="number">0.991460</span> -<span class="number">0.919069</span>  <span class="number">0.266046</span></span><br><span class="line"><span class="number">3</span> -<span class="number">0.709661</span>  <span class="number">1.669052</span>  <span class="number">1.037882</span> -<span class="number">1.705775</span></span><br><span class="line"><span class="number">4</span> -<span class="number">0.919854</span> -<span class="number">0.042379</span>  <span class="number">1.247642</span> -<span class="number">0.009920</span></span><br><span class="line"><span class="number">5</span>  <span class="number">0.290213</span>  <span class="number">0.495767</span>  <span class="number">0.362949</span>  <span class="number">1.548106</span></span><br><span class="line"><span class="number">6</span> -<span class="number">1.131345</span> -<span class="number">0.089329</span>  <span class="number">0.337863</span> -<span class="number">0.945867</span></span><br><span class="line"><span class="number">7</span> -<span class="number">0.932132</span>  <span class="number">1.956030</span>  <span class="number">0.017587</span> -<span class="number">0.016692</span></span><br><span class="line"><span class="number">8</span> -<span class="number">0.575247</span>  <span class="number">0.254161</span> -<span class="number">1.143704</span>  <span class="number">0.215897</span></span><br><span class="line"><span class="number">9</span>  <span class="number">1.193555</span> -<span class="number">0.077118</span> -<span class="number">0.408530</span> -<span class="number">0.862495</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†è§£ä¸ºå¤šç»„</span></span><br><span class="line">In [<span class="number">75</span>]: pieces = [df[:<span class="number">3</span>], df[<span class="number">3</span>:<span class="number">7</span>], df[<span class="number">7</span>:]]</span><br><span class="line"></span><br><span class="line">In [<span class="number">76</span>]: pd.concat(pieces)</span><br><span class="line">Out[<span class="number">76</span>]: </span><br><span class="line">          <span class="number">0</span>         <span class="number">1</span>         <span class="number">2</span>         <span class="number">3</span></span><br><span class="line"><span class="number">0</span> -<span class="number">0.548702</span>  <span class="number">1.467327</span> -<span class="number">1.015962</span> -<span class="number">0.483075</span></span><br><span class="line"><span class="number">1</span>  <span class="number">1.637550</span> -<span class="number">1.217659</span> -<span class="number">0.291519</span> -<span class="number">1.745505</span></span><br><span class="line"><span class="number">2</span> -<span class="number">0.263952</span>  <span class="number">0.991460</span> -<span class="number">0.919069</span>  <span class="number">0.266046</span></span><br><span class="line"><span class="number">3</span> -<span class="number">0.709661</span>  <span class="number">1.669052</span>  <span class="number">1.037882</span> -<span class="number">1.705775</span></span><br><span class="line"><span class="number">4</span> -<span class="number">0.919854</span> -<span class="number">0.042379</span>  <span class="number">1.247642</span> -<span class="number">0.009920</span></span><br><span class="line"><span class="number">5</span>  <span class="number">0.290213</span>  <span class="number">0.495767</span>  <span class="number">0.362949</span>  <span class="number">1.548106</span></span><br><span class="line"><span class="number">6</span> -<span class="number">1.131345</span> -<span class="number">0.089329</span>  <span class="number">0.337863</span> -<span class="number">0.945867</span></span><br><span class="line"><span class="number">7</span> -<span class="number">0.932132</span>  <span class="number">1.956030</span>  <span class="number">0.017587</span> -<span class="number">0.016692</span></span><br><span class="line"><span class="number">8</span> -<span class="number">0.575247</span>  <span class="number">0.254161</span> -<span class="number">1.143704</span>  <span class="number">0.215897</span></span><br><span class="line"><span class="number">9</span>  <span class="number">1.193555</span> -<span class="number">0.077118</span> -<span class="number">0.408530</span> -<span class="number">0.862495</span></span><br></pre></td></tr></tbody></table></figure>
<h6 id="6-2ã€è¿æ¥ï¼ˆJoinï¼‰"><a href="#6-2ã€è¿æ¥ï¼ˆJoinï¼‰" class="headerlink" title="6.2ã€è¿æ¥ï¼ˆJoinï¼‰"></a>6.2ã€è¿æ¥ï¼ˆJoinï¼‰</h6><p>SQL é£æ ¼çš„åˆå¹¶</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">77</span>]: left = pd.DataFrame({<span class="string">'key'</span>: [<span class="string">'foo'</span>, <span class="string">'foo'</span>], <span class="string">'lval'</span>: [<span class="number">1</span>, <span class="number">2</span>]})</span><br><span class="line"></span><br><span class="line">In [<span class="number">78</span>]: right = pd.DataFrame({<span class="string">'key'</span>: [<span class="string">'foo'</span>, <span class="string">'foo'</span>], <span class="string">'rval'</span>: [<span class="number">4</span>, <span class="number">5</span>]})</span><br><span class="line"></span><br><span class="line">In [<span class="number">79</span>]: left</span><br><span class="line">Out[<span class="number">79</span>]: </span><br><span class="line">   key  lval</span><br><span class="line"><span class="number">0</span>  foo     <span class="number">1</span></span><br><span class="line"><span class="number">1</span>  foo     <span class="number">2</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">80</span>]: right</span><br><span class="line">Out[<span class="number">80</span>]: </span><br><span class="line">   key  rval</span><br><span class="line"><span class="number">0</span>  foo     <span class="number">4</span></span><br><span class="line"><span class="number">1</span>  foo     <span class="number">5</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">81</span>]: pd.merge(left, right, on=<span class="string">'key'</span>)</span><br><span class="line">Out[<span class="number">81</span>]: </span><br><span class="line">   key  lval  rval</span><br><span class="line"><span class="number">0</span>  foo     <span class="number">1</span>     <span class="number">4</span></span><br><span class="line"><span class="number">1</span>  foo     <span class="number">1</span>     <span class="number">5</span></span><br><span class="line"><span class="number">2</span>  foo     <span class="number">2</span>     <span class="number">4</span></span><br><span class="line"><span class="number">3</span>  foo     <span class="number">2</span>     <span class="number">5</span></span><br></pre></td></tr></tbody></table></figure>
<p>è¿™é‡Œè¿˜æœ‰å¦ä¸€ä¸ªä¾‹å­</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">82</span>]: left = pd.DataFrame({<span class="string">'key'</span>: [<span class="string">'foo'</span>, <span class="string">'bar'</span>], <span class="string">'lval'</span>: [<span class="number">1</span>, <span class="number">2</span>]})</span><br><span class="line"></span><br><span class="line">In [<span class="number">83</span>]: right = pd.DataFrame({<span class="string">'key'</span>: [<span class="string">'foo'</span>, <span class="string">'bar'</span>], <span class="string">'rval'</span>: [<span class="number">4</span>, <span class="number">5</span>]})</span><br><span class="line"></span><br><span class="line">In [<span class="number">84</span>]: left</span><br><span class="line">Out[<span class="number">84</span>]: </span><br><span class="line">   key  lval</span><br><span class="line"><span class="number">0</span>  foo     <span class="number">1</span></span><br><span class="line"><span class="number">1</span>  bar     <span class="number">2</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">85</span>]: right</span><br><span class="line">Out[<span class="number">85</span>]: </span><br><span class="line">   key  rval</span><br><span class="line"><span class="number">0</span>  foo     <span class="number">4</span></span><br><span class="line"><span class="number">1</span>  bar     <span class="number">5</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">86</span>]: pd.merge(left, right, on=<span class="string">'key'</span>)</span><br><span class="line">Out[<span class="number">86</span>]: </span><br><span class="line">   key  lval  rval</span><br><span class="line"><span class="number">0</span>  foo     <span class="number">1</span>     <span class="number">4</span></span><br><span class="line"><span class="number">1</span>  bar     <span class="number">2</span>     <span class="number">5</span></span><br></pre></td></tr></tbody></table></figure>
<h6 id="6-3ã€è¿½åŠ ï¼ˆAppendï¼‰"><a href="#6-3ã€è¿½åŠ ï¼ˆAppendï¼‰" class="headerlink" title="6.3ã€è¿½åŠ ï¼ˆAppendï¼‰"></a>6.3ã€è¿½åŠ ï¼ˆAppendï¼‰</h6><p>ä¸º DataFrame è¿½åŠ è¡Œ</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">87</span>]: df = pd.DataFrame(np.random.randn(<span class="number">8</span>, <span class="number">4</span>), columns=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">88</span>]: df</span><br><span class="line">Out[<span class="number">88</span>]: </span><br><span class="line">          A         B         C         D</span><br><span class="line"><span class="number">0</span>  <span class="number">1.346061</span>  <span class="number">1.511763</span>  <span class="number">1.627081</span> -<span class="number">0.990582</span></span><br><span class="line"><span class="number">1</span> -<span class="number">0.441652</span>  <span class="number">1.211526</span>  <span class="number">0.268520</span>  <span class="number">0.024580</span></span><br><span class="line"><span class="number">2</span> -<span class="number">1.577585</span>  <span class="number">0.396823</span> -<span class="number">0.105381</span> -<span class="number">0.532532</span></span><br><span class="line"><span class="number">3</span>  <span class="number">1.453749</span>  <span class="number">1.208843</span> -<span class="number">0.080952</span> -<span class="number">0.264610</span></span><br><span class="line"><span class="number">4</span> -<span class="number">0.727965</span> -<span class="number">0.589346</span>  <span class="number">0.339969</span> -<span class="number">0.693205</span></span><br><span class="line"><span class="number">5</span> -<span class="number">0.339355</span>  <span class="number">0.593616</span>  <span class="number">0.884345</span>  <span class="number">1.591431</span></span><br><span class="line"><span class="number">6</span>  <span class="number">0.141809</span>  <span class="number">0.220390</span>  <span class="number">0.435589</span>  <span class="number">0.192451</span></span><br><span class="line"><span class="number">7</span> -<span class="number">0.096701</span>  <span class="number">0.803351</span>  <span class="number">1.715071</span> -<span class="number">0.708758</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">89</span>]: s = df.iloc[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ignore_index=Trueï¼Œå¿½ç•¥åŸå…ˆçš„index</span></span><br><span class="line">In [<span class="number">90</span>]: df.append(s, ignore_index=<span class="literal">True</span>)</span><br><span class="line">Out[<span class="number">90</span>]: </span><br><span class="line">          A         B         C         D</span><br><span class="line"><span class="number">0</span>  <span class="number">1.346061</span>  <span class="number">1.511763</span>  <span class="number">1.627081</span> -<span class="number">0.990582</span></span><br><span class="line"><span class="number">1</span> -<span class="number">0.441652</span>  <span class="number">1.211526</span>  <span class="number">0.268520</span>  <span class="number">0.024580</span></span><br><span class="line"><span class="number">2</span> -<span class="number">1.577585</span>  <span class="number">0.396823</span> -<span class="number">0.105381</span> -<span class="number">0.532532</span></span><br><span class="line"><span class="number">3</span>  <span class="number">1.453749</span>  <span class="number">1.208843</span> -<span class="number">0.080952</span> -<span class="number">0.264610</span></span><br><span class="line"><span class="number">4</span> -<span class="number">0.727965</span> -<span class="number">0.589346</span>  <span class="number">0.339969</span> -<span class="number">0.693205</span></span><br><span class="line"><span class="number">5</span> -<span class="number">0.339355</span>  <span class="number">0.593616</span>  <span class="number">0.884345</span>  <span class="number">1.591431</span></span><br><span class="line"><span class="number">6</span>  <span class="number">0.141809</span>  <span class="number">0.220390</span>  <span class="number">0.435589</span>  <span class="number">0.192451</span></span><br><span class="line"><span class="number">7</span> -<span class="number">0.096701</span>  <span class="number">0.803351</span>  <span class="number">1.715071</span> -<span class="number">0.708758</span></span><br><span class="line"><span class="number">8</span>  <span class="number">1.453749</span>  <span class="number">1.208843</span> -<span class="number">0.080952</span> -<span class="number">0.264610</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="7ã€åˆ†ç»„ï¼ˆGroupingï¼‰"><a href="#7ã€åˆ†ç»„ï¼ˆGroupingï¼‰" class="headerlink" title="7ã€åˆ†ç»„ï¼ˆGroupingï¼‰"></a>7ã€åˆ†ç»„ï¼ˆGroupingï¼‰</h4><p><code>group by</code> æŒ‡çš„æ˜¯æ¶µç›–ä¸‹åˆ—ä¸€é¡¹æˆ–å¤šé¡¹æ­¥éª¤çš„å¤„ç†æµç¨‹ã€‚</p>
<ul>
<li><strong>åˆ†å‰²</strong>ï¼šæŒ‰æ¡ä»¶å°†æ•°æ®åˆ†å‰²æˆå¤šç»„</li>
<li><strong>åº”ç”¨</strong>ï¼šä¸ºæ¯ç»„å•ç‹¬åº”ç”¨å‡½æ•°</li>
<li><strong>ç»„åˆ</strong>ï¼šå°†å¤„ç†ç»“æœç»„åˆæˆä¸€ä¸ªæ•°æ®ç»“æ„</li>
</ul>
<p>æµ‹è¯•æ•°æ®</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">91</span>]: df = pd.DataFrame({<span class="string">'A'</span>: [<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'foo'</span>, <span class="string">'bar'</span>,</span><br><span class="line">   ....:                          <span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'foo'</span>, <span class="string">'foo'</span>],</span><br><span class="line">   ....:                    <span class="string">'B'</span>: [<span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>,</span><br><span class="line">   ....:                          <span class="string">'two'</span>, <span class="string">'two'</span>, <span class="string">'one'</span>, <span class="string">'three'</span>],</span><br><span class="line">   ....:                    <span class="string">'C'</span>: np.random.randn(<span class="number">8</span>),</span><br><span class="line">   ....:                    <span class="string">'D'</span>: np.random.randn(<span class="number">8</span>)})</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [<span class="number">92</span>]: df</span><br><span class="line">Out[<span class="number">92</span>]: </span><br><span class="line">     A      B         C         D</span><br><span class="line"><span class="number">0</span>  foo    one -<span class="number">1.202872</span> -<span class="number">0.055224</span></span><br><span class="line"><span class="number">1</span>  bar    one -<span class="number">1.814470</span>  <span class="number">2.395985</span></span><br><span class="line"><span class="number">2</span>  foo    two  <span class="number">1.018601</span>  <span class="number">1.552825</span></span><br><span class="line"><span class="number">3</span>  bar  three -<span class="number">0.595447</span>  <span class="number">0.166599</span></span><br><span class="line"><span class="number">4</span>  foo    two  <span class="number">1.395433</span>  <span class="number">0.047609</span></span><br><span class="line"><span class="number">5</span>  bar    two -<span class="number">0.392670</span> -<span class="number">0.136473</span></span><br><span class="line"><span class="number">6</span>  foo    one  <span class="number">0.007207</span> -<span class="number">0.561757</span></span><br><span class="line"><span class="number">7</span>  foo  three  <span class="number">1.928123</span> -<span class="number">1.623033</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ1ï¼‰å…ˆåˆ†ç»„ï¼Œå†ç”¨ <code>sum()</code> ç®—å‡ºæ¯ç»„çš„æ±‡æ€»æ•°æ®</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">93</span>]: df.groupby(<span class="string">'A'</span>).<span class="built_in">sum</span>()</span><br><span class="line">Out[<span class="number">93</span>]: </span><br><span class="line">            C        D</span><br><span class="line">A                     </span><br><span class="line">bar -<span class="number">2.802588</span>  <span class="number">2.42611</span></span><br><span class="line">foo  <span class="number">3.146492</span> -<span class="number">0.63958</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰å¤šå±‚åˆ†ç»„åï¼Œç”Ÿæˆå¤šå±‚ç´¢å¼•ï¼Œä¹Ÿå¯ä»¥åº”ç”¨ <code>sum</code> å‡½æ•°</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">94</span>]: df.groupby([<span class="string">'A'</span>, <span class="string">'B'</span>]).<span class="built_in">sum</span>()</span><br><span class="line">Out[<span class="number">94</span>]: </span><br><span class="line">                  C         D</span><br><span class="line">A   B                        </span><br><span class="line">bar one   -<span class="number">1.814470</span>  <span class="number">2.395985</span></span><br><span class="line">    three -<span class="number">0.595447</span>  <span class="number">0.166599</span></span><br><span class="line">    two   -<span class="number">0.392670</span> -<span class="number">0.136473</span></span><br><span class="line">foo one   -<span class="number">1.195665</span> -<span class="number">0.616981</span></span><br><span class="line">    three  <span class="number">1.928123</span> -<span class="number">1.623033</span></span><br><span class="line">    two    <span class="number">2.414034</span>  <span class="number">1.600434</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="8ã€é‡å¡‘ï¼ˆReshapingï¼‰"><a href="#8ã€é‡å¡‘ï¼ˆReshapingï¼‰" class="headerlink" title="8ã€é‡å¡‘ï¼ˆReshapingï¼‰"></a>8ã€é‡å¡‘ï¼ˆReshapingï¼‰</h4><h6 id="8-1ã€å¤šå±‚ç´¢å¼•ï¼ˆMulti-Indexï¼‰"><a href="#8-1ã€å¤šå±‚ç´¢å¼•ï¼ˆMulti-Indexï¼‰" class="headerlink" title="8.1ã€å¤šå±‚ç´¢å¼•ï¼ˆMulti-Indexï¼‰"></a>8.1ã€å¤šå±‚ç´¢å¼•ï¼ˆMulti-Indexï¼‰</h6><p>ç»™æ¯ä¸€è¡Œçš„æ•°æ®æ·»åŠ å¤šä¸ªç´¢å¼• <code>index</code>ï¼Œç±»ä¼¼äº <code>GropyBy</code> çš„åˆ†ç»„æ•ˆæœ</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">95</span>]: tuples = <span class="built_in">list</span>(<span class="built_in">zip</span>(*[[<span class="string">'bar'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>, <span class="string">'baz'</span>,</span><br><span class="line">   ....:                      <span class="string">'foo'</span>, <span class="string">'foo'</span>, <span class="string">'qux'</span>, <span class="string">'qux'</span>],</span><br><span class="line">   ....:                     [<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>,</span><br><span class="line">   ....:                      <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>]]))</span><br><span class="line">   ....: </span><br><span class="line"></span><br><span class="line">In [<span class="number">96</span>]: index = pd.MultiIndex.from_tuples(tuples, names=[<span class="string">'first'</span>, <span class="string">'second'</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">97</span>]: df = pd.DataFrame(np.random.randn(<span class="number">8</span>, <span class="number">2</span>), index=index, columns=[<span class="string">'A'</span>, <span class="string">'B'</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">98</span>]: df2 = df[:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">99</span>]: df2</span><br><span class="line">Out[<span class="number">99</span>]: </span><br><span class="line">                     A         B</span><br><span class="line">first second                    </span><br><span class="line">bar   one     <span class="number">0.029399</span> -<span class="number">0.542108</span></span><br><span class="line">      two     <span class="number">0.282696</span> -<span class="number">0.087302</span></span><br><span class="line">baz   one    -<span class="number">1.575170</span>  <span class="number">1.771208</span></span><br><span class="line">      two     <span class="number">0.816482</span>  <span class="number">1.100230</span></span><br></pre></td></tr></tbody></table></figure>
<p>å¤šå±‚ç´¢å¼•é€‰æ‹©æ•°æ®</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">96</span>]: df.loc[<span class="string">'bar'</span>, <span class="string">'one'</span>]</span><br><span class="line">   ....: df</span><br><span class="line">    </span><br><span class="line">Out[<span class="number">96</span>]: </span><br><span class="line">A   -<span class="number">0.204011</span></span><br><span class="line">B   -<span class="number">1.956557</span></span><br><span class="line">Name: (bar, one), dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<h6 id="8-2ã€å †å ï¼ˆStackï¼‰"><a href="#8-2ã€å †å ï¼ˆStackï¼‰" class="headerlink" title="8.2ã€å †å ï¼ˆStackï¼‰"></a>8.2ã€å †å ï¼ˆStackï¼‰</h6><p><code>stack()</code> æ–¹æ³•å°† DataFrame å‹ç¼©è‡³ä¸€å±‚ï¼Œå³ Series</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">100</span>]: stacked = df2.stack()</span><br><span class="line"></span><br><span class="line">In [<span class="number">101</span>]: stacked</span><br><span class="line">Out[<span class="number">101</span>]: </span><br><span class="line">first  second   </span><br><span class="line">               B   -<span class="number">0.542108</span></span><br><span class="line">       two     A    <span class="number">0.282696</span></span><br><span class="line">               B   -<span class="number">0.087302</span></span><br><span class="line">baz    one     A   -<span class="number">1.575170</span></span><br><span class="line">               B    <span class="number">1.771208</span></span><br><span class="line">       two     A    <span class="number">0.816482</span></span><br><span class="line">               B    <span class="number">1.100230</span></span><br><span class="line">dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<p><strong>å‹ç¼©</strong>åçš„ DataFrame æˆ– Series å…·æœ‰å¤šå±‚ç´¢å¼•ï¼Œ<code>stack()</code> çš„é€†æ“ä½œæ˜¯ <code>unstack()</code>ï¼Œé»˜è®¤ä¸ºæ‹†å æœ€åä¸€å±‚ã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">102</span>]: stacked.unstack()</span><br><span class="line">Out[<span class="number">102</span>]: </span><br><span class="line">                     A         B</span><br><span class="line">first second                    </span><br><span class="line">bar   one     <span class="number">0.029399</span> -<span class="number">0.542108</span></span><br><span class="line">      two     <span class="number">0.282696</span> -<span class="number">0.087302</span></span><br><span class="line">baz   one    -<span class="number">1.575170</span>  <span class="number">1.771208</span></span><br><span class="line">      two     <span class="number">0.816482</span>  <span class="number">1.100230</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">103</span>]: stacked.unstack(<span class="number">1</span>)</span><br><span class="line">Out[<span class="number">103</span>]: </span><br><span class="line">second        one       two</span><br><span class="line">first                      </span><br><span class="line">bar   A  <span class="number">0.029399</span>  <span class="number">0.282696</span></span><br><span class="line">      B -<span class="number">0.542108</span> -<span class="number">0.087302</span></span><br><span class="line">baz   A -<span class="number">1.575170</span>  <span class="number">0.816482</span></span><br><span class="line">      B  <span class="number">1.771208</span>  <span class="number">1.100230</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">104</span>]: stacked.unstack(<span class="number">0</span>)</span><br><span class="line">Out[<span class="number">104</span>]: </span><br><span class="line">first          bar       baz</span><br><span class="line">second                      </span><br><span class="line">one    A  <span class="number">0.029399</span> -<span class="number">1.575170</span></span><br><span class="line">       B -<span class="number">0.542108</span>  <span class="number">1.771208</span></span><br><span class="line">two    A  <span class="number">0.282696</span>  <span class="number">0.816482</span></span><br><span class="line">       B -<span class="number">0.087302</span>  <span class="number">1.100230</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="9ã€æ•°æ®é€è§†è¡¨ï¼ˆPivot-Tablesï¼‰"><a href="#9ã€æ•°æ®é€è§†è¡¨ï¼ˆPivot-Tablesï¼‰" class="headerlink" title="9ã€æ•°æ®é€è§†è¡¨ï¼ˆPivot Tablesï¼‰"></a>9ã€æ•°æ®é€è§†è¡¨ï¼ˆPivot Tablesï¼‰</h4><p>ç±»ä¼¼ <code>GroupBy</code> åˆ†ç»„æŸ¥è¯¢ï¼Œæ›´èƒœä»»æ›´å¤æ‚çš„æŸ¥è¯¢ã€‚</p>
<p>æ•°æ®è¡¨å¦‚ä¸‹</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">105</span>]: df = pd.DataFrame({<span class="string">'A'</span>: [<span class="string">'one'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>] * <span class="number">3</span>,</span><br><span class="line">   .....:                    <span class="string">'B'</span>: [<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>] * <span class="number">4</span>,</span><br><span class="line">   .....:                    <span class="string">'C'</span>: [<span class="string">'foo'</span>, <span class="string">'foo'</span>, <span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'bar'</span>, <span class="string">'bar'</span>] * <span class="number">2</span>,</span><br><span class="line">   .....:                    <span class="string">'D'</span>: np.random.randn(<span class="number">12</span>),</span><br><span class="line">   .....:                    <span class="string">'E'</span>: np.random.randn(<span class="number">12</span>)})</span><br><span class="line">   .....: </span><br><span class="line"></span><br><span class="line">In [<span class="number">106</span>]: df</span><br><span class="line">Out[<span class="number">106</span>]: </span><br><span class="line">        A  B    C         D         E</span><br><span class="line"><span class="number">0</span>     one  A  foo  <span class="number">1.418757</span> -<span class="number">0.179666</span></span><br><span class="line"><span class="number">1</span>     one  B  foo -<span class="number">1.879024</span>  <span class="number">1.291836</span></span><br><span class="line"><span class="number">2</span>     two  C  foo  <span class="number">0.536826</span> -<span class="number">0.009614</span></span><br><span class="line"><span class="number">3</span>   three  A  bar  <span class="number">1.006160</span>  <span class="number">0.392149</span></span><br><span class="line"><span class="number">4</span>     one  B  bar -<span class="number">0.029716</span>  <span class="number">0.264599</span></span><br><span class="line"><span class="number">5</span>     one  C  bar -<span class="number">1.146178</span> -<span class="number">0.057409</span></span><br><span class="line"><span class="number">6</span>     two  A  foo  <span class="number">0.100900</span> -<span class="number">1.425638</span></span><br><span class="line"><span class="number">7</span>   three  B  foo -<span class="number">1.035018</span>  <span class="number">1.024098</span></span><br><span class="line"><span class="number">8</span>     one  C  foo  <span class="number">0.314665</span> -<span class="number">0.106062</span></span><br><span class="line"><span class="number">9</span>     one  A  bar -<span class="number">0.773723</span>  <span class="number">1.824375</span></span><br><span class="line"><span class="number">10</span>    two  B  bar -<span class="number">1.170653</span>  <span class="number">0.595974</span></span><br><span class="line"><span class="number">11</span>  three  C  bar  <span class="number">0.648740</span>  <span class="number">1.167115</span></span><br></pre></td></tr></tbody></table></figure>
<p>ç”Ÿæˆé€è§†å›¾</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">107</span>]: pd.pivot_table(df, values=<span class="string">'D'</span>, index=[<span class="string">'A'</span>, <span class="string">'B'</span>], columns=[<span class="string">'C'</span>])</span><br><span class="line">Out[<span class="number">107</span>]: </span><br><span class="line">C             bar       foo</span><br><span class="line">A     B                    </span><br><span class="line">one   A -<span class="number">0.773723</span>  <span class="number">1.418757</span></span><br><span class="line">      B -<span class="number">0.029716</span> -<span class="number">1.879024</span></span><br><span class="line">      C -<span class="number">1.146178</span>  <span class="number">0.314665</span></span><br><span class="line">three A  <span class="number">1.006160</span>       NaN</span><br><span class="line">      B       NaN -<span class="number">1.035018</span></span><br><span class="line">      C  <span class="number">0.648740</span>       NaN</span><br><span class="line">two   A       NaN  <span class="number">0.100900</span></span><br><span class="line">      B -<span class="number">1.170653</span>       NaN</span><br><span class="line">      C       NaN  <span class="number">0.536826</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="10ã€æ—¶é—´åºåˆ—ï¼ˆTime-Seriesï¼‰"><a href="#10ã€æ—¶é—´åºåˆ—ï¼ˆTime-Seriesï¼‰" class="headerlink" title="10ã€æ—¶é—´åºåˆ—ï¼ˆTime Seriesï¼‰"></a>10ã€æ—¶é—´åºåˆ—ï¼ˆTime Seriesï¼‰</h4><p>Pandas ä¸ºé¢‘ç‡è½¬æ¢æ—¶é‡é‡‡æ ·æä¾›äº†è™½ç„¶ç®€å•æ˜“ç”¨ï¼Œä½†å¼ºå¤§é«˜æ•ˆçš„åŠŸèƒ½ã€‚ä¾‹å¦‚å°†ç§’çº§çš„æ•°æ®è½¬æ¢ä¸º 1 åˆ†é’Ÿä¸ºé¢‘ç‡çš„æ•°æ®ã€‚è¿™ç§æ“ä½œå¸¸è§äºè´¢åŠ¡åº”ç”¨ç¨‹åºï¼Œä½†åˆä¸ä»…é™äºæ­¤ã€‚</p>
<h6 id="10-1ã€æ—¶é—´é¢‘ç‡è½¬æ¢"><a href="#10-1ã€æ—¶é—´é¢‘ç‡è½¬æ¢" class="headerlink" title="10.1ã€æ—¶é—´é¢‘ç‡è½¬æ¢"></a>10.1ã€æ—¶é—´é¢‘ç‡è½¬æ¢</h6><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">108</span>]: rng = pd.date_range(<span class="string">'1/1/2012'</span>, periods=<span class="number">100</span>, freq=<span class="string">'S'</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">109</span>]: ts = pd.Series(np.random.randint(<span class="number">0</span>, <span class="number">500</span>, <span class="built_in">len</span>(rng)), index=rng)</span><br><span class="line"></span><br><span class="line">In [<span class="number">110</span>]: ts.resample(<span class="string">'1Min'</span>).<span class="built_in">sum</span>()</span><br><span class="line">Out[<span class="number">110</span>]: </span><br><span class="line"><span class="number">2012</span>-01-01 <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>    <span class="number">13512</span></span><br><span class="line"><span class="number">2012</span>-01-01 <span class="number">00</span>:01:<span class="number">00</span>     <span class="number">9013</span></span><br><span class="line">Freq: T, dtype: int32</span><br></pre></td></tr></tbody></table></figure>
<h6 id="10-2ã€æ—¶åŒºè¡¨ç¤º"><a href="#10-2ã€æ—¶åŒºè¡¨ç¤º" class="headerlink" title="10.2ã€æ—¶åŒºè¡¨ç¤º"></a>10.2ã€æ—¶åŒºè¡¨ç¤º</h6><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">111</span>]: rng = pd.date_range(<span class="string">'3/6/2012 00:00'</span>, periods=<span class="number">5</span>, freq=<span class="string">'D'</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">112</span>]: ts = pd.Series(np.random.randn(<span class="built_in">len</span>(rng)), rng)</span><br><span class="line"></span><br><span class="line">In [<span class="number">113</span>]: ts</span><br><span class="line">Out[<span class="number">113</span>]: </span><br><span class="line"><span class="number">2012</span>-03-06    <span class="number">0.464000</span></span><br><span class="line"><span class="number">2012</span>-03-07    <span class="number">0.227371</span></span><br><span class="line"><span class="number">2012</span>-03-08   -<span class="number">0.496922</span></span><br><span class="line"><span class="number">2012</span>-03-09    <span class="number">0.306389</span></span><br><span class="line"><span class="number">2012</span>-03-<span class="number">10</span>   -<span class="number">2.290613</span></span><br><span class="line">Freq: D, dtype: float64</span><br><span class="line"></span><br><span class="line">In [<span class="number">114</span>]: ts_utc = ts.tz_localize(<span class="string">'UTC'</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">115</span>]: ts_utc</span><br><span class="line">Out[<span class="number">115</span>]: </span><br><span class="line"><span class="number">2012</span>-03-06 <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>+<span class="number">00</span>:<span class="number">00</span>    <span class="number">0.464000</span></span><br><span class="line"><span class="number">2012</span>-03-07 <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>+<span class="number">00</span>:<span class="number">00</span>    <span class="number">0.227371</span></span><br><span class="line"><span class="number">2012</span>-03-08 <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>+<span class="number">00</span>:<span class="number">00</span>   -<span class="number">0.496922</span></span><br><span class="line"><span class="number">2012</span>-03-09 <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>+<span class="number">00</span>:<span class="number">00</span>    <span class="number">0.306389</span></span><br><span class="line"><span class="number">2012</span>-03-<span class="number">10</span> <span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>+<span class="number">00</span>:<span class="number">00</span>   -<span class="number">2.290613</span></span><br><span class="line">Freq: D, dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<h6 id="10-3ã€è½¬æ¢æ—¶åŒº"><a href="#10-3ã€è½¬æ¢æ—¶åŒº" class="headerlink" title="10.3ã€è½¬æ¢æ—¶åŒº"></a>10.3ã€è½¬æ¢æ—¶åŒº</h6><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">116</span>]: ts_utc.tz_convert(<span class="string">'US/Eastern'</span>)</span><br><span class="line">Out[<span class="number">116</span>]: </span><br><span class="line"><span class="number">2012</span>-03-05 <span class="number">19</span>:<span class="number">00</span>:<span class="number">00</span>-05:<span class="number">00</span>    <span class="number">0.464000</span></span><br><span class="line"><span class="number">2012</span>-03-06 <span class="number">19</span>:<span class="number">00</span>:<span class="number">00</span>-05:<span class="number">00</span>    <span class="number">0.227371</span></span><br><span class="line"><span class="number">2012</span>-03-07 <span class="number">19</span>:<span class="number">00</span>:<span class="number">00</span>-05:<span class="number">00</span>   -<span class="number">0.496922</span></span><br><span class="line"><span class="number">2012</span>-03-08 <span class="number">19</span>:<span class="number">00</span>:<span class="number">00</span>-05:<span class="number">00</span>    <span class="number">0.306389</span></span><br><span class="line"><span class="number">2012</span>-03-09 <span class="number">19</span>:<span class="number">00</span>:<span class="number">00</span>-05:<span class="number">00</span>   -<span class="number">2.290613</span></span><br><span class="line">Freq: D, dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<h6 id="10-4ã€è½¬æ¢æ—¶é—´æ®µ"><a href="#10-4ã€è½¬æ¢æ—¶é—´æ®µ" class="headerlink" title="10.4ã€è½¬æ¢æ—¶é—´æ®µ"></a>10.4ã€è½¬æ¢æ—¶é—´æ®µ</h6><figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">117</span>]: rng = pd.date_range(<span class="string">'1/1/2012'</span>, periods=<span class="number">5</span>, freq=<span class="string">'M'</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">118</span>]: ts = pd.Series(np.random.randn(<span class="built_in">len</span>(rng)), index=rng)</span><br><span class="line"></span><br><span class="line">In [<span class="number">119</span>]: ts</span><br><span class="line">Out[<span class="number">119</span>]: </span><br><span class="line"><span class="number">2012</span>-01-<span class="number">31</span>   -<span class="number">1.134623</span></span><br><span class="line"><span class="number">2012</span>-02-<span class="number">29</span>   -<span class="number">1.561819</span></span><br><span class="line"><span class="number">2012</span>-03-<span class="number">31</span>   -<span class="number">0.260838</span></span><br><span class="line"><span class="number">2012</span>-04-<span class="number">30</span>    <span class="number">0.281957</span></span><br><span class="line"><span class="number">2012</span>-05-<span class="number">31</span>    <span class="number">1.523962</span></span><br><span class="line">Freq: M, dtype: float64</span><br><span class="line"></span><br><span class="line">In [<span class="number">120</span>]: ps = ts.to_period()</span><br><span class="line"></span><br><span class="line">In [<span class="number">121</span>]: ps</span><br><span class="line">Out[<span class="number">121</span>]: </span><br><span class="line"><span class="number">2012</span>-01   -<span class="number">1.134623</span></span><br><span class="line"><span class="number">2012</span>-02   -<span class="number">1.561819</span></span><br><span class="line"><span class="number">2012</span>-03   -<span class="number">0.260838</span></span><br><span class="line"><span class="number">2012</span>-04    <span class="number">0.281957</span></span><br><span class="line"><span class="number">2012</span>-05    <span class="number">1.523962</span></span><br><span class="line">Freq: M, dtype: float64</span><br><span class="line"></span><br><span class="line">In [<span class="number">122</span>]: ps.to_timestamp()</span><br><span class="line">Out[<span class="number">122</span>]: </span><br><span class="line"><span class="number">2012</span>-01-01   -<span class="number">1.134623</span></span><br><span class="line"><span class="number">2012</span>-02-01   -<span class="number">1.561819</span></span><br><span class="line"><span class="number">2012</span>-03-01   -<span class="number">0.260838</span></span><br><span class="line"><span class="number">2012</span>-04-01    <span class="number">0.281957</span></span><br><span class="line"><span class="number">2012</span>-05-01    <span class="number">1.523962</span></span><br><span class="line">Freq: MS, dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<h6 id="10-5ã€è½¬æ¢æ—¶é—´æ®µä¸æ—¶é—´æˆ³"><a href="#10-5ã€è½¬æ¢æ—¶é—´æ®µä¸æ—¶é—´æˆ³" class="headerlink" title="10.5ã€è½¬æ¢æ—¶é—´æ®µä¸æ—¶é—´æˆ³"></a>10.5ã€è½¬æ¢æ—¶é—´æ®µä¸æ—¶é—´æˆ³</h6><p>ä¸‹ä¾‹æŠŠä»¥ 11 æœˆä¸ºç»“æŸå¹´ä»½çš„å­£åº¦é¢‘ç‡è½¬æ¢ä¸ºä¸‹ä¸€å­£åº¦æœˆæœ«ä¸Šåˆ 9 ç‚¹</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">123</span>]: prng = pd.period_range(<span class="string">'1990Q1'</span>, <span class="string">'2000Q4'</span>, freq=<span class="string">'Q-NOV'</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">124</span>]: ts = pd.Series(np.random.randn(<span class="built_in">len</span>(prng)), prng)</span><br><span class="line"></span><br><span class="line">In [<span class="number">125</span>]: ts.index = (prng.asfreq(<span class="string">'M'</span>, <span class="string">'e'</span>) + <span class="number">1</span>).asfreq(<span class="string">'H'</span>, <span class="string">'s'</span>) + <span class="number">9</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">126</span>]: ts.head()</span><br><span class="line">Out[<span class="number">126</span>]: </span><br><span class="line"><span class="number">1990</span>-03-01 09:<span class="number">00</span>   -<span class="number">0.902937</span></span><br><span class="line"><span class="number">1990</span>-06-01 09:<span class="number">00</span>    <span class="number">0.068159</span></span><br><span class="line"><span class="number">1990</span>-09-01 09:<span class="number">00</span>   -<span class="number">0.057873</span></span><br><span class="line"><span class="number">1990</span>-<span class="number">12</span>-01 09:<span class="number">00</span>   -<span class="number">0.368204</span></span><br><span class="line"><span class="number">1991</span>-03-01 09:<span class="number">00</span>   -<span class="number">1.144073</span></span><br><span class="line">Freq: H, dtype: float64</span><br></pre></td></tr></tbody></table></figure>
<h4 id="11ã€ç±»åˆ«å‹ï¼ˆCategoricalï¼‰"><a href="#11ã€ç±»åˆ«å‹ï¼ˆCategoricalï¼‰" class="headerlink" title="11ã€ç±»åˆ«å‹ï¼ˆCategoricalï¼‰"></a>11ã€ç±»åˆ«å‹ï¼ˆCategoricalï¼‰</h4><p>Pandas çš„ DataFrame é‡Œå¯ä»¥åŒ…å«ç±»åˆ«æ•°æ®ã€‚</p>
<p>æ•°æ®è¡¨</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">127</span>]: df = pd.DataFrame({<span class="string">"id"</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">   .....:                    <span class="string">"raw_grade"</span>: [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="string">'e'</span>]})</span><br></pre></td></tr></tbody></table></figure>
<p>å°† <code>grade</code> çš„åŸç”Ÿæ•°æ®è½¬æ¢ä¸ºç±»åˆ«å‹æ•°æ®</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">128</span>]: df[<span class="string">"grade"</span>] = df[<span class="string">"raw_grade"</span>].astype(<span class="string">"category"</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">129</span>]: df[<span class="string">"grade"</span>]</span><br><span class="line">Out[<span class="number">129</span>]: </span><br><span class="line"><span class="number">0</span>    a</span><br><span class="line"><span class="number">1</span>    b</span><br><span class="line"><span class="number">2</span>    b</span><br><span class="line"><span class="number">3</span>    a</span><br><span class="line"><span class="number">4</span>    a</span><br><span class="line"><span class="number">5</span>    e</span><br><span class="line">Name: grade, dtype: category</span><br><span class="line">Categories (<span class="number">3</span>, <span class="built_in">object</span>): [a, b, e]</span><br></pre></td></tr></tbody></table></figure>
<p>ç”¨å«æœ‰åå­—çš„é‡å‘½åä¸åŒç±»å‹ï¼Œè°ƒç”¨ <code>Series.cat.categories</code>ï¼Œç±»åˆ«ä¸åç§°ä¸€ä¸€å¯¹åº”ï¼Œæ•°é‡å¿…é¡»ä¸€è‡´ï¼</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">130</span>]: df[<span class="string">"grade"</span>].cat.categories = [<span class="string">"very good"</span>, <span class="string">"good"</span>, <span class="string">"very bad"</span>]</span><br></pre></td></tr></tbody></table></figure>
<p>é‡æ–°æ’åºå„ç±»åˆ«ï¼Œå¹¶æ·»åŠ ç¼ºå¤±ç±»ï¼Œ<code>Series.cat</code> çš„æ–¹æ³•é»˜è®¤è¿”å›æ–° <code>Series</code>ï¼Œ<code>set_categories</code> å¯ä»¥å¢åŠ ç¼ºå¤±çš„ç±»åˆ«ï¼</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">131</span>]: df[<span class="string">"grade"</span>].cat.set_categories([<span class="string">"very bad"</span>, <span class="string">"bad"</span>, <span class="string">"medium"</span>,</span><br><span class="line">   .....:                                               <span class="string">"good"</span>, <span class="string">"very good"</span>])</span><br><span class="line">   .....: </span><br><span class="line"></span><br><span class="line">In [<span class="number">132</span>]: df[<span class="string">"grade"</span>]</span><br><span class="line">Out[<span class="number">132</span>]: </span><br><span class="line"><span class="number">0</span>    very good</span><br><span class="line"><span class="number">1</span>         good</span><br><span class="line"><span class="number">2</span>         good</span><br><span class="line"><span class="number">3</span>    very good</span><br><span class="line"><span class="number">4</span>    very good</span><br><span class="line"><span class="number">5</span>     very bad</span><br><span class="line">Name: grade, dtype: category</span><br><span class="line">Categories (<span class="number">5</span>, <span class="built_in">object</span>): [very bad, bad, medium, good, very good]</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>ç±»åˆ«æ’åºæ—¶ï¼Œæ˜¯æŒ‰ç…§ç”Ÿæˆç±»åˆ«æ—¶çš„é¡ºåºæ’åºï¼Œè€Œä¸æ˜¯æŒ‰ç…§å­—å…¸åºã€‚</p>
          </div>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">133</span>]: df.sort_values(by=<span class="string">"grade"</span>)</span><br><span class="line">Out[<span class="number">133</span>]: </span><br><span class="line">   <span class="built_in">id</span> raw_grade      grade</span><br><span class="line"><span class="number">5</span>   <span class="number">6</span>         e   very bad</span><br><span class="line"><span class="number">1</span>   <span class="number">2</span>         b       good</span><br><span class="line"><span class="number">2</span>   <span class="number">3</span>         b       good</span><br><span class="line"><span class="number">0</span>   <span class="number">1</span>         a  very good</span><br><span class="line"><span class="number">3</span>   <span class="number">4</span>         a  very good</span><br><span class="line"><span class="number">4</span>   <span class="number">5</span>         a  very good</span><br></pre></td></tr></tbody></table></figure>
<p>æŒ‰ç±»åˆ—åˆ†ç»„ï¼ˆgroupbyï¼‰æ—¶ï¼Œå³ä¾¿æŸç±»åˆ«ä¸ºç©ºï¼Œä¹Ÿä¼šæ˜¾ç¤ºã€‚</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">134</span>]: df.groupby(<span class="string">"grade"</span>).size()</span><br><span class="line">Out[<span class="number">134</span>]: </span><br><span class="line">grade</span><br><span class="line">very bad     <span class="number">1</span></span><br><span class="line">bad          <span class="number">0</span></span><br><span class="line">medium       <span class="number">0</span></span><br><span class="line">good         <span class="number">2</span></span><br><span class="line">very good    <span class="number">3</span></span><br><span class="line">dtype: int64</span><br></pre></td></tr></tbody></table></figure>
<h4 id="12ã€å¯è§†åŒ–ï¼ˆVisualizationï¼‰"><a href="#12ã€å¯è§†åŒ–ï¼ˆVisualizationï¼‰" class="headerlink" title="12ã€å¯è§†åŒ–ï¼ˆVisualizationï¼‰"></a>12ã€å¯è§†åŒ–ï¼ˆVisualizationï¼‰</h4><p><code>matplotlib</code> å¯è§†åŒ–ä¹Ÿå°±å›¾ä¸€ä¹ï¼Œè¯¶ï¼ŒçœŸè¦å¯è§†åŒ–è¿˜å¾—çœ‹æˆ‘ <code>pandas</code>ã€‚</p>
<p>ï¼ˆ1ï¼‰å•ç‰¹å¾</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">135</span>]: ts = pd.Series(np.random.randn(<span class="number">1000</span>),</span><br><span class="line">   .....:                index=pd.date_range(<span class="string">'1/1/2000'</span>, periods=<span class="number">1000</span>))</span><br><span class="line">   .....: </span><br><span class="line"></span><br><span class="line">In [<span class="number">136</span>]: ts = ts.cumsum()</span><br><span class="line"></span><br><span class="line">In [<span class="number">137</span>]: ts.plot()</span><br><span class="line">Out[<span class="number">137</span>]: &lt;matplotlib.axes._subplots.AxesSubplot at <span class="number">0x7f2b5771ac88</span>&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/10/24/5WGS4H.png" alt=""></p>
<p>ï¼ˆ2ï¼‰å¤šç‰¹å¾</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">138</span>]: df = pd.DataFrame(np.random.randn(<span class="number">1000</span>, <span class="number">4</span>), index=ts.index,</span><br><span class="line">   .....:                   columns=[<span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>])</span><br><span class="line">   .....: </span><br><span class="line"></span><br><span class="line">In [<span class="number">139</span>]: df = df.cumsum()</span><br><span class="line"></span><br><span class="line">In [<span class="number">141</span>]: df.plot()</span><br><span class="line">Out[<span class="number">141</span>]: &lt;matplotlib.axes._subplots.AxesSubplot at <span class="number">0x7f2b53a2d7f0</span>&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/10/24/5WGADf.png" alt=""></p>
<h4 id="13ã€æ•°æ®è¾“å…¥ã€è¾“å‡º"><a href="#13ã€æ•°æ®è¾“å…¥ã€è¾“å‡º" class="headerlink" title="13ã€æ•°æ®è¾“å…¥ã€è¾“å‡º"></a>13ã€æ•°æ®è¾“å…¥ã€è¾“å‡º</h4><h6 id="13-1-CSV-æ–‡ä»¶"><a href="#13-1-CSV-æ–‡ä»¶" class="headerlink" title="13.1 CSV æ–‡ä»¶"></a>13.1 CSV æ–‡ä»¶</h6><p>ï¼ˆ1ï¼‰å†™å…¥ CSV æ–‡ä»¶</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">143</span>]: df.to_csv(<span class="string">'foo.csv'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰è¯»å– CSV æ–‡ä»¶</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">144</span>]: pd.read_csv(<span class="string">'foo.csv'</span>)</span><br><span class="line">Out[<span class="number">144</span>]: </span><br><span class="line">     Unnamed: <span class="number">0</span>          A          B         C          D</span><br><span class="line"><span class="number">0</span>    <span class="number">2000</span>-01-01   <span class="number">0.266457</span>  -<span class="number">0.399641</span> -<span class="number">0.219582</span>   <span class="number">1.186860</span></span><br><span class="line"><span class="number">1</span>    <span class="number">2000</span>-01-02  -<span class="number">1.170732</span>  -<span class="number">0.345873</span>  <span class="number">1.653061</span>  -<span class="number">0.282953</span></span><br><span class="line"><span class="number">2</span>    <span class="number">2000</span>-01-03  -<span class="number">1.734933</span>   <span class="number">0.530468</span>  <span class="number">2.060811</span>  -<span class="number">0.515536</span></span><br><span class="line"><span class="number">3</span>    <span class="number">2000</span>-01-04  -<span class="number">1.555121</span>   <span class="number">1.452620</span>  <span class="number">0.239859</span>  -<span class="number">1.156896</span></span><br><span class="line"><span class="number">4</span>    <span class="number">2000</span>-01-05   <span class="number">0.578117</span>   <span class="number">0.511371</span>  <span class="number">0.103552</span>  -<span class="number">2.428202</span></span><br><span class="line"><span class="number">5</span>    <span class="number">2000</span>-01-06   <span class="number">0.478344</span>   <span class="number">0.449933</span> -<span class="number">0.741620</span>  -<span class="number">1.962409</span></span><br><span class="line"><span class="number">6</span>    <span class="number">2000</span>-01-07   <span class="number">1.235339</span>  -<span class="number">0.091757</span> -<span class="number">1.543861</span>  -<span class="number">1.084753</span></span><br><span class="line">..          ...        ...        ...       ...        ...</span><br><span class="line"><span class="number">993</span>  <span class="number">2002</span>-09-<span class="number">20</span> -<span class="number">10.628548</span>  -<span class="number">9.153563</span> -<span class="number">7.883146</span>  <span class="number">28.313940</span></span><br><span class="line"><span class="number">994</span>  <span class="number">2002</span>-09-<span class="number">21</span> -<span class="number">10.390377</span>  -<span class="number">8.727491</span> -<span class="number">6.399645</span>  <span class="number">30.914107</span></span><br><span class="line"><span class="number">995</span>  <span class="number">2002</span>-09-<span class="number">22</span>  -<span class="number">8.985362</span>  -<span class="number">8.485624</span> -<span class="number">4.669462</span>  <span class="number">31.367740</span></span><br><span class="line"><span class="number">996</span>  <span class="number">2002</span>-09-<span class="number">23</span>  -<span class="number">9.558560</span>  -<span class="number">8.781216</span> -<span class="number">4.499815</span>  <span class="number">30.518439</span></span><br><span class="line"><span class="number">997</span>  <span class="number">2002</span>-09-<span class="number">24</span>  -<span class="number">9.902058</span>  -<span class="number">9.340490</span> -<span class="number">4.386639</span>  <span class="number">30.105593</span></span><br><span class="line"><span class="number">998</span>  <span class="number">2002</span>-09-<span class="number">25</span> -<span class="number">10.216020</span>  -<span class="number">9.480682</span> -<span class="number">3.933802</span>  <span class="number">29.758560</span></span><br><span class="line"><span class="number">999</span>  <span class="number">2002</span>-09-<span class="number">26</span> -<span class="number">11.856774</span> -<span class="number">10.671012</span> -<span class="number">3.216025</span>  <span class="number">29.369368</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1000</span> rows x <span class="number">5</span> columns]</span><br></pre></td></tr></tbody></table></figure>
<h6 id="13-2-HDF5-æ–‡ä»¶"><a href="#13-2-HDF5-æ–‡ä»¶" class="headerlink" title="13.2 HDF5 æ–‡ä»¶"></a>13.2 HDF5 æ–‡ä»¶</h6><p>ï¼ˆ1ï¼‰å†™å…¥ HDF5 æ–‡ä»¶</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">145</span>]: df.to_hdf(<span class="string">'foo.h5'</span>, <span class="string">'df'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰è¯»å– HDF5 æ–‡ä»¶</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">146</span>]: pd.read_hdf(<span class="string">'foo.h5'</span>, <span class="string">'df'</span>)</span><br><span class="line">Out[<span class="number">146</span>]: </span><br><span class="line">                    A          B         C          D</span><br><span class="line"><span class="number">2000</span>-01-01   <span class="number">0.266457</span>  -<span class="number">0.399641</span> -<span class="number">0.219582</span>   <span class="number">1.186860</span></span><br><span class="line"><span class="number">2000</span>-01-02  -<span class="number">1.170732</span>  -<span class="number">0.345873</span>  <span class="number">1.653061</span>  -<span class="number">0.282953</span></span><br><span class="line"><span class="number">2000</span>-01-03  -<span class="number">1.734933</span>   <span class="number">0.530468</span>  <span class="number">2.060811</span>  -<span class="number">0.515536</span></span><br><span class="line"><span class="number">2000</span>-01-04  -<span class="number">1.555121</span>   <span class="number">1.452620</span>  <span class="number">0.239859</span>  -<span class="number">1.156896</span></span><br><span class="line"><span class="number">2000</span>-01-05   <span class="number">0.578117</span>   <span class="number">0.511371</span>  <span class="number">0.103552</span>  -<span class="number">2.428202</span></span><br><span class="line"><span class="number">2000</span>-01-06   <span class="number">0.478344</span>   <span class="number">0.449933</span> -<span class="number">0.741620</span>  -<span class="number">1.962409</span></span><br><span class="line"><span class="number">2000</span>-01-07   <span class="number">1.235339</span>  -<span class="number">0.091757</span> -<span class="number">1.543861</span>  -<span class="number">1.084753</span></span><br><span class="line"><span class="meta">... </span>              ...        ...       ...        ...</span><br><span class="line"><span class="number">2002</span>-09-<span class="number">20</span> -<span class="number">10.628548</span>  -<span class="number">9.153563</span> -<span class="number">7.883146</span>  <span class="number">28.313940</span></span><br><span class="line"><span class="number">2002</span>-09-<span class="number">21</span> -<span class="number">10.390377</span>  -<span class="number">8.727491</span> -<span class="number">6.399645</span>  <span class="number">30.914107</span></span><br><span class="line"><span class="number">2002</span>-09-<span class="number">22</span>  -<span class="number">8.985362</span>  -<span class="number">8.485624</span> -<span class="number">4.669462</span>  <span class="number">31.367740</span></span><br><span class="line"><span class="number">2002</span>-09-<span class="number">23</span>  -<span class="number">9.558560</span>  -<span class="number">8.781216</span> -<span class="number">4.499815</span>  <span class="number">30.518439</span></span><br><span class="line"><span class="number">2002</span>-09-<span class="number">24</span>  -<span class="number">9.902058</span>  -<span class="number">9.340490</span> -<span class="number">4.386639</span>  <span class="number">30.105593</span></span><br><span class="line"><span class="number">2002</span>-09-<span class="number">25</span> -<span class="number">10.216020</span>  -<span class="number">9.480682</span> -<span class="number">3.933802</span>  <span class="number">29.758560</span></span><br><span class="line"><span class="number">2002</span>-09-<span class="number">26</span> -<span class="number">11.856774</span> -<span class="number">10.671012</span> -<span class="number">3.216025</span>  <span class="number">29.369368</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1000</span> rows x <span class="number">4</span> columns]</span><br></pre></td></tr></tbody></table></figure>
<h6 id="13-3-Excel-æ–‡ä»¶"><a href="#13-3-Excel-æ–‡ä»¶" class="headerlink" title="13.3 Excel æ–‡ä»¶"></a>13.3 Excel æ–‡ä»¶</h6><p>ï¼ˆ1ï¼‰å†™å…¥ Excel æ–‡ä»¶</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">147</span>]: df.to_excel(<span class="string">'foo.xlsx'</span>, sheet_name=<span class="string">'Sheet1'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰è¯»å– Excel æ–‡ä»¶</p>
<figure class="highlight python"><table><tbody><tr><td class="code"><pre><span class="line">In [<span class="number">148</span>]: pd.read_excel(<span class="string">'foo.xlsx'</span>, <span class="string">'Sheet1'</span>, index_col=<span class="literal">None</span>, na_values=[<span class="string">'NA'</span>])</span><br><span class="line">Out[<span class="number">148</span>]: </span><br><span class="line">    Unnamed: <span class="number">0</span>          A          B         C          D</span><br><span class="line"><span class="number">0</span>   <span class="number">2000</span>-01-01   <span class="number">0.266457</span>  -<span class="number">0.399641</span> -<span class="number">0.219582</span>   <span class="number">1.186860</span></span><br><span class="line"><span class="number">1</span>   <span class="number">2000</span>-01-02  -<span class="number">1.170732</span>  -<span class="number">0.345873</span>  <span class="number">1.653061</span>  -<span class="number">0.282953</span></span><br><span class="line"><span class="number">2</span>   <span class="number">2000</span>-01-03  -<span class="number">1.734933</span>   <span class="number">0.530468</span>  <span class="number">2.060811</span>  -<span class="number">0.515536</span></span><br><span class="line"><span class="number">3</span>   <span class="number">2000</span>-01-04  -<span class="number">1.555121</span>   <span class="number">1.452620</span>  <span class="number">0.239859</span>  -<span class="number">1.156896</span></span><br><span class="line"><span class="number">4</span>   <span class="number">2000</span>-01-05   <span class="number">0.578117</span>   <span class="number">0.511371</span>  <span class="number">0.103552</span>  -<span class="number">2.428202</span></span><br><span class="line"><span class="number">5</span>   <span class="number">2000</span>-01-06   <span class="number">0.478344</span>   <span class="number">0.449933</span> -<span class="number">0.741620</span>  -<span class="number">1.962409</span></span><br><span class="line"><span class="number">6</span>   <span class="number">2000</span>-01-07   <span class="number">1.235339</span>  -<span class="number">0.091757</span> -<span class="number">1.543861</span>  -<span class="number">1.084753</span></span><br><span class="line">..         ...        ...        ...       ...        ...</span><br><span class="line"><span class="number">993</span> <span class="number">2002</span>-09-<span class="number">20</span> -<span class="number">10.628548</span>  -<span class="number">9.153563</span> -<span class="number">7.883146</span>  <span class="number">28.313940</span></span><br><span class="line"><span class="number">994</span> <span class="number">2002</span>-09-<span class="number">21</span> -<span class="number">10.390377</span>  -<span class="number">8.727491</span> -<span class="number">6.399645</span>  <span class="number">30.914107</span></span><br><span class="line"><span class="number">995</span> <span class="number">2002</span>-09-<span class="number">22</span>  -<span class="number">8.985362</span>  -<span class="number">8.485624</span> -<span class="number">4.669462</span>  <span class="number">31.367740</span></span><br><span class="line"><span class="number">996</span> <span class="number">2002</span>-09-<span class="number">23</span>  -<span class="number">9.558560</span>  -<span class="number">8.781216</span> -<span class="number">4.499815</span>  <span class="number">30.518439</span></span><br><span class="line"><span class="number">997</span> <span class="number">2002</span>-09-<span class="number">24</span>  -<span class="number">9.902058</span>  -<span class="number">9.340490</span> -<span class="number">4.386639</span>  <span class="number">30.105593</span></span><br><span class="line"><span class="number">998</span> <span class="number">2002</span>-09-<span class="number">25</span> -<span class="number">10.216020</span>  -<span class="number">9.480682</span> -<span class="number">3.933802</span>  <span class="number">29.758560</span></span><br><span class="line"><span class="number">999</span> <span class="number">2002</span>-09-<span class="number">26</span> -<span class="number">11.856774</span> -<span class="number">10.671012</span> -<span class="number">3.216025</span>  <span class="number">29.369368</span></span><br><span class="line"></span><br><span class="line">[<span class="number">1000</span> rows x <span class="number">5</span> columns]</span><br></pre></td></tr></tbody></table></figure>
]]></content>
  </entry>
  <entry>
    <title>Spring</title>
    <url>/2021/10/08/Spring/</url>
    <content><![CDATA[<h2 id="1ã€-Spring"><a href="#1ã€-Spring" class="headerlink" title="1ã€ Spring"></a>1ã€ Spring</h2><h4 id="1-1ã€-ç®€ä»‹"><a href="#1-1ã€-ç®€ä»‹" class="headerlink" title="1.1ã€ ç®€ä»‹"></a>1.1ã€ ç®€ä»‹</h4><ul>
<li>Springï¼šæ˜¥å¤© â€”â€”&gt; ç»™è½¯ä»¶è¡Œä¸šå¸¦æ¥äº†æ˜¥å¤©ï¼</li>
<li>2002å¹´ï¼Œé¦–æ¬¡æ¨å‡ºäº† <code>Spring</code> æ¡†æ¶çš„é›å½¢ï¼šinterface21 æ¡†æ¶ï¼</li>
<li><code>Spring</code> æ¡†æ¶å³ä»¥ interface21 æ¡†æ¶ä¸ºåŸºç¡€ï¼Œç»è¿‡é‡æ–°è®¾è®¡ï¼Œå¹¶ä¸æ–­ä¸°å¯Œå…¶å†…æ¶µï¼Œäº2004å¹´3æœˆ24æ—¥ï¼Œå‘å¸ƒäº†1.0æ­£å¼ç‰ˆã€‚</li>
<li><strong>Rod Johnson</strong>ï¼ŒSpring Framework åˆ›å§‹äººï¼Œè‘—åä½œå®¶ï¼Œè¿˜æ˜¯æ‚‰å°¼å¤§å­¦çš„éŸ³ä¹å­¦åšå£«ã€‚</li>
<li>springç†å¿µï¼šä½¿ç°æœ‰çš„æŠ€æœ¯æ›´åŠ å®¹æ˜“ä½¿ç”¨ï¼Œæœ¬èº«æ˜¯ä¸ªå¤§æ‚çƒ©ï¼Œæ•´åˆäº†ç°æœ‰çš„æŠ€æœ¯æ¡†æ¶ï¼</li>
</ul>
<ul>
<li>SSHï¼šStruts2 + Spring + Hibernate</li>
<li>SSMï¼šSpringMvc + Spring + Mybatis</li>
</ul>
<span id="more"></span>
<p>å®˜ç½‘ï¼š<a href="https://spring.io/projects/spring-framework#overview">https://spring.io/projects/spring-framework#overview</a></p>
<p>GitHubï¼š<a href="https://github.com/spring-projects/spring-framework">https://github.com/spring-projects/spring-framework</a></p>
<p>maven ä¾èµ–</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="1-2ã€ä¼˜ç‚¹"><a href="#1-2ã€ä¼˜ç‚¹" class="headerlink" title="1.2ã€ä¼˜ç‚¹"></a>1.2ã€ä¼˜ç‚¹</h4><ul>
<li>Spring æ˜¯ä¸€ä¸ªå¼€æºå…è´¹çš„æ¡†æ¶ï¼ˆå®¹å™¨ï¼‰ï¼</li>
<li>Spring æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ã€<code>éå…¥ä¾µå¼</code>çš„æ¡†æ¶ï¼</li>
<li>æ§åˆ¶åè½¬ï¼ˆ<code>IOC</code>ï¼‰ï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆ<code>AOP</code>ï¼‰ï¼</li>
<li>æ”¯æŒäº‹åŠ¡çš„å¤„ç†ï¼Œå¯¹æ¡†æ¶æ•´åˆçš„æ”¯æŒï¼</li>
</ul>
<p><code>æ€»ç»“ä¸€å¥è¯ï¼šSpringå°±æ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ§åˆ¶åè½¬ï¼ˆIOCï¼‰å’Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰çš„æ¡†æ¶ï¼</code></p>
<h4 id="1-3ã€ç»„æˆ"><a href="#1-3ã€ç»„æˆ" class="headerlink" title="1.3ã€ç»„æˆ"></a>1.3ã€ç»„æˆ</h4><p><img src="https://z3.ax1x.com/2021/10/08/5PkD2Q.png" alt=""></p>
<h4 id="1-4ã€-æ‹“å±•"><a href="#1-4ã€-æ‹“å±•" class="headerlink" title="1.4ã€ æ‹“å±•"></a>1.4ã€ æ‹“å±•</h4><p>ç°ä»£åŒ–çš„ Java å¼€å‘ï¼Œè¯´ç™½å°±æ˜¯åŸºäº Spring çš„å¼€å‘ï¼</p>
<p><img src="https://z3.ax1x.com/2021/10/08/5PAVJS.png" alt=""></p>
<ul>
<li>Spring Boot<ul>
<li>ä¸€ä¸ª<code>å¿«é€Ÿå¼€å‘</code>çš„è„šæ‰‹æ¶ã€‚</li>
<li>åŸºäº SpringBoot å¯ä»¥å¿«é€Ÿåœ°å¼€å‘å•ä¸ªå¾®æœåŠ¡ã€‚</li>
<li>çº¦å®šå¤§äºé…ç½®ï¼</li>
</ul>
</li>
<li>Spring Cloud<ul>
<li>SpringCloud æ˜¯åŸºäº SpringBoot å®ç°çš„ã€‚</li>
</ul>
</li>
</ul>
<p>å› ä¸ºç°åœ¨å¤§å¤šæ•°å…¬å¸éƒ½åœ¨ä½¿ç”¨ SpringBoot è¿›è¡Œå¿«é€Ÿå¼€å‘ï¼Œå­¦ä¹  SpringBoot çš„å‰æï¼Œéœ€è¦å®Œå…¨æŒæ¡ Spring åŠ SpringMVCï¼èµ·åˆ°æ‰¿ä¸Šå¯ä¸‹çš„ä½œç”¨ï¼</p>
<p>Springå¼Šç«¯ï¼šå‘å±•äº†å¤ªä¹…ä»¥åï¼Œè¿èƒŒäº†åŸæ¥çš„ç†å¿µï¼é…ç½®ååˆ†ç¹çï¼Œäººç§°<code>é…ç½®åœ°ç‹±</code>ï¼</p>
<h2 id="2ã€-IOCç†è®ºæ¨å¯¼"><a href="#2ã€-IOCç†è®ºæ¨å¯¼" class="headerlink" title="2ã€ IOCç†è®ºæ¨å¯¼"></a>2ã€ IOCç†è®ºæ¨å¯¼</h2><h4 id="2-1ã€MVCä¸‰å±‚æ¶æ„"><a href="#2-1ã€MVCä¸‰å±‚æ¶æ„" class="headerlink" title="2.1ã€MVCä¸‰å±‚æ¶æ„"></a>2.1ã€MVCä¸‰å±‚æ¶æ„</h4><p>MVC ï¼ˆæ¨¡å‹è§†å›¾æ§åˆ¶å™¨ï¼‰å³ Modelã€View å’Œ Controllerã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/08/5PZaLj.png" alt=""></p>
<p><img src="https://z3.ax1x.com/2021/10/08/5PHLBd.png" alt=""></p>
<p>Model</p>
<ul>
<li>ä¸šåŠ¡å¤„ç†ï¼šä¸šåŠ¡é€»è¾‘ï¼ˆServiceï¼‰</li>
<li>æ•°æ®æŒä¹…å±‚ï¼šCRUDï¼ˆDaoï¼‰</li>
</ul>
<p>View</p>
<ul>
<li>å±•ç¤ºæ•°æ®</li>
<li>æä¾›é“¾æ¥å‘èµ·è·¯ç”±è¯·æ±‚ï¼ˆaï¼Œimgï¼Œformâ€¦ï¼‰</li>
</ul>
<p>Controller</p>
<ul>
<li>æ¥å—ç”¨æˆ·è¯·æ±‚ï¼Œrequestï¼šè¯·æ±‚å‚æ•°ã€Sessionä¿¡æ¯â€¦</li>
<li>äº¤ç»™ä¸šåŠ¡å±‚å¤„ç†è¯·æ±‚</li>
<li>æ§åˆ¶è§†å›¾è·³è½¬</li>
</ul>
<p>ä¾‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">ç™»å½•---&gt;æ¥å—ç”¨æˆ·çš„ç™»å½•è¯·æ±‚---&gt;å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼ˆè·å–ç”¨æˆ·ç™»å½•çš„å‚æ•°ï¼šusernameï¼Œpasswordï¼‰---&gt;äº¤ç»™ä¸šåŠ¡å±‚å¤„ç†ç™»å½•ä¸šåŠ¡ï¼ˆåˆ¤æ–­ç”¨æˆ·åè´¦å·å¯†ç æ˜¯å¦æ­£ç¡®ï¼šäº‹åŠ¡ï¼‰---&gt;Daoå±‚æŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®---&gt;æ•°æ®åº“</span><br></pre></td></tr></tbody></table></figure>
<h4 id="2-2ã€å®ä¾‹"><a href="#2-2ã€å®ä¾‹" class="headerlink" title="2.2ã€å®ä¾‹"></a>2.2ã€å®ä¾‹</h4><ol>
<li><p>UserDao æ¥å£</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>UserDaoImpl å®ç°ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span></span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"é»˜è®¤è·å–ç”¨æˆ·çš„æ•°æ®ï¼"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>UserService ä¸šåŠ¡æ¥å£</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>UserServiceImpl ä¸šåŠ¡å®ç°ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>{</span><br><span class="line">    <span class="keyword">private</span> UserDao userDao = <span class="keyword">new</span> UserDaoImpl();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>{</span><br><span class="line">        userDao.show();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>MyTest æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="comment">// ç”¨æˆ·å®é™…è°ƒç”¨çš„æ˜¯ä¸šåŠ¡å±‚ï¼ŒDaoå±‚ä»–ä»¬ä¸éœ€è¦æ¥è§¦</span></span><br><span class="line">        UserService userService = <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line">        userService.show();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>Console ç»“æœæ­£å¸¸</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">é»˜è®¤è·å–ç”¨æˆ·çš„æ•°æ®ï¼</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<p>å¦‚æœè¿™æ—¶æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸šåŠ¡å‘¢ï¼Ÿ</p>
<ol>
<li><p>æ–°å¢ Dao å®ç°ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoMysqlImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span></span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"Mysqlè·å–ç”¨æˆ·çš„æ•°æ®ï¼"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>ä¿®æ”¹ä¸šåŠ¡å®ç°ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>{</span><br><span class="line">    <span class="keyword">private</span> UserDao userDao = <span class="keyword">new</span> UserDaoMysqlImpl();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>{</span><br><span class="line">        userDao.show();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>Console ç»“æœæ­£å¸¸</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Mysqlè·å–ç”¨æˆ·çš„æ•°æ®ï¼</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<p>ä½†æ¯æ–°å¢ä¸€ä¸ªä¸šåŠ¡æ“ä½œï¼Œæˆ‘ä»¬å°±è¦å»æ›´æ”¹æˆ‘ä»¬ä¸šåŠ¡ç±»å—ï¼Ÿå¦‚æœç¨‹åºä»£ç é‡ååˆ†åºå¤§ï¼Œä¿®æ”¹ä¸€æ¬¡çš„æˆæœ¬ä»£ä»·å°†ååˆ†æ˜‚è´µï¼Œè¿™æ˜¾ç„¶ä¸å¯èƒ½ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/10/5ASIN8.png" alt=""></p>
<p>ä¸ºæ­¤æˆ‘ä»¬éœ€è¦ <code>set</code>æ³¨å…¥ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span></span>{</span><br><span class="line">    <span class="keyword">private</span> UserDao userDao = <span class="keyword">new</span> UserDaoImpl();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDao</span><span class="params">(UserDao userDao)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.userDao = userDao;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>{</span><br><span class="line">        userDao.show();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="comment">// ç”¨æˆ·å®é™…è°ƒç”¨çš„æ˜¯ä¸šåŠ¡å±‚ï¼ŒDaoå±‚ä»–ä»¬ä¸éœ€è¦æ¥è§¦</span></span><br><span class="line">        UserServiceImpl userService = <span class="keyword">new</span> UserServiceImpl();</span><br><span class="line">        userService.setUserDao(<span class="keyword">new</span> UserDaoMysqlImpl());</span><br><span class="line">        userService.show();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>ä¹‹å‰ï¼Œç¨‹åºæ˜¯<code>ä¸»åŠ¨</code>åˆ›å»ºå¯¹è±¡ï¼æ§åˆ¶æƒåœ¨ç¨‹åºå‘˜æ‰‹ä¸Šï¼</li>
<li>ç°åœ¨ï¼Œä½¿ç”¨äº† set æ³¨å…¥åï¼Œç¨‹åºä¸å†å…·æœ‰ä¸»åŠ¨æ€§ï¼Œè€Œæ˜¯å˜æˆäº†<code>è¢«åŠ¨</code>çš„æ¥æ”¶å¯¹è±¡ï¼</li>
</ul>
<p>è¿™ç§æ€æƒ³ï¼Œä»æœ¬è´¨ä¸Šè§£å†³äº†é—®é¢˜ï¼Œæˆ‘ä»¬ä¸ç”¨å†å»ç®¡ç†å¯¹è±¡çš„åˆ›å»ºäº†ã€‚ç³»ç»Ÿçš„è€¦åˆæ€§å¤§å¤§é™ä½ï¼Œå¯ä»¥æ›´åŠ ä¸“æ³¨åœ¨ä¸šåŠ¡çš„æ˜¯çº¿ä¸Šï¼è¿™å°±æ˜¯IOCçš„åŸå‹ï¼</p>
<p><img src="https://z3.ax1x.com/2021/10/10/5ASH3Q.png" alt=""></p>
<p><img src="https://z3.ax1x.com/2021/10/10/5ApAD1.png" alt=""></p>
<h4 id="2-3ã€IOCæœ¬è´¨"><a href="#2-3ã€IOCæœ¬è´¨" class="headerlink" title="2.3ã€IOCæœ¬è´¨"></a>2.3ã€IOCæœ¬è´¨</h4><p><strong>æ§åˆ¶ç¿»è½¬Ioc(Inversion of Control)ï¼Œæ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼ŒDI (ä¾èµ–æ³¨å…¥)æ˜¯ä¸€ç§å®ç°Iocçš„ä¸€ç§æ–¹æ³•</strong>ã€‚åœ¨æ²¡æœ‰Iocçš„ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå¯¹è±¡çš„åˆ›å»ºä¸å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»å®Œå…¨ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ï¼Œå¯¹è±¡çš„åˆ›å»ºç”±ç¨‹åºè‡ªå·±æ§åˆ¶ï¼Œæ§åˆ¶ç¿»è½¬åå°†å¯¹è±¡çš„åˆ›å»ºè½¬ç§»ç»™ç¬¬ä¸‰æ–¹ï¼Œä¸ªäººè®¤ä¸ºæ‰€è°“æ§åˆ¶åè½¬å°±æ˜¯<strong>è·å¾—ä¾èµ–å¯¹è±¡çš„æ–¹å¼åè½¬äº†</strong>ã€‚</p>
<p>é‡‡ç”¨ XML æ–¹å¼é…ç½® Bean çš„æ—¶å€™ï¼ŒBean çš„å®šä¹‰ä¿¡æ¯æ˜¯å’Œå®ç°åˆ†ç¦»çš„ï¼Œè€Œé‡‡ç”¨æ³¨è§£çš„æ–¹å¼å¯ä»¥æŠŠä¸¤è€…åˆä¸ºä¸€ä½“ï¼ŒBean çš„å®šä¹‰ä¿¡æ¯ç›´æ¥ä»¥æ³¨è§£çš„å½¢å¼å®šä¹‰åœ¨å®ç°ç±»ä¸­ï¼Œä»è€Œè¾¾åˆ°äº†é›¶é…ç½®çš„ç›®çš„ã€‚</p>
<p><strong>æ§åˆ¶åè½¬æ˜¯ä¸€ç§é€šè¿‡æè¿°ï¼ˆXMLæˆ–æ³¨è§£ï¼‰å¹¶é€šè¿‡ç¬¬ä¸‰æ–¹å»ç”Ÿäº§æˆ–è·å–ç‰¹å®šå¯¹è±¡çš„æ–¹å¼ã€‚åœ¨ Spring ä¸­å®ç°çš„æ§åˆ¶åè½¬çš„æ˜¯ Ioc å®¹å™¨ï¼Œå…¶å®ç°æ–¹å¼æ˜¯ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼ŒDIï¼‰</strong></p>
<h2 id="3ã€HelloSpring"><a href="#3ã€HelloSpring" class="headerlink" title="3ã€HelloSpring"></a>3ã€HelloSpring</h2><p>å®ä½“ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello{"</span> +</span><br><span class="line">                <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">'}'</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"Hello"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"ä½™åƒç¦§"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"beans.xml"</span>);</span><br><span class="line">        Hello hello = (Hello) context.getBean(<span class="string">"hello"</span>);</span><br><span class="line">        System.out.println(hello);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ‰“å°ç»“æœ</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Hello{name=<span class="string">'ä½™åƒç¦§'</span>}</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œè‡ªå§‹è‡³ç»ˆæˆ‘éƒ½æ²¡æœ‰ä½¿ç”¨ <code>new</code> æ¥åˆ›å»º Hello å¯¹è±¡ï¼Œå¯¹è±¡åˆ›å»ºå’Œå±æ€§èµ‹å€¼å…¨æƒäº¤ç”± IOC å®¹å™¨è§£å†³ï¼Œå®ƒä½¿å¾—ç¨‹åºä»åŸæœ¬<code>ä¸»åŠ¨</code>çš„ç¼–ç¨‹è½¬å˜ä¸º<code>è¢«åŠ¨</code>çš„æ¥å—ã€‚</p>
<p><strong>è‡³ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å½»åº•ä¸ç”¨å†åˆ°ç¨‹åºä¸­å»æ”¹åŠ¨äº†ï¼Œè¦å®ç°ä¸åŒçš„æ“ä½œï¼Œåªéœ€è¦åœ¨ xml é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ï¼Œæ‰€è°“ IOCï¼Œå³å¯¹è±¡ç”± Spring åˆ›å»ºã€ç®¡ç†å’Œè£…é…ï¼</strong></p>
<h2 id="jump">4ã€IOCåˆ›å»ºå¯¹è±¡çš„æ–¹å¼</h2>

<p>å®ä½“ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> score;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setScore</span><span class="params">(<span class="keyword">int</span> score)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.score = score;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"User{"</span> +</span><br><span class="line">                <span class="string">"name='"</span> + name + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", id='"</span> + id + <span class="string">'\''</span> +</span><br><span class="line">                <span class="string">", score="</span> + score +</span><br><span class="line">                <span class="string">'}'</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name, String id, <span class="keyword">int</span> score)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.score = score;</span><br><span class="line">        System.out.println(<span class="string">"Userç±»å·²è¢«æœ‰å‚æ„é€ æ–¹æ³•åˆ›å»ºï¼"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"Userç±»å·²è¢«æ— å‚æ„é€ æ–¹æ³•åˆ›å»ºï¼"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-1ã€ä½¿ç”¨æ— å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼ˆé»˜è®¤ï¼‰"><a href="#4-1ã€ä½¿ç”¨æ— å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼ˆé»˜è®¤ï¼‰" class="headerlink" title="4.1ã€ä½¿ç”¨æ— å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼ˆé»˜è®¤ï¼‰"></a>4.1ã€ä½¿ç”¨æ— å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼ˆé»˜è®¤ï¼‰</h4>   <figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"User"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-2ã€-ä½¿ç”¨æœ‰å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡"><a href="#4-2ã€-ä½¿ç”¨æœ‰å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡" class="headerlink" title="4.2ã€ ä½¿ç”¨æœ‰å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡"></a>4.2ã€ ä½¿ç”¨æœ‰å‚æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡</h4><p>(1) æ ¹æ®å‚æ•°åèµ‹å€¼</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;beans xmlns=<span class="string">"http://www.springframework.org/schema/beans"</span></span><br><span class="line">       xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line">       xsi:schemaLocation=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;bean id=<span class="string">"user"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"User"</span>&gt;</span><br><span class="line">        &lt;constructor-arg name=<span class="string">"id"</span> value=<span class="string">"1"</span>/&gt;</span><br><span class="line">        &lt;constructor-arg name=<span class="string">"name"</span> value=<span class="string">"yqx"</span>/&gt;</span><br><span class="line">        &lt;constructor-arg name=<span class="string">"score"</span> value=<span class="string">"10"</span>/&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>(2) æ ¹æ®å‚æ•°ä¸‹æ ‡èµ‹å€¼</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">value</span>=<span class="string">"ysy"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"1"</span> <span class="attr">value</span>=<span class="string">"2"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"2"</span> <span class="attr">value</span>=<span class="string">"20"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>(3) æ ¹æ®å‚æ•°ç±»å‹èµ‹å€¼ï¼ˆç›¸åŒåˆ™æŒ‰é¡ºåºèµ‹å€¼ï¼‰</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span> <span class="attr">value</span>=<span class="string">"mc"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span> <span class="attr">value</span>=<span class="string">"3"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"int"</span> <span class="attr">value</span>=<span class="string">"30"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><code>æ³¨ï¼šåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œåªè¦æ³¨å†Œåœ¨ beans.xml ä¸­ï¼Œåˆ™æ— è®ºæ˜¯å¦è°ƒç”¨ getBean æ¥è·å–å¯¹è±¡éƒ½ä¼šåœ¨è¯»å–é…ç½®æ–‡ä»¶çš„æ—¶å€™åˆ›å»ºå¥½å¯¹è±¡ï¼Œå› æ­¤è¿”å›çš„éƒ½æ˜¯è¿™ä¸ªäº‹å…ˆè¢«åˆ›å»ºå¥½çš„å¯¹è±¡</code></p>
<p>æ­¤å¤„è¿˜æ²¡è¿è¡Œåˆ° <code>getBean</code> æ—¶ï¼Œå°±å·²ç»æ‰“å°äº†åˆ›å»ºå¯¹è±¡çš„è¯­å¥ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/11/5VEsCn.png" alt=""></p>
<p>å¯ä»¥çœ‹åˆ° user1 å’Œ user2 æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/10/11/5VV2RI.png" alt=""></p>
<h2 id="5ã€Spring-é…ç½®"><a href="#5ã€Spring-é…ç½®" class="headerlink" title="5ã€Spring é…ç½®"></a>5ã€Spring é…ç½®</h2><h4 id="5-1ã€bean-çš„é…ç½®"><a href="#5-1ã€bean-çš„é…ç½®" class="headerlink" title="5.1ã€bean çš„é…ç½®"></a>5.1ã€bean çš„é…ç½®</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	id: bean çš„å”¯ä¸€æ ‡è¯†</span></span><br><span class="line"><span class="comment">	class: bean å¯¹è±¡æ‰€å¯¹åº”çš„å…¨é™å®šå(åŒ…å + ç±»å‹)</span></span><br><span class="line"><span class="comment">	name: åˆ«åï¼Œä½†ä¸å”¯ä¸€ï¼Œå¯ä»¥ç”¨ç¬¦å·åˆ†éš”</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"User"</span> <span class="attr">name</span>=<span class="string">"u1,u2 u3;u4"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span> <span class="attr">value</span>=<span class="string">"mc"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span> <span class="attr">value</span>=<span class="string">"3"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"int"</span> <span class="attr">value</span>=<span class="string">"30"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="5-2ã€åˆ«å"><a href="#5-2ã€åˆ«å" class="headerlink" title="5.2ã€åˆ«å"></a>5.2ã€åˆ«å</h4><figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	å’Œ name åŠŸèƒ½ä¸€è‡´ï¼Œå¯ä»¥ç»™åˆ«åå†å–åˆ«å</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">alias</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">alias</span>=<span class="string">"u5"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">alias</span> <span class="attr">name</span>=<span class="string">"u5"</span> <span class="attr">alias</span>=<span class="string">"u6"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="5-3ã€import"><a href="#5-3ã€import" class="headerlink" title="5.3ã€import"></a>5.3ã€import</h4><p><code>import</code> ä¸€èˆ¬ç”¨äºå›¢é˜Ÿå¼€å‘ä½¿ç”¨ï¼Œå¯ä»¥å°†å¤šä¸ªé…ç½®æ–‡ä»¶å¯¼å…¥åˆå¹¶æˆä¸€ä¸ª</p>
<p>å‡è®¾ï¼Œç°åœ¨é¡¹ç›®ä¸­æœ‰å¤šä¸ªäººå¼€å‘ï¼Œè¿™ä¸‰ä¸ªäººè´Ÿè´£ä¸åŒçš„ç±»å¼€å‘ï¼Œä¸åŒçš„ç±»éœ€è¦æ³¨å†Œåœ¨ä¸åŒçš„ bean ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>import</code> å°†æ‰€æœ‰äººçš„ beans.xml åˆå¹¶æˆä¸€ä¸ªï¼</p>
<ul>
<li>beans1.xml</li>
<li>beans2.xml</li>
<li>beans3.xml</li>
<li>applicaionContext.xml</li>
</ul>
<p>applicationContext.xml ä½œä¸ºæ±‡æ€»çš„é…ç½®æ–‡ä»¶åªéœ€è¦åœ¨å…¶ä¸­å¯¼å…¥å…¶å®ƒé…ç½®æ–‡ä»¶å³å¯ã€‚</p>
<p>æ³¨ï¼šæœ‰å¤šä¸ªé‡å¤çš„ bean æ—¶ï¼Œä¼šåˆå¹¶ä¸€ä¸ªã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"beans1.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"beans2.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"beans3.xml"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>ä½¿ç”¨çš„æ—¶å€™ç›´æ¥ä½¿ç”¨æ€»çš„é…ç½®æ–‡ä»¶å°±è¡Œã€‚</p>
<h2 id="6ã€ä¾èµ–æ³¨å…¥"><a href="#6ã€ä¾èµ–æ³¨å…¥" class="headerlink" title="6ã€ä¾èµ–æ³¨å…¥"></a>6ã€ä¾èµ–æ³¨å…¥</h2><h4 id="6-1ã€æ„é€ å™¨æ³¨å…¥"><a href="#6-1ã€æ„é€ å™¨æ³¨å…¥" class="headerlink" title="6.1ã€æ„é€ å™¨æ³¨å…¥"></a>6.1ã€æ„é€ å™¨æ³¨å…¥</h4><p>è¯¦æƒ…æŸ¥çœ‹<a href="#jump">IOC åˆ›å»ºå¯¹è±¡çš„æ–¹å¼</a></p>
<h4 id="6-2ã€Setæ–¹å¼æ³¨å…¥-ã€é‡ç‚¹ã€‘"><a href="#6-2ã€Setæ–¹å¼æ³¨å…¥-ã€é‡ç‚¹ã€‘" class="headerlink" title="6.2ã€Setæ–¹å¼æ³¨å…¥ ã€é‡ç‚¹ã€‘"></a>6.2ã€Setæ–¹å¼æ³¨å…¥ ã€é‡ç‚¹ã€‘</h4><ul>
<li>ä¾èµ–æ³¨å…¥ï¼šSet æ³¨å…¥ï¼<ul>
<li>ä¾èµ–ï¼šbean å¯¹è±¡çš„åˆ›å»ºä¾èµ–äºå®¹å™¨ï¼</li>
<li>æ³¨å…¥ï¼šbean å¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§ç”±å®¹å™¨æ¥æ³¨å…¥ï¼</li>
</ul>
</li>
</ul>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"address"</span> <span class="attr">class</span>=<span class="string">"Address"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"address"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>å®å±±<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"student"</span> <span class="attr">class</span>=<span class="string">"Student"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ™®é€šå€¼æ³¨å…¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"yqx"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"20"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--null--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"wife"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">null</span>&gt;</span><span class="tag">&lt;/<span class="name">null</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--å¼•ç”¨ç±»å‹--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"address"</span> <span class="attr">ref</span>=<span class="string">"address"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--list--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"hobbies"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>å”±æ­Œ<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>è·³èˆ<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>é€›Bç«™<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--set--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"games"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>é£æ¥ä¹‹å›½<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>ä»¥æ’’çš„ç»“åˆ<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>æ€æˆ®å°–å¡”<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--array--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"books"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>é«˜ç­‰æ•°å­¦<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>çº¿æ€§ä»£æ•°<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>æ¦‚ç‡è®º<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--map--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"card"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"The Sun"</span> <span class="attr">value</span>=<span class="string">"å¤ªé˜³"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"The Star"</span> <span class="attr">value</span>=<span class="string">"æ˜Ÿæ˜Ÿ"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"The Hanged Man"</span> <span class="attr">value</span>=<span class="string">"å€’åŠäºº"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--properties--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"info"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"height"</span>&gt;</span>175<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"weight"</span>&gt;</span>60<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ‰“å°å†…å®¹</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Student{</span><br><span class="line">    name=<span class="string">'yqx'</span>, </span><br><span class="line">    address=Address{address=<span class="string">'å®å±±'</span>}, </span><br><span class="line">    age=<span class="number">20</span>, </span><br><span class="line">    books=[é«˜ç­‰æ•°å­¦, çº¿æ€§ä»£æ•°, æ¦‚ç‡è®º], </span><br><span class="line">    hobbies=[å”±æ­Œ, è·³èˆ, é€›Bç«™], </span><br><span class="line">    card={The Sun=å¤ªé˜³, The Star=æ˜Ÿæ˜Ÿ, The Hanged Man=å€’åŠäºº}, </span><br><span class="line">    games=[é£æ¥ä¹‹å›½, ä»¥æ’’çš„ç»“åˆ, æ€æˆ®å°–å¡”], </span><br><span class="line">    wife=<span class="string">'null'</span>, </span><br><span class="line">    info={height=<span class="number">175</span>, weight=<span class="number">60</span>}}</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="6-3ã€æ‹“å±•æ–¹å¼æ³¨å…¥"><a href="#6-3ã€æ‹“å±•æ–¹å¼æ³¨å…¥" class="headerlink" title="6.3ã€æ‹“å±•æ–¹å¼æ³¨å…¥"></a>6.3ã€æ‹“å±•æ–¹å¼æ³¨å…¥</h4><p>p (parameter) å‘½åç©ºé—´ï¼Œå³ <code>set</code> æ–¹å¼æ³¨å…¥ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line">xmlns:p="http://www.springframework.org/schema/p"</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--ä»¥ä¸‹ä¸¤ç§æ–¹å¼ç­‰ä»·--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user1"</span> <span class="attr">class</span>=<span class="string">"User"</span> <span class="attr">p:name</span>=<span class="string">"yqx"</span> <span class="attr">p:age</span>=<span class="string">"18"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user1"</span> <span class="attr">class</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"yqx"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"18"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>c (constructor) å‘½åç©ºé—´ï¼Œå³<code>æ„é€ å™¨</code>æ³¨å…¥ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line">xmlns:c="http://www.springframework.org/schema/c"</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user2"</span> <span class="attr">class</span>=<span class="string">"User"</span> <span class="attr">c:name</span>=<span class="string">"deflory"</span> <span class="attr">c:age</span>=<span class="string">"20"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"use2"</span> <span class="attr">class</span>=<span class="string">"User"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"deflory"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"20"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>å‘½åç©ºé—´æ³¨å…¥ç®€åŒ–äº†é…ç½®æ–‡ä»¶çš„ä»£ç ï¼Œä½†éœ€è¦æ˜¾ç¤ºå£°æ˜å‘½åç©ºé—´ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line">xmlns:p="http://www.springframework.org/schema/p"</span><br><span class="line">xmlns:c="http://www.springframework.org/schema/c"</span><br></pre></td></tr></tbody></table></figure>
<h4 id="6-4ã€Bean-çš„ä½œç”¨åŸŸ"><a href="#6-4ã€Bean-çš„ä½œç”¨åŸŸ" class="headerlink" title="6.4ã€Bean çš„ä½œç”¨åŸŸ"></a>6.4ã€Bean çš„ä½œç”¨åŸŸ</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">ä½œç”¨åŸŸ</th>
<th style="text-align:center">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">singleton</td>
<td style="text-align:center">è¯¥ä½œç”¨åŸŸå°† bean çš„å®šä¹‰é™åˆ¶åœ¨æ¯ä¸€ä¸ª IoC å®¹å™¨ä¸­çš„ä¸€ä¸ªå•ä¸€å®ä¾‹(é»˜è®¤)ã€‚</td>
</tr>
<tr>
<td style="text-align:center">prototype</td>
<td style="text-align:center">è¯¥ä½œç”¨åŸŸå°†å•ä¸€ bean çš„å®šä¹‰é™åˆ¶åœ¨ä»»æ„æ•°é‡çš„å¯¹è±¡å®ä¾‹ã€‚</td>
</tr>
<tr>
<td style="text-align:center">request</td>
<td style="text-align:center">è¯¥ä½œç”¨åŸŸå°† bean çš„å®šä¹‰é™åˆ¶ä¸º HTTP è¯·æ±‚ã€‚åªåœ¨ web-aware Spring ApplicationContext çš„ä¸Šä¸‹æ–‡ä¸­æœ‰æ•ˆã€‚</td>
</tr>
<tr>
<td style="text-align:center">session</td>
<td style="text-align:center">è¯¥ä½œç”¨åŸŸå°† bean çš„å®šä¹‰é™åˆ¶ä¸º HTTP ä¼šè¯ã€‚ åªåœ¨web-aware Spring ApplicationContextçš„ä¸Šä¸‹æ–‡ä¸­æœ‰æ•ˆã€‚</td>
</tr>
<tr>
<td style="text-align:center">global-session</td>
<td style="text-align:center">è¯¥ä½œç”¨åŸŸå°† bean çš„å®šä¹‰é™åˆ¶ä¸ºå…¨å±€ HTTP ä¼šè¯ã€‚åªåœ¨ web-aware Spring ApplicationContext çš„ä¸Šä¸‹æ–‡ä¸­æœ‰æ•ˆã€‚</td>
</tr>
</tbody>
</table>
</div>
<p>singleton å•ä¾‹æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"User"</span> <span class="attr">scope</span>=<span class="string">"singleton"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"deflory"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"20"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>{</span><br><span class="line">    ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"beans.xml"</span>);</span><br><span class="line">    User user1 = context.getBean(<span class="string">"user"</span>, User.class);</span><br><span class="line">    User user2 = context.getBean(<span class="string">"user"</span>, User.class);</span><br><span class="line">    System.out.println(user1 == user2);		<span class="comment">// true</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>prototype åŸå‹æ¨¡å¼</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"User"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"deflory"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"20"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>{</span><br><span class="line">    ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"beans.xml"</span>);</span><br><span class="line">    User user1 = context.getBean(<span class="string">"user"</span>, User.class);</span><br><span class="line">    User user2 = context.getBean(<span class="string">"user"</span>, User.class);</span><br><span class="line">    System.out.println(user1 == user2);		<span class="comment">// false</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="7ã€Bean-çš„è‡ªåŠ¨è£…é…"><a href="#7ã€Bean-çš„è‡ªåŠ¨è£…é…" class="headerlink" title="7ã€Bean çš„è‡ªåŠ¨è£…é…"></a>7ã€Bean çš„è‡ªåŠ¨è£…é…</h2><h4 id="7-1ã€ByNameè‡ªåŠ¨è£…é…"><a href="#7-1ã€ByNameè‡ªåŠ¨è£…é…" class="headerlink" title="7.1ã€ByNameè‡ªåŠ¨è£…é…"></a>7.1ã€ByNameè‡ªåŠ¨è£…é…</h4><p>ä¼šè‡ªåŠ¨å¯»æ‰¾ä¸å±æ€§<code>ç±»å</code>ç›¸åŒçš„ bean_id (é¦–å­—æ¯å°å†™)ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"cat"</span> <span class="attr">class</span>=<span class="string">"Cat"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dog"</span> <span class="attr">class</span>=<span class="string">"Dog"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"person"</span> <span class="attr">class</span>=<span class="string">"Person"</span> <span class="attr">autowire</span>=<span class="string">"byName"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="7-2ã€ByNameè‡ªåŠ¨è£…é…"><a href="#7-2ã€ByNameè‡ªåŠ¨è£…é…" class="headerlink" title="7.2ã€ByNameè‡ªåŠ¨è£…é…"></a>7.2ã€ByNameè‡ªåŠ¨è£…é…</h4><p>ä¼šè‡ªåŠ¨å¯»æ‰¾ä¸<code>å±æ€§</code>ç›¸åŒç±»å‹çš„ bean (è¯¥ç±»å‹å¿…é¡»å”¯ä¸€)ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"Cat"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"Dog"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"person"</span> <span class="attr">class</span>=<span class="string">"Person"</span> <span class="attr">autowire</span>=<span class="string">"byType"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ€»ç»“ï¼šåœ¨ä½¿ç”¨ ByName æ—¶ï¼Œéœ€è¦æŒ‡å®šå’Œç±»åå°å†™ç›¸åŒçš„ bean_idï¼›</p>
<p>â€‹            åœ¨ä½¿ç”¨ ByType æ—¶ï¼Œä¸å±æ€§åŒç±»å‹çš„ bean å¿…é¡»å”¯ä¸€ã€‚</p>
<h4 id="7-3ã€ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…"><a href="#7-3ã€ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…" class="headerlink" title="7.3ã€ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…"></a>7.3ã€ä½¿ç”¨æ³¨è§£å®ç°è‡ªåŠ¨è£…é…</h4><p>ä½¿ç”¨å‰æï¼š<code>å¯¼å…¥çº¦æŸ</code>å¹¶å¼€å¯<code>æ³¨è§£æ”¯æŒ</code></p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- bean definitions go here --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>@Autowired æ³¨è§£</strong></p>
<p>é»˜è®¤ä½¿ç”¨ ByType çš„æ–¹å¼ï¼Œä¸è¡Œåˆ™ä½¿ç”¨ ByNameã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dog <span class="title">getDog</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> dog;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Cat <span class="title">getCat</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> cat;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å¯ä»¥ä½¿ç”¨ <code>@Qualifier</code> æ¥æŒ‡å®š bean_id</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>{</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="meta">@Qualifier(value = "cat11")</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dog <span class="title">getDog</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> dog;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Cat <span class="title">getCat</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> cat;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>@Resource æ³¨è§£ ï¼ˆJava åŸç”Ÿæ³¨è§£ï¼‰</strong></p>
<p>é»˜è®¤ä½¿ç”¨ ByName çš„æ–¹å¼ï¼Œä¸è¡Œåˆ™ä½¿ç”¨ ByTypeã€‚</p>
<p>åŠŸèƒ½æ›´ä¸ºå¼ºå¤§ï¼Œå¯ä»¥æŒ‡å®š bean_idï¼Œç›¸å½“äºä¸Šè¿°ä¸¤ä¸ªæ³¨è§£çš„ç»“åˆã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>{</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource(name = "cat11")</span></span><br><span class="line">    <span class="keyword">private</span> Cat cat;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Dog <span class="title">getDog</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> dog;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Cat <span class="title">getCat</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> cat;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="8ã€ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#8ã€ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="8ã€ä½¿ç”¨æ³¨è§£å¼€å‘"></a>8ã€ä½¿ç”¨æ³¨è§£å¼€å‘</h2><p>å¿…é¡»æŒ‡å®š<code>æ‰«æ</code>å¸¦æœ‰æ³¨è§£çš„åŒ…æ‰èƒ½ä½¿ç”¨</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.yqx.pojo"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="8-1ã€å±æ€§æ³¨å…¥"><a href="#8-1ã€å±æ€§æ³¨å…¥" class="headerlink" title="8.1ã€å±æ€§æ³¨å…¥"></a>8.1ã€å±æ€§æ³¨å…¥</h4><ul>
<li><p>@Component è¡¨æ˜è¯¥ç±»è¢« Spring æ‰˜ç®¡ï¼Œid ä¸ºç±»åé¦–å­—æ¯å°å†™ã€‚</p>
</li>
<li><p>@Value ç»™å±æ€§æ³¨å…¥å€¼ã€‚</p>
</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>{</span><br><span class="line">    <span class="meta">@Value("yqx")</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="8-2ã€æ³¨è§£çš„è¡ç”Ÿ"><a href="#8-2ã€æ³¨è§£çš„è¡ç”Ÿ" class="headerlink" title="8.2ã€æ³¨è§£çš„è¡ç”Ÿ"></a>8.2ã€æ³¨è§£çš„è¡ç”Ÿ</h4><ul>
<li>@Component æœ‰å‡ ä¸ªè¡ç”Ÿæ³¨è§£ï¼Œåœ¨ web å¼€å‘ä¸­ï¼Œä¼šæŒ‰ç…§ mvc ä¸‰å±‚æ¶æ„åˆ†å±‚ï¼<ul>
<li>Dao ã€@Repositoryã€‘</li>
<li>Service ã€@Serviceã€‘</li>
<li>Controller ã€@Controllerã€‘</li>
</ul>
</li>
</ul>
<p>è¿™å››ä¸ªæ³¨è§£åŠŸèƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å°†æŸä¸ªç±»æ³¨å†Œåˆ° Spring ä¸­ï¼Œè£…é… Beanã€‚</p>
<h4 id="8-3ã€ä½œç”¨åŸŸ"><a href="#8-3ã€ä½œç”¨åŸŸ" class="headerlink" title="8.3ã€ä½œç”¨åŸŸ"></a>8.3ã€ä½œç”¨åŸŸ</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Scope;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Scope("prototype")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>{</span><br><span class="line">    <span class="meta">@Value("yqx")</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="8-4ã€å°ç»“"><a href="#8-4ã€å°ç»“" class="headerlink" title="8.4ã€å°ç»“"></a>8.4ã€å°ç»“</h4><p>xml ä¸ æ³¨è§£ï¼š</p>
<ul>
<li>xml æ›´åŠ ä¸‡èƒ½ï¼Œé€‚ç”¨äºä»»ä½•åœºåˆï¼ç»´æŠ¤ç®€å•æ–¹ä¾¿ï¼Œåªéœ€ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚</li>
<li>æ³¨è§£ç»´æŠ¤ç¹çï¼Œåˆ†æ•£åœ¨å„ä¸ªå®ä½“ç±»ä¸­ã€‚</li>
</ul>
<p>xml ä¸ æ³¨è§£æœ€ä½³å®è·µï¼š</p>
<ul>
<li>xml ç”¨æ¥ç®¡ç† beanã€‚</li>
<li>æ³¨è§£åªè´Ÿè´£å®Œæˆå±æ€§æ³¨å…¥ã€‚</li>
</ul>
<h2 id="9ã€ä½¿ç”¨-Java-çš„æ–¹å¼é…ç½®-Spring"><a href="#9ã€ä½¿ç”¨-Java-çš„æ–¹å¼é…ç½®-Spring" class="headerlink" title="9ã€ä½¿ç”¨ Java çš„æ–¹å¼é…ç½® Spring"></a>9ã€ä½¿ç”¨ Java çš„æ–¹å¼é…ç½® Spring</h2><p><strong>@Configuration</strong></p>
<p>åŸºäº Java çš„é…ç½®é€‰é¡¹ï¼Œå¯ä»¥æ˜¯ä½ åœ¨ä¸ç”¨é…ç½® XML çš„æƒ…å†µä¸‹ç¼–å†™å¤§éƒ¨åˆ†çš„ Springã€‚</p>
<ul>
<li>@Configuration ç”¨äºç±»ä¸Šï¼Œè¡¨ç¤ºè¿™ä¸ªç±»å¯ä»¥ä½¿ç”¨ Spring IOC å®¹å™¨ä½œä¸º Bean å®šä¹‰çš„æ¥æºã€‚</li>
<li>@Bean ç”¨äºæ–¹æ³•ä¸Šï¼Œè¿™ä¸ªæ–¹æ³•è¦è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œè¯¥å¯¹è±¡ä¼šè¢«æ³¨å†Œä¸ºåœ¨ Spring åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­çš„ Beanã€‚</li>
</ul>
<p>å®ä½“ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>{</span><br><span class="line">    <span class="meta">@Value("deflory")</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Java é…ç½®ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConfig</span> </span>{</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUser</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸Šé¢çš„ Java é…ç½®ç±»ç­‰åŒäºä¸‹é¢çš„ XML é…ç½®ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œbean_id å’Œ @Bean ä¿®é¥°çš„<code>æ–¹æ³•å</code>ä¸€è‡´ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"getUser"</span> <span class="attr">class</span>=<span class="string">"User"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ³¨ï¼šè™½ç„¶ @Bean ä¸­æ˜¯ return new User()ï¼Œä½†é»˜è®¤è¿˜æ˜¯<code>å•ä¾‹</code>æ¨¡å¼ã€‚</p>
<p><strong>@Import</strong></p>
<p>@import æ³¨è§£å…è®¸ä»å¦ä¸€ä¸ªé…ç½®ç±»ä¸­åŠ è½½ @Bean å®šä¹‰ã€‚</p>
<p>å¦ä¸€ä¸ªé…ç½®ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigA</span> </span>{</span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> A <span class="title">a</span><span class="params">()</span> </span>{</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> A(); </span><br><span class="line">   }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸»é…ç½®ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Import(ConfigA.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigB</span> </span>{</span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> B <span class="title">b</span><span class="params">()</span> </span>{</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> B(); </span><br><span class="line">   }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">   ApplicationContext context = </span><br><span class="line">   <span class="keyword">new</span> AnnotationConfigApplicationContext(ConfigB.class);</span><br><span class="line">   A a = context.getBean(A.class);</span><br><span class="line">   B b = context.getBean(B.class);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="10ã€ä»£ç†æ¨¡å¼"><a href="#10ã€ä»£ç†æ¨¡å¼" class="headerlink" title="10ã€ä»£ç†æ¨¡å¼"></a>10ã€ä»£ç†æ¨¡å¼</h2><p>ä»£ç†æ¨¡å¼çš„åˆ†ç±»ï¼š</p>
<ul>
<li>é™æ€ä»£ç†</li>
<li>åŠ¨æ€ä»£ç†</li>
</ul>
<p><img src="https://z3.ax1x.com/2021/10/16/5JbxhQ.png" alt=""></p>
<h4 id="10-1ã€-é™æ€ä»£ç†"><a href="#10-1ã€-é™æ€ä»£ç†" class="headerlink" title="10.1ã€ é™æ€ä»£ç†"></a>10.1ã€ é™æ€ä»£ç†</h4><p>è§’è‰²åˆ†æï¼š</p>
<ul>
<li>æŠ½è±¡è§’è‰²ï¼šä¸€èˆ¬ä¼šä½¿ç”¨æ¥å£æˆ–è€…æŠ½è±¡ç±»æ¥è§£å†³ã€‚</li>
<li>çœŸå®è§’è‰²ï¼šè¢«ä»£ç†çš„è§’è‰²ã€‚</li>
<li>ä»£ç†è§’è‰²ï¼šä»£ç†çœŸå®è§’è‰²ï¼Œæ·»åŠ é¢å¤–æ“ä½œã€‚</li>
<li>å®¢æˆ·ï¼šè®¿é—®ä»£ç†å¯¹è±¡çš„äººã€‚</li>
</ul>
<p>ä»£ç ï¼š</p>
<ol>
<li><p>æ¥å£</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Rent</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>çœŸå®è§’è‰²</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Landlord</span> <span class="keyword">implements</span> <span class="title">Rent</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"æˆ¿ä¸œè¦å‡ºç§Ÿæˆ¿å­"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>ä»£ç†è§’è‰²</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Agent</span> <span class="keyword">implements</span> <span class="title">Rent</span></span>{</span><br><span class="line">    Rent landlord;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Agent</span><span class="params">(Rent landlord)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.landlord = landlord;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rent</span><span class="params">()</span> </span>{</span><br><span class="line">        findRenter();</span><br><span class="line">        landlord.rent();</span><br><span class="line">        negotiation();</span><br><span class="line">        fee();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fee</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"ä¸­ä»‹æ”¶å–ä¸­ä»‹è´¹"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findRenter</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"ä¸­ä»‹å¯»æ‰¾ç§Ÿå®¢"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">negotiation</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"ä¸­ä»‹ç­¾è®¢åˆåŒ"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>å®¢æˆ·ç«¯è®¿é—®ä»£ç†è§’è‰²</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest01</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Rent agent = <span class="keyword">new</span> Agent(<span class="keyword">new</span> Landlord());</span><br><span class="line">        agent.rent();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<p>ä»£ç†æ¨¡å¼çš„å¥½å¤„ï¼š</p>
<ul>
<li>å¯ä»¥ä½¿çœŸå®è§’è‰²çš„æ“ä½œæ›´åŠ çº¯ç²¹ï¼ä¸ç”¨å»å…³æ³¨ä¸€äº›å…¬å…±çš„ä¸šåŠ¡ã€‚</li>
<li>å…¬å…±ä¸šåŠ¡äº¤ä»£ä»£ç†è§’è‰²ï¼Œå®ç°äº†ä¸šåŠ¡çš„åˆ†å·¥ã€‚</li>
<li>å…¬å…±ä¸šåŠ¡å‘ç”Ÿæ‹“å±•çš„æ—¶å€™ï¼Œæ–¹ä¾¿é›†ä¸­ç®¡ç†ã€‚</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ä¸€ä¸ªçœŸå®è§’è‰²å°±ä¼šäº§ç”Ÿä¸€ä¸ªä»£ç†è§’è‰²ï¼Œä»£ç é‡ä¼šç¿»å€ï¼Œå¼€å‘æ•ˆç‡ä¼šå˜ä½ã€‚</li>
</ul>
<h4 id="10-2ã€åŠ¨æ€ä»£ç†"><a href="#10-2ã€åŠ¨æ€ä»£ç†" class="headerlink" title="10.2ã€åŠ¨æ€ä»£ç†"></a>10.2ã€åŠ¨æ€ä»£ç†</h4><ul>
<li>åŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†è§’è‰²ä¸€æ ·</li>
<li>åŠ¨æ€ä»£ç†çš„ä»£ç†ç±»æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œè€Œéç¨‹åºå‘˜æ‰‹å†™çš„ï¼</li>
<li>åŠ¨æ€ä»£ç†åˆ†ä¸ºä¸¤å¤§ç±»ï¼šåŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†ï¼ŒåŸºäºç±»çš„åŠ¨æ€ä»£ç†ã€‚<ul>
<li>åŸºäºæ¥å£ï¼šJDK åŠ¨æ€ä»£ç† ã€ä¸‹è¿°ä½¿ç”¨ã€‘</li>
<li>åŸºäºç±»ï¼šcglib</li>
<li>java å­—èŠ‚ç å®ç°ï¼šjavasist</li>
</ul>
</li>
</ul>
<p>éœ€è¦äº†è§£ä¸¤ä¸ªç±»ï¼š</p>
<ul>
<li>Proxyï¼šä»£ç†</li>
<li>InvocationHandlerï¼šè°ƒç”¨å¤„ç†ç¨‹åº</li>
</ul>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>åŒ…å«é™æ€ä»£ç†çš„ä¼˜ç‚¹ã€‚</li>
<li>ä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»ä»£ç†çš„æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¯¹åº”ä¸€ç±»ä¸šåŠ¡ã€‚</li>
</ul>
<h2 id="11ã€AOP"><a href="#11ã€AOP" class="headerlink" title="11ã€AOP"></a>11ã€AOP</h2><p>Spring æ¡†æ¶çš„ä¸€ä¸ªå…³é”®ç»„ä»¶æ˜¯<strong>é¢å‘åˆ‡é¢çš„ç¼–ç¨‹</strong>(AOP)æ¡†æ¶ã€‚é¢å‘åˆ‡é¢çš„ç¼–ç¨‹éœ€è¦æŠŠç¨‹åºé€»è¾‘åˆ†è§£æˆä¸åŒçš„éƒ¨åˆ†ç§°ä¸ºæ‰€è°“çš„å…³æ³¨ç‚¹ã€‚è·¨ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„å¤šä¸ªç‚¹çš„åŠŸèƒ½è¢«ç§°ä¸º<strong>æ¨ªåˆ‡å…³æ³¨ç‚¹</strong>ï¼Œè¿™äº›æ¨ªåˆ‡å…³æ³¨ç‚¹åœ¨æ¦‚å¿µä¸Šç‹¬ç«‹äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘ã€‚</p>
<h4 id="11-1ã€é€šçŸ¥ç±»å‹"><a href="#11-1ã€é€šçŸ¥ç±»å‹" class="headerlink" title="11.1ã€é€šçŸ¥ç±»å‹"></a>11.1ã€é€šçŸ¥ç±»å‹</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">é€šçŸ¥</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">å‰ç½®é€šçŸ¥</td>
<td style="text-align:left">åœ¨ä¸€ä¸ªæ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œæ‰§è¡Œé€šçŸ¥ã€‚</td>
</tr>
<tr>
<td style="text-align:left">åç½®é€šçŸ¥</td>
<td style="text-align:left">åœ¨ä¸€ä¸ªæ–¹æ³•æ‰§è¡Œä¹‹åï¼Œä¸è€ƒè™‘å…¶ç»“æœï¼Œæ‰§è¡Œé€šçŸ¥ã€‚</td>
</tr>
<tr>
<td style="text-align:left">è¿”å›åé€šçŸ¥</td>
<td style="text-align:left">åœ¨ä¸€ä¸ªæ–¹æ³•æ‰§è¡Œä¹‹åï¼Œåªæœ‰åœ¨æ–¹æ³•æˆåŠŸå®Œæˆæ—¶ï¼Œæ‰èƒ½æ‰§è¡Œé€šçŸ¥ã€‚</td>
</tr>
<tr>
<td style="text-align:left">æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥</td>
<td style="text-align:left">åœ¨ä¸€ä¸ªæ–¹æ³•æ‰§è¡Œä¹‹åï¼Œåªæœ‰åœ¨æ–¹æ³•é€€å‡ºæŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œæ‰èƒ½æ‰§è¡Œé€šçŸ¥ã€‚</td>
</tr>
<tr>
<td style="text-align:left">ç¯ç»•é€šçŸ¥</td>
<td style="text-align:left">åœ¨å»ºè®®æ–¹æ³•è°ƒç”¨ä¹‹å‰å’Œä¹‹åï¼Œæ‰§è¡Œé€šçŸ¥ã€‚</td>
</tr>
</tbody>
</table>
</div>
<h4 id="11-2ã€åœ¨-Spring-ä¸­ä½¿ç”¨-Aop"><a href="#11-2ã€åœ¨-Spring-ä¸­ä½¿ç”¨-Aop" class="headerlink" title="11.2ã€åœ¨ Spring ä¸­ä½¿ç”¨ Aop"></a>11.2ã€åœ¨ Spring ä¸­ä½¿ç”¨ Aop</h4><p>å¯¼å…¥ä¾èµ–åŒ…</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ·»åŠ çº¦æŸ</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/aop/spring-aop.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>(1) åŸç”Ÿ Spring Api æ¥å£</strong></p>
<p>xml é…ç½®</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"com.yqx.service.UserServiceImpl"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"log"</span> <span class="attr">class</span>=<span class="string">"com.yqx.log.Log"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æ–¹å¼ä¸€ï¼šä½¿ç”¨åŸç”Ÿçš„Spring APIæ¥å£--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®aop--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--åˆ‡å…¥ç‚¹--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"pointcut"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.yqx.service.UserServiceImpl.*(..))"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ‰§è¡Œç¯ç»•å¢åŠ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"log"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ—¥å¿—ç±»ï¼Œè¿™é‡Œé‡‡ç”¨äº†å¤šå®ç°ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.AfterReturningAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.MethodBeforeAdvice;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Log</span> <span class="keyword">implements</span> <span class="title">MethodBeforeAdvice</span>, <span class="title">AfterReturningAdvice</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturning</span><span class="params">(Object returnValue, Method method, Object[] args, Object target)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">        System.out.println(method.getName() + <span class="string">"æ–¹æ³•æ‰§è¡Œå®Œæ¯•ï¼Œè¿”å›å€¼ä¸ºï¼š"</span> + returnValue);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">(Method method, Object[] args, Object target)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">        System.out.println(target.getClass().getName() + <span class="string">"ä¸­çš„"</span> + method.getName() + <span class="string">"æ–¹æ³•è¢«è°ƒç”¨äº†ï¼"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Test æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.yqx.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        ClassPathXmlApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line">        <span class="comment">// åŠ¨æ€ä»£ç†ä»£ç†çš„æ˜¯æ¥å£ï¼Œå› æ­¤åªèƒ½è½¬ä¸ºæ¥å£ç±»å‹</span></span><br><span class="line">        UserService userService = (UserService) context.getBean(<span class="string">"userService"</span>);</span><br><span class="line">        userService.add();</span><br><span class="line">        userService.query();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>(2) è‡ªå®šä¹‰ç±»</strong></p>
<p>æ—¥å¿—ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLog</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"å‰ç½®é€šçŸ¥"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"åç½®é€šçŸ¥"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"com.yqx.service.UserServiceImpl"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"myLog"</span> <span class="attr">class</span>=<span class="string">"com.yqx.log.MyLog"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--è‡ªå®šä¹‰åˆ‡é¢--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">"myLog"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åˆ‡å…¥ç‚¹--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"pointout"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.yqx.service.UserServiceImpl.*(..))"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--é€šçŸ¥--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">"before"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointout"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:after</span> <span class="attr">method</span>=<span class="string">"after"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointout"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>è™½ç„¶æ–¹ä¾¿ï¼Œä½†æ— æ³•è·å–ç±»ä¸æ–¹æ³•çš„ä¿¡æ¯ï¼ŒåŠŸèƒ½ä¸å¤Ÿå¼ºå¤§ã€‚</p>
<p><strong>(3) æ³¨è§£</strong></p>
<p>æ—¥å¿—ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.log;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.After;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Before;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnotationLog</span> </span>{</span><br><span class="line">    <span class="meta">@Before("execution(* com.yqx.service.UserServiceImpl.*(..))")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"å‰ç½®é€šçŸ¥"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After("execution(* com.yqx.service.UserServiceImpl.*(..))")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"åç½®é€šçŸ¥"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around("execution(* com.yqx.service.UserServiceImpl.*(..))")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">around</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">        System.out.println(<span class="string">"ç¯ç»•å‰"</span>);</span><br><span class="line">        System.out.println(joinPoint.getSignature());</span><br><span class="line">        System.out.println(joinPoint.getArgs());</span><br><span class="line">        joinPoint.proceed();</span><br><span class="line">        System.out.println(<span class="string">"ç¯ç»•å"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">        https://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userService"</span> <span class="attr">class</span>=<span class="string">"com.yqx.service.UserServiceImpl"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.yqx.log"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ‰“å°å†…å®¹</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">ç¯ç»•å‰</span><br><span class="line"><span class="keyword">void</span> com.yqx.service.UserService.add()</span><br><span class="line">[Ljava.lang.Object;@6c6cb480</span><br><span class="line">å‰ç½®é€šçŸ¥</span><br><span class="line">æ·»åŠ äº†ä¸€æ¡æ•°æ®</span><br><span class="line">åç½®é€šçŸ¥</span><br><span class="line">ç¯ç»•å</span><br><span class="line">ç¯ç»•å‰</span><br><span class="line"><span class="keyword">void</span> com.yqx.service.UserService.query()</span><br><span class="line">[Ljava.lang.Object;@3c46e67a</span><br><span class="line">å‰ç½®é€šçŸ¥</span><br><span class="line">æŸ¥è¯¢äº†ä¸€æ¡æ•°æ®</span><br><span class="line">åç½®é€šçŸ¥</span><br><span class="line">ç¯ç»•å</span><br><span class="line"></span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="12ã€Mybatis-Spring"><a href="#12ã€Mybatis-Spring" class="headerlink" title="12ã€Mybatis-Spring"></a>12ã€Mybatis-Spring</h2><p>MyBatis-Spring ä¼šå¸®åŠ©ä½ å°† MyBatis ä»£ç æ— ç¼åœ°æ•´åˆåˆ° Spring ä¸­ã€‚å®ƒå°†å…è®¸ MyBatis å‚ä¸åˆ° Spring çš„äº‹åŠ¡ç®¡ç†ä¹‹ä¸­ï¼Œåˆ›å»ºæ˜ å°„å™¨ mapper å’Œ <code>SqlSession</code> å¹¶æ³¨å…¥åˆ° bean ä¸­ï¼Œä»¥åŠå°† Mybatis çš„å¼‚å¸¸è½¬æ¢ä¸º Spring çš„ <code>DataAccessException</code>ã€‚ æœ€ç»ˆï¼Œå¯ä»¥åšåˆ°åº”ç”¨ä»£ç ä¸ä¾èµ–äº MyBatisï¼ŒSpring æˆ– MyBatis-Springã€‚</p>
<p>MyBatis-Spring éœ€è¦ä»¥ä¸‹ç‰ˆæœ¬ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">MyBatis-Spring</th>
<th style="text-align:left">MyBatis</th>
<th style="text-align:left">Spring Framework</th>
<th style="text-align:left">Spring Batch</th>
<th style="text-align:left">Java</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>2.0</strong></td>
<td style="text-align:left">3.5+</td>
<td style="text-align:left">5.0+</td>
<td style="text-align:left">4.0+</td>
<td style="text-align:left">Java 8+</td>
</tr>
<tr>
<td style="text-align:left"><strong>1.3</strong></td>
<td style="text-align:left">3.4+</td>
<td style="text-align:left">3.2.2+</td>
<td style="text-align:left">2.1+</td>
<td style="text-align:left">Java 6+</td>
</tr>
</tbody>
</table>
</div>
<h4 id="12-1ã€æ•´åˆæ–¹å¼ä¸€"><a href="#12-1ã€æ•´åˆæ–¹å¼ä¸€" class="headerlink" title="12.1ã€æ•´åˆæ–¹å¼ä¸€"></a>12.1ã€æ•´åˆæ–¹å¼ä¸€</h4><p>æ‰€éœ€ä¾èµ–å¦‚ä¸‹</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mybatis--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mybatisä¸springæ•´åˆ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--springæ•°æ®åº“è¿æ¥--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mysql--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--spring--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note danger">
            <p>åŒå± org.springframework åŒ…ä¸‹çš„ä¸¤ä¸ªä¾èµ–å¿…é¡»ä¿è¯ç‰ˆæœ¬ä¸€è‡´ï¼ï¼ï¼ä¸ç„¶ä¼šæŠ¥é”™ï¼ï¼ï¼</p>
          </div>
<p>mybatis.xmlï¼Œå…·ä½“åŠŸèƒ½éƒ½æ•´åˆåˆ° <code>spring-mybatis.xml</code> ä¸‹ï¼Œè¿™é‡Œåªæ”¾åˆ«åä»¥åŠ setting è®¾ç½®ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.yqx.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>spring-mybatis.xmlï¼Œä¸€èˆ¬å­˜æ”¾å’Œ sqlSession æœ‰å…³çš„ beanï¼Œå†™å¥½ä¸€èˆ¬å°±ä¸ä¼šå†ä¿®æ”¹äº†ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è¿æ¥å‚æ•°--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">     <span class="comment">&lt;!--ä½¿ç”¨ SqlSessionFactoryBeanæ¥åˆ›å»º SqlSessionFactory--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åœ¨classpathåé¢çš„*å¿…ä¸å¯å°‘ï¼Œç¼ºå°‘*çš„è¯åé¢çš„é€šé…ç¬¦ä¸èµ·ä½œç”¨--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath*:com/yqx/mapper/*.xml"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--ç»‘å®šmybatisé…ç½®æ–‡ä»¶--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis-config.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">    <span class="comment">&lt;!--ä½¿ç”¨SqlSessionTemplateåˆ›å»ºsqlSessionå¯¹è±¡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sessionTemplate"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionTemplate"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>applicationContext.xmlï¼Œä½œä¸ºæ±‡æ€»çš„ xmlï¼ŒåŒæ—¶ç”¨äºå­˜æ”¾è‡ªå·±çš„ beanã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"spring-mybatis.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userMapper"</span> <span class="attr">class</span>=<span class="string">"com.yqx.mapper.UserMapperImpl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionTemplate"</span> <span class="attr">ref</span>=<span class="string">"sessionTemplate"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>å› ä¸ºè¦å°†å¯¹è±¡äº¤ç”± spring çš„ ioc å®¹å™¨æ‰˜ç®¡ï¼Œå› æ­¤éœ€è¦ç»™ mapper æ–‡ä»¶<code>æ·»åŠ å®ç°ç±»</code>ï¼Œæ³¨å…¥ SqlSessionTemplateã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yqx.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.SqlSessionTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserMapperImpl</span> <span class="keyword">implements</span> <span class="title">UserMapper</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> SqlSessionTemplate sqlSessionTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSqlSessionTemplate</span><span class="params">(SqlSessionTemplate sqlSessionTemplate)</span></span>{</span><br><span class="line">        <span class="keyword">this</span>.sqlSessionTemplate = sqlSessionTemplate;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getAllUsers</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> sqlSessionTemplate.getMapper(UserMapper.class).getAllUsers();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<div class="note danger">
            <p>mapper.xml å¦‚æœä¸æ”¾åœ¨ <code>resources</code> ä¸‹ï¼Œspring æ˜¯æ‰¾ä¸åˆ°çš„ï¼ï¼ï¼æŠ¥é”™<code>è­¦å‘Š: Property 'mapperLocations' was specified but matching resources are not found.</code> é™¤éæ˜¾å¼å®šä¹‰èµ„æºçš„ä½ç½®ï¼ï¼ï¼</p>
          </div>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="12-2ã€æ•´åˆæ–¹å¼äºŒ"><a href="#12-2ã€æ•´åˆæ–¹å¼äºŒ" class="headerlink" title="12.2ã€æ•´åˆæ–¹å¼äºŒ"></a>12.2ã€æ•´åˆæ–¹å¼äºŒ</h4><p>UserMapperImpl ç»§æ‰¿äº† <code>SqlSessionDaoSupport</code> å°±å¯ä»¥ç›´æ¥è·å–åˆ° sqlSessionã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yqx.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.support.SqlSessionDaoSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserMapperImpl</span> <span class="keyword">extends</span> <span class="title">SqlSessionDaoSupport</span> <span class="keyword">implements</span> <span class="title">UserMapper</span></span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getAllUsers</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> getSqlSessionTemplate().getMapper(UserMapper.class).getAllUsers();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å› æ­¤ spring-config.xml ä¸­å¹¶ä¸éœ€è¦æ‰˜ç®¡ sqlSessionï¼Œåªéœ€è¦åœ¨åˆ›å»º <code>UserMapperImpl</code> çš„ bean çš„æ—¶å€™æ³¨å…¥ sqlSessionFactory å³å¯ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/mybatis?useSSL=true<span class="symbol">&amp;amp;</span>useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=UTF-8"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"123456"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath*:com/yqx/mapper/*.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis-config.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>applicationContext</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"spring-mybatis.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userMapper"</span> <span class="attr">class</span>=<span class="string">"com.yqx.mapper.UserMapperImpl"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="13ã€å£°æ˜å¼äº‹åŠ¡"><a href="#13ã€å£°æ˜å¼äº‹åŠ¡" class="headerlink" title="13ã€å£°æ˜å¼äº‹åŠ¡"></a>13ã€å£°æ˜å¼äº‹åŠ¡</h2><h4 id="13-1ã€ACIDåŸåˆ™"><a href="#13-1ã€ACIDåŸåˆ™" class="headerlink" title="13.1ã€ACIDåŸåˆ™"></a>13.1ã€ACIDåŸåˆ™</h4><ul>
<li><strong>åŸå­æ€§ï¼ˆAtomicï¼‰</strong>ï¼šäº‹åŠ¡ä¸­çš„å„é¡¹æ“ä½œï¼Œè¦ä¹ˆéƒ½åšè¦ä¹ˆéƒ½ä¸åšï¼Œä»»ä½•ä¸€é¡¹æ“ä½œçš„å¤±è´¥éƒ½ä¼šå¯¼è‡´æ•´ä¸ªäº‹åŠ¡çš„å¤±è´¥ã€‚</li>
<li><strong>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰</strong>ï¼šäº‹åŠ¡å‰åæ•°æ®çš„å®Œæ•´æ€§å¿…é¡»ä¿æŒä¸€è‡´ã€‚</li>
<li><strong>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</strong>ï¼šäº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œæ•°æ®åº“ä¸ºæ¯ä¸€ä¸ªç”¨æˆ·å¼€å¯çš„äº‹åŠ¡ï¼Œä¸èƒ½è¢«å…¶ä»–äº‹ç‰©çš„æ“ä½œæ•°æ®æ‰€å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹ç‰©ä¹‹é—´è¦ç›¸äº’éš”ç¦»ã€‚</li>
<li><strong>æŒä¹…æ€§ï¼ˆDurabilityï¼‰</strong>ï¼šæŒä¹…æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤ï¼Œä»–å¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œæ¥ä¸‹æ¥å³ä½¿æ•°æ®åº“å‘ç”Ÿæ•…éšœä¹Ÿä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“ã€‚</li>
</ul>
<p>è¿™é‡Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ··åˆæ“ä½œ <code>mixedOperations</code>ï¼Œå…¶ä¸­ <code>deleteUserById</code> çš„ sql è¯­å¥æˆ‘æ•…æ„å†™é”™äº†ï¼Œè€ŒæŒ‰ç…§åŸå­æ€§æ¥è¯´ï¼Œè¿™ä¸ªäº‹åŠ¡åˆ é™¤å¤±è´¥äº†ï¼Œç†åº”å‰é¢çš„æ’å…¥æ•°æ®ä¹Ÿåº”è¯¥è¿›è¡Œå›æ»šã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserMapperImpl</span> <span class="keyword">extends</span> <span class="title">SqlSessionDaoSupport</span> <span class="keyword">implements</span> <span class="title">UserMapper</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mixedOperations</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"äº‹åŠ¡å¤„ç†å‰"</span>);</span><br><span class="line">        <span class="keyword">for</span> (User user : getAllUsers()) {</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        }</span><br><span class="line">        System.out.println(<span class="string">"======================================"</span>);</span><br><span class="line">        addUser(<span class="keyword">new</span> User(<span class="number">1</span>, <span class="string">"test"</span>, <span class="number">0</span>));</span><br><span class="line">        deleteUserById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(<span class="string">"äº‹åŠ¡å¤„ç†å"</span>);</span><br><span class="line">        <span class="keyword">for</span> (User user : getAllUsers()) {</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getAllUsers</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> getSqlSessionTemplate().getMapper(UserMapper.class).getAllUsers();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> getSqlSessionTemplate().getMapper(UserMapper.class).addUser(user);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteUserById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> getSqlSessionTemplate().getMapper(UserMapper.class).deleteUserById(id);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä½†å®é™…ä¸Šï¼Œæˆ‘çš„æ•°æ®è¡¨ä¸­çš„çš„ç¡®ç¡®æ’å…¥äº†è¿™ä¸ª test ç”¨æˆ·ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å£°æ˜å¼äº‹åŠ¡æ¥å¸®æˆ‘ä»¬ç®¡ç†ã€‚</p>
<p>å¯¼å…¥çº¦æŸ</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="string"><span class="tag">   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="string"><span class="tag">   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd"</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>é…ç½®å£°æ˜å¼äº‹åŠ¡</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®å£°æ˜å¼äº‹åŠ¡--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--ç»“åˆAOPå®ç°äº‹åŠ¡çš„ç»‡å…¥--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ä¸ºæ–¹æ³•é…ç½®äº‹åŠ¡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"*"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--é…ç½®äº‹åŠ¡åˆ‡å…¥--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"txPointCut"</span> <span class="attr">expression</span>=<span class="string">"execution(* com.yqx.mapper.*.*(..))"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"txPointCut"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
]]></content>
      <categories>
        <category>SSM</category>
      </categories>
  </entry>
  <entry>
    <title>Spring MVC</title>
    <url>/2021/11/08/SpringMVC/</url>
    <content><![CDATA[<h2 id="Spring-MVCå…¥é—¨"><a href="#Spring-MVCå…¥é—¨" class="headerlink" title="Spring MVCå…¥é—¨"></a>Spring MVCå…¥é—¨</h2><h4 id="1ã€Spring-MVC-æ‰§è¡Œæµç¨‹"><a href="#1ã€Spring-MVC-æ‰§è¡Œæµç¨‹" class="headerlink" title="1ã€Spring MVC æ‰§è¡Œæµç¨‹"></a>1ã€Spring MVC æ‰§è¡Œæµç¨‹</h4><p><img src="https://z3.ax1x.com/2021/11/08/IGfx1J.png" alt=""></p>
<p>ï¼ˆ1ï¼‰ç”¨æˆ·é€šè¿‡å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè¯·æ±‚ä¼šè¢« Spring MVC çš„å‰ç«¯æ§åˆ¶å™¨ DispatcherServlet æ‰€æ‹¦æˆªã€‚</p>
<p>ï¼ˆ2ï¼‰DispatcherServlet æ‹¦æˆªåˆ°è¯·æ±‚åï¼Œä¼šè°ƒç”¨ HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨ã€‚</p>
<p>ï¼ˆ3ï¼‰å¤„ç†å™¨æ˜ å°„å™¨æ ¹æ®è¯·æ±‚çš„ URL æ‰¾åˆ°å…·ä½“çš„å¤„ç†å™¨ï¼Œç”Ÿæˆå¤„ç†å™¨å¯¹è±¡åŠå¤„ç†å™¨æ‹¦æˆªå™¨ï¼ˆå¦‚æœæœ‰åˆ™ç”Ÿæˆï¼‰ä¸€å¹¶è¿”å›ç»™ DispatcherServletã€‚</p>
<p>ï¼ˆ4ï¼‰DispatcherServlet ä¼šé€šè¿‡è¿”å›ä¿¡æ¯é€‰æ‹©åˆé€‚çš„ HandlerAdapterï¼ˆå¤„ç†å™¨é€‚é…å™¨ï¼‰ã€‚</p>
<p>ï¼ˆ5ï¼‰HandlerAdapter ä¼šè°ƒç”¨å¹¶æ‰§è¡Œ Handlerï¼ˆå¤„ç†å™¨ï¼‰ï¼Œè¿™é‡Œçš„å¤„ç†å™¨æŒ‡çš„å°±æ˜¯ç¨‹åºä¸­ç¼–å†™çš„ Controller ç±»ï¼Œä¹Ÿè¢«ç§°ä¸ºåç«¯å¤„ç†å™¨ã€‚</p>
<p>ï¼ˆ6ï¼‰Controller æ‰§è¡Œå®Œæˆåï¼Œä¼šè¿”å›ä¸€ä¸ª ModelAndView å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­ä¼šåŒ…å«è§†å›¾åæˆ–åŒ…å«æ¨¡å‹å’Œè§†å›¾åã€‚</p>
<p>ï¼ˆ7ï¼‰HandlerAdapter å°† ModelAndView å¯¹è±¡è¿”å›ç»™ DispatcherServletã€‚</p>
<p>ï¼ˆ8ï¼‰DispatcherServlet ä¼šæ ¹æ® ModelAndView å¯¹è±¡é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ ViewResolverï¼ˆè§†å›¾è§£æå™¨ï¼‰ã€‚</p>
<p>ï¼ˆ9ï¼‰ViewResolver è§£æåï¼Œä¼šå‘ DispatcherServlet ä¸­è¿”å›å…·ä½“çš„ Viewï¼ˆè§†å›¾ï¼‰ã€‚</p>
<p>ï¼ˆ10ï¼‰DispatcherServlet å¯¹ View è¿›è¡Œæ¸²æŸ“ï¼ˆå³å°†æ¨¡å‹æ•°æ®å¡«å……è‡³è§†å›¾ä¸­ï¼‰ã€‚</p>
<p>ï¼ˆ11ï¼‰è§†å›¾æ¸²æŸ“ç»“æœä¼šè¿”å›ç»™å®¢æˆ·ç«¯æµè§ˆå™¨æ˜¾ç¤ºã€‚</p>
<span id="more"></span>
<h4 id="2ã€ç¬¬ä¸€ä¸ª-Spring-MVC-ç¨‹åº"><a href="#2ã€ç¬¬ä¸€ä¸ª-Spring-MVC-ç¨‹åº" class="headerlink" title="2ã€ç¬¬ä¸€ä¸ª Spring MVC ç¨‹åº"></a>2ã€ç¬¬ä¸€ä¸ª Spring MVC ç¨‹åº</h4><p>å¯¼å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>web.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é…ç½®DispatcherServlet--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å¯åŠ¨çº§åˆ«--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    /: åªåŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼Œä¸ä¼šå»åŒ¹é…jspé¡µé¢</span></span><br><span class="line"><span class="comment">    /*: åŒ¹é…æ‰€æœ‰çš„è¯·æ±‚ï¼ŒåŒ…æ‹¬jspé¡µé¢</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>classpath åªä¼šåˆ° class è·¯å¾„ä¸­æŸ¥æ‰¾æ–‡ä»¶ï¼›</p><p>classpath* ä¸ç»åŒ…å« class è·¯å¾„ï¼Œè¿˜åŒ…æ‹¬ jar æ–‡ä»¶ã€‚</p>
          </div>
<p>springmvc-servlet.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¤„ç†å™¨æ˜ å°„å™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¤„ç†å™¨é€‚é…å™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"internalResourceViewResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--å‰ç¼€--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åç¼€--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è‡ªå®šä¹‰å¤„ç†å™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"/hello"</span> <span class="attr">class</span>=<span class="string">"com.yqx.controller.HelloController"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>HelloController.java</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">implements</span> <span class="title">Controller</span> </span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        mv.setViewName(<span class="string">"test"</span>);</span><br><span class="line">        mv.addObject(<span class="string">"msg"</span>, <span class="string">"login"</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>test.jsp</p>
<figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    å‘é€äº†ä¸€æ¡msg:${msg}</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure>
<h4 id="3ã€æ³¨è§£å®ç°-Spring-MVC"><a href="#3ã€æ³¨è§£å®ç°-Spring-MVC" class="headerlink" title="3ã€æ³¨è§£å®ç° Spring MVC"></a>3ã€æ³¨è§£å®ç° Spring MVC</h4><p>springmvc-servlet.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--æ‰«æåŒ…--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.yqx.Controller"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--è®©Spring MVCä¸å¤„ç†é™æ€èµ„æº--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ”¯æŒmvcæ³¨è§£é©±åŠ¨,å¯ä»¥è‡ªåŠ¨å¸®æˆ‘ä»¬æ³¨å…¥å¤„ç†å™¨æ˜ å°„å™¨å’Œå¤„ç†å™¨é€‚é…å™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>Controller.java</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping("/test")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>{</span><br><span class="line">    <span class="meta">@RequestMapping("/1")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">(Model model)</span></span>{</span><br><span class="line">        model.addAttribute(<span class="string">"msg"</span>, <span class="string">"æ³¨è§£å®ç°"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"annotation"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>@Controller ä»£è¡¨ç»„ä»¶ï¼Œè¡¨ç¤ºè¢« spring å®¹å™¨æ‰˜ç®¡ï¼Œä½¿ç”¨ @Repositoryã€@Service äº¦æˆ–æ˜¯ @Component ä¹Ÿæ˜¯ä¸€æ ·çš„æ•ˆæœã€‚</p>
<p>@RequestMapping ç”¨æ¥æ˜ å°„è¯·æ±‚ï¼Œé€šè¿‡å®ƒæ¥æŒ‡å®šæ§åˆ¶å™¨å¯ä»¥å¤„ç†å“ªå„¿äº› URL è¯·æ±‚ï¼Œç›¸å½“äº Servlet åœ¨ web.xml ä¸­çš„é…ç½®ã€‚</p>
<h4 id="4ã€Restful-é£æ ¼"><a href="#4ã€Restful-é£æ ¼" class="headerlink" title="4ã€Restful é£æ ¼"></a>4ã€Restful é£æ ¼</h4><h6 id="4-1ã€ä»€ä¹ˆæ˜¯-Restful-é£æ ¼"><a href="#4-1ã€ä»€ä¹ˆæ˜¯-Restful-é£æ ¼" class="headerlink" title="4.1ã€ä»€ä¹ˆæ˜¯ Restful é£æ ¼"></a>4.1ã€ä»€ä¹ˆæ˜¯ Restful é£æ ¼</h6><p>Restful å°±æ˜¯è¦ä¸€ä¸ªèµ„æºå®šä½åŠèµ„æºæ“ä½œçš„é£æ ¼ã€‚æ—¢ä¸æ˜¯æ ‡å‡†ä¹Ÿä¸æ˜¯åè®®ï¼Œåªæ˜¯ä¸€ç§é£æ ¼ã€‚åŸºäºè¿™ä¸ªé£æ ¼è®¾è®¡çš„è½¯ä»¶ä¼šæ›´ç®€æ´ï¼Œæ›´æœ‰å±‚æ¬¡ï¼Œæ›´æ˜“äºå®ç°ç¼“å­˜ç­‰æœºåˆ¶ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ™®é€šçš„url--&gt;</span></span><br><span class="line">https://www.baidu.com?search=123</span><br><span class="line"><span class="comment">&lt;!--é‡‡ç”¨restfulé£æ ¼çš„url--&gt;</span></span><br><span class="line">https://www.baidu.com/123</span><br></pre></td></tr></tbody></table></figure>
<h6 id="4-2ã€è·¯å¾„å˜é‡"><a href="#4-2ã€è·¯å¾„å˜é‡" class="headerlink" title="4.2ã€è·¯å¾„å˜é‡"></a>4.2ã€è·¯å¾„å˜é‡</h6><p>åœ¨ Spring MVC ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ @PathVariable æ¥å®ç°ã€‚</p>
<p>MyController.java</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>{</span><br><span class="line">    <span class="meta">@RequestMapping("/restful/{a1}/{b1}")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test1</span><span class="params">(Model model, <span class="meta">@PathVariable("a1")</span> <span class="keyword">int</span> a,<span class="meta">@PathVariable("b1")</span> <span class="keyword">int</span> b)</span></span>{</span><br><span class="line">        model.addAttribute(<span class="string">"res"</span>, a-b);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"restful"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>@PathVariable ä¸­çš„å‚æ•°å€¼ä»£è¡¨äº† url ä¸­å¯¹åº”çš„å ä½ç¬¦åã€‚å¦‚æœä¸æŒ‡å®š@PathVariable çš„å‚æ•°å€¼ï¼Œé»˜è®¤å°±ä¼šä½¿ç”¨å‚æ•°åˆ—è¡¨çš„å‚æ•°åã€‚</p>
          </div>
<p>restful.jsp</p>
<figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    ${res}</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/11/09/INV6jf.png" alt=""></p>
<p>åŒæ—¶å®ƒå¯ä»¥æŒ‡å®šæäº¤çš„æ ¼å¼ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ä¸‹è¿°ä¸¤ç§æ–¹å¼ç­‰ä»·</span></span><br><span class="line"><span class="meta">@RequestMapping(value = "/restful/{a}/{b}", method = RequestMethod.POST)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test2</span><span class="params">(Model model, <span class="meta">@PathVariable</span> <span class="keyword">int</span> a,<span class="meta">@PathVariable</span> <span class="keyword">int</span> b)</span></span>{</span><br><span class="line">    model.addAttribute(<span class="string">"res"</span>, a * b);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"restful"</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@PostMapping("/restful/{a1}/{b1}")</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test3</span><span class="params">(Model model, <span class="meta">@PathVariable</span> <span class="keyword">int</span> a,<span class="meta">@PathVariable</span> <span class="keyword">int</span> b)</span></span>{</span><br><span class="line">    model.addAttribute(<span class="string">"res"</span>, a * b);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"restful"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="5ã€é‡å®šå‘å’Œè½¬å‘"><a href="#5ã€é‡å®šå‘å’Œè½¬å‘" class="headerlink" title="5ã€é‡å®šå‘å’Œè½¬å‘"></a>5ã€é‡å®šå‘å’Œè½¬å‘</h4><h6 id="5-1ã€è½¬å‘"><a href="#5-1ã€è½¬å‘" class="headerlink" title="5.1ã€è½¬å‘"></a>5.1ã€<strong>è½¬å‘</strong></h6><p><img src="https://z3.ax1x.com/2021/11/10/INLtSA.png" alt=""></p>
<p>æµè§ˆå™¨çš„è¯·æ±‚å‘é€ç»™ç»„ä»¶1ï¼Œç»„ä»¶1ç»è¿‡ä¸€äº›å¤„ç†ä¹‹åï¼Œå°† request å’Œ response å¯¹è±¡<code>ä¼ é€’</code>ç»™ç»„ä»¶2ï¼Œç”±ç»„ä»¶2ç»§ç»­å¤„ç†ï¼Œç„¶åè¾“å‡ºå“åº”ï¼ˆä¹Ÿå¯ä»¥ç»§ç»­å‘å…¶ä»–ç»„ä»¶â€œä¼ é€’â€ï¼‰ã€‚</p>
<p>åœ¨ä¸Šè¿°è½¬å‘çš„æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œåªæ¶‰åŠåˆ°<code>ä¸€æ¬¡</code>æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„â€œè¯·æ±‚-å“åº”â€ï¼Œè½¬å‘è¿‡ç¨‹ä¸­çš„ç»„ä»¶å…±äº«åŒä¸€ä¸ªè¯·æ±‚ï¼ˆrequestï¼‰å’Œå“åº”ï¼ˆreponseï¼‰å¯¹è±¡ã€‚</p>
<div class="note danger">
            <p>æŠ“é¥­åªèƒ½åœ¨åŒä¸€ä¸ªåº”ç”¨çš„ç»„ä»¶ä¹‹é—´è¿›è¡Œï¼Œä¸å¯ä»¥è½¬å‘ç»™å…¶ä»–åº”ç”¨çš„åœ°å€ã€‚</p>
          </div>
<h6 id="5-2ã€é‡å®šå‘"><a href="#5-2ã€é‡å®šå‘" class="headerlink" title="5.2ã€é‡å®šå‘"></a>5.2ã€<strong>é‡å®šå‘</strong></h6><p><img src="https://z3.ax1x.com/2021/11/10/INOfgA.png" alt=""></p>
<p>æµè§ˆå™¨å‘ç»„ä»¶1å‘é€è¯·æ±‚ä¿¡æ¯ï¼Œç»„ä»¶1å‘æµè§ˆå™¨å‘å›ä¸€ä¸ªé‡å®šå‘å“åº”ä¿¡æ¯ï¼Œè¯¥å“åº”ä¿¡æ¯ä¸åŒ…å«å…·ä½“çš„æ•°æ®å†…å®¹ï¼Œåªæ˜¯åœ¨å“åº”å¤´ä¿¡æ¯ä¸­åŒ…å«äº†<strong>éœ€è¦é‡å®šå‘åˆ°çš„åœ°å€ä¿¡æ¯</strong>ï¼ˆè¯¥åœ°å€å¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆçš„ URLï¼‰ã€‚è€Œæµè§ˆå™¨æ”¶åˆ°è¯¥é‡å®šå‘å“åº”åä¼šè‡ªåŠ¨åœ°å‘è¯¥å“åº”ä¿¡æ¯å¤´ä¸­æ‰€æŒ‡ç¤ºçš„åœ°å€å‘å‡ºè¯·æ±‚ã€‚</p>
<p>åœ¨ä¸Šè¿°é‡å®šå‘çš„æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¶‰åŠåˆ°<code>ä¸¤æ¬¡</code>æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„â€œè¯·æ±‚-å“åº”â€ã€‚</p>
<h6 id="5-3ã€åŒºåˆ«"><a href="#5-3ã€åŒºåˆ«" class="headerlink" title="5.3ã€åŒºåˆ«"></a>5.3ã€åŒºåˆ«</h6><ul>
<li>è½¬å‘æ˜¯æœåŠ¡å™¨å†…éƒ¨è·³è½¬ï¼Œæ•°æ®ä¸ä¼šä¸¢å¤±ï¼Œæµè§ˆå™¨åªæäº¤äº†ä¸€æ¬¡è¯·æ±‚ï¼Œé€Ÿåº¦è¾ƒå¿«ã€‚</li>
<li>é‡å®šå‘æ˜¯å®¢æˆ·ç«¯äºŒæ¬¡è·³è½¬ï¼Œæ•°æ®ä¼šä¸¢å¤±ï¼Œæµè§ˆå™¨æäº¤äº†äºŒæ¬¡è¯·æ±‚ï¼Œé€Ÿåº¦è¾ƒæ…¢ã€‚</li>
</ul>
<p>åšå¢åˆ æ”¹æŸ¥æ—¶æœ€å¥½ä½¿ç”¨é‡å®šå‘ï¼Œå¦åˆ™æ¯æ¬¡åˆ·æ–°é¡µé¢å°±ç›¸å½“äºåœ¨è¯·æ±‚ä¸€æ¬¡ï¼Œå¯èƒ½ä¼šåšé¢å¤–çš„æ“ä½œï¼Œå¯¼è‡´æ•°æ®é”™è¯¯ã€‚</p>
<div class="note success">
            <p>è½¬å‘æ˜¯æœåŠ¡å™¨å†…éƒ¨è·³è½¬ï¼Œå› æ­¤å¯ä»¥è®¿é—®åˆ° /WEB-INF ä¸‹çš„èµ„æºï¼›è€Œé‡å®šå‘æ˜¯å®¢æˆ·ç«¯è·³è½¬ï¼Œå› æ­¤æ— æ³•è®¿é—®åˆ° /WEB-INF ä¸‹çš„èµ„æºã€‚</p>
          </div>
<h6 id="5-3ã€ä»£ç å®ç°"><a href="#5-3ã€ä»£ç å®ç°" class="headerlink" title="5.3ã€ä»£ç å®ç°"></a>5.3ã€ä»£ç å®ç°</h6><p>Controller.java</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span></span>{</span><br><span class="line">    <span class="meta">@RequestMapping("/forward1")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test1</span><span class="params">(Model model)</span></span>{</span><br><span class="line">        model.addAttribute(<span class="string">"msg"</span>, <span class="string">"forward1"</span>);</span><br><span class="line">        <span class="comment">// é»˜è®¤ä½¿ç”¨è½¬å‘</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"test"</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping("/forward2")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test2</span><span class="params">(Model model)</span></span>{</span><br><span class="line">        model.addAttribute(<span class="string">"msg"</span>, <span class="string">"forward2"</span>);</span><br><span class="line">        <span class="comment">// æ˜¾å¼ä½¿ç”¨è½¬å‘</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"forward:/WEB-INF/jsp/test.jsp"</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping("/redirect")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test3</span><span class="params">(Model model)</span></span>{</span><br><span class="line">        model.addAttribute(<span class="string">"msg"</span>, <span class="string">"redirect"</span>);</span><br><span class="line">        <span class="comment">// æ˜¾å¼ä½¿ç”¨é‡å®šå‘</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"redirect:/index.jsp"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="6ã€è¯·æ±‚å‚æ•°"><a href="#6ã€è¯·æ±‚å‚æ•°" class="headerlink" title="6ã€è¯·æ±‚å‚æ•°"></a>6ã€è¯·æ±‚å‚æ•°</h4><h6 id="6-1ã€é€šè¿‡-url-ä¼ é€’ä¸€èˆ¬å‚æ•°"><a href="#6-1ã€é€šè¿‡-url-ä¼ é€’ä¸€èˆ¬å‚æ•°" class="headerlink" title="6.1ã€é€šè¿‡ url ä¼ é€’ä¸€èˆ¬å‚æ•°"></a><strong>6.1ã€é€šè¿‡ url ä¼ é€’ä¸€èˆ¬å‚æ•°</strong></h6><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParameterController</span> </span>{</span><br><span class="line">    <span class="comment">// urlå‚æ•°å¿…é¡»å’Œå‚æ•°åˆ—è¡¨å‚æ•°åä¸€è‡´,å¦åˆ™æ— æ³•è·å–</span></span><br><span class="line">    <span class="meta">@RequestMapping("parameter1")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test1</span><span class="params">(String name, Model model)</span></span>{</span><br><span class="line">        model.addAttribute(<span class="string">"name"</span>, name);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"parameter"</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// urlå‚æ•°å¿…é¡»å’Œ@RequestParamä¸­çš„å‚æ•°å€¼ä¸€è‡´,å¦åˆ™æ— æ³•è·å–ä¸”ä¼šæŠ¥400é”™è¯¯ï¼ï¼ï¼</span></span><br><span class="line">    <span class="meta">@RequestMapping("parameter2")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test2</span><span class="params">(<span class="meta">@RequestParam("username")</span> String name, Model model)</span></span>{</span><br><span class="line">        model.addAttribute(<span class="string">"name"</span>, name);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"parameter"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h6 id="6-2ã€é€šè¿‡-url-ä¼ é€’å®ä½“ç±»å‚æ•°"><a href="#6-2ã€é€šè¿‡-url-ä¼ é€’å®ä½“ç±»å‚æ•°" class="headerlink" title="6.2ã€é€šè¿‡ url ä¼ é€’å®ä½“ç±»å‚æ•°"></a><strong>6.2ã€é€šè¿‡ url ä¼ é€’å®ä½“ç±»å‚æ•°</strong></h6><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/parameter3")</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test3</span><span class="params">(User user123, Model model)</span></span>{</span><br><span class="line">    model.addAttribute(user123);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"user"</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>user.jsp</p>
<figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;!--å¦‚æœæ²¡æœ‰è®¾ç½®é”®å€¼å¯¹çš„é”®,é»˜è®¤ä½¿ç”¨å€¼çš„ç±»å‹é¦–å­—æ¯å°å†™ä½œä¸ºé”®--&gt;</span><br><span class="line">    å§“å:${user.name}, å¹´é¾„:${user.age}</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/11/10/IUExMV.png" alt=""></p>
<h4 id="7ã€ä¹±ç é—®é¢˜"><a href="#7ã€ä¹±ç é—®é¢˜" class="headerlink" title="7ã€ä¹±ç é—®é¢˜"></a>7ã€ä¹±ç é—®é¢˜</h4><p>æ— è®ºä»€ä¹ˆæ—¶å€™ï¼Œåªè¦æ˜¯ web åº”ç”¨æœåŠ¡é¡¹ç›®ï¼Œå°±ä¸å¯èƒ½é€ƒè„±ä¹±ç çš„ç—›è‹¦ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/10/IUerrV.gif" alt=""></p>
<p>ä¸è¿‡ä¸‡å¹¸çš„æ˜¯ï¼ŒSpring ä¸ºæˆ‘ä»¬æä¾›äº†ååˆ†å¼ºå¤§çš„è¿‡æ»¤å™¨ï¼Œå‡ ä¹å¯ä»¥è§£å†³æ‰€æœ‰çš„ä¹±ç é—®é¢˜ï¼Œåªéœ€è¦åœ¨ web.xml ä¸­é…ç½®å³å¯ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/11/10/IUnT4e.gif" alt=""></p>
<h4 id="8ã€JSON"><a href="#8ã€JSON" class="headerlink" title="8ã€JSON"></a>8ã€JSON</h4><p>åœ¨å‰åç«¯è¿›è¡Œæ•°æ®äº¤äº’æ—¶ï¼Œéœ€è¦ä¸€ç§ç»Ÿä¸€çš„æ•°æ®æ ¼å¼ï¼Œå¦åˆ™åç«¯ä¼ çš„æ•°æ®å‰ç«¯ä¸çŸ¥é“æ€ä¹ˆè§£æå°±æ¯«æ— æ„ä¹‰äº†ã€‚</p>
<h6 id="8-1ã€json-ä¼˜ç‚¹"><a href="#8-1ã€json-ä¼˜ç‚¹" class="headerlink" title="8.1ã€json ä¼˜ç‚¹"></a>8.1ã€<strong>json ä¼˜ç‚¹</strong></h6><ul>
<li><p>JSONç±»ä¼¼äºXMLï¼Œæ¯”XMLæ›´å°ã€æ›´å¿«ã€æ›´å®¹æ˜“è§£æã€‚ä½†åŒæ—¶XMLä¹Ÿæœ‰å®ƒçš„ä¸å¯æ›¿ä»£æ€§ï¼Œåº”æ ¹æ®ä½¿ç”¨åœºæ™¯è¿›è¡Œæ›´åˆé€‚çš„é€‰æ‹©ï¼›</p>
</li>
<li><p>JSONè¯­æ³•ç®€å•ï¼Œå¾ˆå®¹æ˜“ç†è§£ï¼Œå¹¶ä¸”å¯¹è±¡ä¿¡æ¯è‡ªæè¿°ï¼Œæ•°æ®ä¼ è¾“é‡å°ä¸å ç”¨å¸¦å®½ï¼›</p>
</li>
<li><p>JSONçš„å¯è¯»æ€§ã€å¯æ‰©å±•æ€§éƒ½éå¸¸å¥½ï¼Œç¼–ç éš¾åº¦ä¹Ÿæ¯”è¾ƒä½ï¼Œå³ä½¿ä¸å€ŸåŠ©å·¥å…·ä¹Ÿèƒ½å†™å‡ºæ¯”è¾ƒè§„èŒƒçš„JSON</p>
</li>
</ul>
<h6 id="8-2ã€Jackson"><a href="#8-2ã€Jackson" class="headerlink" title="8.2ã€Jackson"></a>8.2ã€Jackson</h6><p>å¯¼å…¥ä¾èµ–</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>Controller.java</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyController</span> </span>{</span><br><span class="line">    <span class="meta">@RequestMapping("/json1")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test1</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="comment">// è¿”å›æ™®é€šçš„å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§"</span>, <span class="string">"ç”·"</span>).toString();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping("/json2")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test2</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException </span>{</span><br><span class="line">        ObjectMapper objectMapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        User user = <span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§"</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">        String str = objectMapper.writeValueAsString(user);</span><br><span class="line">        <span class="comment">// è¿”å›jsonæ ¼å¼çš„å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping("/json3")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test3</span><span class="params">()</span> <span class="keyword">throws</span> JsonProcessingException </span>{</span><br><span class="line">        ObjectMapper objectMapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        User user1 = <span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§1"</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">        User user2 = <span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§2"</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">        User user3 = <span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§3"</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">        User user4 = <span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§4"</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">        User user5 = <span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§5"</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">        List&lt;User&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        list.add(user1);</span><br><span class="line">        list.add(user2);</span><br><span class="line">        list.add(user3);</span><br><span class="line">        list.add(user4);</span><br><span class="line">        list.add(user5);</span><br><span class="line">        String str = objectMapper.writeValueAsString(list);</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ç»“æœ</p>
<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">/json1</span><br><span class="line">User(name=ä½™åƒç¦§, sex=ç”·)</span><br><span class="line"></span><br><span class="line">/json2</span><br><span class="line">{"name":"ä½™åƒç¦§","sex":"ç”·"}</span><br><span class="line"></span><br><span class="line">/json3</span><br><span class="line">[{"name":"ä½™åƒç¦§1","sex":"ç”·"},{"name":"ä½™åƒç¦§2","sex":"ç”·"},{"name":"ä½™åƒç¦§3","sex":"ç”·"},{"name":"ä½™åƒç¦§4","sex":"ç”·"},{"name":"ä½™åƒç¦§5","sex":"ç”·"}]</span><br></pre></td></tr></tbody></table></figure>
<p>å¦‚æœå‡ºç°äº†ä¹±ç ï¼Œå¯ä»¥å¤åˆ¶ä¸‹è¿°ä»£ç ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--è§£å†³è¿”å›å­—ç¬¦ä¸²ä¹±ç é—®é¢˜--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.StringHttpMessageConverter"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.json.MappingJackson2HttpMessageConverter"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"objectMapper"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.json.Jackson2ObjectMapperFactoryBean"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"failOnEmptyBeans"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:message-converters</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>@RestController ä¿®é¥°åœ¨ç±»ä¸Šï¼Œè¡¨ç¤ºè¯¥ç±»ä¸ä¼šé€šè¿‡è§†å›¾è§£æå™¨ï¼Œå³è¯¥ç±»ä¸­æ‰€æœ‰è¯·æ±‚æ˜ å°„æ–¹æ³•æ‰€è¿”å›çš„å­—ç¬¦ä¸²å½“åšæ™®é€šçš„ String ç±»å‹æ¥å¤„ç†ï¼›</p><p>åŒç†è¿˜æœ‰ä¸€ä¸ª @RequestBody ä¿®é¥°åœ¨æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•ä¸ä¼šé€šè¿‡è§†å›¾è§£æå™¨ã€‚</p>
          </div>
<p><strong>å°è£…æˆå·¥å…·ç±»</strong></p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.JsonProcessingException;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JacksonUtil</span> </span>{</span><br><span class="line">    <span class="comment">// é‡è½½å¤ç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">objectToJson</span><span class="params">(Object object)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> objectToJson(object, <span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">objectToJson</span><span class="params">(Object object, String format)</span></span>{</span><br><span class="line">        ObjectMapper objectMapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯Dateå¯¹è±¡ï¼Œåˆ™ä¼šformat</span></span><br><span class="line">        objectMapper.setDateFormat(<span class="keyword">new</span> SimpleDateFormat(format));</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="keyword">return</span> objectMapper.writeValueAsString(object);</span><br><span class="line">        } <span class="keyword">catch</span> (JsonProcessingException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h6 id="8-3ã€Fastjson"><a href="#8-3ã€Fastjson" class="headerlink" title="8.3ã€Fastjson"></a>8.3ã€Fastjson</h6><p>ä½¿ç”¨è¾ƒ <strong>Jackson</strong> è€Œè¨€æ›´åŠ ä¾¿æ·ï¼ŒåŒæ—¶é»˜è®¤å°±ä½¿ç”¨ â€œyyyy-MM-dd HH:mm:ssâ€ æ¥æ ¼å¼åŒ–æ—¥æœŸã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/json5")</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test5</span><span class="params">()</span></span>{</span><br><span class="line">    User user1 = <span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§1"</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">    User user2 = <span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§2"</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">    User user3 = <span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§3"</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">    User user4 = <span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§4"</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">    User user5 = <span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§5"</span>, <span class="string">"ç”·"</span>);</span><br><span class="line">    List&lt;User&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    list.add(user1);</span><br><span class="line">    list.add(user2);</span><br><span class="line">    list.add(user3);</span><br><span class="line">    list.add(user4);</span><br><span class="line">    list.add(user5);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"*******Javaå¯¹è±¡è½¬JSONå­—ç¬¦ä¸²*******"</span>);</span><br><span class="line">    String str1 = JSON.toJSONString(list) ;</span><br><span class="line">    System.out.println( <span class="string">"SON.toSONString(list)==&gt;"</span>+str1);</span><br><span class="line">    String str2 = JSON.toJSONString(user1);</span><br><span class="line">    System.out.println( <span class="string">"JSON.toJSONString(user1)==&gt;"</span>+str2);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"\n******JSONå­—ç¬¦ä¸²è½¬Javaå¯¹è±¡*******"</span>);</span><br><span class="line">    User jp_user1=JSON.parseObject( str2,User.class);</span><br><span class="line">    System.out.println(<span class="string">"3SON.parseObject(str2,User.class)==&gt;"</span>+jp_user1);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"\n******Javaå¯¹è±¡è½¬JSONå¯¹è±¡******"</span>);</span><br><span class="line">    JSONObject jsonObject1 = (JSONObject)JSON.toJSON(user2);</span><br><span class="line">    System.out.println(<span class="string">"(JSONObject) JSON.to3SON(user2)z=&gt;"</span>+jsonObject1.getString(<span class="string">"name"</span>));</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"\n******JSONå¯¹è±¡è½¬Javaå¯¹è±¡******"</span>);</span><br><span class="line">    User to_java_user = JSON.toJavaObject(jsonObject1, User.class);</span><br><span class="line">    System.out.println(<span class="string">"JSON.toJavaObject(jsonObject1, User.class)==&gt;"</span> + to_java_user);</span><br><span class="line"></span><br><span class="line">    String str = JSON.toJSONString(list);</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">*******Javaå¯¹è±¡è½¬JSONå­—ç¬¦ä¸²*******</span><br><span class="line">SON.toSONString(list)==&gt;[{<span class="string">"name"</span>:<span class="string">"ä½™åƒç¦§1"</span>,<span class="string">"sex"</span>:<span class="string">"ç”·"</span>},{<span class="string">"name"</span>:<span class="string">"ä½™åƒç¦§2"</span>,<span class="string">"sex"</span>:<span class="string">"ç”·"</span>},{<span class="string">"name"</span>:<span class="string">"ä½™åƒç¦§3"</span>,<span class="string">"sex"</span>:<span class="string">"ç”·"</span>},{<span class="string">"name"</span>:<span class="string">"ä½™åƒç¦§4"</span>,<span class="string">"sex"</span>:<span class="string">"ç”·"</span>},{<span class="string">"name"</span>:<span class="string">"ä½™åƒç¦§5"</span>,<span class="string">"sex"</span>:<span class="string">"ç”·"</span>}]</span><br><span class="line">JSON.toJSONString(user1)==&gt;{<span class="string">"name"</span>:<span class="string">"ä½™åƒç¦§1"</span>,<span class="string">"sex"</span>:<span class="string">"ç”·"</span>}</span><br><span class="line"></span><br><span class="line">******JSONå­—ç¬¦ä¸²è½¬Javaå¯¹è±¡*******</span><br><span class="line">3SON.parseObject(str2,User.class)==&gt;User(name=ä½™åƒç¦§<span class="number">1</span>, sex=ç”·)</span><br><span class="line"></span><br><span class="line">******Javaå¯¹è±¡è½¬JSONå¯¹è±¡******</span><br><span class="line">(JSONObject) JSON.to3SON(user2)z=&gt;ä½™åƒç¦§<span class="number">2</span></span><br><span class="line"></span><br><span class="line">******JSONå¯¹è±¡è½¬Javaå¯¹è±¡******</span><br><span class="line">JSON.toJavaObject(jsonObject1, User.class)==&gt;User(name=ä½™åƒç¦§<span class="number">2</span>, sex=ç”·)</span><br></pre></td></tr></tbody></table></figure>
<h4 id="9ã€SSMæ•´åˆ"><a href="#9ã€SSMæ•´åˆ" class="headerlink" title="9ã€SSMæ•´åˆ"></a>9ã€SSMæ•´åˆ</h4><h6 id="9-1ã€é…ç½®æ–‡ä»¶ä»£ç -ä»¥åå¯ä»¥ç›´æ¥å¤åˆ¶æ‹¿æ¥ç”¨"><a href="#9-1ã€é…ç½®æ–‡ä»¶ä»£ç -ä»¥åå¯ä»¥ç›´æ¥å¤åˆ¶æ‹¿æ¥ç”¨" class="headerlink" title="9.1ã€é…ç½®æ–‡ä»¶ä»£ç (ä»¥åå¯ä»¥ç›´æ¥å¤åˆ¶æ‹¿æ¥ç”¨)"></a>9.1ã€é…ç½®æ–‡ä»¶ä»£ç (ä»¥åå¯ä»¥ç›´æ¥å¤åˆ¶æ‹¿æ¥ç”¨)</h6><ul>
<li><p>pom.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>SpringMVC<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>SpringMVC-05-SSM<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.18<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/resources<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">directory</span>&gt;</span>src/main/java<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.properties<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">include</span>&gt;</span>**/*.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>applicationContext.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.yqx.service"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"springmvc-servlet.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"spring.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>mybatis-config.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.yqx.pojo"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>spring.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF8"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è¯»å–é…ç½®æ–‡ä»¶--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:db.properties"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"${jdbc.driver}"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"${jdbc.url}"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"${jdbc.username}"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"${jdbc.password}"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis-config.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mapperLocations"</span> <span class="attr">value</span>=<span class="string">"classpath*:com/yqx/mapper/*.xml"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"sqlSessionTemplate"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionTemplate"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">ref</span>=<span class="string">"sqlSessionFactory"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>springmvc-servlet.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF8"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--é™æ€èµ„æºè¿‡æ»¤--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å¤„ç†å™¨æ˜ å°„å™¨åŠå¤„ç†å™¨é€‚é…å™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.yqx.controller"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"internalResourceViewResolver"</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>web.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</li>
</ul>
<h6 id="9-2-è¸©é›·"><a href="#9-2-è¸©é›·" class="headerlink" title="9.2 è¸©é›·"></a>9.2 è¸©é›·</h6><p>ï¼ˆ1ï¼‰db.properties </p>
<p>æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">org.apache.ibatis.exceptions.PersistenceException: </span><br><span class="line">Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is java.sql.SQLException: Access denied <span class="keyword">for</span> user <span class="string">'11499'</span>@<span class="string">'localhost'</span> (using password: YES)</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™æ˜¯å› ä¸º db.properties é‡Œé¢ username å¿…é¡»ç”¨ <code>jdbc.username</code>ã€‚å¦åˆ™ username å°±å˜æˆäº†ç³»ç»Ÿç®¡ç†å‘˜ï¼ˆâ€™11499â€™@â€™localhostâ€™ï¼‰çš„åå­—ã€‚</p>
<figure class="highlight properties"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># å…¶å®å¯ä»¥åªå°†usernameæ”¹æˆjdbc.username</span></span><br><span class="line"><span class="meta">jdbc.driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/ssmbuild?useSSL=true&amp;useUnicode=true&amp;characterEncoding=utf8</span></span><br><span class="line"><span class="meta">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">jdbc.password</span>=<span class="string">123456</span></span><br></pre></td></tr></tbody></table></figure>
<p>å°† spring.xml ä¸­ DataSource å±æ€§ä¹Ÿä¸€å¹¶ä¿®æ”¹ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"${jdbc.driver}"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"${jdbc.url}"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"${jdbc.username}"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"${jdbc.password}"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ2ï¼‰mapper.java</p>
<p>æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Type <span class="class"><span class="keyword">interface</span> <span class="title">com</span>.<span class="title">yqx</span>.<span class="title">mapper</span>.<span class="title">BookMapper</span> <span class="title">is</span> <span class="title">not</span> <span class="title">known</span> <span class="title">to</span> <span class="title">the</span> <span class="title">MapperRegistry</span>.</span></span><br></pre></td></tr></tbody></table></figure>
<p>è¿™ä¸ªé—®é¢˜æœ‰ç‚¹å‚»ï¼Œå› ä¸º mapper.xml æ–‡ä»¶æˆ‘éƒ½æ˜¯ç›´æ¥ä½¿ç”¨æ¨¡æ¿ï¼Œå¦‚ä¸‹ã€‚</p>
<p>ä½†è¿™ä¸ªé¡¹ç›®æ˜¯ BookMapperï¼Œç„¶åå°±å¿˜è®°æ”¹äº†â€¦</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.yqx.mapper.UserMapper"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ3ï¼‰web.xml</p>
<p>æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type <span class="string">'com.yqx.service.BookMapperImpl'</span> available: expected at least <span class="number">1</span> bean which qualifies as autowire candidate. Dependency annotations: {<span class="meta">@org</span>.springframework.beans.factory.annotation.Autowired(required=<span class="keyword">true</span>)}</span><br></pre></td></tr></tbody></table></figure>
<p>å› ä¸ºåœ¨ web.xml ä¸­åªå¼•å…¥äº† springmvc-servlet.xmlï¼Œå› æ­¤ä¸å¯èƒ½æœ‰ BookMapperImpl è¿™ä¸ª beanã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>åªéœ€è¦å¼•å…¥æ€»çš„é…ç½®æ–‡ä»¶ applicationContext.xml ï¼Œå†åœ¨ applicaitonContext.xml ä¸­å¼•å…¥æ‰€æœ‰å…¶ä»–æ–‡ä»¶å°±è¡Œã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"springmvc-servlet.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">"spring.xml"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ4ï¼‰post è¡¨å•æäº¤å‡ºç°ä¹±ç </p>
<p>æ·»åŠ è¿‡æ»¤å™¨</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆ5ï¼‰xml æ–‡ä»¶ç¼–ç </p>
<p>æŠ¥é”™ä¿¡æ¯</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">com.sun.org.apache.xerces.internal.impl.io.MalformedByteSequenceException: <span class="number">1</span>å­—èŠ‚çš„ UTF-<span class="number">8</span> åºåˆ—çš„å­—èŠ‚ <span class="number">1</span> æ— æ•ˆ</span><br></pre></td></tr></tbody></table></figure>
<p>è¯¥é”™è¯¯æ˜¯ç”±ä¸€äº›é…ç½®æ–‡ä»¶å¼•èµ·çš„ï¼šå¦‚applicationContext.xmlçš„ç¼–ç é—®é¢˜ç­‰ã€‚</p>
<p>å¯¹äºMaven é¡¹ç›®ï¼Œåœ¨é¡¹ç›®ä¾èµ–é…ç½®æ–‡ä»¶ pom.xml ä¸­åŠ å…¥æ„å»ºé¡¹ç›®ç¼–ç å±æ€§ï¼ˆæ³¨æ„é¡ºåºï¼‰ï¼š</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="10ã€Ajax"><a href="#10ã€Ajax" class="headerlink" title="10ã€Ajax"></a>10ã€Ajax</h4><h6 id="10-1ã€å¼‚æ­¥"><a href="#10-1ã€å¼‚æ­¥" class="headerlink" title="10.1ã€å¼‚æ­¥"></a>10.1ã€å¼‚æ­¥</h6><p>å¼‚æ­¥ï¼ˆAsynchronous, asyncï¼‰æ˜¯ä¸åŒæ­¥ï¼ˆSynchronous, syncï¼‰ç›¸å¯¹çš„æ¦‚å¿µã€‚</p>
<p>åœ¨æˆ‘ä»¬å­¦ä¹ çš„ä¼ ç»Ÿå•çº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œç¨‹åºçš„è¿è¡Œæ˜¯åŒæ­¥çš„ï¼ˆåŒæ­¥ä¸æ„å‘³ç€æ‰€æœ‰æ­¥éª¤åŒæ—¶è¿è¡Œï¼Œè€Œæ˜¯æŒ‡æ­¥éª¤åœ¨ä¸€ä¸ªæ§åˆ¶æµåºåˆ—ä¸­æŒ‰<code>é¡ºåº</code>æ‰§è¡Œï¼‰ã€‚è€Œå¼‚æ­¥çš„æ¦‚å¿µåˆ™æ˜¯ä¸ä¿è¯åŒæ­¥çš„æ¦‚å¿µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªå¼‚æ­¥è¿‡ç¨‹çš„æ‰§è¡Œå°†ä¸å†ä¸åŸæœ‰çš„åºåˆ—æœ‰é¡ºåºå…³ç³»ã€‚</p>
<p>ç®€å•æ¥ç†è§£å°±æ˜¯ï¼šåŒæ­¥æŒ‰ä½ çš„ä»£ç é¡ºåºæ‰§è¡Œï¼Œå¼‚æ­¥ä¸æŒ‰ç…§ä»£ç é¡ºåºæ‰§è¡Œï¼Œå¼‚æ­¥çš„æ‰§è¡Œæ•ˆç‡æ›´é«˜ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/13/IsFhIf.png" alt=""></p>
<h6 id="10-2ã€ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹"><a href="#10-2ã€ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹" class="headerlink" title="10.2ã€ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹"></a>10.2ã€ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹</h6><p>åœ¨å‰ç«¯ç¼–ç¨‹ä¸­ï¼ˆç”šè‡³åç«¯æœ‰æ—¶ä¹Ÿæ˜¯è¿™æ ·ï¼‰ï¼Œæˆ‘ä»¬åœ¨å¤„ç†ä¸€äº›ç®€çŸ­ã€å¿«é€Ÿçš„æ“ä½œæ—¶ï¼Œä¾‹å¦‚è®¡ç®— 1 + 1 çš„ç»“æœï¼Œå¾€å¾€åœ¨ä¸»çº¿ç¨‹ä¸­å°±å¯ä»¥å®Œæˆã€‚ä¸»çº¿ç¨‹ä½œä¸ºä¸€ä¸ªçº¿ç¨‹ï¼Œä¸èƒ½å¤ŸåŒæ—¶æ¥å—å¤šæ–¹é¢çš„è¯·æ±‚ã€‚æ‰€ä»¥ï¼Œå½“ä¸€ä¸ªäº‹ä»¶æ²¡æœ‰ç»“æŸæ—¶ï¼Œç•Œé¢å°†æ— æ³•å¤„ç†å…¶ä»–è¯·æ±‚ã€‚</p>
<p>ç°åœ¨æœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œå¦‚æœæˆ‘ä»¬è®¾ç½®å®ƒçš„ onclick äº‹ä»¶ä¸ºä¸€ä¸ªæ­»å¾ªç¯ï¼Œé‚£ä¹ˆå½“è¿™ä¸ªæŒ‰é’®æŒ‰ä¸‹ï¼Œæ•´ä¸ªç½‘é¡µå°†å¤±å»å“åº”ã€‚</p>
<p>ä¸ºäº†é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œæˆ‘ä»¬å¸¸å¸¸ç”¨å­çº¿ç¨‹æ¥å®Œæˆä¸€äº›å¯èƒ½æ¶ˆè€—æ—¶é—´è¶³å¤Ÿé•¿ä»¥è‡³äºè¢«ç”¨æˆ·å¯Ÿè§‰çš„äº‹æƒ…ï¼Œ<strong>æ¯”å¦‚è¯»å–ä¸€ä¸ªå¤§æ–‡ä»¶æˆ–è€…å‘å‡ºä¸€ä¸ªç½‘ç»œè¯·æ±‚</strong>ã€‚å› ä¸ºå­çº¿ç¨‹ç‹¬ç«‹äºä¸»çº¿ç¨‹ï¼Œæ‰€ä»¥å³ä½¿å‡ºç°é˜»å¡ä¹Ÿä¸ä¼šå½±å“ä¸»çº¿ç¨‹çš„è¿è¡Œã€‚ä½†æ˜¯å­çº¿ç¨‹æœ‰ä¸€ä¸ªå±€é™ï¼šä¸€æ—¦å‘å°„äº†ä»¥åå°±ä¼šä¸ä¸»çº¿ç¨‹å¤±å»åŒæ­¥ï¼Œæˆ‘ä»¬æ— æ³•ç¡®å®šå®ƒçš„ç»“æŸï¼Œå¦‚æœç»“æŸä¹‹åéœ€è¦å¤„ç†ä¸€äº›äº‹æƒ…ï¼Œæ¯”å¦‚å¤„ç†æ¥è‡ªæœåŠ¡å™¨çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•å°†å®ƒåˆå¹¶åˆ°ä¸»çº¿ç¨‹ä¸­å»çš„ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<strong>JavaScript ä¸­çš„å¼‚æ­¥æ“ä½œå‡½æ•°å¾€å¾€é€šè¿‡å›è°ƒå‡½æ•°æ¥å®ç°å¼‚æ­¥ä»»åŠ¡çš„ç»“æœå¤„ç†</strong>ã€‚</p>
<p><strong>å›è°ƒå‡½æ•°</strong></p>
<p>å›è°ƒå‡½æ•°å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œ<strong>å®ƒæ˜¯åœ¨æˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡çš„æ—¶å€™å°±å‘Šè¯‰å®ƒï¼šç­‰ä½ å®Œæˆäº†è¿™ä¸ªä»»åŠ¡ä¹‹åè¦å¹²ä»€ä¹ˆã€‚è¿™æ ·ä¸€æ¥ä¸»çº¿ç¨‹å‡ ä¹ä¸ç”¨å…³å¿ƒå¼‚æ­¥ä»»åŠ¡çš„çŠ¶æ€äº†ï¼Œä»–è‡ªå·±ä¼šå–„å§‹å–„ç»ˆã€‚</strong></p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).innerHTML=<span class="string">"RUNOOB!"</span>;</span><br><span class="line">}, <span class="number">3000</span>);</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™æ®µç¨‹åºä¸­çš„ setTimeout å°±æ˜¯ä¸€ä¸ªæ¶ˆè€—æ—¶é—´è¾ƒé•¿ï¼ˆ3 ç§’ï¼‰çš„è¿‡ç¨‹ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸ªå›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ¯«ç§’æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ‰§è¡Œä¹‹åä¼šäº§ç”Ÿä¸€ä¸ªå­çº¿ç¨‹ï¼Œå­çº¿ç¨‹ä¼šç­‰å¾… 3 ç§’ï¼Œç„¶åæ‰§è¡Œå›è°ƒå‡½æ•° â€œprintâ€ï¼Œåœ¨å‘½ä»¤è¡Œè¾“å‡º â€œRUNOOB!â€ã€‚</p>
<h6 id="10-3ã€åˆ©ç”¨-JQuery-å®ç°-Ajax"><a href="#10-3ã€åˆ©ç”¨-JQuery-å®ç°-Ajax" class="headerlink" title="10.3ã€åˆ©ç”¨ JQuery å®ç° Ajax"></a>10.3ã€åˆ©ç”¨ JQuery å®ç° Ajax</h6><p><strong>åˆä½“éªŒ</strong></p>
<p>jsp é¡µé¢ï¼Œ<code>js å†™åœ¨ html å‰ï¼Œè¦åŠ $(function())</code></p>
<figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;script src=<span class="string">"${pageContext.request.contextPath}/static/js/jquery.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">// éœ€è¦ç­‰é¡µé¢åŠ è½½å®Œæ‰èƒ½è·å–åˆ°é¡µé¢å…ƒç´ </span></span><br><span class="line">    $(function (){</span><br><span class="line">        $(<span class="string">"#btn"</span>).click(function (){</span><br><span class="line">            $.post(<span class="string">"/ajax1"</span>, function (data){</span><br><span class="line">                let html = <span class="string">"&lt;table&gt;&lt;thead&gt;&lt;td&gt;å§“å&lt;/td&gt;&lt;td&gt;å¹´é¾„&lt;/td&gt;&lt;/thead&gt;&lt;tbody&gt;"</span>;</span><br><span class="line">                <span class="keyword">for</span>(let i=<span class="number">0</span>;i&lt;data.length;i++) {</span><br><span class="line">                    html += <span class="string">"&lt;tr&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;td&gt;"</span> + data[i].name + <span class="string">"&lt;/td&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;td&gt;"</span> + data[i].age + <span class="string">"&lt;/td&gt;"</span> +</span><br><span class="line">                        <span class="string">"&lt;/tr&gt;"</span></span><br><span class="line">                }</span><br><span class="line">                html += <span class="string">"&lt;/tbody&gt;&lt;/table&gt;"</span></span><br><span class="line">                console.log(html)</span><br><span class="line">                $(<span class="string">"#content"</span>).html(html)</span><br><span class="line">            })</span><br><span class="line">        })</span><br><span class="line">    })</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;button id=<span class="string">"btn"</span>&gt;æŸ¥è¯¢&lt;/button&gt;</span><br><span class="line">    &lt;div id=<span class="string">"content"</span>&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>controller.java</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AjaxController</span> </span>{</span><br><span class="line">    <span class="meta">@RequestMapping("/ajax1")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">test1</span><span class="params">()</span></span>{</span><br><span class="line">        List&lt;User&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        list.add(<span class="keyword">new</span> User(<span class="string">"ä½™åƒç¦§"</span>, <span class="number">1</span>));</span><br><span class="line">        list.add(<span class="keyword">new</span> User(<span class="string">"ç´«æ¢¦æ²é¦™"</span>, <span class="number">2</span>));</span><br><span class="line">        list.add(<span class="keyword">new</span> User(<span class="string">"è‡ªæ€ä¹‹ç‹"</span>, <span class="number">3</span>));</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<div class="note danger">
            <p>No converter found for return value of type: class java.util.ArrayList æ˜¯å› ä¸ºæ— æ³•å°†è¿”å›çš„å¯¹è±¡è½¬æ¢ä¸º Json è¾“å‡ºåˆ°ç½‘é¡µä¸Šï¼Œåªéœ€å¯¼å…¥ Jackson æˆ– FastJson çš„ jar åŒ…å°±è¡Œ</p>
          </div>
<p><strong>éªŒè¯ç”¨æˆ·åå¯†ç </strong></p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping("/ajax2")</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test2</span><span class="params">(String name, String pwd)</span></span>{</span><br><span class="line">    String msg=<span class="string">""</span>;</span><br><span class="line">    <span class="keyword">if</span>(name!=<span class="keyword">null</span>){</span><br><span class="line">        <span class="keyword">if</span> (name.equals(<span class="string">"yqx"</span>)){</span><br><span class="line">            msg=<span class="string">"ok"</span>;</span><br><span class="line">        }<span class="keyword">else</span> {</span><br><span class="line">            msg=<span class="string">"ç”¨æˆ·åè¾“å…¥é”™è¯¯"</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span>(pwd!=<span class="keyword">null</span>){</span><br><span class="line">        <span class="keyword">if</span> (pwd.equals(<span class="string">"123"</span>)){</span><br><span class="line">            msg=<span class="string">"ok"</span>;</span><br><span class="line">        }<span class="keyword">else</span> {</span><br><span class="line">            msg=<span class="string">"å¯†ç è¾“å…¥é”™è¯¯"</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> msg;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è¿”å›æ—¶å‡ºç°å­—ç¬¦ä¸²ä¹±ç è¯·æŸ¥çœ‹<a href="#8.2ã€Jackson">8.2</a></p>
<p>jsp é¡µé¢</p>
<figure class="highlight jsp"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">"text/html;charset=UTF-8"</span> language=<span class="string">"java"</span> %&gt;</span><br><span class="line">&lt;script src=<span class="string">"${pageContext.request.contextPath}/static/js/jquery.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="function">function <span class="title">name_blur</span><span class="params">()</span></span>{</span><br><span class="line">        $.post(<span class="string">"/ajax2"</span>, {<span class="string">"name"</span>: $(<span class="string">"#name"</span>).val()}, function (data){</span><br><span class="line">            <span class="keyword">if</span>(data == <span class="string">"ok"</span>){</span><br><span class="line">                $(<span class="string">"#span1"</span>).text(data).css(<span class="string">"color"</span>, <span class="string">"green"</span>);</span><br><span class="line">            }<span class="keyword">else</span>{</span><br><span class="line">                $(<span class="string">"#span1"</span>).text(data).css(<span class="string">"color"</span>, <span class="string">"red"</span>);</span><br><span class="line">            }</span><br><span class="line">        })</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function">function <span class="title">pwd_blur</span><span class="params">()</span></span>{</span><br><span class="line">        $.post(<span class="string">"/ajax2"</span>, {<span class="string">"pwd"</span>: $(<span class="string">"#pwd"</span>).val()}, function (data){</span><br><span class="line">            <span class="keyword">if</span>(data == <span class="string">"ok"</span>){</span><br><span class="line">                $(<span class="string">"#span2"</span>).text(data).css(<span class="string">"color"</span>, <span class="string">"green"</span>);</span><br><span class="line">            }<span class="keyword">else</span>{</span><br><span class="line">                $(<span class="string">"#span2"</span>).text(data).css(<span class="string">"color"</span>, <span class="string">"red"</span>);</span><br><span class="line">            }</span><br><span class="line">        })</span><br><span class="line">    }</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form&gt;</span><br><span class="line">        ç”¨æˆ·å:&lt;input id=<span class="string">"name"</span> type=<span class="string">"text"</span> onblur=<span class="string">"name_blur()"</span>&gt;</span><br><span class="line">        &lt;span id=<span class="string">"span1"</span>&gt;&lt;/span&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        å¯†ç :&lt;input id=<span class="string">"pwd"</span> type=<span class="string">"password"</span> onblur=<span class="string">"pwd_blur()"</span>&gt;</span><br><span class="line">        &lt;span id=<span class="string">"span2"</span>&gt;&lt;/span&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure>
<div class="note danger">
            <p>script æ ‡ç­¾æ²¡æœ‰è‡ªé—­åˆï¼ï¼ï¼å¿…é¡»å†™å…¨ï¼ï¼ï¼</p>
          </div>
<h4 id="11ã€æ‹¦æˆªå™¨"><a href="#11ã€æ‹¦æˆªå™¨" class="headerlink" title="11ã€æ‹¦æˆªå™¨"></a>11ã€æ‹¦æˆªå™¨</h4><p>åœ¨ç³»ç»Ÿä¸­ï¼Œç»å¸¸éœ€è¦åœ¨å¤„ç†ç”¨æˆ·è¯·æ±‚ä¹‹å‰å’Œä¹‹åæ‰§è¡Œä¸€äº›è¡Œä¸ºï¼Œä¾‹å¦‚<strong>æ£€æµ‹ç”¨æˆ·çš„æƒé™ï¼Œæˆ–è€…å°†è¯·æ±‚çš„ä¿¡æ¯è®°å½•åˆ°æ—¥å¿—ä¸­</strong>ï¼Œå³å¹³æ—¶æ‰€è¯´çš„â€œ<code>æƒé™æ£€æµ‹</code>â€åŠâ€œ<code>æ—¥å¿—è®°å½•</code>â€ã€‚å½“ç„¶ä¸ä»…ä»…è¿™äº›ï¼Œæ‰€ä»¥éœ€è¦ä¸€ç§æœºåˆ¶ï¼Œ<strong>æ‹¦æˆªç”¨æˆ·çš„è¯·æ±‚ï¼Œåœ¨è¯·æ±‚çš„å‰åæ·»åŠ å¤„ç†é€»è¾‘</strong>ã€‚</p>
<p>Spring MVC æä¾›äº† Interceptor æ‹¦æˆªå™¨æœºåˆ¶ï¼Œç”¨äºè¯·æ±‚çš„é¢„å¤„ç†å’Œåå¤„ç†ã€‚</p>
<p>MyInterceptor.javaï¼Œéœ€å®ç° <code>HandlerInterceptor</code> æ¥å£ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request,</span></span></span><br><span class="line"><span class="params"><span class="function">            HttpServletResponse response, Object handler, Exception ex)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        System.out.println(<span class="string">"afterCompletionæ–¹æ³•åœ¨æ§åˆ¶å™¨çš„å¤„ç†è¯·æ±‚æ–¹æ³•æ‰§è¡Œå®Œæˆåæ‰§è¡Œï¼Œå³è§†å›¾æ¸²æŸ“ç»“æŸä¹‹åæ‰§è¡Œ"</span>);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request,</span></span></span><br><span class="line"><span class="params"><span class="function">            HttpServletResponse response, Object handler,</span></span></span><br><span class="line"><span class="params"><span class="function">            ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        System.out.println(<span class="string">"postHandleæ–¹æ³•åœ¨æ§åˆ¶å™¨çš„å¤„ç†è¯·æ±‚æ–¹æ³•è°ƒç”¨ä¹‹åï¼Œè§£æè§†å›¾ä¹‹å‰æ‰§è¡Œ"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request,</span></span></span><br><span class="line"><span class="params"><span class="function">            HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        System.out.println(<span class="string">"preHandleæ–¹æ³•åœ¨æ§åˆ¶å™¨çš„å¤„ç†è¯·æ±‚æ–¹æ³•è°ƒç”¨ä¹‹å‰æ‰§è¡Œ"</span>);</span><br><span class="line">        HttpSession session = request.getSession();</span><br><span class="line">        <span class="keyword">if</span> (session.getAttribute(<span class="string">"name"</span>) == <span class="keyword">null</span>){</span><br><span class="line">            response.sendRedirect(<span class="string">"/toLogin"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>preHandle( )ï¼šè¯¥æ–¹æ³•åœ¨æ§åˆ¶å™¨çš„å¤„ç†è¯·æ±‚æ–¹æ³•å‰æ‰§è¡Œï¼Œå…¶è¿”å›å€¼è¡¨ç¤ºæ˜¯å¦ä¸­æ–­åç»­æ“ä½œï¼Œè¿”å› true è¡¨ç¤º<code>ç»§ç»­</code>å‘ä¸‹æ‰§è¡Œï¼Œè¿”å› false è¡¨ç¤º<code>ä¸­æ–­</code>åç»­æ“ä½œã€‚</li>
<li>postHandle( )ï¼šè¯¥æ–¹æ³•åœ¨æ§åˆ¶å™¨çš„å¤„ç†è¯·æ±‚æ–¹æ³•è°ƒç”¨ä¹‹åã€è§£æè§†å›¾ä¹‹å‰æ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡æ­¤æ–¹æ³•å¯¹è¯·æ±‚åŸŸä¸­çš„æ¨¡å‹å’Œè§†å›¾åšè¿›ä¸€æ­¥çš„ä¿®æ”¹ã€‚</li>
<li>afterCompletion( )ï¼šè¯¥æ–¹æ³•åœ¨æ§åˆ¶å™¨çš„å¤„ç†è¯·æ±‚æ–¹æ³•æ‰§è¡Œå®Œæˆåæ‰§è¡Œï¼Œå³è§†å›¾æ¸²æŸ“ç»“æŸåæ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡æ­¤æ–¹æ³•å®ç°ä¸€äº›èµ„æºæ¸…ç†ã€è®°å½•æ—¥å¿—ä¿¡æ¯ç­‰å·¥ä½œã€‚</li>
</ul>
<p>å†™å®Œæ‹¦æˆªå™¨éœ€åœ¨Spring MVC çš„é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--å…³äºæ‹¦æˆªå™¨çš„é…ç½®--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--/** åŒ…æ‹¬è·¯å¾„åŠå…¶å­è·¯å¾„--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--/admin/* æ‹¦æˆªçš„æ˜¯/admin/addç­‰ç­‰è¿™ç§ , /admin/add/userä¸ä¼šè¢«æ‹¦æˆª--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--/admin/** æ‹¦æˆªçš„æ˜¯/admin/ä¸‹çš„æ‰€æœ‰--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ­¤å¤„æˆ‘ä»¬åªéœ€è¦åˆ¤æ–­è¿›å…¥é¦–é¡µæ—¶æœ‰æ²¡æœ‰ç™»å½•,å› æ­¤åªéœ€æ‹¦æˆª/toMainè¯·æ±‚--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/toMain"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--beané…ç½®çš„å°±æ˜¯æ‹¦æˆªå™¨--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.yqx.interceptor.MyInterceptor"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
]]></content>
      <categories>
        <category>SSM</category>
      </categories>
  </entry>
  <entry>
    <title>Linux</title>
    <url>/2021/11/21/Linux/</url>
    <content><![CDATA[<h1 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a>ä¸€ã€ç®€ä»‹</h1><p>Linux å†…æ ¸æœ€åˆåªæ˜¯ç”±èŠ¬å…°äººæ—çº³æ–¯Â·æ‰˜ç“¦å…¹ï¼ˆLinus Torvaldsï¼‰åœ¨èµ«å°”è¾›åŸºå¤§å­¦ä¸Šå­¦æ—¶å‡ºäºä¸ªäººçˆ±å¥½è€Œç¼–å†™çš„ã€‚</p>
<p>Linux æ˜¯ä¸€å¥—å…è´¹ä½¿ç”¨å’Œè‡ªç”±ä¼ æ’­çš„ç±» Unix æ“ä½œç³»ç»Ÿï¼Œæ˜¯ä¸€ä¸ªåŸºäº POSIX å’Œ UNIX çš„å¤šç”¨æˆ·ã€å¤šä»»åŠ¡ã€æ”¯æŒå¤šçº¿ç¨‹å’Œå¤š CPU çš„æ“ä½œç³»ç»Ÿã€‚</p>
<p>Linux èƒ½è¿è¡Œä¸»è¦çš„ UNIX å·¥å…·è½¯ä»¶ã€åº”ç”¨ç¨‹åºå’Œç½‘ç»œåè®®ã€‚å®ƒæ”¯æŒ 32 ä½å’Œ 64 ä½ç¡¬ä»¶ã€‚Linux ç»§æ‰¿äº† Unix ä»¥ç½‘ç»œä¸ºæ ¸å¿ƒçš„è®¾è®¡æ€æƒ³ï¼Œæ˜¯ä¸€ä¸ªæ€§èƒ½ç¨³å®šçš„å¤šç”¨æˆ·ç½‘ç»œæ“ä½œç³»ç»Ÿã€‚</p>
<p><strong>Linux çš„å‘è¡Œç‰ˆ</strong></p>
<p>Linux çš„å‘è¡Œç‰ˆè¯´ç®€å•ç‚¹å°±æ˜¯å°† Linux å†…æ ¸ä¸åº”ç”¨è½¯ä»¶åšä¸€ä¸ªæ‰“åŒ…ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/21/IjJRPA.png" alt=""></p>
<p>ç›®å‰å¸‚é¢ä¸Šè¾ƒçŸ¥åçš„å‘è¡Œç‰ˆæœ‰ï¼šUbuntuã€RedHatã€CentOSã€Debianã€Fedoraã€SuSEã€OpenSUSEã€Arch Linuxã€SolusOS ç­‰ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/21/IjJ5Kf.png" alt=""></p>
<span id="more"></span>
<h1 id="äºŒã€Linux-ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹"><a href="#äºŒã€Linux-ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹" class="headerlink" title="äºŒã€Linux ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹"></a>äºŒã€Linux ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹</h1><p>linuxå¯åŠ¨æ—¶æˆ‘ä»¬ä¼šçœ‹åˆ°è®¸å¤šå¯åŠ¨ä¿¡æ¯ã€‚</p>
<p>Linuxç³»ç»Ÿçš„å¯åŠ¨è¿‡ç¨‹å¹¶ä¸æ˜¯å¤§å®¶æƒ³è±¡ä¸­çš„é‚£ä¹ˆå¤æ‚ï¼Œå…¶è¿‡ç¨‹å¯ä»¥åˆ†ä¸º5ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li>å†…æ ¸çš„å¼•å¯¼</li>
<li>è¿è¡Œ init</li>
<li>ç³»ç»Ÿåˆå§‹åŒ–</li>
<li>å»ºç«‹ç»ˆç«¯</li>
<li>ç”¨æˆ·ç™»å½•ç³»ç»Ÿ</li>
</ul>
<p><strong><font size="5px">å†…æ ¸å¼•å¯¼</font></strong></p>
<p>å½“è®¡ç®—æœºæ‰“å¼€ç”µæºåï¼Œé¦–å…ˆæ˜¯BIOSå¼€æœºè‡ªæ£€ï¼ŒæŒ‰ç…§BIOSä¸­è®¾ç½®çš„å¯åŠ¨è®¾å¤‡ï¼ˆé€šå¸¸æ˜¯ç¡¬ç›˜ï¼‰æ¥å¯åŠ¨ã€‚</p>
<p>æ“ä½œç³»ç»Ÿæ¥ç®¡ç¡¬ä»¶ä»¥åï¼Œé¦–å…ˆè¯»å…¥ /boot ç›®å½•ä¸‹çš„å†…æ ¸æ–‡ä»¶ã€‚</p>
<p><strong><font size="5px">è¿è¡Œ init</font></strong></p>
<p>init è¿›ç¨‹æ˜¯ç³»ç»Ÿæ‰€æœ‰è¿›ç¨‹çš„èµ·ç‚¹ï¼Œä½ å¯ä»¥æŠŠå®ƒæ¯”æ‹Ÿæˆç³»ç»Ÿæ‰€æœ‰è¿›ç¨‹çš„è€ç¥–å®—ï¼Œæ²¡æœ‰è¿™ä¸ªè¿›ç¨‹ï¼Œç³»ç»Ÿä¸­ä»»ä½•è¿›ç¨‹éƒ½ä¸ä¼šå¯åŠ¨ã€‚</p>
<p>init ç¨‹åºé¦–å…ˆæ˜¯éœ€è¦è¯»å–é…ç½®æ–‡ä»¶  /usr/lib/systemd/systemã€ /etc/systemd/systemã€‚</p>
<p><strong><font size="5px">è¿è¡Œçº§åˆ«</font></strong></p>
<p>è®¸å¤šç¨‹åºéœ€è¦å¼€æœºå¯åŠ¨ã€‚å®ƒä»¬åœ¨Windowså«åšâ€æœåŠ¡â€ï¼ˆserviceï¼‰ï¼Œåœ¨Linuxå°±å«åšâ€å®ˆæŠ¤è¿›ç¨‹â€ï¼ˆdaemonï¼‰ã€‚</p>
<p>initè¿›ç¨‹çš„ä¸€å¤§ä»»åŠ¡ï¼Œå°±æ˜¯å»è¿è¡Œè¿™äº›å¼€æœºå¯åŠ¨çš„ç¨‹åºã€‚</p>
<p>ä½†æ˜¯ï¼Œä¸åŒçš„åœºåˆéœ€è¦å¯åŠ¨ä¸åŒçš„ç¨‹åºï¼Œæ¯”å¦‚ç”¨ä½œæœåŠ¡å™¨æ—¶ï¼Œéœ€è¦å¯åŠ¨Apacheï¼Œç”¨ä½œæ¡Œé¢å°±ä¸éœ€è¦ã€‚</p>
<p>Linuxå…è®¸ä¸ºä¸åŒçš„åœºåˆï¼Œåˆ†é…ä¸åŒçš„å¼€æœºå¯åŠ¨ç¨‹åºï¼Œè¿™å°±å«åšâ€è¿è¡Œçº§åˆ«â€ï¼ˆrunlevelï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯åŠ¨æ—¶æ ¹æ®â€è¿è¡Œçº§åˆ«â€ï¼Œç¡®å®šè¦è¿è¡Œå“ªäº›ç¨‹åºã€‚</p>
<p>Linuxç³»ç»Ÿæœ‰7ä¸ªè¿è¡Œçº§åˆ«(runlevel)ï¼š</p>
<ul>
<li>è¿è¡Œçº§åˆ«0ï¼šç³»ç»ŸåœæœºçŠ¶æ€ï¼Œç³»ç»Ÿé»˜è®¤è¿è¡Œçº§åˆ«ä¸èƒ½è®¾ä¸º0ï¼Œå¦åˆ™ä¸èƒ½æ­£å¸¸å¯åŠ¨</li>
<li>è¿è¡Œçº§åˆ«1ï¼šå•ç”¨æˆ·å·¥ä½œçŠ¶æ€ï¼Œrootæƒé™ï¼Œç”¨äºç³»ç»Ÿç»´æŠ¤ï¼Œç¦æ­¢è¿œç¨‹ç™»é™†</li>
<li>è¿è¡Œçº§åˆ«2ï¼šå¤šç”¨æˆ·çŠ¶æ€(æ²¡æœ‰NFS)</li>
<li>è¿è¡Œçº§åˆ«3ï¼šå®Œå…¨çš„å¤šç”¨æˆ·çŠ¶æ€(æœ‰NFS)ï¼Œç™»é™†åè¿›å…¥æ§åˆ¶å°å‘½ä»¤è¡Œæ¨¡å¼</li>
<li>è¿è¡Œçº§åˆ«4ï¼šç³»ç»Ÿæœªä½¿ç”¨ï¼Œä¿ç•™</li>
<li>è¿è¡Œçº§åˆ«5ï¼šX11æ§åˆ¶å°ï¼Œç™»é™†åè¿›å…¥å›¾å½¢GUIæ¨¡å¼</li>
<li>è¿è¡Œçº§åˆ«6ï¼šç³»ç»Ÿæ­£å¸¸å…³é—­å¹¶é‡å¯ï¼Œé»˜è®¤è¿è¡Œçº§åˆ«ä¸èƒ½è®¾ä¸º6ï¼Œå¦åˆ™ä¸èƒ½æ­£å¸¸å¯åŠ¨</li>
</ul>
<p><strong><font size="5px">ç³»ç»Ÿåˆå§‹åŒ–</font></strong></p>
<p>åœ¨initçš„é…ç½®æ–‡ä»¶ä¸­æœ‰è¿™ä¹ˆä¸€è¡Œï¼š si::sysinit:/etc/rc.d/rc.sysinitã€€å®ƒè°ƒç”¨æ‰§è¡Œäº†/etc/rc.d/rc.sysinitï¼Œè€Œrc.sysinitæ˜¯ä¸€ä¸ªbash shellçš„è„šæœ¬ï¼Œå®ƒä¸»è¦æ˜¯å®Œæˆä¸€äº›ç³»ç»Ÿåˆå§‹åŒ–çš„å·¥ä½œï¼Œrc.sysinitæ˜¯æ¯ä¸€ä¸ªè¿è¡Œçº§åˆ«éƒ½è¦é¦–å…ˆè¿è¡Œçš„é‡è¦è„šæœ¬ã€‚</p>
<p>å®ƒä¸»è¦å®Œæˆçš„å·¥ä½œæœ‰ï¼šæ¿€æ´»äº¤æ¢åˆ†åŒºï¼Œæ£€æŸ¥ç£ç›˜ï¼ŒåŠ è½½ç¡¬ä»¶æ¨¡å—ä»¥åŠå…¶å®ƒä¸€äº›éœ€è¦ä¼˜å…ˆæ‰§è¡Œä»»åŠ¡ã€‚</p>
<p><strong><font size="5px">å»ºç«‹ç»ˆç«¯</font></strong></p>
<p>rcæ‰§è¡Œå®Œæ¯•åï¼Œè¿”å›initã€‚è¿™æ—¶åŸºæœ¬ç³»ç»Ÿç¯å¢ƒå·²ç»è®¾ç½®å¥½äº†ï¼Œå„ç§å®ˆæŠ¤è¿›ç¨‹ä¹Ÿå·²ç»å¯åŠ¨äº†ã€‚</p>
<p>initæ¥ä¸‹æ¥ä¼šæ‰“å¼€6ä¸ªç»ˆç«¯ï¼Œä»¥ä¾¿ç”¨æˆ·ç™»å½•ç³»ç»Ÿã€‚åœ¨inittabä¸­çš„ä»¥ä¸‹6è¡Œå°±æ˜¯å®šä¹‰äº†6ä¸ªç»ˆç«¯ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">1:2345:respawn:/sbin/mingetty tty1</span><br><span class="line">2:2345:respawn:/sbin/mingetty tty2</span><br><span class="line">3:2345:respawn:/sbin/mingetty tty3</span><br><span class="line">4:2345:respawn:/sbin/mingetty tty4</span><br><span class="line">5:2345:respawn:/sbin/mingetty tty5</span><br><span class="line">6:2345:respawn:/sbin/mingetty tty6</span><br></pre></td></tr></tbody></table></figure>
<p><strong><font size="5px">ç”¨æˆ·ç™»å½•ç³»ç»Ÿ</font></strong></p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œç”¨æˆ·çš„ç™»å½•æ–¹å¼æœ‰ä¸‰ç§ï¼š</p>
<ul>
<li>ï¼ˆ1ï¼‰å‘½ä»¤è¡Œç™»å½•</li>
<li>ï¼ˆ2ï¼‰sshç™»å½•</li>
<li>ï¼ˆ3ï¼‰å›¾å½¢ç•Œé¢ç™»å½•</li>
</ul>
<p>å¯¹äºè¿è¡Œçº§åˆ«ä¸º5çš„å›¾å½¢æ–¹å¼ç”¨æˆ·æ¥è¯´ï¼Œä»–ä»¬çš„ç™»å½•æ˜¯é€šè¿‡ä¸€ä¸ªå›¾å½¢åŒ–çš„ç™»å½•ç•Œé¢ã€‚ç™»å½•æˆåŠŸåå¯ä»¥ç›´æ¥è¿›å…¥ KDEã€Gnome ç­‰çª—å£ç®¡ç†å™¨ã€‚</p>
<p>è€Œæœ¬æ–‡ä¸»è¦è®²çš„è¿˜æ˜¯æ–‡æœ¬æ–¹å¼ç™»å½•çš„æƒ…å†µï¼šå½“æˆ‘ä»¬çœ‹åˆ°mingettyçš„ç™»å½•ç•Œé¢æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¾“å…¥ç”¨æˆ·åå’Œå¯†ç æ¥ç™»å½•ç³»ç»Ÿäº†ã€‚</p>
<p>Linux çš„è´¦å·éªŒè¯ç¨‹åºæ˜¯ loginï¼Œlogin ä¼šæ¥æ”¶ mingetty ä¼ æ¥çš„ç”¨æˆ·åä½œä¸ºç”¨æˆ·åå‚æ•°ã€‚</p>
<p>ç„¶å login ä¼šå¯¹ç”¨æˆ·åè¿›è¡Œåˆ†æï¼šå¦‚æœç”¨æˆ·åä¸æ˜¯ rootï¼Œä¸”å­˜åœ¨ /etc/nologin æ–‡ä»¶ï¼Œlogin å°†è¾“å‡º nologin æ–‡ä»¶çš„å†…å®¹ï¼Œç„¶åé€€å‡ºã€‚</p>
<p>è¿™é€šå¸¸ç”¨æ¥ç³»ç»Ÿç»´æŠ¤æ—¶é˜²æ­¢é root ç”¨æˆ·ç™»å½•ã€‚åªæœ‰/etc/securettyä¸­ç™»è®°äº†çš„ç»ˆç«¯æ‰å…è®¸ root ç”¨æˆ·ç™»å½•ï¼Œå¦‚æœä¸å­˜åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œåˆ™ root ç”¨æˆ·å¯ä»¥åœ¨ä»»ä½•ç»ˆç«¯ä¸Šç™»å½•ã€‚</p>
<p>/etc/userttyæ–‡ä»¶ç”¨äºå¯¹ç”¨æˆ·ä½œå‡ºé™„åŠ è®¿é—®é™åˆ¶ï¼Œå¦‚æœä¸å­˜åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œåˆ™æ²¡æœ‰å…¶ä»–é™åˆ¶ã€‚</p>
<p><strong><font size="5px">å›¾å½¢æ¨¡å¼ä¸æ–‡å­—æ¨¡å¼çš„åˆ‡æ¢æ–¹å¼</font></strong></p>
<p>Linuxé¢„è®¾æä¾›äº†å…­ä¸ªå‘½ä»¤çª—å£ç»ˆç«¯æœºè®©æˆ‘ä»¬æ¥ç™»å½•ã€‚</p>
<p>é»˜è®¤æˆ‘ä»¬ç™»å½•çš„å°±æ˜¯ç¬¬ä¸€ä¸ªçª—å£ï¼Œä¹Ÿå°±æ˜¯tty1ï¼Œè¿™ä¸ªå…­ä¸ªçª—å£åˆ†åˆ«ä¸ºtty1,tty2 â€¦ tty6ï¼Œä½ å¯ä»¥æŒ‰ä¸‹Ctrl + Alt + F1 ~ F6 æ¥åˆ‡æ¢å®ƒä»¬ã€‚</p>
<p>å¦‚æœä½ å®‰è£…äº†å›¾å½¢ç•Œé¢ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯è¿›å…¥å›¾å½¢ç•Œé¢çš„ï¼Œæ­¤æ—¶ä½ å°±å¯ä»¥æŒ‰Ctrl + Alt + F1 ~ F6æ¥è¿›å…¥å…¶ä¸­ä¸€ä¸ªå‘½ä»¤çª—å£ç•Œé¢ã€‚</p>
<p>å½“ä½ è¿›å…¥å‘½ä»¤çª—å£ç•Œé¢åå†è¿”å›å›¾å½¢ç•Œé¢åªè¦æŒ‰ä¸‹Ctrl + Alt + F7 å°±å›æ¥äº†ã€‚</p>
<p>å¦‚æœä½ ç”¨çš„vmware è™šæ‹Ÿæœºï¼Œå‘½ä»¤çª—å£åˆ‡æ¢çš„å¿«æ·é”®ä¸º Alt + Space + F1~F6. å¦‚æœä½ åœ¨å›¾å½¢ç•Œé¢ä¸‹è¯·æŒ‰Alt + Shift + Ctrl + F1~F6 åˆ‡æ¢è‡³å‘½ä»¤çª—å£ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/21/IvVYmq.png" alt=""></p>
<p><strong><font size="5px">å…³æœºå‘½ä»¤</font></strong></p>
<p>åœ¨linuxé¢†åŸŸå†…å¤§å¤šç”¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¾ˆå°‘é‡åˆ°å…³æœºçš„æ“ä½œã€‚æ¯•ç«ŸæœåŠ¡å™¨ä¸Šè·‘ä¸€ä¸ªæœåŠ¡æ˜¯æ°¸æ— æ­¢å¢ƒçš„ï¼Œé™¤éç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä¸å¾—å·²æ‰ä¼šå…³æœºã€‚</p>
<p>æ­£ç¡®çš„å…³æœºæµç¨‹ä¸ºï¼šsync &gt; shutdown &gt; reboot &gt; halt</p>
<p>å…³æœºæŒ‡ä»¤ä¸ºï¼šshutdown ï¼Œä½ å¯ä»¥man shutdown æ¥çœ‹ä¸€ä¸‹å¸®åŠ©æ–‡æ¡£ã€‚</p>
<p>ä¾‹å¦‚ä½ å¯ä»¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤å…³æœºï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">sync <span class="comment"># å°†æ•°æ®ç”±å†…å­˜åŒæ­¥åˆ°ç¡¬ç›˜ä¸­ã€‚</span></span><br><span class="line"></span><br><span class="line">shutdown <span class="comment"># å…³æœºæŒ‡ä»¤ï¼Œä½ å¯ä»¥man shutdown æ¥çœ‹ä¸€ä¸‹å¸®åŠ©æ–‡æ¡£ã€‚ä¾‹å¦‚ä½ å¯ä»¥è¿è¡Œå¦‚ä¸‹å‘½ä»¤å…³æœºï¼š</span></span><br><span class="line"></span><br><span class="line">shutdown â€“h 10 <span class="comment"># â€˜This server will shutdown after 10 minsâ€™ è¿™ä¸ªå‘½ä»¤å‘Šè¯‰å¤§å®¶ï¼Œè®¡ç®—æœºå°†åœ¨10åˆ†é’Ÿåå…³æœºï¼Œå¹¶ä¸”ä¼šæ˜¾ç¤ºåœ¨ç™»é™†ç”¨æˆ·çš„å½“å‰å±å¹•ä¸­ã€‚</span></span><br><span class="line"></span><br><span class="line">shutdown â€“h now <span class="comment"># ç«‹é©¬å…³æœº</span></span><br><span class="line"></span><br><span class="line">shutdown â€“h 20:25 <span class="comment"># ç³»ç»Ÿä¼šåœ¨ä»Šå¤©20:25å…³æœº</span></span><br><span class="line"></span><br><span class="line">shutdown â€“h +10 <span class="comment"># ååˆ†é’Ÿåå…³æœº</span></span><br><span class="line"></span><br><span class="line">shutdown â€“r now <span class="comment"># ç³»ç»Ÿç«‹é©¬é‡å¯</span></span><br><span class="line"></span><br><span class="line">shutdown â€“r +10 <span class="comment"># ç³»ç»Ÿååˆ†é’Ÿåé‡å¯</span></span><br><span class="line"></span><br><span class="line">reboot <span class="comment"># å°±æ˜¯é‡å¯ï¼Œç­‰åŒäº shutdown â€“r now</span></span><br><span class="line"></span><br><span class="line">halt <span class="comment"># å…³é—­ç³»ç»Ÿï¼Œç­‰åŒäºshutdown â€“h now å’Œ poweroff</span></span><br></pre></td></tr></tbody></table></figure>
<p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼Œä¸ç®¡æ˜¯é‡å¯ç³»ç»Ÿè¿˜æ˜¯å…³é—­ç³»ç»Ÿï¼Œé¦–å…ˆè¦è¿è¡Œ <strong>sync</strong> å‘½ä»¤ï¼ŒæŠŠå†…å­˜ä¸­çš„æ•°æ®å†™åˆ°ç£ç›˜ä¸­ã€‚</p>
<p>å…³æœºçš„å‘½ä»¤æœ‰ <strong>shutdown â€“h now halt poweroff</strong> å’Œ <strong>init 0</strong> , é‡å¯ç³»ç»Ÿçš„å‘½ä»¤æœ‰ <strong>shutdown â€“r now reboot init 6</strong>ã€‚</p>
<h1 id="ä¸‰ã€Linux-ç³»ç»Ÿç›®å½•ç»“æ„"><a href="#ä¸‰ã€Linux-ç³»ç»Ÿç›®å½•ç»“æ„" class="headerlink" title="ä¸‰ã€Linux ç³»ç»Ÿç›®å½•ç»“æ„"></a>ä¸‰ã€Linux ç³»ç»Ÿç›®å½•ç»“æ„</h1><p>ç™»å½•åˆ°ç³»ç»Ÿåï¼Œåœ¨å½“å‰å‘½ä»¤çª—å£ä¸‹è¾“å…¥å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">ls /</span><br></pre></td></tr></tbody></table></figure>
<p>ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤º:</p>
<p><img src="https://z3.ax1x.com/2021/11/21/IvepGD.png" alt=""></p>
<p>æ ‘çŠ¶ç›®å½•ç»“æ„ï¼š</p>
<p><img src="https://z3.ax1x.com/2021/11/21/IveiMd.png" alt=""></p>
<p>ä»¥ä¸‹æ˜¯å¯¹è¿™äº›ç›®å½•çš„è§£é‡Šï¼š</p>
<ul>
<li><p><strong>ç³»ç»Ÿå¯åŠ¨å¿…é¡»ï¼š</strong></p>
<ul>
<li><p><strong>/bootï¼š</strong>å­˜æ”¾çš„å¯åŠ¨Linux æ—¶ä½¿ç”¨çš„å†…æ ¸æ–‡ä»¶ï¼ŒåŒ…æ‹¬è¿æ¥æ–‡ä»¶ä»¥åŠé•œåƒæ–‡ä»¶ã€‚</p>
</li>
<li><p><strong>/etcï¼š</strong>å­˜æ”¾<strong>æ‰€æœ‰</strong>çš„ç³»ç»Ÿéœ€è¦çš„<strong>é…ç½®æ–‡ä»¶</strong>å’Œ<strong>å­ç›®å½•åˆ—è¡¨ï¼Œ</strong>æ›´æ”¹ç›®å½•ä¸‹çš„æ–‡ä»¶å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿä¸èƒ½å¯åŠ¨ã€‚</p>
</li>
<li><p><strong>/lib</strong>ï¼šå­˜æ”¾åŸºæœ¬ä»£ç åº“ï¼ˆæ¯”å¦‚c++åº“ï¼‰ï¼Œå…¶ä½œç”¨ç±»ä¼¼äºWindowsé‡Œçš„DLLæ–‡ä»¶ã€‚å‡ ä¹æ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½éœ€è¦ç”¨åˆ°è¿™äº›å…±äº«åº“ã€‚</p>
</li>
<li><p><strong>/sys</strong>ï¼š è¿™æ˜¯linux2.6å†…æ ¸çš„ä¸€ä¸ªå¾ˆå¤§çš„å˜åŒ–ã€‚è¯¥ç›®å½•ä¸‹å®‰è£…äº†2.6å†…æ ¸ä¸­æ–°å‡ºç°çš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ sysfs ã€‚sysfsæ–‡ä»¶ç³»ç»Ÿé›†æˆäº†ä¸‹é¢3ç§æ–‡ä»¶ç³»ç»Ÿçš„ä¿¡æ¯ï¼šé’ˆå¯¹è¿›ç¨‹ä¿¡æ¯çš„procæ–‡ä»¶ç³»ç»Ÿã€é’ˆå¯¹è®¾å¤‡çš„devfsæ–‡ä»¶ç³»ç»Ÿä»¥åŠé’ˆå¯¹ä¼ªç»ˆç«¯çš„devptsæ–‡ä»¶ç³»ç»Ÿã€‚è¯¥æ–‡ä»¶ç³»ç»Ÿæ˜¯å†…æ ¸è®¾å¤‡æ ‘çš„ä¸€ä¸ªç›´è§‚åæ˜ ã€‚å½“ä¸€ä¸ªå†…æ ¸å¯¹è±¡è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œå¯¹åº”çš„æ–‡ä»¶å’Œç›®å½•ä¹Ÿåœ¨å†…æ ¸å¯¹è±¡å­ç³»ç»Ÿä¸­</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>æŒ‡ä»¤é›†åˆï¼š</strong></p>
<ul>
<li><strong>/bin</strong>ï¼šå­˜æ”¾ç€æœ€å¸¸ç”¨çš„ç¨‹åºå’ŒæŒ‡ä»¤</li>
<li><strong>/sbin</strong>ï¼š<strong>åªæœ‰ç³»ç»Ÿç®¡ç†å‘˜èƒ½ä½¿ç”¨çš„ç¨‹åºå’ŒæŒ‡ä»¤</strong>ã€‚</li>
</ul>
</li>
<li><p><strong>å¤–éƒ¨æ–‡ä»¶ç®¡ç†ï¼š</strong></p>
<ul>
<li><strong>/dev ï¼š</strong>Device(è®¾å¤‡)çš„ç¼©å†™, å­˜æ”¾çš„æ˜¯Linuxçš„å¤–éƒ¨è®¾å¤‡ã€‚<strong>æ³¨æ„ï¼š</strong>åœ¨Linuxä¸­è®¿é—®è®¾å¤‡å’Œè®¿é—®æ–‡ä»¶çš„æ–¹å¼æ˜¯ç›¸åŒçš„ã€‚</li>
<li><strong>/media</strong>ï¼šç±»windowsçš„<strong>å…¶ä»–è®¾å¤‡ï¼Œ</strong>ä¾‹å¦‚Uç›˜ã€å…‰é©±ç­‰ç­‰ï¼Œè¯†åˆ«ålinuxä¼šæŠŠè®¾å¤‡æ”¾åˆ°è¿™ä¸ªç›®å½•ä¸‹ã€‚</li>
<li><strong>/mnt</strong>ï¼šä¸´æ—¶æŒ‚è½½åˆ«çš„æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…‰é©±æŒ‚è½½åœ¨/mnt/ä¸Šï¼Œç„¶åè¿›å…¥è¯¥ç›®å½•å°±å¯ä»¥æŸ¥çœ‹å…‰é©±é‡Œçš„å†…å®¹äº†ã€‚</li>
</ul>
</li>
<li><p><strong>ä¸´æ—¶æ–‡ä»¶ï¼š</strong></p>
<ul>
<li><p><strong>/run</strong>ï¼šæ˜¯ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿï¼Œå­˜å‚¨ç³»ç»Ÿå¯åŠ¨ä»¥æ¥çš„ä¿¡æ¯ã€‚å½“ç³»ç»Ÿé‡å¯æ—¶ï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶åº”è¯¥è¢«åˆ æ‰æˆ–æ¸…é™¤ã€‚å¦‚æœä½ çš„ç³»ç»Ÿä¸Šæœ‰ /var/run ç›®å½•ï¼Œåº”è¯¥è®©å®ƒæŒ‡å‘ runã€‚</p>
</li>
<li><p><strong>/lost+found</strong>ï¼šä¸€èˆ¬æƒ…å†µä¸‹ä¸ºç©ºçš„ï¼Œç³»ç»Ÿéæ³•å…³æœºåï¼Œè¿™é‡Œå°±å­˜æ”¾ä¸€äº›æ–‡ä»¶ã€‚</p>
</li>
<li><p><strong>/tmp</strong>ï¼šè¿™ä¸ªç›®å½•æ˜¯ç”¨æ¥å­˜æ”¾ä¸€äº›ä¸´æ—¶æ–‡ä»¶çš„ã€‚</p>
</li>
</ul>
</li>
<li><p><strong>è´¦æˆ·ï¼š</strong></p>
<ul>
<li><strong>/root</strong>ï¼šç³»ç»Ÿç®¡ç†å‘˜çš„ç”¨æˆ·ä¸»ç›®å½•ã€‚</li>
<li><strong>/home</strong>ï¼šç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œä»¥ç”¨æˆ·çš„è´¦å·å‘½åçš„ã€‚</li>
<li><strong>/usr</strong>ï¼šç”¨æˆ·çš„å¾ˆå¤šåº”ç”¨ç¨‹åºå’Œæ–‡ä»¶éƒ½æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œç±»ä¼¼äºwindowsä¸‹çš„program filesç›®å½•ã€‚</li>
<li><strong>/usr/binï¼š</strong>ç³»ç»Ÿç”¨æˆ·ä½¿ç”¨çš„åº”ç”¨ç¨‹åºä¸æŒ‡ä»¤ã€‚</li>
<li><strong>/usr/sbinï¼š</strong>è¶…çº§ç”¨æˆ·ä½¿ç”¨çš„æ¯”è¾ƒé«˜çº§çš„ç®¡ç†ç¨‹åºå’Œç³»ç»Ÿå®ˆæŠ¤ç¨‹åºã€‚</li>
<li><strong>/usr/srcï¼š</strong>å†…æ ¸æºä»£ç é»˜è®¤çš„æ”¾ç½®ç›®å½•ã€‚</li>
</ul>
</li>
<li><p><strong>è¿è¡Œè¿‡ç¨‹ä¸­è¦ç”¨ï¼š</strong></p>
<ul>
<li><strong>/var</strong>ï¼šå­˜æ”¾ç»å¸¸ä¿®æ”¹çš„æ•°æ®ï¼Œæ¯”å¦‚ç¨‹åºè¿è¡Œçš„æ—¥å¿—æ–‡ä»¶ï¼ˆ/var/log ç›®å½•ä¸‹ï¼‰ã€‚</li>
<li><strong>/proc</strong>ï¼šç®¡ç†<strong>å†…å­˜ç©ºé—´ï¼</strong>è™šæ‹Ÿçš„ç›®å½•ï¼Œæ˜¯ç³»ç»Ÿå†…å­˜çš„æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®è¿™ä¸ªç›®å½•æ¥ï¼Œè·å–ç³»ç»Ÿä¿¡æ¯ã€‚è¿™ä¸ªç›®å½•çš„å†…å®¹ä¸åœ¨ç¡¬ç›˜ä¸Šè€Œæ˜¯åœ¨å†…å­˜é‡Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥ä¿®æ”¹é‡Œé¢çš„æŸäº›æ–‡ä»¶æ¥åšä¿®æ”¹ã€‚</li>
</ul>
</li>
<li><p><strong>æ‰©å±•ç”¨çš„ï¼š</strong></p>
<ul>
<li><strong>/opt</strong>ï¼šé»˜è®¤æ˜¯ç©ºçš„ï¼Œæˆ‘ä»¬å®‰è£…é¢å¤–è½¯ä»¶å¯ä»¥æ”¾åœ¨è¿™ä¸ªé‡Œé¢ã€‚</li>
<li><strong>/srv</strong>ï¼šå­˜æ”¾æœåŠ¡å¯åŠ¨åéœ€è¦æå–çš„æ•°æ®<strong>ï¼ˆä¸ç”¨æœåŠ¡å™¨å°±æ˜¯ç©ºï¼‰</strong></li>
</ul>
</li>
</ul>
<p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæœ‰å‡ ä¸ªç›®å½•æ˜¯æ¯”è¾ƒé‡è¦çš„ï¼Œå¹³æ—¶éœ€è¦æ³¨æ„ä¸è¦è¯¯åˆ é™¤æˆ–è€…éšæ„æ›´æ”¹å†…éƒ¨æ–‡ä»¶ã€‚</p>
<p><strong>/etc</strong>ï¼š ä¸Šè¾¹ä¹Ÿæåˆ°äº†ï¼Œè¿™ä¸ªæ˜¯ç³»ç»Ÿä¸­çš„é…ç½®æ–‡ä»¶ï¼Œå¦‚æœä½ æ›´æ”¹äº†è¯¥ç›®å½•ä¸‹çš„æŸä¸ªæ–‡ä»¶å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿä¸èƒ½å¯åŠ¨ã€‚</p>
<p><strong>/bin, /sbin, /usr/bin, /usr/sbin</strong>: è¿™æ˜¯ç³»ç»Ÿé¢„è®¾çš„æ‰§è¡Œæ–‡ä»¶çš„æ”¾ç½®ç›®å½•ï¼Œæ¯”å¦‚ ls å°±æ˜¯åœ¨ /bin/ls ç›®å½•ä¸‹çš„ã€‚</p>
<p>å€¼å¾—æå‡ºçš„æ˜¯ï¼Œ/bin, /usr/bin æ˜¯ç»™ç³»ç»Ÿç”¨æˆ·ä½¿ç”¨çš„æŒ‡ä»¤ï¼ˆé™¤rootå¤–çš„é€šç”¨æˆ·ï¼‰ï¼Œè€Œ/sbin, /usr/sbin åˆ™æ˜¯ç»™ root ä½¿ç”¨çš„æŒ‡ä»¤ã€‚</p>
<p><strong>/var</strong>ï¼š è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç›®å½•ï¼Œç³»ç»Ÿä¸Šè·‘äº†å¾ˆå¤šç¨‹åºï¼Œé‚£ä¹ˆæ¯ä¸ªç¨‹åºéƒ½ä¼šæœ‰ç›¸åº”çš„æ—¥å¿—äº§ç”Ÿï¼Œè€Œè¿™äº›æ—¥å¿—å°±è¢«è®°å½•åˆ°è¿™ä¸ªç›®å½•ä¸‹ï¼Œå…·ä½“åœ¨ /var/log ç›®å½•ä¸‹ï¼Œå¦å¤– mail çš„é¢„è®¾æ”¾ç½®ä¹Ÿæ˜¯åœ¨è¿™é‡Œã€‚</p>
<h1 id="å››ã€å¸¸ç”¨çš„åŸºæœ¬å‘½ä»¤ã€é‡ç‚¹ã€‘"><a href="#å››ã€å¸¸ç”¨çš„åŸºæœ¬å‘½ä»¤ã€é‡ç‚¹ã€‘" class="headerlink" title="å››ã€å¸¸ç”¨çš„åŸºæœ¬å‘½ä»¤ã€é‡ç‚¹ã€‘"></a>å››ã€å¸¸ç”¨çš„åŸºæœ¬å‘½ä»¤ã€é‡ç‚¹ã€‘</h1><h2 id="1ã€æ–‡ä»¶ä¸ç›®å½•ç®¡ç†"><a href="#1ã€æ–‡ä»¶ä¸ç›®å½•ç®¡ç†" class="headerlink" title="1ã€æ–‡ä»¶ä¸ç›®å½•ç®¡ç†"></a>1ã€æ–‡ä»¶ä¸ç›®å½•ç®¡ç†</h2><div class="note success">
            <p>ç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„ </p>
          </div>
<p>æˆ‘ä»¬çŸ¥é“ Linux çš„ç›®å½•ç»“æ„ä¸ºæ ‘çŠ¶ç»“æ„ï¼Œæœ€é¡¶çº§çš„ç›®å½•ä¸ºæ ¹ç›®å½• /ã€‚</p>
<p>å…¶ä»–ç›®å½•é€šè¿‡æŒ‚åœ¨å¯ä»¥å°†ä»–ä»¬æ·»åŠ åˆ°æ ‘ä¸­ï¼Œé€šè¿‡æ¥è§¦æŒ‚è½½å¯ä»¥ç§»é™¤ä»–ä»¬ã€‚</p>
<p><strong>ç»å¯¹è·¯å¾„ï¼š</strong></p>
<p>è·¯å¾„çš„å†™æ³•ï¼Œç”±æ ¹ç›®å½• / å†™èµ·ï¼Œä¾‹å¦‚ï¼š/usr/share/doc è¿™ä¸ªç›®å½•ã€‚</p>
<p><strong>ç›¸å¯¹è·¯å¾„ï¼š</strong></p>
<p>è·¯å¾„çš„å†™æ³•ï¼Œä¸æ˜¯ç”± / å†™èµ·ï¼Œä¾‹å¦‚ç”± /usr/share/doc è¦åˆ° /usr/share/man åº•ä¸‹æ—¶ï¼Œå¯ä»¥å†™æˆï¼šcd ../man è¿™å°±æ˜¯ç›¸å¯¹è·¯å¾„çš„å†™æ³•å•¦ï¼</p>
<div class="note success">
            <p>å¤„ç†æ–‡ä»¶çš„å¸¸ç”¨å‘½ä»¤ </p>
          </div>
<ul>
<li>ls: åˆ—å‡ºç›®å½•</li>
<li>cdï¼šåˆ‡æ¢ç›®å½•</li>
<li>pwdï¼šæ˜¾ç¤ºç›®å‰çš„ç›®å½•</li>
<li>mkdirï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•</li>
<li>rmdirï¼šåˆ é™¤ä¸€ä¸ªç©ºçš„ç›®å½•</li>
<li>cp: å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•</li>
<li>rm: ç§»é™¤æ–‡ä»¶æˆ–ç›®å½•</li>
<li>mv: ç§»åŠ¨æ–‡ä»¶ä¸ç›®å½•ï¼Œæˆ–ä¿®æ”¹æ–‡ä»¶ä¸ç›®å½•çš„åç§°</li>
</ul>
<p>ä½ å¯ä»¥ä½¿ç”¨ <em>man [å‘½ä»¤]</em> æ¥æŸ¥çœ‹å„ä¸ªå‘½ä»¤çš„ä½¿ç”¨æ–‡æ¡£ï¼Œå¦‚ ï¼šman cpã€‚</p>
<div class="note success">
            <p>lsï¼ˆåˆ—å‡ºç›®å½•ï¼‰ </p>
          </div>
<p>åœ¨Linuxç³»ç»Ÿå½“ä¸­ï¼Œ lsï¼ˆè‹±æ–‡ listï¼‰ å‘½ä»¤å¯èƒ½æ˜¯æœ€å¸¸è¢«è¿è¡Œçš„ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">ls [-aAdfFhilnrRSt] ç›®å½•åç§°</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li><strong>-a</strong> ï¼šå…¨éƒ¨çš„æ–‡ä»¶ï¼Œè¿åŒéšè—æ–‡ä»¶( å¼€å¤´ä¸º . çš„æ–‡ä»¶) ä¸€èµ·åˆ—å‡ºæ¥(å¸¸ç”¨)</li>
<li><strong>-l</strong> ï¼šé•¿æ•°æ®ä¸²åˆ—å‡ºï¼ŒåŒ…å«æ–‡ä»¶çš„å±æ€§ä¸æƒé™ç­‰ç­‰æ•°æ®ï¼›(å¸¸ç”¨)</li>
</ul>
<ul>
<li><strong>-F</strong>ï¼šä¸ºæŸ¥è¯¢å‡ºæ¥çš„æ¯ä¸ªåˆ—ä¸¾é¡¹ç›®æœ«å°¾éƒ½æ·»åŠ ä¸€ä¸ªç¬¦å·<ul>
<li>/ è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç›®å½•</li>
<li>@ è¡¨æ˜è¿™æ˜¯å…¶ä»–æ–‡ä»¶çš„ç¬¦å·é“¾æ¥</li>
<li>* è¡¨æ˜æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥è¯¢è¯¥ç›®å½•ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶</span></span><br><span class="line">[root@deflory src]<span class="comment"># ls -F | grep "*"</span></span><br><span class="line">mkreleasehdr.sh*</span><br><span class="line">redis-benchmark*</span><br><span class="line">redis-check-aof*</span><br><span class="line">redis-check-rdb*</span><br><span class="line">redis-cli*</span><br><span class="line">redis-sentinel*</span><br><span class="line">redis-server*</span><br><span class="line">redis-trib.rb*</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>cdï¼ˆåˆ‡æ¢ç›®å½•ï¼‰ </p>
          </div>
<p>cdæ˜¯Change Directoryçš„ç¼©å†™ï¼Œè¿™æ˜¯ç”¨æ¥å˜æ¢å·¥ä½œç›®å½•çš„å‘½ä»¤ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> [ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„]</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>pwd ( æ˜¾ç¤ºç›®å‰æ‰€åœ¨çš„ç›®å½• ) </p>
          </div>
<p>pwd æ˜¯ <strong>Print Working Directory</strong> çš„ç¼©å†™ï¼Œä¹Ÿå°±æ˜¯æ˜¾ç¤ºç›®å‰æ‰€åœ¨ç›®å½•çš„å‘½ä»¤ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">pwd</span> [-P]</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li><strong>-P</strong> ï¼šæ˜¾ç¤ºå‡ºç¡®å®çš„è·¯å¾„ï¼Œè€Œéä½¿ç”¨è¿æ¥(link) è·¯å¾„ã€‚</li>
</ul>
<div class="note success">
            <p>mkdir ï¼ˆåˆ›å»ºæ–°ç›®å½•ï¼‰ </p>
          </div>
<p>å¦‚æœæƒ³è¦åˆ›å»ºæ–°çš„ç›®å½•çš„è¯ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨mkdir (make directory)å§ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">mkdir [-mp] ç›®å½•åç§°</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li><strong>-m</strong> ï¼šé…ç½®æ–‡ä»¶çš„æƒé™å–”ï¼ç›´æ¥é…ç½®ï¼Œä¸éœ€è¦çœ‹é»˜è®¤æƒé™ (umask) çš„è„¸è‰²ï½</li>
<li><strong>-p</strong> ï¼šå¸®åŠ©ä½ ç›´æ¥å°†æ‰€éœ€è¦çš„ç›®å½•(åŒ…å«ä¸Šä¸€çº§ç›®å½•)é€’å½’åˆ›å»ºèµ·æ¥ï¼</li>
</ul>
<div class="note success">
            <p>rmdir ( åˆ é™¤ç©ºçš„ç›®å½• ) </p>
          </div>
<p>rmdir å³ remove directionï¼Œåˆ é™¤ç›®å½•ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">rmdir [-p] ç›®å½•åç§°</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li><strong>-p</strong>ï¼šè¿åŒä¸Šä¸€çº§ã€ç©ºçš„ã€ç›®å½•ä¹Ÿä¸€èµ·åˆ é™¤</li>
</ul>
<p>æ³¨æ„ï¼šè¿™ä¸ª rmdir ä»…èƒ½åˆ é™¤ç©ºçš„ç›®å½•ï¼Œä½ å¯ä»¥ä½¿ç”¨ rm å‘½ä»¤æ¥åˆ é™¤éç©ºç›®å½•ï¼Œåé¢æˆ‘ä»¬ä¼šå°†ï¼</p>
<div class="note success">
            <p>cp ( å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½• ) </p>
          </div>
<p>cp å³ copyï¼Œå¤åˆ¶æ–‡ä»¶ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">cp [-adfilprsu] source1 source2 source3 .... directory</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li><strong>-a</strong>ï¼šç›¸å½“æ–¼ -pdr çš„æ„æ€ï¼Œè‡³æ–¼ pdr è¯·å‚è€ƒä¸‹åˆ—è¯´æ˜ï¼›(å¸¸ç”¨)</li>
<li><strong>-p</strong>ï¼šè¿åŒæ–‡ä»¶çš„å±æ€§ä¸€èµ·å¤åˆ¶è¿‡å»ï¼Œè€Œéä½¿ç”¨é»˜è®¤å±æ€§(å¤‡ä»½å¸¸ç”¨)ï¼›</li>
<li><strong>-d</strong>ï¼šè‹¥æ¥æºæ¡£ä¸ºè¿ç»“æ¡£çš„å±æ€§(link file)ï¼Œåˆ™å¤åˆ¶è¿ç»“æ¡£å±æ€§è€Œéæ–‡ä»¶æœ¬èº«ï¼›</li>
<li><strong>-r</strong>ï¼šé€’å½’æŒç»­å¤åˆ¶ï¼Œç”¨æ–¼ç›®å½•çš„å¤åˆ¶è¡Œä¸ºï¼›(å¸¸ç”¨)</li>
<li><strong>-f</strong>ï¼šä¸ºå¼ºåˆ¶(force)çš„æ„æ€ï¼Œè‹¥ç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ä¸”æ— æ³•å¼€å¯ï¼Œåˆ™ç§»é™¤åå†å°è¯•ä¸€æ¬¡ï¼›</li>
<li><strong>-i</strong>ï¼šè‹¥ç›®æ ‡æ¡£(destination)å·²ç»å­˜åœ¨æ—¶ï¼Œåœ¨è¦†ç›–æ—¶ä¼šå…ˆè¯¢é—®åŠ¨ä½œçš„è¿›è¡Œ(å¸¸ç”¨)</li>
<li><strong>-l</strong>ï¼šè¿›è¡Œç¡¬å¼è¿ç»“(hard link)çš„è¿ç»“æ¡£åˆ›å»ºï¼Œè€Œéå¤åˆ¶æ–‡ä»¶æœ¬èº«ã€‚</li>
<li><strong>-s</strong>ï¼šå¤åˆ¶æˆä¸ºç¬¦å·è¿ç»“æ¡£ (symbolic link)ï¼Œäº¦å³ã€æ·å¾„ã€æ–‡ä»¶ï¼›</li>
<li><strong>-u</strong>ï¼šè‹¥ destination æ¯” source æ—§æ‰å‡çº§ destination ï¼</li>
</ul>
<div class="note success">
            <p>rm ( ç§»é™¤æ–‡ä»¶æˆ–ç›®å½• ) </p>
          </div>
<p>rm å³ removeï¼Œç§»é™¤æ–‡ä»¶ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">rm [-fir] æ–‡ä»¶æˆ–ç›®å½•</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li>-f ï¼šå°±æ˜¯ force çš„æ„æ€ï¼Œå¿½ç•¥ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œä¸ä¼šå‡ºç°è­¦å‘Šä¿¡æ¯ï¼›</li>
<li>-i ï¼šäº’åŠ¨æ¨¡å¼ï¼Œåœ¨åˆ é™¤å‰ä¼šè¯¢é—®ä½¿ç”¨è€…æ˜¯å¦åŠ¨ä½œ</li>
<li>-r ï¼šé€’å½’åˆ é™¤å•Šï¼æœ€å¸¸ç”¨åœ¨ç›®å½•çš„åˆ é™¤äº†ï¼è¿™æ˜¯éå¸¸å±é™©çš„é€‰é¡¹ï¼ï¼ï¼</li>
</ul>
<p><code>rm -rf /</code> åˆ åº“è·‘è·¯ï¼Œä»å…¥é—¨åˆ°å…¥ç‹±ã€‚</p>
<div class="note success">
            <p>mv  ( ç§»åŠ¨æ–‡ä»¶ä¸ç›®å½•ï¼Œæˆ–ä¿®æ”¹åç§° ) </p>
          </div>
<p>mv å³ moveï¼Œç§»åŠ¨æ–‡ä»¶ï¼ˆç§»åŠ¨åˆ°ç›¸åŒç›®å½•ä¸‹å³ä¸ºé‡å‘½åï¼‰ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">mv [-fiu] source1 source2 source3 .... directory</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li>-f ï¼šforce å¼ºåˆ¶çš„æ„æ€ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œä¸ä¼šè¯¢é—®è€Œç›´æ¥è¦†ç›–ï¼›</li>
<li>-i ï¼šè‹¥ç›®æ ‡æ–‡ä»¶ (destination) å·²ç»å­˜åœ¨æ—¶ï¼Œå°±ä¼šè¯¢é—®æ˜¯å¦è¦†ç›–ï¼</li>
<li>-u ï¼šè‹¥ç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œä¸” source æ¯”è¾ƒæ–°ï¼Œæ‰ä¼šå‡çº§ (update)</li>
</ul>
<h2 id="2ã€æ–‡ä»¶åŸºæœ¬å±æ€§"><a href="#2ã€æ–‡ä»¶åŸºæœ¬å±æ€§" class="headerlink" title="2ã€æ–‡ä»¶åŸºæœ¬å±æ€§"></a>2ã€æ–‡ä»¶åŸºæœ¬å±æ€§</h2><p>Linux ç³»ç»Ÿæ˜¯ä¸€ç§å…¸å‹çš„å¤šç”¨æˆ·ç³»ç»Ÿï¼Œä¸åŒçš„ç”¨æˆ·å¤„äºä¸åŒçš„åœ°ä½ï¼Œæ‹¥æœ‰ä¸åŒçš„æƒé™ã€‚</p>
<p>ä¸ºäº†ä¿æŠ¤ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼ŒLinux ç³»ç»Ÿå¯¹ä¸åŒçš„ç”¨æˆ·è®¿é—®åŒä¸€æ–‡ä»¶ï¼ˆåŒ…æ‹¬ç›®å½•æ–‡ä»¶ï¼‰çš„æƒé™åšäº†ä¸åŒçš„è§„å®šã€‚</p>
<p>åœ¨ Linux ä¸­æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªå‘½ä»¤æ¥ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€å±ç”¨æˆ·ä¸æƒé™ï¼š</p>
<ul>
<li>chown (change owner) ï¼š ä¿®æ”¹æ‰€å±ç”¨æˆ·ä¸ç»„ã€‚</li>
<li>chmod (change mode) ï¼š ä¿®æ”¹ç”¨æˆ·çš„æƒé™ã€‚</li>
</ul>
<p>ä¸‹å›¾ä¸­é€šè¿‡ chown æ¥æˆæƒç”¨æˆ·ï¼Œé€šè¿‡ chmod ä¸ºç”¨æˆ·è®¾ç½®å¯ä»¥å¼€é—¨çš„æƒé™ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/21/IvdbtO.png" alt=""></p>
<p>åœ¨ Linux ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong>ll</strong> æˆ–è€… <strong>ls â€“l</strong> å‘½ä»¤æ¥æ˜¾ç¤ºä¸€ä¸ªæ–‡ä»¶çš„å±æ€§ä»¥åŠæ–‡ä»¶æ‰€å±çš„ç”¨æˆ·å’Œç»„ï¼Œå¦‚ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@www /]<span class="comment"># ls -l</span></span><br><span class="line">total 64</span><br><span class="line">dr-xr-xr-x   2 root root 4096 Dec 14  2012 bin</span><br><span class="line">dr-xr-xr-x   4 root root 4096 Apr 19  2012 boot</span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></tbody></table></figure>
<p>å®ä¾‹ä¸­ï¼Œ<strong>bin</strong> æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªå±æ€§ç”¨ <strong>d</strong> è¡¨ç¤ºã€‚<strong>d</strong> åœ¨ Linux ä¸­ä»£è¡¨è¯¥æ–‡ä»¶æ˜¯ä¸€ä¸ªç›®å½•æ–‡ä»¶ã€‚</p>
<p>åœ¨ Linux ä¸­ç¬¬ä¸€ä¸ªå­—ç¬¦ä»£è¡¨è¿™ä¸ªæ–‡ä»¶æ˜¯ç›®å½•ã€æ–‡ä»¶æˆ–é“¾æ¥æ–‡ä»¶ç­‰ç­‰ã€‚</p>
<ul>
<li>å½“ä¸º <strong>d</strong> åˆ™æ˜¯ç›®å½•</li>
<li>å½“ä¸º <strong>-</strong> åˆ™æ˜¯æ–‡ä»¶ï¼›</li>
<li>è‹¥æ˜¯ <strong>l</strong> åˆ™è¡¨ç¤ºä¸ºé“¾æ¥æ–‡æ¡£(link file)ï¼›</li>
<li>è‹¥æ˜¯ <strong>b</strong> åˆ™è¡¨ç¤ºä¸ºè£…ç½®æ–‡ä»¶é‡Œé¢çš„å¯ä¾›å‚¨å­˜çš„æ¥å£è®¾å¤‡(å¯éšæœºå­˜å–è£…ç½®)ï¼›</li>
<li>è‹¥æ˜¯ <strong>c</strong> åˆ™è¡¨ç¤ºä¸ºè£…ç½®æ–‡ä»¶é‡Œé¢çš„ä¸²è¡Œç«¯å£è®¾å¤‡ï¼Œä¾‹å¦‚é”®ç›˜ã€é¼ æ ‡(ä¸€æ¬¡æ€§è¯»å–è£…ç½®)ã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥çš„å­—ç¬¦ä¸­ï¼Œä»¥ä¸‰ä¸ªä¸ºä¸€ç»„ï¼Œä¸”å‡ä¸º <strong>rwx</strong> çš„ä¸‰ä¸ªå‚æ•°çš„ç»„åˆã€‚å…¶ä¸­ï¼Œ <strong>r</strong> ä»£è¡¨å¯è¯»(read)ã€ <strong>w</strong> ä»£è¡¨å¯å†™(write)ã€ <strong>x</strong> ä»£è¡¨å¯æ‰§è¡Œ(execute)ã€‚ è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸‰ä¸ªæƒé™çš„ä½ç½®ä¸ä¼šæ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰æƒé™ï¼Œå°±ä¼šå‡ºç°å‡å· <strong>-</strong> è€Œå·²ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/22/IvsbNt.png" alt=""></p>
<p>æ¯ä¸ªæ–‡ä»¶çš„å±æ€§ç”±å·¦è¾¹ç¬¬ä¸€éƒ¨åˆ†çš„ 10 ä¸ªå­—ç¬¦æ¥ç¡®å®šï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/22/IvsO9f.png" alt=""></p>
<p>ä»å·¦è‡³å³ç”¨ <strong>0-9</strong> è¿™äº›æ•°å­—æ¥è¡¨ç¤ºã€‚</p>
<p>ç¬¬ <strong>0</strong> ä½ç¡®å®šæ–‡ä»¶ç±»å‹ï¼Œç¬¬ <strong>1-3</strong> ä½ç¡®å®šå±ä¸»ï¼ˆè¯¥æ–‡ä»¶çš„æ‰€æœ‰è€…ï¼‰æ‹¥æœ‰è¯¥æ–‡ä»¶çš„æƒé™ã€‚</p>
<p>ç¬¬4-6ä½ç¡®å®šå±ç»„ï¼ˆæ‰€æœ‰è€…çš„åŒç»„ç”¨æˆ·ï¼‰æ‹¥æœ‰è¯¥æ–‡ä»¶çš„æƒé™ï¼Œç¬¬7-9ä½ç¡®å®šå…¶ä»–ç”¨æˆ·æ‹¥æœ‰è¯¥æ–‡ä»¶çš„æƒé™ã€‚</p>
<p>å…¶ä¸­ï¼Œç¬¬ <strong>1ã€4ã€7</strong> ä½è¡¨ç¤ºè¯»æƒé™ï¼Œå¦‚æœç”¨ <strong>r</strong> å­—ç¬¦è¡¨ç¤ºï¼Œåˆ™æœ‰è¯»æƒé™ï¼Œå¦‚æœç”¨ <strong>-</strong> å­—ç¬¦è¡¨ç¤ºï¼Œåˆ™æ²¡æœ‰è¯»æƒé™ï¼›</p>
<p>ç¬¬ <strong>2ã€5ã€8</strong> ä½è¡¨ç¤ºå†™æƒé™ï¼Œå¦‚æœç”¨ <strong>w</strong> å­—ç¬¦è¡¨ç¤ºï¼Œåˆ™æœ‰å†™æƒé™ï¼Œå¦‚æœç”¨ <strong>-</strong> å­—ç¬¦è¡¨ç¤ºæ²¡æœ‰å†™æƒé™ï¼›ç¬¬ <strong>3ã€6ã€9</strong> ä½è¡¨ç¤ºå¯æ‰§è¡Œæƒé™ï¼Œå¦‚æœç”¨ <strong>x</strong> å­—ç¬¦è¡¨ç¤ºï¼Œåˆ™æœ‰æ‰§è¡Œæƒé™ï¼Œå¦‚æœç”¨ <strong>-</strong> å­—ç¬¦è¡¨ç¤ºï¼Œåˆ™æ²¡æœ‰æ‰§è¡Œæƒé™ã€‚</p>
<h2 id="3ã€æ–‡ä»¶å±ä¸»å’Œå±ç»„"><a href="#3ã€æ–‡ä»¶å±ä¸»å’Œå±ç»„" class="headerlink" title="3ã€æ–‡ä»¶å±ä¸»å’Œå±ç»„"></a>3ã€æ–‡ä»¶å±ä¸»å’Œå±ç»„</h2><p>å¯¹äºæ–‡ä»¶æ¥è¯´ï¼Œå®ƒéƒ½æœ‰ä¸€ä¸ªç‰¹å®šçš„æ‰€æœ‰è€…ï¼Œä¹Ÿå°±æ˜¯å¯¹è¯¥æ–‡ä»¶å…·æœ‰æ‰€æœ‰æƒçš„ç”¨æˆ·ã€‚</p>
<p>åŒæ—¶ï¼Œåœ¨Linuxç³»ç»Ÿä¸­ï¼Œç”¨æˆ·æ˜¯æŒ‰ç»„åˆ†ç±»çš„ï¼Œä¸€ä¸ªç”¨æˆ·å±äºä¸€ä¸ªæˆ–å¤šä¸ªç»„ã€‚</p>
<p>æ–‡ä»¶æ‰€æœ‰è€…ä»¥å¤–çš„ç”¨æˆ·åˆå¯ä»¥åˆ†ä¸ºæ–‡ä»¶æ‰€æœ‰è€…çš„åŒç»„ç”¨æˆ·å’Œå…¶ä»–ç”¨æˆ·ã€‚</p>
<p>å› æ­¤ï¼ŒLinuxç³»ç»ŸæŒ‰æ–‡ä»¶æ‰€æœ‰è€…ã€æ–‡ä»¶æ‰€æœ‰è€…åŒç»„ç”¨æˆ·å’Œå…¶ä»–ç”¨æˆ·æ¥è§„å®šäº†ä¸åŒçš„æ–‡ä»¶è®¿é—®æƒé™ã€‚</p>
<p>åœ¨ä»¥ä¸Šå®ä¾‹ä¸­ï¼Œmysql æ–‡ä»¶æ˜¯ä¸€ä¸ªç›®å½•æ–‡ä»¶ï¼Œå±ä¸»å’Œå±ç»„éƒ½ä¸º mysqlï¼Œå±ä¸»æœ‰å¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œçš„æƒé™ï¼›ä¸å±ä¸»åŒç»„çš„å…¶ä»–ç”¨æˆ·æœ‰å¯è¯»å’Œå¯æ‰§è¡Œçš„æƒé™ï¼›å…¶ä»–ç”¨æˆ·ä¹Ÿæœ‰å¯è¯»å’Œå¯æ‰§è¡Œçš„æƒé™ã€‚</p>
<p>å¯¹äº root ç”¨æˆ·æ¥è¯´ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ–‡ä»¶çš„æƒé™å¯¹å…¶ä¸èµ·ä½œç”¨ã€‚</p>
<p><strong><font size="5px">æ›´æ”¹æ–‡ä»¶å±æ€§</font></strong></p>
<div class="note success">
            <p>chgrpï¼šæ›´æ”¹æ–‡ä»¶å±ç»„ </p>
          </div>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">chgrp [-R] å±ç»„å æ–‡ä»¶å</span><br></pre></td></tr></tbody></table></figure>
<p>å‚æ•°é€‰é¡¹</p>
<ul>
<li>-Rï¼šé€’å½’æ›´æ”¹æ–‡ä»¶å±ç»„ï¼Œå°±æ˜¯åœ¨æ›´æ”¹æŸä¸ªç›®å½•æ–‡ä»¶çš„å±ç»„æ—¶ï¼Œå¦‚æœåŠ ä¸Š-Rçš„å‚æ•°ï¼Œé‚£ä¹ˆè¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„å±ç»„éƒ½ä¼šæ›´æ”¹ã€‚</li>
</ul>
<div class="note success">
            <p>chownï¼šæ›´æ”¹æ–‡ä»¶å±ä¸»ï¼Œä¹Ÿå¯ä»¥åŒæ—¶æ›´æ”¹æ–‡ä»¶å±ç»„ </p>
          </div>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">chown [â€“R] å±ä¸»å æ–‡ä»¶å</span><br><span class="line">chown [-R] å±ä¸»åï¼šå±ç»„å æ–‡ä»¶å</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥ /root ç›®å½•ï¼ˆ~ï¼‰å°†install.logçš„æ‹¥æœ‰è€…æ”¹ä¸ºbinè¿™ä¸ªè´¦å·ï¼š</span></span><br><span class="line">[root@www ~] <span class="built_in">cd</span> ~</span><br><span class="line">[root@www ~] chown bin install.log</span><br><span class="line">[root@www ~] ls -l</span><br><span class="line">-rw-r--r--  1 bin  users 68495 Jun 25 08:53 install.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†install.logçš„æ‹¥æœ‰è€…ä¸ç¾¤ç»„æ”¹å›ä¸ºrootï¼š</span></span><br><span class="line">[root@www ~] chown root:root install.log</span><br><span class="line">[root@www ~] ls -l</span><br><span class="line">-rw-r--r--  1 root root 68495 Jun 25 08:53 install.log</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>chmodï¼šæ›´æ”¹æ–‡ä»¶9ä¸ªå±æ€§ </p>
          </div>
<p>Linuxæ–‡ä»¶å±æ€§æœ‰ä¸¤ç§è®¾ç½®æ–¹æ³•ï¼Œä¸€ç§æ˜¯æ•°å­—ï¼Œä¸€ç§æ˜¯ç¬¦å·ã€‚</p>
<p>Linux æ–‡ä»¶çš„åŸºæœ¬æƒé™å°±æœ‰ä¹ä¸ªï¼Œåˆ†åˆ«æ˜¯ <strong>owner/group/others(æ‹¥æœ‰è€…/ç»„/å…¶ä»–)</strong> ä¸‰ç§èº«ä»½å„æœ‰è‡ªå·±çš„ <strong>read/write/execute</strong> æƒé™ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">chmod [-R] xyz æ–‡ä»¶æˆ–ç›®å½•</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li>xyz : å°±æ˜¯åˆšåˆšæåˆ°çš„æ•°å­—ç±»å‹çš„æƒé™å±æ€§ï¼Œä¸º rwx å±æ€§æ•°å€¼çš„ç›¸åŠ ã€‚</li>
<li>-R : è¿›è¡Œé€’å½’(recursive)çš„æŒç»­å˜æ›´ï¼Œäº¦å³è¿åŒæ¬¡ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šå˜æ›´</li>
</ul>
<div class="note success">
            <p>ç¬¦å·ç±»å‹æ”¹å˜æ–‡ä»¶æƒé™ </p>
          </div>
<p>è¿˜æœ‰ä¸€ä¸ªæ”¹å˜æƒé™çš„æ–¹æ³•ï¼Œä»ä¹‹å‰çš„ä»‹ç»ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒåŸºæœ¬ä¸Šå°±ä¹ä¸ªæƒé™åˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>userï¼šç”¨æˆ·</li>
<li>groupï¼šç»„</li>
<li>othersï¼šå…¶ä»–</li>
</ul>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <strong>u, g, o</strong> æ¥ä»£è¡¨ä¸‰ç§èº«ä»½çš„æƒé™ã€‚æ­¤å¤–ï¼Œ <strong>a</strong> åˆ™ä»£è¡¨ <strong>all</strong>ï¼Œå³å…¨éƒ¨çš„èº«ä»½ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># å°†æ–‡ä»¶æƒé™è®¾ç½®ä¸º **-rwxr-xr--**</span></span><br><span class="line">touch test1    // åˆ›å»º test1 æ–‡ä»¶</span><br><span class="line">ls -al test1    // æŸ¥çœ‹ test1 é»˜è®¤æƒé™</span><br><span class="line">-rw-r--r-- 1 root root 0 Nov 15 10:32 test1</span><br><span class="line">chmod u=rwx,g=rx,o=r  test1    // ä¿®æ”¹ test1 æƒé™</span><br><span class="line">ls -al test1</span><br><span class="line">-rwxr-xr-- 1 root root 0 Nov 15 10:32 test1</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å¯æ‰§è¡Œæƒé™å»æ‰è€Œä¸æ”¹å˜å…¶ä»–å·²å­˜åœ¨çš„æƒé™</span></span><br><span class="line">chmod  a-x test1</span><br><span class="line">ls -al test1</span><br><span class="line">-rw-r--r-- 1 root root 0 Nov 15 10:32 test1</span><br></pre></td></tr></tbody></table></figure>
<h2 id="4ã€æ–‡ä»¶å†…å®¹æŸ¥çœ‹"><a href="#4ã€æ–‡ä»¶å†…å®¹æŸ¥çœ‹" class="headerlink" title="4ã€æ–‡ä»¶å†…å®¹æŸ¥çœ‹"></a>4ã€æ–‡ä»¶å†…å®¹æŸ¥çœ‹</h2><p>Linuxç³»ç»Ÿä¸­ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ï¼š</p>
<ul>
<li>cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</li>
<li>tac ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„å€’ç€å†™ï¼</li>
<li>nl  æ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºé“è¾“å‡ºè¡Œå·ï¼</li>
<li>more ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</li>
<li>less ä¸ more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥å¾€å‰ç¿»é¡µï¼</li>
<li>head åªçœ‹å¤´å‡ è¡Œ</li>
<li>tail åªçœ‹å°¾å·´å‡ è¡Œ</li>
</ul>
<div class="note success">
            <p>cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ </p>
          </div>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">cat [-AbEnTv] æ–‡ä»¶å</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li>-A ï¼šç›¸å½“æ–¼ -vET çš„æ•´åˆé€‰é¡¹ï¼Œå¯åˆ—å‡ºä¸€äº›ç‰¹æ®Šå­—ç¬¦è€Œä¸æ˜¯ç©ºç™½è€Œå·²ï¼›</li>
<li>-b ï¼šåˆ—å‡ºè¡Œå·ï¼Œä»…é’ˆå¯¹éç©ºç™½è¡Œåšè¡Œå·æ˜¾ç¤ºï¼Œç©ºç™½è¡Œä¸æ ‡è¡Œå·ï¼</li>
<li>-E ï¼šå°†ç»“å°¾çš„æ–­è¡Œå­—èŠ‚ $ æ˜¾ç¤ºå‡ºæ¥ï¼›</li>
<li>-n ï¼šåˆ—å°å‡ºè¡Œå·ï¼Œè¿åŒç©ºç™½è¡Œä¹Ÿä¼šæœ‰è¡Œå·ï¼Œä¸ -b çš„é€‰é¡¹ä¸åŒï¼›</li>
<li>-T ï¼šå°† [tab] æŒ‰é”®ä»¥ ^I æ˜¾ç¤ºå‡ºæ¥ï¼›</li>
<li>-v ï¼šåˆ—å‡ºä¸€äº›çœ‹ä¸å‡ºæ¥çš„ç‰¹æ®Šå­—ç¬¦</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># æ£€çœ‹ /etc/issue è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼š</span></span><br><span class="line">cat /etc/issue</span><br><span class="line">CentOS release 6.4 (Final)</span><br><span class="line">Kernel \r on an \m</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>tacï¼Œä¸catå‘½ä»¤åˆšå¥½ç›¸åï¼Œæ–‡ä»¶å†…å®¹ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„å€’ç€å†™ï¼ </p>
          </div>
<p>è¯­æ³•åŒ <code>cat</code></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># æ£€çœ‹ /etc/issue è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼š</span></span><br><span class="line">tac /etc/issue</span><br><span class="line">Kernel \r on an \m</span><br><span class="line">CentOS release 6.4 (Final)</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>nl æ˜¾ç¤ºè¡Œå· </p>
          </div>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">nl [-bnw] æ–‡ä»¶</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li>-b ï¼šæŒ‡å®šè¡Œå·æŒ‡å®šçš„æ–¹å¼ï¼Œä¸»è¦æœ‰ä¸¤ç§ï¼š<ul>
<li>-b a ï¼šè¡¨ç¤ºä¸è®ºæ˜¯å¦ä¸ºç©ºè¡Œï¼Œä¹ŸåŒæ ·åˆ—å‡ºè¡Œå·(ç±»ä¼¼ cat -n)ï¼›</li>
<li>-b t ï¼šå¦‚æœæœ‰ç©ºè¡Œï¼Œç©ºçš„é‚£ä¸€è¡Œä¸è¦åˆ—å‡ºè¡Œå·(é»˜è®¤å€¼)ï¼›</li>
</ul>
</li>
<li>-n ï¼šåˆ—å‡ºè¡Œå·è¡¨ç¤ºçš„æ–¹æ³•ï¼Œä¸»è¦æœ‰ä¸‰ç§ï¼š<ul>
<li>-n ln ï¼šè¡Œå·åœ¨è§å¹•çš„æœ€å·¦æ–¹æ˜¾ç¤ºï¼›</li>
<li>-n rn ï¼šè¡Œå·åœ¨è‡ªå·±æ ä½çš„æœ€å³æ–¹æ˜¾ç¤ºï¼Œä¸”ä¸åŠ  0 ï¼›</li>
<li>-n rz ï¼šè¡Œå·åœ¨è‡ªå·±æ ä½çš„æœ€å³æ–¹æ˜¾ç¤ºï¼Œä¸”åŠ  0 ï¼›</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># ç”¨ nl åˆ—å‡º /etc/issue çš„å†…å®¹</span></span><br><span class="line">nl /etc/issue</span><br><span class="line">1  CentOS release 6.4 (Final)</span><br><span class="line">2  Kernel \r on an \m</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>more ä¸€é¡µä¸€é¡µç¿»åŠ¨ </p>
          </div>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">more æ–‡ä»¶å</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># ç¿»çœ‹/etc/man_db.configæ–‡ä»¶</span></span><br><span class="line">more /etc/man_db.config </span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Generated automatically from man.conf.in by the</span></span><br><span class="line"><span class="comment"># configure script.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># man.conf from man-1.6d</span></span><br><span class="line">....(ä¸­é—´çœç•¥)....</span><br><span class="line">--More--(28%)  &lt;== é‡ç‚¹åœ¨è¿™ä¸€è¡Œå–”ï¼ä½ çš„å…‰æ ‡ä¹Ÿä¼šåœ¨è¿™é‡Œç­‰å¾…ä½ çš„å‘½ä»¤</span><br></pre></td></tr></tbody></table></figure>
<p>åœ¨ more è¿™ä¸ªç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä½ æœ‰å‡ ä¸ªæŒ‰é”®å¯ä»¥æŒ‰çš„ï¼š</p>
<ul>
<li>ç©ºç™½é”® (space)ï¼šä»£è¡¨å‘ä¸‹ç¿»ä¸€é¡µï¼›</li>
<li>Enter     ï¼šä»£è¡¨å‘ä¸‹ç¿»ã€ä¸€è¡Œã€ï¼›</li>
<li>/å­—ä¸²     ï¼šä»£è¡¨åœ¨è¿™ä¸ªæ˜¾ç¤ºçš„å†…å®¹å½“ä¸­ï¼Œå‘ä¸‹æœå¯»ã€å­—ä¸²ã€è¿™ä¸ªå…³é”®å­—ï¼›</li>
<li>:f      ï¼šç«‹åˆ»æ˜¾ç¤ºå‡ºæ¡£åä»¥åŠç›®å‰æ˜¾ç¤ºçš„è¡Œæ•°ï¼›</li>
<li>q       ï¼šä»£è¡¨ç«‹åˆ»ç¦»å¼€ more ï¼Œä¸å†æ˜¾ç¤ºè¯¥æ–‡ä»¶å†…å®¹ã€‚</li>
<li>b æˆ– [ctrl]-b ï¼šä»£è¡¨å¾€å›ç¿»é¡µï¼Œä¸è¿‡è¿™åŠ¨ä½œåªå¯¹æ–‡ä»¶æœ‰ç”¨ï¼Œå¯¹ç®¡çº¿æ— ç”¨ã€‚</li>
</ul>
<div class="note success">
            <p>less ä¸€é¡µä¸€é¡µç¿»åŠ¨ï¼Œæ¯” more åŠŸèƒ½æ›´å¼ºå¤§ </p>
          </div>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">less æ–‡ä»¶å</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">less /etc/man.config</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Generated automatically from man.conf.in by the</span></span><br><span class="line"><span class="comment"># configure script.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># man.conf from man-1.6d</span></span><br><span class="line">....(ä¸­é—´çœç•¥)....</span><br><span class="line">:   &lt;== è¿™é‡Œå¯ä»¥ç­‰å¾…ä½ è¾“å…¥å‘½ä»¤ï¼</span><br></pre></td></tr></tbody></table></figure>
<p>lessè¿è¡Œæ—¶å¯ä»¥è¾“å…¥çš„å‘½ä»¤æœ‰ï¼š</p>
<ul>
<li>ç©ºç™½é”®  ï¼šå‘ä¸‹ç¿»åŠ¨ä¸€é¡µï¼›</li>
<li>[pagedown]ï¼šå‘ä¸‹ç¿»åŠ¨ä¸€é¡µï¼›</li>
<li>[pageup] ï¼šå‘ä¸Šç¿»åŠ¨ä¸€é¡µï¼›</li>
<li>/å­—ä¸²   ï¼šå‘ä¸‹æœå¯»ã€å­—ä¸²ã€çš„åŠŸèƒ½ï¼›</li>
<li>?å­—ä¸²   ï¼šå‘ä¸Šæœå¯»ã€å­—ä¸²ã€çš„åŠŸèƒ½ï¼›</li>
<li>n     ï¼šé‡å¤å‰ä¸€ä¸ªæœå¯» (ä¸ / æˆ– ? æœ‰å…³ï¼)</li>
<li>N     ï¼šåå‘çš„é‡å¤å‰ä¸€ä¸ªæœå¯» (ä¸ / æˆ– ? æœ‰å…³ï¼)</li>
<li>q     ï¼šç¦»å¼€ less è¿™ä¸ªç¨‹åºï¼›</li>
</ul>
<div class="note success">
            <p>head å–å‡ºæ–‡ä»¶å‰é¢å‡ è¡Œ </p>
          </div>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">head [-n number] æ–‡ä»¶ </span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li>-n ï¼šåé¢æ¥æ•°å­—ï¼Œä»£è¡¨æ˜¾ç¤ºå‡ è¡Œçš„æ„æ€</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤çš„æƒ…å†µä¸­ï¼Œæ˜¾ç¤ºå‰é¢ 10 è¡Œï¼è‹¥è¦æ˜¾ç¤ºå‰ 20 è¡Œï¼Œå°±å¾—è¦è¿™æ ·ï¼š</span></span><br><span class="line">head -n 20 /etc/man.config</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>tail å–å‡ºæ–‡ä»¶åé¢å‡ è¡Œ </p>
          </div>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">tail [-n number] æ–‡ä»¶ </span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li>-n ï¼šåé¢æ¥æ•°å­—ï¼Œä»£è¡¨æ˜¾ç¤ºå‡ è¡Œçš„æ„æ€</li>
<li>-f ï¼šè¡¨ç¤ºæŒç»­ä¾¦æµ‹åé¢æ‰€æ¥çš„æ¡£åï¼Œè¦ç­‰åˆ°æŒ‰ä¸‹[ctrl]-cæ‰ä¼šç»“æŸtailçš„ä¾¦æµ‹</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤çš„æƒ…å†µä¸­ï¼Œæ˜¾ç¤ºå‰é¢ 10 è¡Œï¼è‹¥è¦æ˜¾ç¤ºå‰ 20 è¡Œï¼Œå°±å¾—è¦è¿™æ ·ï¼š</span></span><br><span class="line">tail -n 20 /etc/man.config</span><br></pre></td></tr></tbody></table></figure>
<h2 id="5ã€è½¯é“¾æ¥å’Œç¡¬é“¾æ¥"><a href="#5ã€è½¯é“¾æ¥å’Œç¡¬é“¾æ¥" class="headerlink" title="5ã€è½¯é“¾æ¥å’Œç¡¬é“¾æ¥"></a>5ã€è½¯é“¾æ¥å’Œç¡¬é“¾æ¥</h2><p>Linux é“¾æ¥åˆ†ä¸¤ç§ï¼Œä¸€ç§è¢«ç§°ä¸ºç¡¬é“¾æ¥ï¼ˆHard Linkï¼‰ï¼Œå¦ä¸€ç§è¢«ç§°ä¸ºç¬¦å·é“¾æ¥ï¼ˆSymbolic Linkï¼‰ï¼Œä¹Ÿè¢«ç§°ä½œè½¯è¿æ¥ã€‚<strong>é»˜è®¤æƒ…å†µä¸‹ï¼Œ <code>ln</code> å‘½ä»¤äº§ç”Ÿçš„æ˜¯ç¡¬é“¾æ¥ï¼Œä½¿ç”¨ -s åˆ›å»ºè½¯é“¾æ¥ã€‚</strong></p>
<h4 id="5-1ã€ç¡¬é“¾æ¥"><a href="#5-1ã€ç¡¬é“¾æ¥" class="headerlink" title="5.1ã€ç¡¬é“¾æ¥"></a><strong><font size="5px">5.1ã€ç¡¬é“¾æ¥</font></strong></h4><p>ç¡¬è¿æ¥æŒ‡é€šè¿‡ç´¢å¼•èŠ‚ç‚¹æ¥è¿›è¡Œè¿æ¥ã€‚åœ¨ Linux çš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¿å­˜åœ¨ç£ç›˜åˆ†åŒºä¸­çš„æ–‡ä»¶ä¸ç®¡æ˜¯ä»€ä¹ˆç±»å‹éƒ½ç»™å®ƒåˆ†é…ä¸€ä¸ªç¼–å·ï¼Œç§°ä¸ºç´¢å¼•èŠ‚ç‚¹å·(Inode Index)ã€‚åœ¨ Linux ä¸­ï¼Œå¤šä¸ªæ–‡ä»¶åæŒ‡å‘åŒä¸€ç´¢å¼•èŠ‚ç‚¹æ˜¯å­˜åœ¨çš„ã€‚æ¯”å¦‚ï¼šA æ˜¯ B çš„ç¡¬é“¾æ¥ï¼ˆA å’Œ B éƒ½æ˜¯æ–‡ä»¶åï¼‰ï¼Œåˆ™ A çš„ç›®å½•é¡¹ä¸­çš„ inode èŠ‚ç‚¹å·ä¸ B çš„ç›®å½•é¡¹ä¸­çš„ inode èŠ‚ç‚¹å·ç›¸åŒï¼Œå³ä¸€ä¸ª inode èŠ‚ç‚¹å¯¹åº”ä¸¤ä¸ªä¸åŒçš„æ–‡ä»¶åï¼Œä¸¤ä¸ªæ–‡ä»¶åæŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶ï¼ŒA å’Œ B å¯¹æ–‡ä»¶ç³»ç»Ÿæ¥è¯´æ˜¯å®Œå…¨å¹³ç­‰çš„ã€‚<strong>åˆ é™¤å…¶ä¸­ä»»ä½•ä¸€ä¸ªéƒ½ä¸ä¼šå½±å“å¦å¤–ä¸€ä¸ªçš„è®¿é—®ã€‚</strong></p>
<p>ç¡¬è¿æ¥çš„ä½œç”¨æ˜¯å…è®¸ä¸€ä¸ªæ–‡ä»¶æ‹¥æœ‰å¤šä¸ªæœ‰æ•ˆè·¯å¾„åï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥å»ºç«‹ç¡¬è¿æ¥åˆ°é‡è¦æ–‡ä»¶ï¼Œä»¥é˜²æ­¢â€œè¯¯åˆ â€çš„åŠŸèƒ½ã€‚å…¶åŸå› å¦‚ä¸Šæ‰€è¿°ï¼Œå› ä¸ºå¯¹åº”è¯¥ç›®å½•çš„ç´¢å¼•èŠ‚ç‚¹æœ‰ä¸€ä¸ªä»¥ä¸Šçš„è¿æ¥ã€‚<strong>åªåˆ é™¤ä¸€ä¸ªè¿æ¥å¹¶ä¸å½±å“ç´¢å¼•èŠ‚ç‚¹æœ¬èº«å’Œå…¶å®ƒçš„è¿æ¥ï¼Œåªæœ‰å½“æœ€åä¸€ä¸ªè¿æ¥è¢«åˆ é™¤åï¼Œæ–‡ä»¶çš„æ•°æ®å—åŠç›®å½•çš„è¿æ¥æ‰ä¼šè¢«é‡Šæ”¾ã€‚</strong>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–‡ä»¶çœŸæ­£åˆ é™¤çš„æ¡ä»¶æ˜¯ä¸ä¹‹ç›¸å…³çš„æ‰€æœ‰ç¡¬è¿æ¥æ–‡ä»¶å‡è¢«åˆ é™¤ã€‚</p>
<h4 id="5-2ã€è½¯é“¾æ¥"><a href="#5-2ã€è½¯é“¾æ¥" class="headerlink" title="5.2ã€è½¯é“¾æ¥"></a><strong><font size="5px">5.2ã€è½¯é“¾æ¥</font></strong></h4><p>å¦å¤–ä¸€ç§è¿æ¥ç§°ä¹‹ä¸ºç¬¦å·è¿æ¥ï¼ˆSymbolic Linkï¼‰ï¼Œä¹Ÿå«è½¯è¿æ¥ã€‚è½¯é“¾æ¥æ–‡ä»¶æœ‰ç±»ä¼¼äº Windows çš„å¿«æ·æ–¹å¼ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ã€‚åœ¨ç¬¦å·è¿æ¥ä¸­ï¼Œæ–‡ä»¶å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«çš„æœ‰å¦ä¸€æ–‡ä»¶çš„ä½ç½®ä¿¡æ¯ã€‚æ¯”å¦‚ï¼šA æ˜¯ B çš„è½¯é“¾æ¥ï¼ˆA å’Œ B éƒ½æ˜¯æ–‡ä»¶åï¼‰ï¼ŒA çš„ç›®å½•é¡¹ä¸­çš„ inode èŠ‚ç‚¹å·ä¸ B çš„ç›®å½•é¡¹ä¸­çš„ inode èŠ‚ç‚¹å·ä¸ç›¸åŒï¼ŒA å’Œ B æŒ‡å‘çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„ inodeï¼Œç»§è€ŒæŒ‡å‘ä¸¤å—ä¸åŒçš„æ•°æ®å—ã€‚<strong>ä½†æ˜¯ A çš„æ•°æ®å—ä¸­å­˜æ”¾çš„åªæ˜¯ B çš„è·¯å¾„åï¼ˆå¯ä»¥æ ¹æ®è¿™ä¸ªæ‰¾åˆ° B çš„ç›®å½•é¡¹ï¼‰</strong>ã€‚A å’Œ B ä¹‹é—´æ˜¯â€œä¸»ä»â€å…³ç³»ï¼Œå¦‚æœ B è¢«åˆ é™¤äº†ï¼ŒA ä»ç„¶å­˜åœ¨ï¼ˆå› ä¸ºä¸¤ä¸ªæ˜¯ä¸åŒçš„æ–‡ä»¶ï¼‰ï¼Œä½†æŒ‡å‘çš„æ˜¯ä¸€ä¸ªæ— æ•ˆçš„é“¾æ¥ã€‚</p>
<h4 id="5-3ã€ç¡¬é“¾æ¥ã€è½¯é“¾æ¥ä»¥åŠå¤åˆ¶çš„åŒºåˆ«"><a href="#5-3ã€ç¡¬é“¾æ¥ã€è½¯é“¾æ¥ä»¥åŠå¤åˆ¶çš„åŒºåˆ«" class="headerlink" title="5.3ã€ç¡¬é“¾æ¥ã€è½¯é“¾æ¥ä»¥åŠå¤åˆ¶çš„åŒºåˆ«"></a><strong><font size="5px">5.3ã€ç¡¬é“¾æ¥ã€è½¯é“¾æ¥ä»¥åŠå¤åˆ¶çš„åŒºåˆ«</font></strong></h4><p>ç°æœ‰åŸæ–‡ä»¶ test1ï¼Œç¡¬é“¾æ¥ test2ï¼Œè½¯é“¾æ¥ test3ï¼Œå‰¯æœ¬ test4</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">touch test1			<span class="comment"># åˆ›å»ºtest1</span></span><br><span class="line">ln test1 test2		<span class="comment"># åˆ›å»ºtest1çš„ç¡¬é“¾æ¥test2</span></span><br><span class="line">ln -s test1 test3	<span class="comment"># åˆ›å»ºtest1çš„è½¯é“¾æ¥test3</span></span><br><span class="line">cp test1 test4		<span class="comment"># åˆ›å»ºtest1çš„å‰¯æœ¬test3</span></span><br><span class="line">ls</span><br><span class="line">test1  test2  test3  test4</span><br></pre></td></tr></tbody></table></figure>
<p>ç¡¬é“¾æ¥ test2 å°±ç›¸å½“äºåˆåˆ›å»ºäº†ä¸€ä¸ªå¼•ç”¨ï¼ŒæŒ‡å‘æ–‡ä»¶åœ°å€ï¼Œå› æ­¤åˆ é™¤å…¶ä¸­ä»»ä½•ä¸€ä¸ªéƒ½ä¸ä¼šå½±å“å¦ä¸€ä¸ªçš„è®¿é—®ï¼›</p>
<p>è€Œè½¯é“¾æ¥åˆ™ç±»ä¼¼ Windows çš„å¿«æ·æ–¹å¼ï¼ŒæŒ‡å‘ test1ï¼Œå¦‚æœæ­¤æ—¶ test1 è¢«åˆ é™¤ï¼Œé‚£ä¹ˆè¯¥è½¯è¿æ¥ test3 ä¾¿æˆä¸ºäº†<code>æ— æ•ˆçš„é“¾æ¥</code>ã€‚</p>
<p>å¤åˆ¶åˆ™æ˜¯åœ¨ç‰©ç†ç£ç›˜ä¸Šå¼€è¾Ÿäº†ä¸€ä¸ªæ–°çš„ç©ºé—´ï¼Œå°†æ–‡ä»¶å†…å®¹å†™å…¥ã€‚</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p><img src="https://z3.ax1x.com/2021/11/22/IxkF29.png" alt=""></p>
<p>ä¸‹é¢è®©æˆ‘ä»¬éªŒè¯ä¸€ä¸‹</p>
<p>å¾€ test1 ä¸­å†™å…¥å†…å®¹ <strong>â€œç´«æ¢¦æ²é¦™ï¼šå¤§å®¶å¥½â€</strong>ï¼Œå¯ä»¥å‘ç° test2 å’Œ test3 ä¸­ä¹Ÿèƒ½æŸ¥çœ‹åˆ°å†™å…¥çš„å†…å®¹ï¼Œè€Œ test4 å´ä¸è¡Œã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/22/IxiJSA.png" alt=""></p>
<p>è€Œåæˆ‘ä»¬åˆ é™¤ test1 æ–‡ä»¶ï¼Œls å¯ä»¥å‘ç° test3 å˜æˆäº†çº¢è‰²ï¼Œå³æ— æ•ˆé“¾æ¥ï¼Œä½† test2 å´èƒ½æ­£å¸¸æŸ¥çœ‹å†…å®¹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/22/IxFFnP.png" alt=""></p>
<h2 id="6ã€vi-vim"><a href="#6ã€vi-vim" class="headerlink" title="6ã€vi/vim"></a>6ã€vi/vim</h2><p>æ‰€æœ‰çš„ç±» Unix ç³»ç»Ÿéƒ½ä¼šå†…å»º vi æ–‡ä¹¦ç¼–è¾‘å™¨ï¼Œå…¶ä»–çš„æ–‡ä¹¦ç¼–è¾‘å™¨åˆ™ä¸ä¸€å®šä¼šå­˜åœ¨ã€‚</p>
<p>ä½†æ˜¯ç›®å‰æˆ‘ä»¬ä½¿ç”¨æ¯”è¾ƒå¤šçš„æ˜¯ vim ç¼–è¾‘å™¨ã€‚</p>
<p>vim å…·æœ‰ç¨‹åºç¼–è¾‘çš„èƒ½åŠ›ï¼Œå¯ä»¥ä¸»åŠ¨çš„ä»¥å­—ä½“é¢œè‰²è¾¨åˆ«è¯­æ³•çš„æ­£ç¡®æ€§ï¼Œæ–¹ä¾¿ç¨‹åºè®¾è®¡ã€‚</p>
<h4 id="6-1ã€ä»€ä¹ˆæ˜¯-vim"><a href="#6-1ã€ä»€ä¹ˆæ˜¯-vim" class="headerlink" title="6.1ã€ä»€ä¹ˆæ˜¯ vim?"></a><strong><font size="5px">6.1ã€ä»€ä¹ˆæ˜¯ vim?</font></strong></h4><p>Vim æ˜¯ä» vi å‘å±•å‡ºæ¥çš„ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ã€‚ä»£ç è¡¥å…¨ã€ç¼–è¯‘åŠé”™è¯¯è·³è½¬ç­‰æ–¹ä¾¿ç¼–ç¨‹çš„åŠŸèƒ½ç‰¹åˆ«ä¸°å¯Œï¼Œåœ¨ç¨‹åºå‘˜ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚</p>
<p>ç®€å•çš„æ¥è¯´ï¼Œ vi æ˜¯è€å¼çš„å­—å¤„ç†å™¨ï¼Œä¸è¿‡åŠŸèƒ½å·²ç»å¾ˆé½å…¨äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å¯ä»¥è¿›æ­¥çš„åœ°æ–¹ã€‚ vim åˆ™å¯ä»¥è¯´æ˜¯ç¨‹åºå¼€å‘è€…çš„ä¸€é¡¹å¾ˆå¥½ç”¨çš„å·¥å…·ã€‚</p>
<p>è¿ vim çš„å®˜æ–¹ç½‘ç«™ (<a href="http://www.vim.org/">http://www.vim.org</a>) è‡ªå·±ä¹Ÿè¯´ vim æ˜¯ä¸€ä¸ªç¨‹åºå¼€å‘å·¥å…·è€Œä¸æ˜¯æ–‡å­—å¤„ç†è½¯ä»¶ã€‚</p>
<p>vim é”®ç›˜å›¾ï¼š</p>
<p><img src="https://z3.ax1x.com/2021/11/22/Ix3Pjf.png" alt=""></p>
<h4 id="6-2ã€vi-vim-çš„ä½¿ç”¨"><a href="#6-2ã€vi-vim-çš„ä½¿ç”¨" class="headerlink" title="6.2ã€vi/vim çš„ä½¿ç”¨"></a><strong><font size="5px">6.2ã€vi/vim çš„ä½¿ç”¨</font></strong></h4><p>åŸºæœ¬ä¸Š vi/vim å…±åˆ†ä¸ºä¸‰ç§æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯<strong>å‘½ä»¤æ¨¡å¼ï¼ˆCommand modeï¼‰</strong>ï¼Œ<strong>è¾“å…¥æ¨¡å¼ï¼ˆInsert modeï¼‰</strong>å’Œ<strong>åº•çº¿å‘½ä»¤æ¨¡å¼ï¼ˆLast line modeï¼‰</strong>ã€‚ è¿™ä¸‰ç§æ¨¡å¼çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼š</p>
<font size="4px">**å‘½ä»¤æ¨¡å¼ï¼š**</font>

<p>ç”¨æˆ·åˆšåˆšå¯åŠ¨ vi/vimï¼Œä¾¿è¿›å…¥äº†å‘½ä»¤æ¨¡å¼ã€‚</p>
<p>æ­¤çŠ¶æ€ä¸‹æ•²å‡»é”®ç›˜åŠ¨ä½œä¼šè¢«Vimè¯†åˆ«ä¸ºå‘½ä»¤ï¼Œè€Œéè¾“å…¥å­—ç¬¦ã€‚æ¯”å¦‚æˆ‘ä»¬æ­¤æ—¶æŒ‰ä¸‹iï¼Œå¹¶ä¸ä¼šè¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œiè¢«å½“ä½œäº†ä¸€ä¸ªå‘½ä»¤ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å¸¸ç”¨çš„å‡ ä¸ªå‘½ä»¤ï¼š</p>
<ul>
<li><strong>i</strong> åˆ‡æ¢åˆ°è¾“å…¥æ¨¡å¼ï¼Œä»¥è¾“å…¥å­—ç¬¦ã€‚</li>
<li><strong>x</strong> åˆ é™¤å½“å‰å…‰æ ‡æ‰€åœ¨å¤„çš„å­—ç¬¦ã€‚</li>
<li><strong>:</strong> åˆ‡æ¢åˆ°åº•çº¿å‘½ä»¤æ¨¡å¼ï¼Œä»¥åœ¨æœ€åº•ä¸€è¡Œè¾“å…¥å‘½ä»¤ã€‚</li>
</ul>
<p>è‹¥æƒ³è¦ç¼–è¾‘æ–‡æœ¬ï¼šå¯åŠ¨Vimï¼Œè¿›å…¥äº†å‘½ä»¤æ¨¡å¼ï¼ŒæŒ‰ä¸‹iï¼Œåˆ‡æ¢åˆ°è¾“å…¥æ¨¡å¼ã€‚</p>
<p>å‘½ä»¤æ¨¡å¼åªæœ‰ä¸€äº›æœ€åŸºæœ¬çš„å‘½ä»¤ï¼Œå› æ­¤ä»è¦ä¾é åº•çº¿å‘½ä»¤æ¨¡å¼è¾“å…¥æ›´å¤šå‘½ä»¤ã€‚</p>
<font size="4px">**è¾“å…¥æ¨¡å¼ï¼š**</font>

<p>åœ¨å‘½ä»¤æ¨¡å¼ä¸‹æŒ‰ä¸‹iå°±è¿›å…¥äº†è¾“å…¥æ¨¡å¼ã€‚</p>
<p>åœ¨è¾“å…¥æ¨¡å¼ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‰é”®ï¼š</p>
<ul>
<li><strong>å­—ç¬¦æŒ‰é”®ä»¥åŠ Shift ç»„åˆ</strong>ï¼Œè¾“å…¥å­—ç¬¦</li>
<li><strong>ENTER</strong>ï¼Œå›è½¦é”®ï¼Œæ¢è¡Œ</li>
<li><strong>BACK SPACE</strong>ï¼Œé€€æ ¼é”®ï¼Œåˆ é™¤å…‰æ ‡å‰ä¸€ä¸ªå­—ç¬¦</li>
<li><strong>DEL</strong>ï¼Œåˆ é™¤é”®ï¼Œåˆ é™¤å…‰æ ‡åä¸€ä¸ªå­—ç¬¦</li>
<li><strong>æ–¹å‘é”®</strong>ï¼Œåœ¨æ–‡æœ¬ä¸­ç§»åŠ¨å…‰æ ‡</li>
<li><strong>HOME</strong>/<strong>END</strong>ï¼Œç§»åŠ¨å…‰æ ‡åˆ°è¡Œé¦–/è¡Œå°¾</li>
<li><strong>Page Up</strong>/<strong>Page Down</strong>ï¼Œä¸Š/ä¸‹ç¿»é¡µ</li>
<li><strong>Insert</strong>ï¼Œåˆ‡æ¢å…‰æ ‡ä¸ºè¾“å…¥/æ›¿æ¢æ¨¡å¼ï¼Œå…‰æ ‡å°†å˜æˆç«–çº¿/ä¸‹åˆ’çº¿</li>
<li><strong>ESC</strong>ï¼Œé€€å‡ºè¾“å…¥æ¨¡å¼ï¼Œåˆ‡æ¢åˆ°å‘½ä»¤æ¨¡å¼</li>
</ul>
<font size="4px">**åº•çº¿å‘½ä»¤æ¨¡å¼ï¼š**</font>

<p>åœ¨å‘½ä»¤æ¨¡å¼ä¸‹æŒ‰ä¸‹:ï¼ˆè‹±æ–‡å†’å·ï¼‰å°±è¿›å…¥äº†åº•çº¿å‘½ä»¤æ¨¡å¼ã€‚</p>
<p>åº•çº¿å‘½ä»¤æ¨¡å¼å¯ä»¥è¾“å…¥å•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦çš„å‘½ä»¤ï¼Œå¯ç”¨çš„å‘½ä»¤éå¸¸å¤šã€‚</p>
<p>åœ¨åº•çº¿å‘½ä»¤æ¨¡å¼ä¸­ï¼ŒåŸºæœ¬çš„å‘½ä»¤æœ‰ï¼ˆå·²ç»çœç•¥äº†å†’å·ï¼‰ï¼š</p>
<ul>
<li>q é€€å‡ºç¨‹åº</li>
<li>w ä¿å­˜æ–‡ä»¶</li>
</ul>
<p>æŒ‰ESCé”®å¯éšæ—¶é€€å‡ºåº•çº¿å‘½ä»¤æ¨¡å¼ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/22/Ix3DbD.png" alt=""></p>
<h4 id="6-3ã€vi-vim-æŒ‰é”®è¯´æ˜"><a href="#6-3ã€vi-vim-æŒ‰é”®è¯´æ˜" class="headerlink" title="6.3ã€vi/vim æŒ‰é”®è¯´æ˜"></a><strong><font size="5px">6.3ã€vi/vim æŒ‰é”®è¯´æ˜</font></strong></h4><font size="4px">**å‘½ä»¤æ¨¡å¼ï¼š**</font>

<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">ç§»åŠ¨å…‰æ ‡çš„æ–¹æ³•</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">h æˆ– å‘å·¦ç®­å¤´é”®(â†)</td>
<td>å…‰æ ‡å‘å·¦ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">j æˆ– å‘ä¸‹ç®­å¤´é”®(â†“)</td>
<td>å…‰æ ‡å‘ä¸‹ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">k æˆ– å‘ä¸Šç®­å¤´é”®(â†‘)</td>
<td>å…‰æ ‡å‘ä¸Šç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">l æˆ– å‘å³ç®­å¤´é”®(â†’)</td>
<td>å…‰æ ‡å‘å³ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">[Ctrl] + [f]</td>
<td>å±å¹•ã€å‘ä¸‹ã€ç§»åŠ¨ä¸€é¡µï¼Œç›¸å½“äº [Page Down]æŒ‰é”® (å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">[Ctrl] + [b]</td>
<td>å±å¹•ã€å‘ä¸Šã€ç§»åŠ¨ä¸€é¡µï¼Œç›¸å½“äº [Page Up] æŒ‰é”® (å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">[Ctrl] + [d]</td>
<td>å±å¹•ã€å‘ä¸‹ã€ç§»åŠ¨åŠé¡µ</td>
</tr>
<tr>
<td style="text-align:left">[Ctrl] + [u]</td>
<td>å±å¹•ã€å‘ä¸Šã€ç§»åŠ¨åŠé¡µ</td>
</tr>
<tr>
<td style="text-align:left">+</td>
<td>å…‰æ ‡ç§»åŠ¨åˆ°éç©ºæ ¼ç¬¦çš„ä¸‹ä¸€è¡Œ</td>
</tr>
<tr>
<td style="text-align:left">-</td>
<td>å…‰æ ‡ç§»åŠ¨åˆ°éç©ºæ ¼ç¬¦çš„ä¸Šä¸€è¡Œ</td>
</tr>
<tr>
<td style="text-align:left">n<space></space></td>
<td>é‚£ä¸ª n è¡¨ç¤ºã€æ•°å­—ã€ï¼Œä¾‹å¦‚ 20 ã€‚æŒ‰ä¸‹æ•°å­—åå†æŒ‰ç©ºæ ¼é”®ï¼Œå…‰æ ‡ä¼šå‘å³ç§»åŠ¨è¿™ä¸€è¡Œçš„ n ä¸ªå­—ç¬¦ã€‚ä¾‹å¦‚ 20<space> åˆ™å…‰æ ‡ä¼šå‘åé¢ç§»åŠ¨ 20 ä¸ªå­—ç¬¦è·ç¦»ã€‚</space></td>
</tr>
<tr>
<td style="text-align:left">0 æˆ–åŠŸèƒ½é”®[Home]</td>
<td>è¿™æ˜¯æ•°å­—ã€ 0 ã€ï¼šç§»åŠ¨åˆ°è¿™ä¸€è¡Œçš„æœ€å‰é¢å­—ç¬¦å¤„ (å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">$ æˆ–åŠŸèƒ½é”®[End]</td>
<td>ç§»åŠ¨åˆ°è¿™ä¸€è¡Œçš„æœ€åé¢å­—ç¬¦å¤„(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">H</td>
<td>å…‰æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„æœ€ä¸Šæ–¹é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">M</td>
<td>å…‰æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„ä¸­å¤®é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">L</td>
<td>å…‰æ ‡ç§»åŠ¨åˆ°è¿™ä¸ªå±å¹•çš„æœ€ä¸‹æ–¹é‚£ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">G</td>
<td>ç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„æœ€åä¸€è¡Œ(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">nG</td>
<td>n ä¸ºæ•°å­—ã€‚ç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„ç¬¬ n è¡Œã€‚ä¾‹å¦‚ 20G åˆ™ä¼šç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„ç¬¬ 20 è¡Œ(å¯é…åˆ :set nu)</td>
</tr>
<tr>
<td style="text-align:left">gg</td>
<td>ç§»åŠ¨åˆ°è¿™ä¸ªæ¡£æ¡ˆçš„ç¬¬ä¸€è¡Œï¼Œç›¸å½“äº 1G å•Šï¼ (å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">n<enter></enter></td>
<td>n ä¸ºæ•°å­—ã€‚å…‰æ ‡å‘ä¸‹ç§»åŠ¨ n è¡Œ(å¸¸ç”¨)</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">æœç´¢æ›¿æ¢</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">/word</td>
<td>å‘å…‰æ ‡ä¹‹ä¸‹å¯»æ‰¾ä¸€ä¸ªåç§°ä¸º word çš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚è¦åœ¨æ¡£æ¡ˆå†…æœå¯» vbird è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå°±è¾“å…¥ /vbird å³å¯ï¼ (å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">?word</td>
<td>å‘å…‰æ ‡ä¹‹ä¸Šå¯»æ‰¾ä¸€ä¸ªå­—ç¬¦ä¸²åç§°ä¸º word çš„å­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td style="text-align:left">n</td>
<td>è¿™ä¸ª n æ˜¯è‹±æ–‡æŒ‰é”®ã€‚ä»£è¡¨é‡å¤å‰ä¸€ä¸ªæœå¯»çš„åŠ¨ä½œã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œ å¦‚æœåˆšåˆšæˆ‘ä»¬æ‰§è¡Œ /vbird å»å‘ä¸‹æœå¯» vbird è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™æŒ‰ä¸‹ n åï¼Œä¼šå‘ä¸‹ç»§ç»­æœå¯»ä¸‹ä¸€ä¸ªåç§°ä¸º vbird çš„å­—ç¬¦ä¸²ã€‚å¦‚æœæ˜¯æ‰§è¡Œ ?vbird çš„è¯ï¼Œé‚£ä¹ˆæŒ‰ä¸‹ n åˆ™ä¼šå‘ä¸Šç»§ç»­æœå¯»åç§°ä¸º vbird çš„å­—ç¬¦ä¸²ï¼</td>
</tr>
<tr>
<td style="text-align:left">N</td>
<td>è¿™ä¸ª N æ˜¯è‹±æ–‡æŒ‰é”®ã€‚ä¸ n åˆšå¥½ç›¸åï¼Œä¸ºã€åå‘ã€è¿›è¡Œå‰ä¸€ä¸ªæœå¯»åŠ¨ä½œã€‚ ä¾‹å¦‚ /vbird åï¼ŒæŒ‰ä¸‹ N åˆ™è¡¨ç¤ºã€å‘ä¸Šã€æœå¯» vbird ã€‚</td>
</tr>
<tr>
<td style="text-align:left">:n1,n2s/word1/word2/g</td>
<td>n1 ä¸ n2 ä¸ºæ•°å­—ã€‚åœ¨ç¬¬ n1 ä¸ n2 è¡Œä¹‹é—´å¯»æ‰¾ word1 è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶å°†è¯¥å­—ç¬¦ä¸²å–ä»£ä¸º word2 ï¼ä¸¾ä¾‹æ¥è¯´ï¼Œåœ¨ 100 åˆ° 200 è¡Œä¹‹é—´æœå¯» vbird å¹¶å–ä»£ä¸º VBIRD åˆ™ï¼š ã€:100,200s/vbird/VBIRD/gã€ã€‚(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left"><strong>:1,$s/word1/word2/g</strong> æˆ– <strong>:%s/word1/word2/g</strong></td>
<td>ä»ç¬¬ä¸€è¡Œåˆ°æœ€åä¸€è¡Œå¯»æ‰¾ word1 å­—ç¬¦ä¸²ï¼Œå¹¶å°†è¯¥å­—ç¬¦ä¸²å–ä»£ä¸º word2 ï¼(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left"><strong>:1,$s/word1/word2/gc</strong> æˆ– <strong>:%s/word1/word2/gc</strong></td>
<td>ä»ç¬¬ä¸€è¡Œåˆ°æœ€åä¸€è¡Œå¯»æ‰¾ word1 å­—ç¬¦ä¸²ï¼Œå¹¶å°†è¯¥å­—ç¬¦ä¸²å–ä»£ä¸º word2 ï¼ä¸”åœ¨å–ä»£å‰æ˜¾ç¤ºæç¤ºå­—ç¬¦ç»™ç”¨æˆ·ç¡®è®¤ (confirm) æ˜¯å¦éœ€è¦å–ä»£ï¼(å¸¸ç”¨)</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">åˆ é™¤ã€å¤åˆ¶ä¸è´´ä¸Š</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">x, X</td>
<td>åœ¨ä¸€è¡Œå­—å½“ä¸­ï¼Œx ä¸ºå‘ååˆ é™¤ä¸€ä¸ªå­—ç¬¦ (ç›¸å½“äº [del] æŒ‰é”®)ï¼Œ X ä¸ºå‘å‰åˆ é™¤ä¸€ä¸ªå­—ç¬¦(ç›¸å½“äº [backspace] äº¦å³æ˜¯é€€æ ¼é”®) (å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">nx</td>
<td>n ä¸ºæ•°å­—ï¼Œè¿ç»­å‘ååˆ é™¤ n ä¸ªå­—ç¬¦ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘è¦è¿ç»­åˆ é™¤ 10 ä¸ªå­—ç¬¦ï¼Œ ã€10xã€ã€‚</td>
</tr>
<tr>
<td style="text-align:left">dd</td>
<td>åˆ é™¤æ¸¸æ ‡æ‰€åœ¨çš„é‚£ä¸€æ•´è¡Œ(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">ndd</td>
<td>n ä¸ºæ•°å­—ã€‚åˆ é™¤å…‰æ ‡æ‰€åœ¨çš„å‘ä¸‹ n è¡Œï¼Œä¾‹å¦‚ 20dd åˆ™æ˜¯åˆ é™¤ 20 è¡Œ (å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">d1G</td>
<td>åˆ é™¤å…‰æ ‡æ‰€åœ¨åˆ°ç¬¬ä¸€è¡Œçš„æ‰€æœ‰æ•°æ®</td>
</tr>
<tr>
<td style="text-align:left">dG</td>
<td>åˆ é™¤å…‰æ ‡æ‰€åœ¨åˆ°æœ€åä¸€è¡Œçš„æ‰€æœ‰æ•°æ®</td>
</tr>
<tr>
<td style="text-align:left">d$</td>
<td>åˆ é™¤æ¸¸æ ‡æ‰€åœ¨å¤„ï¼Œåˆ°è¯¥è¡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">d0</td>
<td>é‚£ä¸ªæ˜¯æ•°å­—çš„ 0 ï¼Œåˆ é™¤æ¸¸æ ‡æ‰€åœ¨å¤„ï¼Œåˆ°è¯¥è¡Œçš„æœ€å‰é¢ä¸€ä¸ªå­—ç¬¦</td>
</tr>
<tr>
<td style="text-align:left">yy</td>
<td>å¤åˆ¶æ¸¸æ ‡æ‰€åœ¨çš„é‚£ä¸€è¡Œ(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">nyy</td>
<td>n ä¸ºæ•°å­—ã€‚å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„å‘ä¸‹ n è¡Œï¼Œä¾‹å¦‚ 20yy åˆ™æ˜¯å¤åˆ¶ 20 è¡Œ(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">y1G</td>
<td>å¤åˆ¶æ¸¸æ ‡æ‰€åœ¨è¡Œåˆ°ç¬¬ä¸€è¡Œçš„æ‰€æœ‰æ•°æ®</td>
</tr>
<tr>
<td style="text-align:left">yG</td>
<td>å¤åˆ¶æ¸¸æ ‡æ‰€åœ¨è¡Œåˆ°æœ€åä¸€è¡Œçš„æ‰€æœ‰æ•°æ®</td>
</tr>
<tr>
<td style="text-align:left">y0</td>
<td>å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸ªå­—ç¬¦åˆ°è¯¥è¡Œè¡Œé¦–çš„æ‰€æœ‰æ•°æ®</td>
</tr>
<tr>
<td style="text-align:left">y$</td>
<td>å¤åˆ¶å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸ªå­—ç¬¦åˆ°è¯¥è¡Œè¡Œå°¾çš„æ‰€æœ‰æ•°æ®</td>
</tr>
<tr>
<td style="text-align:left">p, P</td>
<td>p ä¸ºå°†å·²å¤åˆ¶çš„æ•°æ®åœ¨å…‰æ ‡ä¸‹ä¸€è¡Œè´´ä¸Šï¼ŒP åˆ™ä¸ºè´´åœ¨æ¸¸æ ‡ä¸Šä¸€è¡Œï¼ ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ç›®å‰å…‰æ ‡åœ¨ç¬¬ 20 è¡Œï¼Œä¸”å·²ç»å¤åˆ¶äº† 10 è¡Œæ•°æ®ã€‚åˆ™æŒ‰ä¸‹ p åï¼Œ é‚£ 10 è¡Œæ•°æ®ä¼šè´´åœ¨åŸæœ¬çš„ 20 è¡Œä¹‹åï¼Œäº¦å³ç”± 21 è¡Œå¼€å§‹è´´ã€‚ä½†å¦‚æœæ˜¯æŒ‰ä¸‹ P å‘¢ï¼Ÿ é‚£ä¹ˆåŸæœ¬çš„ç¬¬ 20 è¡Œä¼šè¢«æ¨åˆ°å˜æˆ 30 è¡Œã€‚ (å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">J</td>
<td>å°†å…‰æ ‡æ‰€åœ¨è¡Œä¸ä¸‹ä¸€è¡Œçš„æ•°æ®ç»“åˆæˆåŒä¸€è¡Œ</td>
</tr>
<tr>
<td style="text-align:left">c</td>
<td>é‡å¤åˆ é™¤å¤šä¸ªæ•°æ®ï¼Œä¾‹å¦‚å‘ä¸‹åˆ é™¤ 10 è¡Œï¼Œ[ 10cj ]</td>
</tr>
<tr>
<td style="text-align:left">u</td>
<td>å¤åŸå‰ä¸€ä¸ªåŠ¨ä½œã€‚(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">[Ctrl]+r</td>
<td>é‡åšä¸Šä¸€ä¸ªåŠ¨ä½œã€‚(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">.</td>
<td>ä¸è¦æ€€ç–‘ï¼è¿™å°±æ˜¯å°æ•°ç‚¹ï¼æ„æ€æ˜¯é‡å¤å‰ä¸€ä¸ªåŠ¨ä½œçš„æ„æ€ã€‚ å¦‚æœä½ æƒ³è¦é‡å¤åˆ é™¤ã€é‡å¤è´´ä¸Šç­‰ç­‰åŠ¨ä½œï¼ŒæŒ‰ä¸‹å°æ•°ç‚¹ã€.ã€å°±å¥½äº†ï¼ (å¸¸ç”¨)</td>
</tr>
</tbody>
</table>
</div>
<font size="4px">**è¾“å…¥æ¨¡å¼ï¼š**</font>

<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">è¿›å…¥è¾“å…¥æˆ–å–ä»£çš„ç¼–è¾‘æ¨¡å¼</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">i, I</td>
<td>è¿›å…¥è¾“å…¥æ¨¡å¼(Insert mode)ï¼š i ä¸ºã€ä»ç›®å‰å…‰æ ‡æ‰€åœ¨å¤„è¾“å…¥ã€ï¼Œ I ä¸ºã€åœ¨ç›®å‰æ‰€åœ¨è¡Œçš„ç¬¬ä¸€ä¸ªéç©ºæ ¼ç¬¦å¤„å¼€å§‹è¾“å…¥ã€ã€‚ (å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">a, A</td>
<td>è¿›å…¥è¾“å…¥æ¨¡å¼(Insert mode)ï¼š a ä¸ºã€ä»ç›®å‰å…‰æ ‡æ‰€åœ¨çš„ä¸‹ä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹è¾“å…¥ã€ï¼Œ A ä¸ºã€ä»å…‰æ ‡æ‰€åœ¨è¡Œçš„æœ€åä¸€ä¸ªå­—ç¬¦å¤„å¼€å§‹è¾“å…¥ã€ã€‚(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">o, O</td>
<td>è¿›å…¥è¾“å…¥æ¨¡å¼(Insert mode)ï¼š è¿™æ˜¯è‹±æ–‡å­—æ¯ o çš„å¤§å°å†™ã€‚o ä¸ºåœ¨ç›®å‰å…‰æ ‡æ‰€åœ¨çš„ä¸‹ä¸€è¡Œå¤„è¾“å…¥æ–°çš„ä¸€è¡Œï¼› O ä¸ºåœ¨ç›®å‰å…‰æ ‡æ‰€åœ¨çš„ä¸Šä¸€è¡Œå¤„è¾“å…¥æ–°çš„ä¸€è¡Œï¼(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">r, R</td>
<td>è¿›å…¥å–ä»£æ¨¡å¼(Replace mode)ï¼š r åªä¼šå–ä»£å…‰æ ‡æ‰€åœ¨çš„é‚£ä¸€ä¸ªå­—ç¬¦ä¸€æ¬¡ï¼›Rä¼šä¸€ç›´å–ä»£å…‰æ ‡æ‰€åœ¨çš„æ–‡å­—ï¼Œç›´åˆ°æŒ‰ä¸‹ ESC ä¸ºæ­¢ï¼›(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">[Esc]</td>
<td>é€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œå›åˆ°ä¸€èˆ¬æ¨¡å¼ä¸­(å¸¸ç”¨)</td>
</tr>
</tbody>
</table>
</div>
<font size="4px">**åº•çº¿å‘½ä»¤æ¨¡å¼ï¼š**</font>

<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">æŒ‡ä»¤è¡Œçš„å‚¨å­˜ã€ç¦»å¼€ç­‰æŒ‡ä»¤</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">:w</td>
<td>å°†ç¼–è¾‘çš„æ•°æ®å†™å…¥ç¡¬ç›˜æ¡£æ¡ˆä¸­(å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">:w!</td>
<td>è‹¥æ–‡ä»¶å±æ€§ä¸ºã€åªè¯»ã€æ—¶ï¼Œå¼ºåˆ¶å†™å…¥è¯¥æ¡£æ¡ˆã€‚ä¸è¿‡ï¼Œåˆ°åº•èƒ½ä¸èƒ½å†™å…¥ï¼Œ è¿˜æ˜¯è·Ÿä½ å¯¹è¯¥æ¡£æ¡ˆçš„æ¡£æ¡ˆæƒé™æœ‰å…³å•Šï¼</td>
</tr>
<tr>
<td style="text-align:left">:q</td>
<td>ç¦»å¼€ vi (å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">:q!</td>
<td>è‹¥æ›¾ä¿®æ”¹è¿‡æ¡£æ¡ˆï¼Œåˆä¸æƒ³å‚¨å­˜ï¼Œä½¿ç”¨ ! ä¸ºå¼ºåˆ¶ç¦»å¼€ä¸å‚¨å­˜æ¡£æ¡ˆã€‚</td>
</tr>
<tr>
<td style="text-align:left">æ³¨æ„ä¸€ä¸‹å•Šï¼Œé‚£ä¸ªæƒŠå¹å· (!) åœ¨ vi å½“ä¸­ï¼Œå¸¸å¸¸å…·æœ‰ã€å¼ºåˆ¶ã€çš„æ„æ€ï½</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">:wq</td>
<td>å‚¨å­˜åç¦»å¼€ï¼Œè‹¥ä¸º :wq! åˆ™ä¸ºå¼ºåˆ¶å‚¨å­˜åç¦»å¼€ (å¸¸ç”¨)</td>
</tr>
<tr>
<td style="text-align:left">ZZ</td>
<td>è¿™æ˜¯å¤§å†™çš„ Z å–”ï¼å¦‚æœä¿®æ”¹è¿‡ï¼Œä¿å­˜å½“å‰æ–‡ä»¶ï¼Œç„¶åé€€å‡ºï¼æ•ˆæœç­‰åŒäº(ä¿å­˜å¹¶é€€å‡º)</td>
</tr>
<tr>
<td style="text-align:left">ZQ</td>
<td>ä¸ä¿å­˜ï¼Œå¼ºåˆ¶é€€å‡ºã€‚æ•ˆæœç­‰åŒäº <strong>:q!</strong>ã€‚</td>
</tr>
<tr>
<td style="text-align:left">:w [filename]</td>
<td>å°†ç¼–è¾‘çš„æ•°æ®å‚¨å­˜æˆå¦ä¸€ä¸ªæ¡£æ¡ˆï¼ˆç±»ä¼¼å¦å­˜æ–°æ¡£ï¼‰</td>
</tr>
<tr>
<td style="text-align:left">:r [filename]</td>
<td>åœ¨ç¼–è¾‘çš„æ•°æ®ä¸­ï¼Œè¯»å…¥å¦ä¸€ä¸ªæ¡£æ¡ˆçš„æ•°æ®ã€‚äº¦å³å°† ã€filenameã€ è¿™ä¸ªæ¡£æ¡ˆå†…å®¹åŠ åˆ°æ¸¸æ ‡æ‰€åœ¨è¡Œåé¢</td>
</tr>
<tr>
<td style="text-align:left">:n1,n2 w [filename]</td>
<td>å°† n1 åˆ° n2 çš„å†…å®¹å‚¨å­˜æˆ filename è¿™ä¸ªæ¡£æ¡ˆã€‚</td>
</tr>
<tr>
<td style="text-align:left">:! command</td>
<td>æš‚æ—¶ç¦»å¼€ vi åˆ°æŒ‡ä»¤è¡Œæ¨¡å¼ä¸‹æ‰§è¡Œ command çš„æ˜¾ç¤ºç»“æœï¼ä¾‹å¦‚ ã€:! ls /homeã€å³å¯åœ¨ vi å½“ä¸­å¯Ÿçœ‹ /home åº•ä¸‹ä»¥ ls è¾“å‡ºçš„æ¡£æ¡ˆä¿¡æ¯ï¼</td>
</tr>
</tbody>
</table>
</div>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">vim ç¯å¢ƒçš„å˜æ›´</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">:set nu</td>
<td>æ˜¾ç¤ºè¡Œå·ï¼Œè®¾å®šä¹‹åï¼Œä¼šåœ¨æ¯ä¸€è¡Œçš„å‰ç¼€æ˜¾ç¤ºè¯¥è¡Œçš„è¡Œå·</td>
</tr>
<tr>
<td style="text-align:left">:set nonu</td>
<td>ä¸ set nu ç›¸åï¼Œä¸ºå–æ¶ˆè¡Œå·ï¼</td>
</tr>
</tbody>
</table>
</div>
<p><strong>ç‰¹åˆ«æ³¨æ„ï¼Œåœ¨ vi/vim ä¸­ï¼Œæ•°å­—æ˜¯å¾ˆæœ‰æ„ä¹‰çš„ï¼æ•°å­—é€šå¸¸ä»£è¡¨é‡å¤åšå‡ æ¬¡çš„æ„æ€ï¼ ä¹Ÿæœ‰å¯èƒ½æ˜¯ä»£è¡¨å»åˆ°ç¬¬å‡ ä¸ªä»€ä¹ˆä»€ä¹ˆçš„æ„æ€ã€‚</strong></p>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œè¦åˆ é™¤ 50 è¡Œï¼Œåˆ™æ˜¯ç”¨ ã€50ddã€ å¯¹å§ï¼ æ•°å­—åŠ åœ¨åŠ¨ä½œä¹‹å‰ï¼Œå¦‚æˆ‘è¦å‘ä¸‹ç§»åŠ¨ 20 è¡Œå‘¢ï¼Ÿé‚£å°±æ˜¯ã€20jã€æˆ–è€…æ˜¯ã€20â†“ã€å³å¯ã€‚</p>
<h2 id="7ã€ç”¨æˆ·å’Œç”¨æˆ·ç»„ç®¡ç†"><a href="#7ã€ç”¨æˆ·å’Œç”¨æˆ·ç»„ç®¡ç†" class="headerlink" title="7ã€ç”¨æˆ·å’Œç”¨æˆ·ç»„ç®¡ç†"></a>7ã€ç”¨æˆ·å’Œç”¨æˆ·ç»„ç®¡ç†</h2><p>Linuxç³»ç»Ÿæ˜¯ä¸€ä¸ªå¤šç”¨æˆ·å¤šä»»åŠ¡çš„åˆ†æ—¶æ“ä½œç³»ç»Ÿï¼Œä»»ä½•ä¸€ä¸ªè¦ä½¿ç”¨ç³»ç»Ÿèµ„æºçš„ç”¨æˆ·ï¼Œéƒ½å¿…é¡»é¦–å…ˆå‘ç³»ç»Ÿç®¡ç†å‘˜ç”³è¯·ä¸€ä¸ªè´¦å·ï¼Œç„¶åä»¥è¿™ä¸ªè´¦å·çš„èº«ä»½è¿›å…¥ç³»ç»Ÿã€‚</p>
<p>ç”¨æˆ·çš„è´¦å·ä¸€æ–¹é¢å¯ä»¥å¸®åŠ©ç³»ç»Ÿç®¡ç†å‘˜å¯¹ä½¿ç”¨ç³»ç»Ÿçš„ç”¨æˆ·è¿›è¡Œè·Ÿè¸ªï¼Œå¹¶æ§åˆ¶ä»–ä»¬å¯¹ç³»ç»Ÿèµ„æºçš„è®¿é—®ï¼›å¦ä¸€æ–¹é¢ä¹Ÿå¯ä»¥å¸®åŠ©ç”¨æˆ·ç»„ç»‡æ–‡ä»¶ï¼Œå¹¶ä¸ºç”¨æˆ·æä¾›å®‰å…¨æ€§ä¿æŠ¤ã€‚</p>
<p>æ¯ä¸ªç”¨æˆ·è´¦å·éƒ½æ‹¥æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç”¨æˆ·åå’Œå„è‡ªçš„å£ä»¤ã€‚</p>
<p>ç”¨æˆ·åœ¨ç™»å½•æ—¶é”®å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå£ä»¤åï¼Œå°±èƒ½å¤Ÿè¿›å…¥ç³»ç»Ÿå’Œè‡ªå·±çš„ä¸»ç›®å½•ã€‚</p>
<p>å®ç°ç”¨æˆ·è´¦å·çš„ç®¡ç†ï¼Œè¦å®Œæˆçš„å·¥ä½œä¸»è¦æœ‰å¦‚ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li>ç”¨æˆ·è´¦å·çš„æ·»åŠ ã€åˆ é™¤ä¸ä¿®æ”¹ã€‚</li>
<li>ç”¨æˆ·å£ä»¤çš„ç®¡ç†ã€‚</li>
<li>ç”¨æˆ·ç»„çš„ç®¡ç†ã€‚</li>
</ul>
<h4 id="7-1ã€ç”¨æˆ·è´¦å·ç®¡ç†"><a href="#7-1ã€ç”¨æˆ·è´¦å·ç®¡ç†" class="headerlink" title="7.1ã€ç”¨æˆ·è´¦å·ç®¡ç†"></a><font size="5px"><strong>7.1ã€ç”¨æˆ·è´¦å·ç®¡ç†</strong></font></h4><p>ç”¨æˆ·è´¦å·çš„ç®¡ç†å·¥ä½œä¸»è¦æ¶‰åŠåˆ°ç”¨æˆ·è´¦å·çš„æ·»åŠ ã€ä¿®æ”¹å’Œåˆ é™¤ã€‚</p>
<p>æ·»åŠ ç”¨æˆ·è´¦å·å°±æ˜¯åœ¨ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªæ–°è´¦å·ï¼Œç„¶åä¸ºæ–°è´¦å·åˆ†é…ç”¨æˆ·å·ã€ç”¨æˆ·ç»„ã€ä¸»ç›®å½•å’Œç™»å½•Shellç­‰èµ„æºã€‚åˆšæ·»åŠ çš„è´¦å·æ˜¯è¢«é”å®šçš„ï¼Œæ— æ³•ä½¿ç”¨ã€‚</p>
<div class="note success">
            <p>useradd æ·»åŠ ç”¨æˆ· </p>
          </div>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">useradd é€‰é¡¹ ç”¨æˆ·å</span><br></pre></td></tr></tbody></table></figure>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><p>é€‰é¡¹:</p>
<ul>
<li>-c comment æŒ‡å®šä¸€æ®µæ³¨é‡Šæ€§æè¿°ã€‚</li>
<li>-d ç›®å½• æŒ‡å®šç”¨æˆ·ä¸»ç›®å½•ï¼Œå¦‚æœæ­¤ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åŒæ—¶ä½¿ç”¨-mé€‰é¡¹ï¼Œå¯ä»¥åˆ›å»ºä¸»ç›®å½•ã€‚</li>
<li>-g ç”¨æˆ·ç»„ æŒ‡å®šç”¨æˆ·æ‰€å±çš„ç”¨æˆ·ç»„ã€‚</li>
<li>-G ç”¨æˆ·ç»„ï¼Œç”¨æˆ·ç»„ æŒ‡å®šç”¨æˆ·æ‰€å±çš„é™„åŠ ç»„ã€‚</li>
<li>-s Shellæ–‡ä»¶ æŒ‡å®šç”¨æˆ·çš„ç™»å½•Shellã€‚</li>
<li>-u ç”¨æˆ·å· æŒ‡å®šç”¨æˆ·çš„ç”¨æˆ·å·ï¼Œå¦‚æœåŒæ—¶æœ‰-oé€‰é¡¹ï¼Œåˆ™å¯ä»¥é‡å¤ä½¿ç”¨å…¶ä»–ç”¨æˆ·çš„æ ‡è¯†å·ã€‚</li>
</ul>
</li>
<li><p>ç”¨æˆ·å:</p>
<p>æŒ‡å®šæ–°è´¦å·çš„ç™»å½•åã€‚</p>
</li>
</ul>
<p>å¢åŠ ç”¨æˆ·è´¦å·å°±æ˜¯åœ¨ <code>/etc/passwd</code> æ–‡ä»¶ä¸­ä¸ºæ–°ç”¨æˆ·å¢åŠ ä¸€æ¡è®°å½•ï¼ŒåŒæ—¶æ›´æ–°å…¶ä»–ç³»ç»Ÿæ–‡ä»¶å¦‚<strong>/etc/shadow, /etc/group</strong>ç­‰ã€‚</p>
<p>Linuxæä¾›äº†é›†æˆçš„ç³»ç»Ÿç®¡ç†å·¥å…· userconfï¼Œå®ƒå¯ä»¥ç”¨æ¥å¯¹ç”¨æˆ·è´¦å·è¿›è¡Œç»Ÿä¸€ç®¡ç†ã€‚</p>
<div class="note success">
            <p>userdel åˆ é™¤è´¦å· </p>
          </div>
<p>å¦‚æœä¸€ä¸ªç”¨æˆ·çš„è´¦å·ä¸å†ä½¿ç”¨ï¼Œå¯ä»¥ä»ç³»ç»Ÿä¸­åˆ é™¤ã€‚åˆ é™¤ç”¨æˆ·è´¦å·å°±æ˜¯è¦å°† <code>/etc/passwd</code> ç­‰ç³»ç»Ÿæ–‡ä»¶ä¸­çš„è¯¥ç”¨æˆ·è®°å½•åˆ é™¤ï¼Œå¿…è¦æ—¶è¿˜åˆ é™¤ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚</p>
<p>æ ¼å¼ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">userdel é€‰é¡¹ ç”¨æˆ·å</span><br></pre></td></tr></tbody></table></figure>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><p>é€‰é¡¹:</p>
<ul>
<li>-r æŠŠç”¨æˆ·çš„ä¸»ç›®å½•ä»¥åŠç³»ç»Ÿæ–‡ä»¶ä¸­çš„è®°å½•ä¸€èµ·åˆ é™¤ã€‚</li>
</ul>
</li>
<li><p>ç”¨æˆ·å:</p>
<p>æŒ‡å®šåˆ é™¤è´¦å·çš„ç”¨æˆ·åã€‚</p>
</li>
</ul>
<div class="note success">
            <p>usermod ä¿®æ”¹è´¦å· </p>
          </div>
<p>ä¿®æ”¹ç”¨æˆ·è´¦å·å°±æ˜¯æ ¹æ®å®é™…æƒ…å†µæ›´æ”¹ç”¨æˆ·çš„æœ‰å…³å±æ€§ï¼Œå¦‚ç”¨æˆ·å·ã€ä¸»ç›®å½•ã€ç”¨æˆ·ç»„ã€ç™»å½•Shellç­‰ã€‚</p>
<p>æ ¼å¼ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">usermod é€‰é¡¹ ç”¨æˆ·å</span><br></pre></td></tr></tbody></table></figure>
<p>å‚æ•°è¯´æ˜ï¼ˆåŒ useradd ä¸€æ ·ï¼‰ï¼š</p>
<ul>
<li><p>é€‰é¡¹:</p>
<ul>
<li>-c comment æŒ‡å®šä¸€æ®µæ³¨é‡Šæ€§æè¿°ã€‚</li>
<li>-d ç›®å½• æŒ‡å®šç”¨æˆ·ä¸»ç›®å½•ï¼Œå¦‚æœæ­¤ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åŒæ—¶ä½¿ç”¨-mé€‰é¡¹ï¼Œå¯ä»¥åˆ›å»ºä¸»ç›®å½•ã€‚</li>
<li>-g ç”¨æˆ·ç»„ æŒ‡å®šç”¨æˆ·æ‰€å±çš„ç”¨æˆ·ç»„ã€‚</li>
<li>-G ç”¨æˆ·ç»„ï¼Œç”¨æˆ·ç»„ æŒ‡å®šç”¨æˆ·æ‰€å±çš„é™„åŠ ç»„ã€‚</li>
<li>-s Shellæ–‡ä»¶ æŒ‡å®šç”¨æˆ·çš„ç™»å½•Shellã€‚</li>
<li>-u ç”¨æˆ·å· æŒ‡å®šç”¨æˆ·çš„ç”¨æˆ·å·ï¼Œå¦‚æœåŒæ—¶æœ‰-oé€‰é¡¹ï¼Œåˆ™å¯ä»¥é‡å¤ä½¿ç”¨å…¶ä»–ç”¨æˆ·çš„æ ‡è¯†å·ã€‚</li>
</ul>
</li>
<li><p>ç”¨æˆ·å:</p>
<p>æŒ‡å®šæ–°è´¦å·çš„ç™»å½•åã€‚</p>
</li>
</ul>
<div class="note success">
            <p>passwd å£ä»¤ç®¡ç† </p>
          </div>
<p>ç”¨æˆ·ç®¡ç†çš„ä¸€é¡¹é‡è¦å†…å®¹æ˜¯ç”¨æˆ·å£ä»¤çš„ç®¡ç†ã€‚<strong>ç”¨æˆ·è´¦å·åˆšåˆ›å»ºæ—¶æ²¡æœ‰å£ä»¤ï¼Œä½†æ˜¯è¢«ç³»ç»Ÿé”å®šï¼Œæ— æ³•ä½¿ç”¨ï¼Œå¿…é¡»ä¸ºå…¶æŒ‡å®šå£ä»¤åæ‰å¯ä»¥ä½¿ç”¨ï¼Œå³ä½¿æ˜¯æŒ‡å®šç©ºå£ä»¤ã€‚</strong></p>
<p>æŒ‡å®šå’Œä¿®æ”¹ç”¨æˆ·å£ä»¤çš„Shellå‘½ä»¤æ˜¯<code>passwd</code>ã€‚è¶…çº§ç”¨æˆ·å¯ä»¥ä¸ºè‡ªå·±å’Œå…¶ä»–ç”¨æˆ·æŒ‡å®šå£ä»¤ï¼Œæ™®é€šç”¨æˆ·åªèƒ½ç”¨å®ƒä¿®æ”¹è‡ªå·±çš„å£ä»¤ã€‚</p>
<p>æ ¼å¼ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">passwd é€‰é¡¹ ç”¨æˆ·å</span><br></pre></td></tr></tbody></table></figure>
<p>å¯ä½¿ç”¨çš„é€‰é¡¹ï¼š</p>
<ul>
<li>-l é”å®šå£ä»¤ï¼Œå³ç¦ç”¨è´¦å·ã€‚</li>
<li>-u å£ä»¤è§£é”ã€‚</li>
<li>-d ä½¿è´¦å·æ— å£ä»¤ã€‚</li>
<li>-f å¼ºè¿«ç”¨æˆ·ä¸‹æ¬¡ç™»å½•æ—¶ä¿®æ”¹å£ä»¤ã€‚</li>
</ul>
<p>æ™®é€šç”¨æˆ·ä¿®æ”¹è‡ªå·±çš„å£ä»¤æ—¶ï¼Œpasswdå‘½ä»¤ä¼šå…ˆè¯¢é—®åŸå£ä»¤ï¼ŒéªŒè¯åå†è¦æ±‚ç”¨æˆ·è¾“å…¥ä¸¤éæ–°å£ä»¤ï¼Œå¦‚æœä¸¤æ¬¡è¾“å…¥çš„å£ä»¤ä¸€è‡´ï¼Œåˆ™å°†è¿™ä¸ªå£ä»¤æŒ‡å®šç»™ç”¨æˆ·ï¼›è€Œè¶…çº§ç”¨æˆ·ä¸ºç”¨æˆ·æŒ‡å®šå£ä»¤æ—¶ï¼Œå°±ä¸éœ€è¦çŸ¥é“åŸå£ä»¤ã€‚</p>
<h4 id="7-2ã€ç”¨æˆ·ç»„ç®¡ç†"><a href="#7-2ã€ç”¨æˆ·ç»„ç®¡ç†" class="headerlink" title="7.2ã€ç”¨æˆ·ç»„ç®¡ç†"></a><font size="5px"><strong>7.2ã€ç”¨æˆ·ç»„ç®¡ç†</strong></font></h4><p>æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªç”¨æˆ·ç»„ï¼Œç³»ç»Ÿå¯ä»¥å¯¹ä¸€ä¸ªç”¨æˆ·ç»„ä¸­çš„æ‰€æœ‰ç”¨æˆ·è¿›è¡Œé›†ä¸­ç®¡ç†ã€‚ä¸åŒLinux ç³»ç»Ÿå¯¹ç”¨æˆ·ç»„çš„è§„å®šæœ‰æ‰€ä¸åŒï¼Œå¦‚Linuxä¸‹çš„ç”¨æˆ·å±äºä¸å®ƒåŒåçš„ç”¨æˆ·ç»„ï¼Œè¿™ä¸ªç”¨æˆ·ç»„åœ¨åˆ›å»ºç”¨æˆ·æ—¶åŒæ—¶åˆ›å»ºã€‚</p>
<p>ç”¨æˆ·ç»„çš„ç®¡ç†æ¶‰åŠç”¨æˆ·ç»„çš„æ·»åŠ ã€åˆ é™¤å’Œä¿®æ”¹ã€‚ç»„çš„å¢åŠ ã€åˆ é™¤å’Œä¿®æ”¹å®é™…ä¸Šå°±æ˜¯å¯¹/etc/groupæ–‡ä»¶çš„æ›´æ–°ã€‚</p>
<div class="note success">
            <p>groupadd æ·»åŠ ç”¨æˆ·ç»„ </p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">groupadd é€‰é¡¹ ç”¨æˆ·ç»„</span><br></pre></td></tr></tbody></table></figure>
<p>å¯ä»¥ä½¿ç”¨çš„é€‰é¡¹æœ‰ï¼š</p>
<ul>
<li>-g GID æŒ‡å®šæ–°ç”¨æˆ·ç»„çš„ç»„æ ‡è¯†å·ï¼ˆGIDï¼‰ã€‚</li>
<li>-o ä¸€èˆ¬ä¸-gé€‰é¡¹åŒæ—¶ä½¿ç”¨ï¼Œè¡¨ç¤ºæ–°ç”¨æˆ·ç»„çš„GIDå¯ä»¥ä¸ç³»ç»Ÿå·²æœ‰ç”¨æˆ·ç»„çš„GIDç›¸åŒã€‚</li>
</ul>
<div class="note success">
            <p>groupdel åˆ é™¤ç”¨æˆ·ç»„ </p>
          </div>
<p>æ ¼å¼ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">groupdel ç”¨æˆ·ç»„</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>groupmod ä¿®æ”¹ç”¨æˆ·ç»„ </p>
          </div>
<p>æ ¼å¼ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">groupmod é€‰é¡¹ ç”¨æˆ·ç»„</span><br></pre></td></tr></tbody></table></figure>
<p>å¸¸ç”¨çš„é€‰é¡¹æœ‰ï¼š</p>
<ul>
<li>-g GID ä¸ºç”¨æˆ·ç»„æŒ‡å®šæ–°çš„ç»„æ ‡è¯†å·ã€‚</li>
<li>-o ä¸-gé€‰é¡¹åŒæ—¶ä½¿ç”¨ï¼Œç”¨æˆ·ç»„çš„æ–°GIDå¯ä»¥ä¸ç³»ç»Ÿå·²æœ‰ç”¨æˆ·ç»„çš„GIDç›¸åŒã€‚</li>
<li>-næ–°ç”¨æˆ·ç»„ å°†ç”¨æˆ·ç»„çš„åå­—æ”¹ä¸ºæ–°åå­—</li>
</ul>
<div class="note success">
            <p>newgrp åˆ‡æ¢ç”¨æˆ·ç»„ </p>
          </div>
<p>å¦‚æœä¸€ä¸ªç”¨æˆ·åŒæ—¶å±äºå¤šä¸ªç”¨æˆ·ç»„ï¼Œé‚£ä¹ˆç”¨æˆ·å¯ä»¥åœ¨ç”¨æˆ·ç»„ä¹‹é—´åˆ‡æ¢ï¼Œä»¥ä¾¿å…·æœ‰å…¶ä»–ç”¨æˆ·ç»„çš„æƒé™ã€‚</p>
<p>æ ¼å¼ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">newgrp ç”¨æˆ·ç»„</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™æ¡å‘½ä»¤å°†å½“å‰ç”¨æˆ·åˆ‡æ¢åˆ°å…¶å®ƒç”¨æˆ·ç»„ï¼Œå‰ææ¡ä»¶æ˜¯è¿™ä¸ªç”¨æˆ·ç»„ç¡®å®æ˜¯è¯¥ç”¨æˆ·çš„ä¸»ç»„æˆ–é™„åŠ ç»„ã€‚ç±»ä¼¼äºç”¨æˆ·è´¦å·çš„ç®¡ç†ï¼Œç”¨æˆ·ç»„çš„ç®¡ç†ä¹Ÿå¯ä»¥é€šè¿‡é›†æˆçš„ç³»ç»Ÿç®¡ç†å·¥å…·æ¥å®Œæˆã€‚</p>
<h4 id="7-3ã€ä¸ç”¨æˆ·æœ‰å…³çš„ç³»ç»Ÿæ–‡ä»¶"><a href="#7-3ã€ä¸ç”¨æˆ·æœ‰å…³çš„ç³»ç»Ÿæ–‡ä»¶" class="headerlink" title="7.3ã€ä¸ç”¨æˆ·æœ‰å…³çš„ç³»ç»Ÿæ–‡ä»¶"></a><font size="5px"><strong>7.3ã€ä¸ç”¨æˆ·æœ‰å…³çš„ç³»ç»Ÿæ–‡ä»¶</strong></font></h4><p>å®Œæˆç”¨æˆ·ç®¡ç†çš„å·¥ä½œæœ‰è®¸å¤šç§æ–¹æ³•ï¼Œä½†æ˜¯æ¯ä¸€ç§æ–¹æ³•å®é™…ä¸Šéƒ½æ˜¯å¯¹æœ‰å…³çš„ç³»ç»Ÿæ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚</p>
<p>ä¸ç”¨æˆ·å’Œç”¨æˆ·ç»„ç›¸å…³çš„ä¿¡æ¯éƒ½å­˜æ”¾åœ¨ä¸€äº›ç³»ç»Ÿæ–‡ä»¶ä¸­ï¼Œè¿™äº›æ–‡ä»¶åŒ…æ‹¬ <strong>/etc/passwd, /etc/shadow, /etc/group</strong> ç­‰ã€‚</p>
<p><strong><font size="4px">/etc/passwd</font></strong></p>
<p>Linuxç³»ç»Ÿä¸­çš„æ¯ä¸ªç”¨æˆ·éƒ½åœ¨/etc/passwdæ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªå¯¹åº”çš„è®°å½•è¡Œï¼Œå®ƒè®°å½•äº†è¿™ä¸ªç”¨æˆ·çš„ä¸€äº›åŸºæœ¬å±æ€§ã€‚</p>
<p>è¿™ä¸ªæ–‡ä»¶å¯¹æ‰€æœ‰ç”¨æˆ·éƒ½æ˜¯å¯è¯»çš„ã€‚å®ƒçš„å†…å®¹ç±»ä¼¼ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<p><img src="https://z3.ax1x.com/2021/11/23/oS0fER.png" alt=""></p>
<p>ä»ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ/etc/passwdä¸­ä¸€è¡Œè®°å½•å¯¹åº”ç€ä¸€ä¸ªç”¨æˆ·ï¼Œæ¯è¡Œè®°å½•åˆè¢«å†’å·(:)åˆ†éš”ä¸º7ä¸ªå­—æ®µï¼Œå…¶æ ¼å¼å’Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">ç”¨æˆ·å:å£ä»¤:ç”¨æˆ·æ ‡è¯†å·:ç»„æ ‡è¯†å·:æ³¨é‡Šæ€§æè¿°:ä¸»ç›®å½•:ç™»å½•Shell</span><br></pre></td></tr></tbody></table></figure>
<ol>
<li><p><strong>ç”¨æˆ·å</strong>ï¼Œä»£è¡¨ç”¨æˆ·è´¦å·çš„å­—ç¬¦ä¸²</p>
<p>é€šå¸¸é•¿åº¦ä¸è¶…è¿‡8ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”ç”±å¤§å°å†™å­—æ¯å’Œ/æˆ–æ•°å­—ç»„æˆã€‚ç™»å½•åä¸­ä¸èƒ½æœ‰å†’å·(:)ï¼Œå› ä¸ºå†’å·åœ¨è¿™é‡Œæ˜¯åˆ†éš”ç¬¦ã€‚</p>
<p>ä¸ºäº†å…¼å®¹èµ·è§ï¼Œç™»å½•åä¸­æœ€å¥½ä¸è¦åŒ…å«ç‚¹å­—ç¬¦(.)ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨è¿å­—ç¬¦(-)å’ŒåŠ å·(+)æ‰“å¤´ã€‚</p>
</li>
<li><p><strong>å£ä»¤</strong>ï¼Œå­˜æ”¾åŠ å¯†åçš„ç”¨æˆ·å£ä»¤å­—</p>
<p>è™½ç„¶è¿™ä¸ªå­—æ®µå­˜æ”¾çš„åªæ˜¯ç”¨æˆ·å£ä»¤çš„åŠ å¯†ä¸²ï¼Œä¸æ˜¯æ˜æ–‡ï¼Œä½†æ˜¯ç”±äº/etc/passwdæ–‡ä»¶å¯¹æ‰€æœ‰ç”¨æˆ·éƒ½å¯è¯»ï¼Œæ‰€ä»¥è¿™ä»æ˜¯ä¸€ä¸ªå®‰å…¨éšæ‚£ã€‚å› æ­¤ï¼Œç°åœ¨è®¸å¤šLinux ç³»ç»Ÿï¼ˆå¦‚SVR4ï¼‰éƒ½ä½¿ç”¨äº†shadowæŠ€æœ¯ï¼Œ<strong>æŠŠçœŸæ­£çš„åŠ å¯†åçš„ç”¨æˆ·å£ä»¤å­—å­˜æ”¾åˆ°/etc/shadowæ–‡ä»¶ä¸­</strong>ï¼Œè€Œåœ¨/etc/passwdæ–‡ä»¶çš„å£ä»¤å­—æ®µä¸­åªå­˜æ”¾ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ï¼Œä¾‹å¦‚â€œxâ€æˆ–è€…â€œ*â€ã€‚</p>
</li>
<li><p><strong>ç”¨æˆ·æ ‡è¯†å·</strong>ï¼Œæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œç³»ç»Ÿå†…éƒ¨ç”¨å®ƒæ¥è¡¨ç¤ºç”¨æˆ·</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹å®ƒä¸ç”¨æˆ·åæ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚<strong>å¦‚æœå‡ ä¸ªç”¨æˆ·åå¯¹åº”çš„ç”¨æˆ·æ ‡è¯†å·æ˜¯ä¸€æ ·çš„ï¼Œç³»ç»Ÿå†…éƒ¨å°†æŠŠå®ƒä»¬è§†ä¸ºåŒä¸€ä¸ªç”¨æˆ·ï¼Œä½†æ˜¯å®ƒä»¬å¯ä»¥æœ‰ä¸åŒçš„å£ä»¤ã€ä¸åŒçš„ä¸»ç›®å½•ä»¥åŠä¸åŒçš„ç™»å½•Shellç­‰ã€‚</strong></p>
<p>é€šå¸¸ç”¨æˆ·æ ‡è¯†å·çš„å–å€¼èŒƒå›´æ˜¯0ï½65 535ã€‚0æ˜¯è¶…çº§ç”¨æˆ·rootçš„æ ‡è¯†å·ï¼Œ1ï½99ç”±ç³»ç»Ÿä¿ç•™ï¼Œä½œä¸ºç®¡ç†è´¦å·ï¼Œæ™®é€šç”¨æˆ·çš„æ ‡è¯†å·ä»100å¼€å§‹ã€‚åœ¨Linuxç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªç•Œé™æ˜¯500ã€‚</p>
</li>
<li><p><strong>ç»„æ ‡è¯†å·</strong>ï¼Œè®°å½•ç”¨æˆ·çš„æ‰€å±ç»„</p>
<p>å®ƒå¯¹åº”ç€/etc/groupæ–‡ä»¶ä¸­çš„ä¸€æ¡è®°å½•ã€‚</p>
</li>
<li><p><strong>æ³¨é‡Šæ€§æè¿°</strong>ï¼Œè®°å½•ç€ç”¨æˆ·çš„ä¸ªäººæƒ…å†µ</p>
<p>ä¾‹å¦‚ç”¨æˆ·çš„çœŸå®å§“åã€ç”µè¯ã€åœ°å€ç­‰ï¼Œ<strong>è¿™ä¸ªå­—æ®µå¹¶æ²¡æœ‰ä»€ä¹ˆå®é™…çš„ç”¨é€”</strong>ã€‚åœ¨ä¸åŒçš„Linux ç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªå­—æ®µçš„æ ¼å¼å¹¶æ²¡æœ‰ç»Ÿä¸€ã€‚åœ¨è®¸å¤šLinuxç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªå­—æ®µå­˜æ”¾çš„æ˜¯ä¸€æ®µä»»æ„çš„æ³¨é‡Šæ€§æè¿°æ–‡å­—ï¼Œç”¨åš finger å‘½ä»¤çš„è¾“å‡ºã€‚</p>
</li>
<li><p><strong>ä¸»ç›®å½•</strong>ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·çš„èµ·å§‹å·¥ä½œç›®å½•</p>
<p>å®ƒæ˜¯<strong>ç”¨æˆ·åœ¨ç™»å½•åˆ°ç³»ç»Ÿä¹‹åæ‰€å¤„çš„ç›®å½•</strong>ã€‚åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œå„ç”¨æˆ·çš„ä¸»ç›®å½•éƒ½è¢«ç»„ç»‡åœ¨åŒä¸€ä¸ªç‰¹å®šçš„ç›®å½•ä¸‹ï¼Œè€Œç”¨æˆ·ä¸»ç›®å½•çš„åç§°å°±æ˜¯è¯¥ç”¨æˆ·çš„ç™»å½•åã€‚å„ç”¨æˆ·å¯¹è‡ªå·±çš„ä¸»ç›®å½•æœ‰è¯»ã€å†™ã€æ‰§è¡Œï¼ˆæœç´¢ï¼‰æƒé™ï¼Œå…¶ä»–ç”¨æˆ·å¯¹æ­¤ç›®å½•çš„è®¿é—®æƒé™åˆ™æ ¹æ®å…·ä½“æƒ…å†µè®¾ç½®ã€‚</p>
</li>
<li><p><strong>ç™»å½•Shell</strong>ï¼ŒShellæ˜¯ç”¨æˆ·ä¸Linuxç³»ç»Ÿä¹‹é—´çš„æ¥å£</p>
<p><strong>ç”¨æˆ·ç™»å½•åï¼Œè¦å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œè´Ÿè´£å°†ç”¨æˆ·çš„æ“ä½œä¼ ç»™å†…æ ¸ï¼Œè¿™ä¸ªè¿›ç¨‹æ˜¯ç”¨æˆ·ç™»å½•åˆ°ç³»ç»Ÿåè¿è¡Œçš„å‘½ä»¤è§£é‡Šå™¨æˆ–æŸä¸ªç‰¹å®šçš„ç¨‹åºï¼Œå³Shellã€‚</strong></p>
<p>Linuxçš„Shellæœ‰è®¸å¤šç§ï¼Œæ¯ç§éƒ½æœ‰ä¸åŒçš„ç‰¹ç‚¹ã€‚å¸¸ç”¨çš„æœ‰sh(Bourne Shell), csh(C Shell), ksh(Korn Shell), tcsh(TENEX/TOPS-20 type C Shell), bash(Bourne Again Shell)ç­‰ã€‚</p>
<p>ç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥æ ¹æ®ç³»ç»Ÿæƒ…å†µå’Œç”¨æˆ·ä¹ æƒ¯ä¸ºç”¨æˆ·æŒ‡å®šæŸä¸ªShellã€‚<strong>å¦‚æœä¸æŒ‡å®šShellï¼Œé‚£ä¹ˆç³»ç»Ÿä½¿ç”¨ sh ä¸ºé»˜è®¤çš„ç™»å½• Shell</strong>ï¼Œå³è¿™ä¸ªå­—æ®µçš„å€¼ä¸º/bin/shã€‚</p>
<p>ç”¨æˆ·çš„ç™»å½•Shellä¹Ÿå¯ä»¥æŒ‡å®šä¸ºæŸä¸ªç‰¹å®šçš„ç¨‹åºï¼ˆæ­¤ç¨‹åºä¸æ˜¯ä¸€ä¸ªå‘½ä»¤è§£é‡Šå™¨ï¼‰ã€‚</p>
<p>åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥é™åˆ¶ç”¨æˆ·åªèƒ½è¿è¡ŒæŒ‡å®šçš„åº”ç”¨ç¨‹åºï¼Œåœ¨è¯¥åº”ç”¨ç¨‹åºè¿è¡Œç»“æŸåï¼Œç”¨æˆ·å°±è‡ªåŠ¨é€€å‡ºäº†ç³»ç»Ÿã€‚æœ‰äº›Linux ç³»ç»Ÿè¦æ±‚åªæœ‰é‚£äº›åœ¨ç³»ç»Ÿä¸­ç™»è®°äº†çš„ç¨‹åºæ‰èƒ½å‡ºç°åœ¨è¿™ä¸ªå­—æ®µä¸­ã€‚</p>
</li>
<li><p><strong>ä¼ªç”¨æˆ·</strong>ï¼Œæ–¹ä¾¿ç³»ç»Ÿç®¡ç†</p>
<p>è¿™äº›ç”¨æˆ·åœ¨/etc/passwdæ–‡ä»¶ä¸­ä¹Ÿå æœ‰ä¸€æ¡è®°å½•ï¼Œä½†æ˜¯ä¸èƒ½ç™»å½•ï¼Œå› ä¸ºå®ƒä»¬çš„ç™»å½•Shellä¸ºç©ºã€‚å®ƒä»¬çš„å­˜åœ¨ä¸»è¦æ˜¯æ–¹ä¾¿ç³»ç»Ÿç®¡ç†ï¼Œæ»¡è¶³ç›¸åº”çš„ç³»ç»Ÿè¿›ç¨‹å¯¹æ–‡ä»¶å±ä¸»çš„è¦æ±‚ã€‚</p>
<p>å¸¸è§çš„ä¼ªç”¨æˆ·å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># ä¼ª ç”¨ æˆ· å« ä¹‰ </span></span><br><span class="line">bin <span class="comment"># æ‹¥æœ‰å¯æ‰§è¡Œçš„ç”¨æˆ·å‘½ä»¤æ–‡ä»¶ </span></span><br><span class="line">sys <span class="comment"># æ‹¥æœ‰ç³»ç»Ÿæ–‡ä»¶ </span></span><br><span class="line">adm <span class="comment"># æ‹¥æœ‰å¸æˆ·æ–‡ä»¶ </span></span><br><span class="line">uucp <span class="comment"># UUCPä½¿ç”¨ </span></span><br><span class="line">lp <span class="comment"># lpæˆ–lpdå­ç³»ç»Ÿä½¿ç”¨ </span></span><br><span class="line">nobody <span class="comment"># NFSä½¿ç”¨</span></span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<div class="note success">
            <p><strong>é™¤äº†ä¸Šè¿°åˆ—å‡ºçš„ä¼ªç”¨æˆ·å¤–ï¼Œè¿˜æœ‰è®¸å¤šæ ‡å‡†çš„ä¼ªç”¨æˆ·ï¼Œä¾‹å¦‚ï¼šauditï¼Œcronï¼Œmailï¼Œusenetç­‰ï¼Œå®ƒä»¬ä¹Ÿéƒ½å„è‡ªä¸ºç›¸å…³çš„è¿›ç¨‹å’Œæ–‡ä»¶æ‰€éœ€è¦ã€‚</strong></p>
          </div>
<p>ç”±äº/etc/passwdæ–‡ä»¶æ˜¯æ‰€æœ‰ç”¨æˆ·éƒ½å¯è¯»çš„ï¼Œå¦‚æœç”¨æˆ·çš„å¯†ç å¤ªç®€å•æˆ–è§„å¾‹æ¯”è¾ƒæ˜æ˜¾çš„è¯ï¼Œä¸€å°æ™®é€šçš„è®¡ç®—æœºå°±èƒ½å¤Ÿå¾ˆå®¹æ˜“åœ°å°†å®ƒç ´è§£ï¼Œ<strong>å› æ­¤å¯¹å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜çš„Linuxç³»ç»Ÿéƒ½æŠŠåŠ å¯†åçš„å£ä»¤å­—åˆ†ç¦»å‡ºæ¥ï¼Œå•ç‹¬å­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯/etc/shadowæ–‡ä»¶ã€‚ æœ‰è¶…çº§ç”¨æˆ·æ‰æ‹¥æœ‰è¯¥æ–‡ä»¶è¯»æƒé™</strong>ï¼Œè¿™å°±ä¿è¯äº†ç”¨æˆ·å¯†ç çš„å®‰å…¨æ€§ã€‚</p>
<div class="note success">
            <p><strong>/etc/shadowä¸­çš„è®°å½•è¡Œä¸/etc/passwdä¸­çš„ä¸€ä¸€å¯¹åº”ï¼Œå®ƒç”±pwconvå‘½ä»¤æ ¹æ®/etc/passwdä¸­çš„æ•°æ®è‡ªåŠ¨äº§ç”Ÿã€‚</strong></p>
          </div>
<p>å®ƒçš„æ–‡ä»¶æ ¼å¼ä¸ /etc/passwd ç±»ä¼¼ï¼Œç”±è‹¥å¹²ä¸ªå­—æ®µç»„æˆï¼Œå­—æ®µä¹‹é—´ç”¨â€:â€éš”å¼€ã€‚è¿™äº›å­—æ®µæ˜¯ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">ç™»å½•å:åŠ å¯†å£ä»¤:æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´:æœ€å°æ—¶é—´é—´éš”:æœ€å¤§æ—¶é—´é—´éš”:è­¦å‘Šæ—¶é—´:ä¸æ´»åŠ¨æ—¶é—´:å¤±æ•ˆæ—¶é—´:æ ‡å¿—</span><br></pre></td></tr></tbody></table></figure>
<ol>
<li><strong>â€œç™»å½•åâ€</strong>ï¼Œæ˜¯ä¸/etc/passwdæ–‡ä»¶ä¸­çš„ç™»å½•åç›¸ä¸€è‡´çš„ç”¨æˆ·è´¦å·</li>
<li><strong>â€œåŠ å¯†å£ä»¤</strong>â€œï¼Œå­˜æ”¾çš„æ˜¯åŠ å¯†åçš„ç”¨æˆ·å£ä»¤å­—ï¼Œé•¿åº¦ä¸º13ä¸ªå­—ç¬¦ã€‚å¦‚æœä¸ºç©ºï¼Œåˆ™å¯¹åº”ç”¨æˆ·æ²¡æœ‰å£ä»¤ï¼Œç™»å½•æ—¶ä¸éœ€è¦å£ä»¤ï¼›å¦‚æœå«æœ‰ä¸å±äºé›†åˆ { ./0-9A-Za-z }ä¸­çš„å­—ç¬¦ï¼Œåˆ™å¯¹åº”çš„ç”¨æˆ·ä¸èƒ½ç™»å½•ã€‚</li>
<li><strong>â€œæœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´â€</strong>ï¼Œè¡¨ç¤ºçš„æ˜¯ä»æŸä¸ªæ—¶åˆ»èµ·ï¼Œåˆ°ç”¨æˆ·æœ€åä¸€æ¬¡ä¿®æ”¹å£ä»¤æ—¶çš„å¤©æ•°ã€‚æ—¶é—´èµ·ç‚¹å¯¹ä¸åŒçš„ç³»ç»Ÿå¯èƒ½ä¸ä¸€æ ·ã€‚ä¾‹å¦‚åœ¨SCO Linux ä¸­ï¼Œè¿™ä¸ªæ—¶é—´èµ·ç‚¹æ˜¯1970å¹´1æœˆ1æ—¥ã€‚</li>
<li><strong>â€œæœ€å°æ—¶é—´é—´éš”â€</strong>ï¼ŒæŒ‡çš„æ˜¯ä¸¤æ¬¡ä¿®æ”¹å£ä»¤ä¹‹é—´æ‰€éœ€çš„æœ€å°å¤©æ•°ã€‚</li>
<li><strong>â€œæœ€å¤§æ—¶é—´é—´éš”â€</strong>ï¼ŒæŒ‡çš„æ˜¯å£ä»¤ä¿æŒæœ‰æ•ˆçš„æœ€å¤§å¤©æ•°ã€‚</li>
<li><strong>â€œè­¦å‘Šæ—¶é—´â€</strong>ï¼Œè¡¨ç¤ºçš„æ˜¯ä»ç³»ç»Ÿå¼€å§‹è­¦å‘Šç”¨æˆ·åˆ°ç”¨æˆ·å¯†ç æ­£å¼å¤±æ•ˆä¹‹é—´çš„å¤©æ•°ã€‚</li>
<li><strong>â€œä¸æ´»åŠ¨æ—¶é—´â€</strong>ï¼Œè¡¨ç¤ºçš„æ˜¯ç”¨æˆ·æ²¡æœ‰ç™»å½•æ´»åŠ¨ä½†è´¦å·ä»èƒ½ä¿æŒæœ‰æ•ˆçš„æœ€å¤§å¤©æ•°ã€‚</li>
<li><strong>â€œå¤±æ•ˆæ—¶é—´â€</strong>ï¼Œç»™å‡ºçš„æ˜¯ä¸€ä¸ªç»å¯¹çš„å¤©æ•°ï¼Œå¦‚æœä½¿ç”¨äº†è¿™ä¸ªå­—æ®µï¼Œé‚£ä¹ˆå°±ç»™å‡ºç›¸åº”è´¦å·çš„ç”Ÿå­˜æœŸã€‚æœŸæ»¡åï¼Œè¯¥è´¦å·å°±ä¸å†æ˜¯ä¸€ä¸ªåˆæ³•çš„è´¦å·ï¼Œä¹Ÿå°±ä¸èƒ½å†ç”¨æ¥ç™»å½•äº†ã€‚</li>
</ol>
<p>/etc/shadow æ–‡ä»¶å†…å®¹å¦‚ä¸‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/23/opIlDA.png" alt=""></p>
<div class="note success">
            <p><strong>ç”¨æˆ·ç»„çš„æ‰€æœ‰ä¿¡æ¯éƒ½å­˜æ”¾åœ¨ /etc/group æ–‡ä»¶ä¸­</strong></p>
          </div>
<p>å°†ç”¨æˆ·åˆ†ç»„æ˜¯Linux ç³»ç»Ÿä¸­å¯¹ç”¨æˆ·è¿›è¡Œç®¡ç†åŠæ§åˆ¶è®¿é—®æƒé™çš„ä¸€ç§æ‰‹æ®µã€‚</p>
<p>æ¯ä¸ªç”¨æˆ·éƒ½å±äºæŸä¸ªç”¨æˆ·ç»„ï¼›ä¸€ä¸ªç»„ä¸­å¯ä»¥æœ‰å¤šä¸ªç”¨æˆ·ï¼Œä¸€ä¸ªç”¨æˆ·ä¹Ÿå¯ä»¥å±äºä¸åŒçš„ç»„ã€‚</p>
<p>å½“ä¸€ä¸ªç”¨æˆ·åŒæ—¶æ˜¯å¤šä¸ªç»„ä¸­çš„æˆå‘˜æ—¶ï¼Œåœ¨/etc/passwdæ–‡ä»¶ä¸­è®°å½•çš„æ˜¯ç”¨æˆ·æ‰€å±çš„ä¸»ç»„ï¼Œä¹Ÿå°±æ˜¯ç™»å½•æ—¶æ‰€å±çš„é»˜è®¤ç»„ï¼Œè€Œå…¶ä»–ç»„ç§°ä¸ºé™„åŠ ç»„ã€‚</p>
<p>ç”¨æˆ·è¦è®¿é—®å±äºé™„åŠ ç»„çš„æ–‡ä»¶æ—¶ï¼Œå¿…é¡»é¦–å…ˆä½¿ç”¨newgrpå‘½ä»¤ä½¿è‡ªå·±æˆä¸ºæ‰€è¦è®¿é—®çš„ç»„ä¸­çš„æˆå‘˜ã€‚</p>
<p>ç”¨æˆ·ç»„çš„æ‰€æœ‰ä¿¡æ¯éƒ½å­˜æ”¾åœ¨/etc/groupæ–‡ä»¶ä¸­ã€‚æ­¤æ–‡ä»¶çš„æ ¼å¼ä¹Ÿç±»ä¼¼äº/etc/passwdæ–‡ä»¶ï¼Œç”±å†’å·(:)éš”å¼€è‹¥å¹²ä¸ªå­—æ®µï¼Œè¿™äº›å­—æ®µæœ‰ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">ç»„å:å£ä»¤:ç»„æ ‡è¯†å·:ç»„å†…ç”¨æˆ·åˆ—è¡¨</span><br></pre></td></tr></tbody></table></figure>
<ol>
<li><strong>â€œç»„åâ€</strong>ï¼Œæ˜¯ç”¨æˆ·ç»„çš„åç§°ï¼Œç”±å­—æ¯æˆ–æ•°å­—æ„æˆã€‚ä¸/etc/passwdä¸­çš„ç™»å½•åä¸€æ ·ï¼Œç»„åä¸åº”é‡å¤ã€‚</li>
<li><strong>â€œå£ä»¤â€ï¼Œ</strong>å­˜æ”¾çš„æ˜¯ç”¨æˆ·ç»„åŠ å¯†åçš„å£ä»¤å­—ã€‚ä¸€èˆ¬Linux ç³»ç»Ÿçš„ç”¨æˆ·ç»„éƒ½æ²¡æœ‰å£ä»¤ï¼Œå³è¿™ä¸ªå­—æ®µä¸€èˆ¬ä¸ºç©ºï¼Œæˆ–è€…æ˜¯*ã€‚</li>
<li><strong>â€œç»„æ ‡è¯†å·â€ï¼Œ</strong>ä¸ç”¨æˆ·æ ‡è¯†å·ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œè¢«ç³»ç»Ÿå†…éƒ¨ç”¨æ¥æ ‡è¯†ç»„ã€‚</li>
<li><strong>â€œç»„å†…ç”¨æˆ·åˆ—è¡¨â€</strong>ï¼Œæ˜¯å±äºè¿™ä¸ªç»„çš„æ‰€æœ‰ç”¨æˆ·çš„åˆ—è¡¨ï¼Œä¸åŒç”¨æˆ·ä¹‹é—´ç”¨é€—å·(,)åˆ†éš”ã€‚è¿™ä¸ªç”¨æˆ·ç»„å¯èƒ½æ˜¯ç”¨æˆ·çš„ä¸»ç»„ï¼Œä¹Ÿå¯èƒ½æ˜¯é™„åŠ ç»„ã€‚</li>
</ol>
<p><img src="https://z3.ax1x.com/2021/11/23/op7lDJ.png" alt=""></p>
<h4 id="7-4ã€æ·»åŠ æ‰¹é‡ç”¨æˆ·"><a href="#7-4ã€æ·»åŠ æ‰¹é‡ç”¨æˆ·" class="headerlink" title="7.4ã€æ·»åŠ æ‰¹é‡ç”¨æˆ·"></a>7.4ã€æ·»åŠ æ‰¹é‡ç”¨æˆ·</h4><p>æ·»åŠ å’Œåˆ é™¤ç”¨æˆ·å¯¹æ¯ä½Linuxç³»ç»Ÿç®¡ç†å‘˜éƒ½æ˜¯è½»è€Œæ˜“ä¸¾çš„äº‹ï¼Œæ¯”è¾ƒæ£˜æ‰‹çš„æ˜¯å¦‚æœè¦æ·»åŠ å‡ åä¸ªã€ä¸Šç™¾ä¸ªç”šè‡³ä¸Šåƒä¸ªç”¨æˆ·æ—¶ï¼Œæˆ‘ä»¬ä¸å¤ªå¯èƒ½è¿˜ä½¿ç”¨useraddä¸€ä¸ªä¸€ä¸ªåœ°æ·»åŠ ï¼Œå¿…ç„¶è¦æ‰¾ä¸€ç§ç®€ä¾¿çš„åˆ›å»ºå¤§é‡ç”¨æˆ·çš„æ–¹æ³•ã€‚Linuxç³»ç»Ÿæä¾›äº†åˆ›å»ºå¤§é‡ç”¨æˆ·çš„å·¥å…·ï¼Œå¯ä»¥è®©æ‚¨ç«‹å³åˆ›å»ºå¤§é‡ç”¨æˆ·ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<font size="4px">**å…ˆç¼–è¾‘ä¸€ä¸ªæ–‡æœ¬ç”¨æˆ·æ–‡ä»¶**</font>

<p>æ¯ä¸€åˆ—æŒ‰ç…§<code>/etc/passwd</code>å¯†ç æ–‡ä»¶çš„æ ¼å¼ä¹¦å†™ï¼Œè¦æ³¨æ„æ¯ä¸ªç”¨æˆ·çš„ç”¨æˆ·åã€UIDã€å®¿ä¸»ç›®å½•éƒ½ä¸å¯ä»¥ç›¸åŒï¼Œå…¶ä¸­å¯†ç æ å¯ä»¥ç•™åšç©ºç™½æˆ–è¾“å…¥xå·ã€‚ä¸€ä¸ªèŒƒä¾‹æ–‡ä»¶user.txtå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">user001::600:100:user:/home/user001:/bin/bash</span><br><span class="line">user002::601:100:user:/home/user002:/bin/bash</span><br><span class="line">user003::602:100:user:/home/user003:/bin/bash</span><br><span class="line">user004::603:100:user:/home/user004:/bin/bash</span><br><span class="line">user005::604:100:user:/home/user005:/bin/bash</span><br><span class="line">user006::605:100:user:/home/user006:/bin/bash</span><br></pre></td></tr></tbody></table></figure>
<font size="4px">**ä»¥ root çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ /usr/sbin/newusersï¼Œä»åˆšåˆ›å»ºçš„ç”¨æˆ·æ–‡ä»¶ user.txt ä¸­å¯¼å…¥æ•°æ®ï¼Œåˆ›å»ºç”¨æˆ·ï¼š**</font>

<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">newusers &lt; user.txt</span><br></pre></td></tr></tbody></table></figure>
<p>ç„¶åå¯ä»¥æ‰§è¡Œå‘½ä»¤ <code>vipw</code> æˆ– <code>vi /etc/passwd</code> æ£€æŸ¥ <code>/etc/passwd</code> æ–‡ä»¶æ˜¯å¦å·²ç»å‡ºç°è¿™äº›ç”¨æˆ·çš„æ•°æ®ï¼Œå¹¶ä¸”ç”¨æˆ·çš„å®¿ä¸»ç›®å½•æ˜¯å¦å·²ç»åˆ›å»ºã€‚</p>
<font size="4px">**æ‰§è¡Œå‘½ä»¤ /usr/sbin/pwunconv**</font>

<p>å°† <code>/etc/shadow</code> äº§ç”Ÿçš„ <code>shadow</code> å¯†ç è§£ç ï¼Œç„¶åå›å†™åˆ° <code>/etc/passwd</code> ä¸­ï¼Œå¹¶å°†<code>/etc/shadow</code>çš„<code>shadow</code>å¯†ç æ åˆ æ‰ã€‚è¿™æ˜¯ä¸ºäº†æ–¹ä¾¿ä¸‹ä¸€æ­¥çš„å¯†ç è½¬æ¢å·¥ä½œï¼Œå³å…ˆå–æ¶ˆ <code>shadow password</code> åŠŸèƒ½ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">pwunconv</span><br></pre></td></tr></tbody></table></figure>
<font size="4px">**ç¼–è¾‘æ¯ä¸ªç”¨æˆ·çš„å¯†ç å¯¹ç…§æ–‡ä»¶**</font>

<p>æ ¼å¼ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">ç”¨æˆ·å:å¯†ç </span><br></pre></td></tr></tbody></table></figure>
<p>å®ä¾‹æ–‡ä»¶ <code>passwd.txt</code> å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">user001:123456</span><br><span class="line">user002:123456</span><br><span class="line">user003:123456</span><br><span class="line">user004:123456</span><br><span class="line">user005:123456</span><br><span class="line">user006:123456</span><br></pre></td></tr></tbody></table></figure>
<font size="4px">**ä»¥ root èº«ä»½æ‰§è¡Œå‘½ä»¤ /usr/sbin/chpasswd**</font>

<p>åˆ›å»ºç”¨æˆ·å¯†ç ï¼Œ<code>chpasswd</code> ä¼šå°†ç»è¿‡ <code>/usr/bin/passwd</code> å‘½ä»¤ç¼–ç è¿‡çš„å¯†ç å†™å…¥ <code>/etc/passwd</code> çš„å¯†ç æ ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">chpasswd &lt; passwd.txt</span><br></pre></td></tr></tbody></table></figure>
<font size="4px">**ç¡®å®šå¯†ç ç»ç¼–ç å†™å…¥/etc/passwdçš„å¯†ç æ å**</font>

<p>æ‰§è¡Œå‘½ä»¤ <code>/usr/sbin/pwconv</code> å°†å¯†ç ç¼–ç ä¸º <code>shadow password</code>ï¼Œå¹¶å°†ç»“æœå†™å…¥ <code>/etc/shadow</code>ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">pwconv</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™æ ·å°±å®Œæˆäº†å¤§é‡ç”¨æˆ·çš„åˆ›å»ºäº†ï¼Œä¹‹åæ‚¨å¯ä»¥åˆ°/homeä¸‹æ£€æŸ¥è¿™äº›ç”¨æˆ·å®¿ä¸»ç›®å½•çš„æƒé™è®¾ç½®æ˜¯å¦éƒ½æ­£ç¡®ï¼Œå¹¶ç™»å½•éªŒè¯ç”¨æˆ·å¯†ç æ˜¯å¦æ­£ç¡®ã€‚</p>
<h2 id="8ã€ç£ç›˜ç®¡ç†"><a href="#8ã€ç£ç›˜ç®¡ç†" class="headerlink" title="8ã€ç£ç›˜ç®¡ç†"></a>8ã€ç£ç›˜ç®¡ç†</h2><h4 id="8-1ã€df-å’Œ-du"><a href="#8-1ã€df-å’Œ-du" class="headerlink" title="8.1ã€df å’Œ du"></a>8.1ã€df å’Œ du</h4><p>Linux ç£ç›˜ç®¡ç†å¥½åç›´æ¥å…³ç³»åˆ°æ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½é—®é¢˜ã€‚</p>
<p>Linux ç£ç›˜ç®¡ç†å¸¸ç”¨ä¸‰ä¸ªå‘½ä»¤ä¸º <strong>df</strong> å’Œ <strong>du</strong>ã€‚</p>
<ul>
<li><strong>df</strong>ï¼ˆè‹±æ–‡å…¨ç§°ï¼šdisk fullï¼‰ï¼šåˆ—å‡ºæ–‡ä»¶ç³»ç»Ÿçš„æ•´ä½“ç£ç›˜ä½¿ç”¨é‡</li>
<li><strong>du</strong>ï¼ˆè‹±æ–‡å…¨ç§°ï¼šdisk usedï¼‰ï¼šæ£€æŸ¥ç£ç›˜ç©ºé—´ä½¿ç”¨é‡</li>
</ul>
<p><strong></strong></p><div class="note success"><strong>
            <p>df</p>
          </strong></div><p></p>
<p>df å‘½ä»¤å‚æ•°åŠŸèƒ½ï¼šæ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ç©ºé—´å ç”¨æƒ…å†µã€‚å¯ä»¥åˆ©ç”¨è¯¥å‘½ä»¤æ¥è·å–ç¡¬ç›˜è¢«å ç”¨äº†å¤šå°‘ç©ºé—´ï¼Œç›®å‰è¿˜å‰©ä¸‹å¤šå°‘ç©ºé—´ç­‰ä¿¡æ¯ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">df [-ahikHTm] [ç›®å½•æˆ–æ–‡ä»¶å]</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li>-a ï¼šåˆ—å‡ºæ‰€æœ‰çš„æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…æ‹¬ç³»ç»Ÿç‰¹æœ‰çš„ /proc ç­‰æ–‡ä»¶ç³»ç»Ÿï¼›</li>
<li>-k ï¼šä»¥ KBytes çš„å®¹é‡æ˜¾ç¤ºå„æ–‡ä»¶ç³»ç»Ÿï¼›</li>
<li>-m ï¼šä»¥ MBytes çš„å®¹é‡æ˜¾ç¤ºå„æ–‡ä»¶ç³»ç»Ÿï¼›</li>
<li>-h ï¼šä»¥äººä»¬è¾ƒæ˜“é˜…è¯»çš„ GBytes, MBytes, KBytes ç­‰æ ¼å¼è‡ªè¡Œæ˜¾ç¤ºï¼›</li>
<li>-H ï¼šä»¥ M=1000K å–ä»£ M=1024K çš„è¿›ä½æ–¹å¼ï¼›</li>
<li>-T ï¼šæ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿç±»å‹, è¿åŒè¯¥ partition çš„ filesystem åç§° (ä¾‹å¦‚ ext3) ä¹Ÿåˆ—å‡ºï¼›</li>
<li>-i ï¼šä¸ç”¨ç¡¬ç›˜å®¹é‡ï¼Œè€Œä»¥ inode çš„æ•°é‡æ¥æ˜¾ç¤º</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@deflory /]<span class="comment"># df</span></span><br><span class="line">Filesystem     1K-blocks    Used Available Use% Mounted on</span><br><span class="line">devtmpfs          930364       0    930364   0% /dev</span><br><span class="line">tmpfs             940912       0    940912   0% /dev/shm</span><br><span class="line">tmpfs             940912     452    940460   1% /run</span><br><span class="line">tmpfs             940912       0    940912   0% /sys/fs/cgroup</span><br><span class="line">/dev/vda1       51474024 2238768  46912128   5% /</span><br><span class="line">tmpfs             188184       0    188184   0% /run/user/0</span><br><span class="line"></span><br><span class="line">[root@deflory /]<span class="comment"># df -h</span></span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">devtmpfs        909M     0  909M   0% /dev</span><br><span class="line">tmpfs           919M     0  919M   0% /dev/shm</span><br><span class="line">tmpfs           919M  452K  919M   1% /run</span><br><span class="line">tmpfs           919M     0  919M   0% /sys/fs/cgroup</span><br><span class="line">/dev/vda1        50G  2.2G   45G   5% /</span><br><span class="line">tmpfs           184M     0  184M   0% /run/user/0</span><br></pre></td></tr></tbody></table></figure>
<p>åœ¨ Linux åº•ä¸‹å¦‚æœ df æ²¡æœ‰åŠ ä»»ä½•é€‰é¡¹ï¼Œé‚£ä¹ˆé»˜è®¤ä¼šå°†ç³»ç»Ÿå†…æ‰€æœ‰çš„ (ä¸å«ç‰¹æ®Šå†…å­˜å†…çš„æ–‡ä»¶ç³»ç»Ÿä¸ swap) éƒ½ä»¥ 1 Kbytes çš„å®¹é‡æ¥åˆ—å‡ºæ¥ï¼</p>
<p><strong></strong></p><div class="note success"><strong>
            <p>du</p>
          </strong></div><p></p>
<p>Linux du å‘½ä»¤ä¹Ÿæ˜¯æŸ¥çœ‹ä½¿ç”¨ç©ºé—´çš„ï¼Œä½†æ˜¯ä¸ df å‘½ä»¤ä¸åŒçš„æ˜¯ Linux du å‘½ä»¤æ˜¯å¯¹æ–‡ä»¶å’Œç›®å½•ç£ç›˜ä½¿ç”¨çš„ç©ºé—´çš„æŸ¥çœ‹ï¼Œè¿˜æ˜¯å’Œdfå‘½ä»¤æœ‰ä¸€äº›åŒºåˆ«çš„ï¼Œè¿™é‡Œä»‹ç» Linux du å‘½ä»¤ã€‚</p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">du [-ahskm] æ–‡ä»¶æˆ–ç›®å½•åç§°</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li>-a ï¼šåˆ—å‡ºæ‰€æœ‰çš„æ–‡ä»¶ä¸ç›®å½•å®¹é‡ï¼Œå› ä¸ºé»˜è®¤ä»…ç»Ÿè®¡ç›®å½•åº•ä¸‹çš„æ–‡ä»¶é‡è€Œå·²ã€‚</li>
<li>-h ï¼šä»¥äººä»¬è¾ƒæ˜“è¯»çš„å®¹é‡æ ¼å¼ (G/M) æ˜¾ç¤ºï¼›</li>
<li>-s ï¼šåˆ—å‡ºæ€»é‡è€Œå·²ï¼Œè€Œä¸åˆ—å‡ºæ¯ä¸ªå„åˆ«çš„ç›®å½•å ç”¨å®¹é‡ï¼›</li>
<li>-S ï¼šä¸åŒ…æ‹¬å­ç›®å½•ä¸‹çš„æ€»è®¡ï¼Œä¸ -s æœ‰ç‚¹å·®åˆ«ã€‚</li>
<li>-k ï¼šä»¥ KBytes åˆ—å‡ºå®¹é‡æ˜¾ç¤ºï¼›</li>
<li>-m ï¼šä»¥ MBytes åˆ—å‡ºå®¹é‡æ˜¾ç¤ºï¼›</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸è¦å†æ ¹ç›®å½•ä¸‹ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼Œå®ƒä¼šé€’å½’å°†æ‰€æœ‰æ–‡ä»¶çš„æ‰€å ç£ç›˜ç©ºé—´éƒ½æ˜¾ç¤ºå‡ºæ¥ï¼Œä¼šå¾ˆå¤šï¼</span></span><br><span class="line">[root@deflory ~]<span class="comment"># du -h</span></span><br><span class="line">8.0K	./.pip</span><br><span class="line">4.0K	./.ssh</span><br><span class="line">8.0K	./.cache/pip/http/f/e/d/0/e</span><br><span class="line">12K	./.cache/pip/http/f/e/d/0</span><br><span class="line">16K	./.cache/pip/http/f/e/d</span><br><span class="line">20K	./.cache/pip/http/f/e</span><br><span class="line">24K	./.cache/pip/http/f</span><br><span class="line">36K	./.cache/pip/http/b/b/8/7/6</span><br><span class="line">40K	./.cache/pip/http/b/b/8/7</span><br><span class="line">44K	./.cache/pip/http/b/b/8</span><br><span class="line">48K	./.cache/pip/http/b/b</span><br><span class="line">52K	./.cache/pip/http/b</span><br><span class="line">80K	./.cache/pip/http</span><br><span class="line">88K	./.cache/pip</span><br><span class="line">92K	./.cache</span><br><span class="line">136K	.</span><br><span class="line"></span><br><span class="line">[root@deflory ~]<span class="comment"># du -sm /*</span></span><br><span class="line">0	/bin</span><br><span class="line">148	/boot</span><br><span class="line">0	/dev</span><br><span class="line">35	/etc</span><br><span class="line">1	/home</span><br><span class="line">0	/lib</span><br><span class="line">0	/lib64</span><br><span class="line">1	/lost+found</span><br><span class="line">1	/media</span><br><span class="line">1	/mnt</span><br><span class="line">1	/opt</span><br><span class="line">du: cannot access â€˜/proc/2407/task/2407/fd/4â€™: No such file or directory</span><br><span class="line">du: cannot access â€˜/proc/2407/task/2407/fdinfo/4â€™: No such file or directory</span><br><span class="line">du: cannot access â€˜/proc/2407/fd/4â€™: No such file or directory</span><br><span class="line">du: cannot access â€˜/proc/2407/fdinfo/4â€™: No such file or directory</span><br><span class="line">0	/proc</span><br><span class="line">1	/root</span><br><span class="line">1	/run</span><br><span class="line">0	/sbin</span><br><span class="line">1	/srv</span><br><span class="line">0	/sys</span><br><span class="line">1	/tmp</span><br><span class="line">1754	/usr	<span class="comment"># å‰æœŸ/usræœ€å¤§</span></span><br><span class="line">200	/var</span><br></pre></td></tr></tbody></table></figure>
<h4 id="8-2ã€ç£ç›˜æŒ‚è½½å’Œå¸é™¤"><a href="#8-2ã€ç£ç›˜æŒ‚è½½å’Œå¸é™¤" class="headerlink" title="8.2ã€ç£ç›˜æŒ‚è½½å’Œå¸é™¤"></a>8.2ã€ç£ç›˜æŒ‚è½½å’Œå¸é™¤</h4><p>Linux çš„ç£ç›˜æŒ‚è½½ä½¿ç”¨ <code>mount</code> å‘½ä»¤ï¼Œå¸è½½ä½¿ç”¨ <code>umount</code> å‘½ä»¤ã€‚</p>
<p>ç£ç›˜æŒ‚è½½è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">mount [-t æ–‡ä»¶ç³»ç»Ÿ] [-L Labelå] [-o é¢å¤–é€‰é¡¹] [-n]  è£…ç½®æ–‡ä»¶å  æŒ‚è½½ç‚¹</span><br></pre></td></tr></tbody></table></figure>
<p>ç”¨é»˜è®¤çš„æ–¹å¼ï¼Œå°†åˆšåˆšåˆ›å»ºçš„ /dev/hdc6 æŒ‚è½½åˆ° /mnt/hdc6 ä¸Šé¢ï¼</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># mkdir /mnt/hdc6</span></span><br><span class="line">[root@www ~]<span class="comment"># mount /dev/hdc6 /mnt/hdc6</span></span><br><span class="line">[root@www ~]<span class="comment"># df</span></span><br><span class="line">Filesystem           1K-blocks      Used Available Use% Mounted on</span><br><span class="line">.....ä¸­é—´çœç•¥.....</span><br><span class="line">/dev/hdc6              1976312     42072   1833836   3% /mnt/hdc6</span><br></pre></td></tr></tbody></table></figure>
<p>ç£ç›˜å¸è½½å‘½ä»¤ <code>umount</code> è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">umount [-fn] è£…ç½®æ–‡ä»¶åæˆ–æŒ‚è½½ç‚¹</span><br></pre></td></tr></tbody></table></figure>
<p>é€‰é¡¹ä¸å‚æ•°ï¼š</p>
<ul>
<li>-f ï¼šå¼ºåˆ¶å¸é™¤ï¼å¯ç”¨åœ¨ç±»ä¼¼ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿ (NFS) æ— æ³•è¯»å–åˆ°çš„æƒ…å†µä¸‹ï¼›</li>
<li>-n ï¼šä¸å‡çº§ /etc/mtab æƒ…å†µä¸‹å¸é™¤ã€‚</li>
</ul>
<p>å¸è½½/dev/hdc6</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@www ~]<span class="comment"># umount /dev/hdc6   </span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="9ã€è¿›ç¨‹ç®¡ç†"><a href="#9ã€è¿›ç¨‹ç®¡ç†" class="headerlink" title="9ã€è¿›ç¨‹ç®¡ç†"></a>9ã€è¿›ç¨‹ç®¡ç†</h2><p>å¯¹äºæˆ‘ä»¬å¼€å‘äººå‘˜æ¥è¯´ï¼Œå…¶å® Linux æ›´å¤šåå‘äºä½¿ç”¨å³å¯ï¼</p>
<h4 id="9-1ã€è¿›ç¨‹çš„åŸºæœ¬æ¦‚å¿µ"><a href="#9-1ã€è¿›ç¨‹çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="9.1ã€è¿›ç¨‹çš„åŸºæœ¬æ¦‚å¿µ"></a>9.1ã€è¿›ç¨‹çš„åŸºæœ¬æ¦‚å¿µ</h4><ol>
<li>åœ¨ Linux ä¸­ï¼Œæ¯ä¸€ä¸ªç¨‹åºéƒ½æ˜¯æœ‰è‡ªå·±çš„ä¸€ä¸ªè¿›ç¨‹ï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ª id å·ï¼</li>
<li>æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½ä¼šæœ‰ä¸€ä¸ªçˆ¶è¿›ç¨‹ã€‚</li>
<li>è¿›ç¨‹æœ‰ä¸¤ç§è¿è¡Œæ–¹å¼ï¼šå‰å°å’Œåå°ã€‚</li>
<li>ä¸€èˆ¬æœåŠ¡éƒ½æ˜¯åœ¨åå°è¿è¡Œï¼Œç¨‹åºéƒ½æ˜¯åœ¨å‰å°è¿è¡Œã€‚</li>
</ol>
<h4 id="9-2ã€æœ‰å…³è¿›ç¨‹å‘½ä»¤"><a href="#9-2ã€æœ‰å…³è¿›ç¨‹å‘½ä»¤" class="headerlink" title="9.2ã€æœ‰å…³è¿›ç¨‹å‘½ä»¤"></a>9.2ã€æœ‰å…³è¿›ç¨‹å‘½ä»¤</h4><div class="note success">
            <p>ps æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­æ­£åœ¨æ‰§è¡Œçš„å„ç§è¿›ç¨‹ä¿¡æ¯</p>
          </div>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">ps [-aux]</span><br></pre></td></tr></tbody></table></figure>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li>-a æ˜¾ç¤ºå½“å‰ç»ˆç«¯è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯</li>
<li>-u ä»¥ç”¨æˆ·çš„ä¿¡æ¯æ˜¾ç¤ºè¿›ç¨‹</li>
<li>-x æ˜¾ç¤ºåå°è¿è¡Œè¿›ç¨‹çš„å‚æ•°</li>
</ul>
<p>ç”±äº <code>ps -aux</code> ä¼šæŸ¥çœ‹æ‰€æœ‰çš„è¿›ç¨‹ï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šé…åˆ <code>|grep</code> æŸ¥è¯¢æŒ‡å®šçš„è¿›ç¨‹ã€‚</p>
<p>â€œ|â€  æ˜¯ Linux ç®¡é“å‘½ä»¤æ“ä½œç¬¦ï¼Œç®€ç§°ç®¡é“ç¬¦ã€‚ä½¿ç”¨æ­¤ç®¡é“ç¬¦ â€œ|â€ å¯ä»¥å°†ä¸¤ä¸ªå‘½ä»¤åˆ†éš”å¼€ï¼Œâ€œ|â€ å·¦è¾¹å‘½ä»¤çš„è¾“å‡ºå°±ä¼šä½œä¸º â€œ|â€ å³è¾¹å‘½ä»¤çš„è¾“å…¥ï¼Œæ­¤å‘½ä»¤å¯è¿ç»­ä½¿ç”¨ï¼Œç¬¬ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä¼šä½œä¸ºç¬¬äºŒä¸ªå‘½ä»¤çš„è¾“å…¥ï¼Œç¬¬äºŒä¸ªå‘½ä»¤çš„è¾“å‡ºåˆä¼šä½œä¸ºç¬¬ä¸‰ä¸ªå‘½ä»¤çš„è¾“å…¥ï¼Œä¾æ­¤ç±»æ¨ã€‚</p>
<p>å› æ­¤ <strong>ps -aux |grep mysql</strong> å³æ„è°“å¯»æ‰¾æœ‰å…³ mysql çš„è¿›ç¨‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/23/o9J1aV.png" alt=""></p>
<p><strong><font size="4px">ps -efï¼šå¯ä»¥æŸ¥çœ‹çˆ¶è¿›ç¨‹çš„ä¿¡æ¯</font></strong></p>
<p><img src="https://z3.ax1x.com/2021/11/23/o9YZo6.png" alt=""></p>
<p><strong><font size="4px">pstree -puï¼šæŸ¥çœ‹ç›®å½•æ ‘ç»“æ„ï¼ˆ-p æ˜¾ç¤ºçˆ¶idï¼›-u æ˜¾ç¤ºç”¨æˆ·ç»„ï¼‰</font></strong></p>
<p><img src="https://z3.ax1x.com/2021/11/23/o9Y1OA.png" alt=""></p>
<p><strong></strong></p><div class="note success"><strong>
            <p>kill -9 æ€æ­»è¿›ç¨‹</p>
          </strong></div><p></p>
<p>è¯­æ³•ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">kill</span> -9 è¿›ç¨‹id</span><br></pre></td></tr></tbody></table></figure>
<h2 id="10ã€è½¯ä»¶å®‰è£…çš„ä¸‰ç§æ–¹å¼"><a href="#10ã€è½¯ä»¶å®‰è£…çš„ä¸‰ç§æ–¹å¼" class="headerlink" title="10ã€è½¯ä»¶å®‰è£…çš„ä¸‰ç§æ–¹å¼"></a>10ã€è½¯ä»¶å®‰è£…çš„ä¸‰ç§æ–¹å¼</h2><h4 id="10-1ã€å®‰è£…-jdkï¼ˆrpmï¼‰"><a href="#10-1ã€å®‰è£…-jdkï¼ˆrpmï¼‰" class="headerlink" title="10.1ã€å®‰è£… jdkï¼ˆrpmï¼‰"></a>10.1ã€å®‰è£… jdkï¼ˆrpmï¼‰</h4><p>rpmä¸‹è½½åœ°å€ï¼š<a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a></p>
<p>ä¸‹è½½å®Œæ¯•å¯ä»¥ä½¿ç”¨ <strong>Xftp</strong> è¿œç¨‹ä¼ è¾“åˆ°æœåŠ¡å™¨ä¸­ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/23/oCAnUI.png" alt=""></p>
<p><strong><font size="4px">å®‰è£… JDKï¼ˆrpmï¼‰ï¼šrpm -ivh jdk-8u311-linux-x64.rpm</font></strong></p>
<p><img src="https://z3.ax1x.com/2021/11/23/oCAdP0.png" alt=""></p>
<p>rpm å®‰è£…ä¼šæŠŠ java/bin ç›®å½•ä¸‹çš„ javaã€javac ç­‰å‘½ä»¤å¤åˆ¶åˆ° <code>/usr/bin</code> ç›®å½•ä¸‹ï¼Œæ‰€ä»¥åœ¨ /etc/profile æˆ– /etc/profile.d ä¸­éƒ½æ‰¾ä¸åˆ°å…³äºjavaç¯å¢ƒçš„ä»»ä½•é…ç½®ï¼Œå¹¶ä¸”ä»ç„¶å¯ä»¥ä½¿ç”¨javaï¼Œä¹Ÿå°±æ˜¯è¯´ä¸éœ€è¦é…ç½®ç¯å¢ƒå˜é‡ï¼<br>åŒç†åœ¨ Windows ä¸ŠæŠŠä½ ä»¬çš„ jdk/bin ç›®å½•ä¸‹çš„æ–‡ä»¶éƒ½å¤åˆ¶åˆ° C:\Windows\System32\ ç›®å½•ä¸‹ä¹Ÿå¯ä»¥å®ç°åƒ rpm çš„æ•ˆæœã€‚</p>
<p><strong><font size="4px">å¸è½½ JDKï¼ˆrpmï¼‰ï¼šrpm -qa|grep jdk</font></strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">rpm -qa|grep jdk <span class="comment"># æŸ¥è¯¢javaç‰ˆæœ¬</span></span><br><span class="line">jdk1.8-1.8.0_311-fcs.x86_64</span><br><span class="line">rpm -e --nodeps jdk1.8-1.8.0_311-fcs.x86_64 <span class="comment"># å¸è½½è¯¥javaç‰ˆæœ¬</span></span><br><span class="line">java <span class="comment"># å†æ¬¡è¿è¡Œjavaå‘½ä»¤</span></span><br><span class="line">-bash: /usr/bin/java: No such file or directory</span><br></pre></td></tr></tbody></table></figure>
<p><strong><font size="4px">é…ç½®ç¯å¢ƒå˜é‡</font></strong></p>
<p>æ­£å¦‚ä¸Šæ–‡æ‰€è¯´ï¼Œå› ä¸ºæ˜¯ rpm å®‰è£…ï¼Œå› æ­¤å¹¶ä¸éœ€è¦é…ç½®ç¯å¢ƒå˜é‡ï¼Œä½†è¿™é‡Œè¿˜æ˜¯è®°å½•ä¸€ä¸‹ï¼Œä»¥å…åé¢ç”¨åˆ°ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…å®Œæˆåé…ç½®ç¯å¢ƒå˜é‡ æ–‡ä»¶ï¼š/etc/profile</span></span><br><span class="line">JAVA_HOME=/usr/java/jdk1.8.0_221-amd64</span><br><span class="line">CLASSPATH=%JAVA_HOME%/lib:%JAVA_HOME%/jre/lib <span class="comment"># ç”¨ï¼šåˆ†å‰²!</span></span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$JAVA_HOME</span>/jre/bin</span><br><span class="line"><span class="built_in">export</span> PATH CLASSPATH JAVA_HOME</span><br><span class="line"><span class="comment"># ä¿å­˜é€€å‡º</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®©æ–°å¢çš„ç¯å¢ƒå˜é‡ç”Ÿæ•ˆï¼</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯• java -version</span></span><br><span class="line">[root@kuangshen java]<span class="comment"># java -version</span></span><br><span class="line">java version <span class="string">"1.8.0_221"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_221-b11)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.221-b11, mixed mode)</span><br></pre></td></tr></tbody></table></figure>
<h4 id="10-2ã€tomcat-å®‰è£…ï¼ˆå‹ç¼©åŒ…ï¼‰"><a href="#10-2ã€tomcat-å®‰è£…ï¼ˆå‹ç¼©åŒ…ï¼‰" class="headerlink" title="10.2ã€tomcat å®‰è£…ï¼ˆå‹ç¼©åŒ…ï¼‰"></a>10.2ã€tomcat å®‰è£…ï¼ˆå‹ç¼©åŒ…ï¼‰</h4><p>ä¸‹è½½ tomcat çš„å‹ç¼©åŒ… <strong>apache-tomcat-9.0.55.tar.gz</strong>ï¼Œåœ°å€ï¼š<a href="https://tomcat.apache.org/download-90.cgiã€‚">https://tomcat.apache.org/download-90.cgiã€‚</a></p>
<p><strong><font size="4px">è§£å‹ç¼©è‡³ /usr ä¸‹</font></strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">tar -zxvf apache-tomcat-9.0.22.tar.gz -C /usr</span><br></pre></td></tr></tbody></table></figure>
<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li><p>-c å»ºç«‹æ–°çš„å‹ç¼©æ–‡ä»¶ </p>
</li>
<li><p>-r æ·»åŠ æ–‡ä»¶åˆ°å·²ç»å‹ç¼©çš„æ–‡ä»¶ </p>
</li>
<li>-u æ·»åŠ æ”¹å˜äº†å’Œç°æœ‰çš„æ–‡ä»¶åˆ°å·²ç»å­˜åœ¨çš„å‹ç¼©æ–‡ä»¶ </li>
<li>-x ä»å‹ç¼©çš„æ–‡ä»¶ä¸­æå–æ–‡ä»¶ </li>
<li>-t æ˜¾ç¤ºå‹ç¼©æ–‡ä»¶çš„å†…å®¹ </li>
<li>-z æ”¯æŒgzipè§£å‹æ–‡ä»¶ </li>
<li>-j æ”¯æŒbzip2è§£å‹æ–‡ä»¶ </li>
<li>-v æ˜¾ç¤ºæ“ä½œè¿‡ç¨‹ </li>
<li>-k ä¿ç•™æºæœ‰æ–‡ä»¶ä¸è¦†ç›– </li>
<li>-C åˆ‡æ¢åˆ°æŒ‡å®šç›®å½• </li>
<li>-f æŒ‡å®šå‹ç¼©æ–‡ä»¶</li>
</ul>
<p><strong><font size="4px">è¿è¡Œ Tomcat</font></strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># éœ€è¦è¿›å…¥åˆ°tomcatçš„binç›®å½•</span></span><br><span class="line"><span class="comment"># æ‰§è¡Œï¼šstartup.sh --&gt;å¯åŠ¨tomcat</span></span><br><span class="line"><span class="comment"># æ‰§è¡Œï¼šshutdown.sh --&gt;å…³é—­tomcat</span></span><br><span class="line">./startup.sh</span><br><span class="line">./shutdown.sh</span><br></pre></td></tr></tbody></table></figure>
<p><strong><font size="4px">ç¡®ä¿ Linux çš„é˜²ç«å¢™ç«¯å£æ˜¯å¼€å¯çš„</font></strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹firewallæœåŠ¡çŠ¶æ€</span></span><br><span class="line">systemctl status firewalld</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯ã€é‡å¯ã€å…³é—­ã€firewalld.serviceæœåŠ¡</span></span><br><span class="line"><span class="comment"># å¼€å¯</span></span><br><span class="line">service firewalld start</span><br><span class="line"><span class="comment"># é‡å¯</span></span><br><span class="line">service firewalld restart</span><br><span class="line"><span class="comment"># å…³é—­</span></span><br><span class="line">service firewalld stop</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™</span></span><br><span class="line">firewall-cmd --list-all    <span class="comment"># æŸ¥çœ‹å…¨éƒ¨ä¿¡æ¯</span></span><br><span class="line">firewall-cmd --list-ports  <span class="comment"># åªçœ‹ç«¯å£ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯ç«¯å£</span></span><br><span class="line">å¼€ç«¯å£å‘½ä»¤ï¼šfirewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class="line">é‡å¯é˜²ç«å¢™ï¼šsystemctl restart firewalld.service</span><br><span class="line"></span><br><span class="line">å‘½ä»¤å«ä¹‰ï¼š</span><br><span class="line">--zone <span class="comment">#ä½œç”¨åŸŸ</span></span><br><span class="line">--add-port=80/tcp  <span class="comment">#æ·»åŠ ç«¯å£ï¼Œæ ¼å¼ä¸ºï¼šç«¯å£/é€šè®¯åè®®</span></span><br><span class="line">--permanent   <span class="comment">#æ°¸ä¹…ç”Ÿæ•ˆï¼Œæ²¡æœ‰æ­¤å‚æ•°é‡å¯åå¤±æ•ˆ</span></span><br></pre></td></tr></tbody></table></figure>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
  </entry>
  <entry>
    <title>MySQL</title>
    <url>/2021/11/15/MySQL/</url>
    <content><![CDATA[<h2 id="ä¸€ã€MySQL-å…¥é—¨"><a href="#ä¸€ã€MySQL-å…¥é—¨" class="headerlink" title="ä¸€ã€MySQL å…¥é—¨"></a>ä¸€ã€MySQL å…¥é—¨</h2><p>MySQL æ˜¯æœ€æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œåœ¨ WEB åº”ç”¨æ–¹é¢ MySQL æ˜¯æœ€å¥½çš„ RDBMSï¼ˆRelational Database Management Systemï¼‰åº”ç”¨è½¯ä»¶ä¹‹ä¸€ã€‚</p>
<h4 id="1ã€ä»€ä¹ˆæ˜¯æ•°æ®åº“ï¼Ÿ"><a href="#1ã€ä»€ä¹ˆæ˜¯æ•°æ®åº“ï¼Ÿ" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯æ•°æ®åº“ï¼Ÿ"></a>1ã€ä»€ä¹ˆæ˜¯æ•°æ®åº“ï¼Ÿ</h4><p>æ•°æ®åº“ï¼ˆDataBaseï¼Œç®€ç§°DBï¼‰</p>
<p><strong>æ¦‚å¿µ</strong>ï¼šé•¿æœŸå­˜æ”¾åœ¨è®¡ç®—æœºå†…ï¼Œæœ‰ç»„ç»‡ï¼Œå¯å…±äº«çš„å¤§é‡æ•°æ®çš„é›†åˆï¼Œæ˜¯ä¸€ä¸ªæ•°æ®â€œä»“åº“â€ã€‚</p>
<p><strong>ä½œç”¨</strong>ï¼šä¿å­˜ï¼Œå¹¶èƒ½å®‰å…¨ç®¡ç†æ•°æ®ï¼ˆå¢åˆ æ”¹æŸ¥ç­‰ï¼‰ï¼Œå‡å°‘å†—ä½™â€¦</p>
<p><strong>æ•°æ®åº“æ€»è§ˆ</strong></p>
<ul>
<li>å…³ç³»å‹æ•°æ®åº“ï¼ˆSQLï¼‰<ul>
<li>MySQLï¼ŒOracleï¼ŒSQL Serverï¼ŒSQLiteï¼ŒDB2â€¦</li>
<li>å…³ç³»å‹æ•°æ®åº“é€šè¿‡å¤–é”®å…³è”æ¥å»ºç«‹è¡¨ä¸è¡¨ä¹‹é—´çš„å…³ç³»ã€‚</li>
</ul>
</li>
<li>éå…³ç³»å‹æ•°æ®åº“ï¼ˆNOSQLï¼ŒNot Only SQLï¼‰<ul>
<li>Redisï¼ŒMongoDBâ€¦</li>
<li>éå…³ç³»å‹æ•°æ®åº“é€šå¸¸æŒ‡æ•°æ®ä»¥å¯¹è±¡çš„å½¢å¼å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œè€Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»é€šè¿‡æ¯ä¸ªå¯¹è±¡è‡ªèº«çš„å±æ€§æ¥å†³å®šã€‚</li>
</ul>
</li>
</ul>
<span id="more"></span>
<h4 id="2ã€ä»€ä¹ˆæ˜¯-DBMS"><a href="#2ã€ä»€ä¹ˆæ˜¯-DBMS" class="headerlink" title="2ã€ä»€ä¹ˆæ˜¯ DBMS?"></a>2ã€ä»€ä¹ˆæ˜¯ DBMS?</h4><p>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆ<strong>D</strong>ata<strong>B</strong>ase <strong>M</strong>anagement <strong>S</strong>ystemï¼‰</p>
<p>æ•°æ®åº“ç®¡ç†è½¯ä»¶ï¼Œç§‘å­¦ç»„ç»‡å’Œå­˜å‚¨æ•°æ®ï¼Œé«˜æ•ˆåœ°è·å–å’Œç»´æŠ¤æ•°æ®ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/15/IRrIw6.png" alt=""></p>
<p>ä¸é‚£ä¹ˆä¸¥æ ¼çš„è¯ï¼ŒMySQLä¹Ÿç®—æ˜¯ä¸€ä¸ªæ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚</p>
<h4 id="3ã€MySQLç®€ä»‹"><a href="#3ã€MySQLç®€ä»‹" class="headerlink" title="3ã€MySQLç®€ä»‹"></a>3ã€MySQLç®€ä»‹</h4><p><img src="https://z3.ax1x.com/2021/11/15/IRsSTf.png" alt=""></p>
<p><strong>æ¦‚å¿µ</strong>ï¼šæ˜¯ç°åœ¨<strong>æµè¡Œ</strong>çš„ã€<strong>å¼€æº</strong>çš„ã€<strong>å…è´¹</strong>çš„ã€<strong>å…³ç³»å‹</strong>æ•°æ®åº“ã€‚</p>
<p><strong>å†å²</strong>ï¼šç”±ç‘å…¸MySQL ABå…¬å¸å¼€å‘ï¼Œç›®å‰å±äº Oracle æ——ä¸‹äº§å“ã€‚</p>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>MySQL æ˜¯å¼€æºçš„ï¼Œç›®å‰éš¶å±äº Oracle æ——ä¸‹äº§å“ã€‚</li>
<li>MySQL æ”¯æŒå¤§å‹çš„æ•°æ®åº“ã€‚å¯ä»¥å¤„ç†æ‹¥æœ‰ä¸Šåƒä¸‡æ¡è®°å½•çš„å¤§å‹æ•°æ®åº“ã€‚</li>
<li>MySQL ä½¿ç”¨æ ‡å‡†çš„ SQL æ•°æ®è¯­è¨€å½¢å¼ã€‚</li>
<li>MySQL å¯ä»¥è¿è¡Œäºå¤šä¸ªç³»ç»Ÿä¸Šï¼Œå¹¶ä¸”æ”¯æŒå¤šç§è¯­è¨€ã€‚è¿™äº›ç¼–ç¨‹è¯­è¨€åŒ…æ‹¬ Cã€C++ã€Pythonã€Javaã€Perlã€PHPã€Eiffelã€Ruby å’Œ Tcl ç­‰ã€‚</li>
<li>MySQL å¯¹PHPæœ‰å¾ˆå¥½çš„æ”¯æŒï¼ŒPHP æ˜¯ç›®å‰æœ€æµè¡Œçš„ Web å¼€å‘è¯­è¨€ã€‚</li>
<li>MySQL æ”¯æŒå¤§å‹æ•°æ®åº“ï¼Œæ”¯æŒ 5000 ä¸‡æ¡è®°å½•çš„æ•°æ®ä»“åº“ï¼Œ32 ä½ç³»ç»Ÿè¡¨æ–‡ä»¶æœ€å¤§å¯æ”¯æŒ 4GBï¼Œ64 ä½ç³»ç»Ÿæ”¯æŒæœ€å¤§çš„è¡¨æ–‡ä»¶ä¸º8TBã€‚</li>
<li>MySQL æ˜¯å¯ä»¥å®šåˆ¶çš„ï¼Œé‡‡ç”¨äº† GPL åè®®ï¼Œä½ å¯ä»¥ä¿®æ”¹æºç æ¥å¼€å‘è‡ªå·±çš„ MySQL ç³»ç»Ÿã€‚</li>
</ul>
<p><strong>å®˜ç½‘ :</strong> <strong><a href="https://www.mysql.com/">https://www.mysql.com/</a></strong></p>
<h4 id="4ã€å®‰è£…MySQL"><a href="#4ã€å®‰è£…MySQL" class="headerlink" title="4ã€å®‰è£…MySQL"></a>4ã€å®‰è£…MySQL</h4><p>è¿™é‡Œå»ºè®®ä½¿ç”¨<code>å‹ç¼©ç‰ˆ</code>ï¼Œå®‰è£…å¿«ï¼Œæ–¹ä¾¿ï¼Œä¸å¤æ‚ã€‚</p>
<p>exe å¯æ‰§è¡Œæ–‡ä»¶å®‰è£… MySQL è°ç”¨è°çŸ¥é“ï¼Œå¸è½½æ˜¯çœŸçš„éº»çƒ¦ï¼Œâ”­â”®ï¹â”­â”®ã€‚</p>
<p>mysql5.7 64ä½ä¸‹è½½åœ°å€:</p>
<p><a href="https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.19-winx64.zip">https://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.19-winx64.zip</a></p>
<p><strong>å®‰è£…æ­¥éª¤</strong></p>
<p>1ã€ä¸‹è½½åå¾—åˆ°zipå‹ç¼©åŒ….</p>
<p>2ã€è§£å‹åˆ°è‡ªå·±æƒ³è¦å®‰è£…åˆ°çš„ç›®å½•ï¼Œæ­¤å¤„æˆ‘è§£å‹åˆ°çš„æ˜¯ D:\Environment\mysql-5.7.19</p>
<p>3ã€æ·»åŠ ç¯å¢ƒå˜é‡ï¼šæˆ‘çš„ç”µè„‘-&gt;å±æ€§-&gt;é«˜çº§-&gt;ç¯å¢ƒå˜é‡</p>
<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">é€‰æ‹©PATH,åœ¨å…¶åé¢æ·»åŠ : ä½ çš„mysql å®‰è£…æ–‡ä»¶ä¸‹é¢çš„binæ–‡ä»¶å¤¹</span><br></pre></td></tr></tbody></table></figure>
<p>4ã€åœ¨ bin æ–‡ä»¶å¤¹ä¸‹åˆ›å»º my.ini é…ç½®æ–‡ä»¶</p>
<figure class="highlight ini"><table><tbody><tr><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">basedir</span>=D:\Environment\mysql-<span class="number">5.7</span>.<span class="number">19</span>\</span><br><span class="line"><span class="attr">datadir</span>=D:\Environment\mysql-<span class="number">5.7</span>.<span class="number">19</span>\data\</span><br><span class="line"><span class="attr">port</span>=<span class="number">3306</span></span><br><span class="line">skip-grant-tables</span><br></pre></td></tr></tbody></table></figure>
<p>5ã€å¯åŠ¨ç®¡ç†å‘˜æ¨¡å¼ä¸‹çš„ CMDï¼Œå¹¶å°†è·¯å¾„åˆ‡æ¢è‡³ mysql ä¸‹çš„ bin ç›®å½•ï¼Œç„¶åè¾“å…¥ mysqld â€“install (å®‰è£…mysql)</p>
<p>6ã€å†è¾“å…¥  mysqld â€”initialize-insecure â€”user=mysql åˆå§‹åŒ–æ•°æ®æ–‡ä»¶</p>
<p>7ã€ç„¶åå†æ¬¡å¯åŠ¨ mysqlï¼ˆnet start mysqlï¼‰ ç„¶åç”¨å‘½ä»¤ mysql â€“u root â€“p è¿›å…¥ mysql ç®¡ç†ç•Œé¢ï¼ˆå¯†ç æš‚æ—¶ä¸ºç©ºï¼‰</p>
<p>8ã€è¿›å…¥ç•Œé¢åæ›´æ”¹rootå¯†ç </p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line">update mysql.user <span class="keyword">set</span> authentication_string<span class="operator">=</span>password(<span class="string">'123456'</span>) <span class="keyword">where</span> <span class="keyword">user</span><span class="operator">=</span><span class="string">'root'</span> <span class="keyword">and</span> Host <span class="operator">=</span> <span class="string">'localhost'</span>;</span><br></pre></td></tr></tbody></table></figure>
<p>9ã€åˆ·æ–°æƒé™</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line">flush privileges;</span><br></pre></td></tr></tbody></table></figure>
<p>10ã€ä¿®æ”¹ my.iniæ–‡ä»¶åˆ é™¤æœ€åä¸€å¥skip-grant-tables</p>
<p>11ã€é‡å¯mysqlå³å¯æ­£å¸¸ä½¿ç”¨</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line">net stop mysql</span><br><span class="line">net <span class="keyword">start</span> mysql</span><br></pre></td></tr></tbody></table></figure>
<p>12ã€è¿æ¥ä¸Šæµ‹è¯•å‡ºç°ä»¥ä¸‹ç»“æœå°±å®‰è£…å¥½äº†</p>
<p><img src="https://z3.ax1x.com/2021/11/16/IWQrr9.png" alt=""></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line">update <span class="keyword">user</span> <span class="keyword">set</span> password<span class="operator">=</span>password(<span class="string">'123456'</span>)<span class="keyword">where</span> <span class="keyword">user</span><span class="operator">=</span><span class="string">'root'</span>; # ä¿®æ”¹å¯†ç </span><br><span class="line">flush privileges; # åˆ·æ–°æ•°æ®åº“</span><br><span class="line"><span class="keyword">show</span> databases; # æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“</span><br><span class="line">use dbnameï¼›# æ‰“å¼€æŸä¸ªæ•°æ®åº“</span><br><span class="line"><span class="keyword">show</span> tables; # æ˜¾ç¤ºæ•°æ®åº“Mysqlä¸­æ‰€æœ‰çš„è¡¨</span><br><span class="line"><span class="keyword">describe</span> <span class="keyword">user</span>; # æ˜¾ç¤ºè¡¨Mysqlæ•°æ®åº“ä¸­<span class="keyword">User</span>è¡¨çš„åˆ—ä¿¡æ¯</span><br><span class="line"><span class="keyword">create</span> database name; # åˆ›å»ºæ•°æ®åº“</span><br><span class="line">use databasename; # é€‰æ‹©æ•°æ®åº“</span><br><span class="line">exit; # é€€å‡º Mysql</span><br><span class="line">? # å‘½ä»¤å…³é”®è¯ï¼Œå¯»æ±‚å¸®åŠ©</span><br></pre></td></tr></tbody></table></figure>
<h2 id="äºŒã€åŸºæœ¬æ¦‚å¿µ"><a href="#äºŒã€åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="äºŒã€åŸºæœ¬æ¦‚å¿µ"></a>äºŒã€åŸºæœ¬æ¦‚å¿µ</h2><h4 id="1ã€æ•°æ®ç±»å‹"><a href="#1ã€æ•°æ®ç±»å‹" class="headerlink" title="1ã€æ•°æ®ç±»å‹"></a>1ã€æ•°æ®ç±»å‹</h4><p><strong>æ•°å€¼ç±»å‹</strong></p>
<p>MySQL æ”¯æŒæ‰€æœ‰æ ‡å‡† SQL æ•°å€¼æ•°æ®ç±»å‹ã€‚</p>
<p>å…³é”®å­—INTæ˜¯INTEGERçš„åŒä¹‰è¯ï¼Œå…³é”®å­—DECæ˜¯DECIMALçš„åŒä¹‰è¯ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">ç±»å‹</th>
<th style="text-align:left">å¤§å°</th>
<th style="text-align:left">èŒƒå›´ï¼ˆæœ‰ç¬¦å·ï¼‰</th>
<th style="text-align:left">èŒƒå›´ï¼ˆæ— ç¬¦å·ï¼‰</th>
<th style="text-align:left">ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">TINYINT</td>
<td style="text-align:left">1 Bytes</td>
<td style="text-align:left">(-128ï¼Œ127)</td>
<td style="text-align:left">(0ï¼Œ255)</td>
<td style="text-align:left">å°æ•´æ•°å€¼</td>
</tr>
<tr>
<td style="text-align:left">SMALLINT</td>
<td style="text-align:left">2 Bytes</td>
<td style="text-align:left">(-32 768ï¼Œ32 767)</td>
<td style="text-align:left">(0ï¼Œ65 535)</td>
<td style="text-align:left">å¤§æ•´æ•°å€¼</td>
</tr>
<tr>
<td style="text-align:left">MEDIUMINT</td>
<td style="text-align:left">3 Bytes</td>
<td style="text-align:left">(-8 388 608ï¼Œ8 388 607)</td>
<td style="text-align:left">(0ï¼Œ16 777 215)</td>
<td style="text-align:left">å¤§æ•´æ•°å€¼</td>
</tr>
<tr>
<td style="text-align:left">INTæˆ–INTEGER</td>
<td style="text-align:left">4 Bytes</td>
<td style="text-align:left">(-2 147 483 648ï¼Œ2 147 483 647)</td>
<td style="text-align:left">(0ï¼Œ4 294 967 295)</td>
<td style="text-align:left">å¤§æ•´æ•°å€¼</td>
</tr>
<tr>
<td style="text-align:left">BIGINT</td>
<td style="text-align:left">8 Bytes</td>
<td style="text-align:left">(-9,223,372,036,854,775,808ï¼Œ9 223 372 036 854 775 807)</td>
<td style="text-align:left">(0ï¼Œ18 446 744 073 709 551 615)</td>
<td style="text-align:left">æå¤§æ•´æ•°å€¼</td>
</tr>
<tr>
<td style="text-align:left">FLOAT</td>
<td style="text-align:left">4 Bytes</td>
<td style="text-align:left">(-3.402 823 466 E+38ï¼Œ-1.175 494 351 E-38)ï¼Œ0ï¼Œ(1.175 494 351 E-38ï¼Œ3.402 823 466 351 E+38)</td>
<td style="text-align:left">0ï¼Œ(1.175 494 351 E-38ï¼Œ3.402 823 466 E+38)</td>
<td style="text-align:left">å•ç²¾åº¦ æµ®ç‚¹æ•°å€¼</td>
</tr>
<tr>
<td style="text-align:left">DOUBLE</td>
<td style="text-align:left">8 Bytes</td>
<td style="text-align:left">(-1.797 693 134 862 315 7 E+308ï¼Œ-2.225 073 858 507 201 4 E-308)ï¼Œ0ï¼Œ(2.225 073 858 507 201 4 E-308ï¼Œ1.797 693 134 862 315 7 E+308)</td>
<td style="text-align:left">0ï¼Œ(2.225 073 858 507 201 4 E-308ï¼Œ1.797 693 134 862 315 7 E+308)</td>
<td style="text-align:left">åŒç²¾åº¦ æµ®ç‚¹æ•°å€¼</td>
</tr>
<tr>
<td style="text-align:left">DECIMAL</td>
<td style="text-align:left">å¯¹DECIMAL(M,D) ï¼Œå¦‚æœM&gt;Dï¼Œä¸ºM+2å¦åˆ™ä¸ºD+2</td>
<td style="text-align:left">ä¾èµ–äºMå’ŒDçš„å€¼</td>
<td style="text-align:left">ä¾èµ–äºMå’ŒDçš„å€¼</td>
<td style="text-align:left">å°æ•°å€¼</td>
</tr>
</tbody>
</table>
</div>
<p><strong>æ—¥æœŸç±»å‹</strong></p>
<p>æ¯ä¸ªæ—¶é—´ç±»å‹æœ‰ä¸€ä¸ªæœ‰æ•ˆå€¼èŒƒå›´å’Œä¸€ä¸ªâ€é›¶â€å€¼ï¼Œå½“æŒ‡å®šä¸åˆæ³•çš„MySQLä¸èƒ½è¡¨ç¤ºçš„å€¼æ—¶ä½¿ç”¨â€é›¶â€å€¼ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">ç±»å‹</th>
<th style="text-align:left">å¤§å° ( bytes)</th>
<th style="text-align:left">èŒƒå›´</th>
<th style="text-align:left">æ ¼å¼</th>
<th style="text-align:left">ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">DATE</td>
<td style="text-align:left">3</td>
<td style="text-align:left">1000-01-01 ~ 9999-12-31</td>
<td style="text-align:left">YYYY-MM-DD</td>
<td style="text-align:left">æ—¥æœŸå€¼</td>
</tr>
<tr>
<td style="text-align:left">TIME</td>
<td style="text-align:left">3</td>
<td style="text-align:left">â€˜-838:59:59â€™ ~ â€˜838:59:59â€™</td>
<td style="text-align:left">HH:MM:SS</td>
<td style="text-align:left">æ—¶é—´å€¼æˆ–æŒç»­æ—¶é—´</td>
</tr>
<tr>
<td style="text-align:left">YEAR</td>
<td style="text-align:left">1</td>
<td style="text-align:left">1901 ~ 2155</td>
<td style="text-align:left">YYYY</td>
<td style="text-align:left">å¹´ä»½å€¼</td>
</tr>
<tr>
<td style="text-align:left">DATETIME</td>
<td style="text-align:left">8</td>
<td style="text-align:left">1000-01-01 00:00:00 ~ 9999-12-31 23:59:59</td>
<td style="text-align:left">YYYY-MM-DD HH:MM:SS</td>
<td style="text-align:left">æ··åˆæ—¥æœŸå’Œæ—¶é—´å€¼</td>
</tr>
<tr>
<td style="text-align:left">TIMESTAMP</td>
<td style="text-align:left">4</td>
<td style="text-align:left">1970-01-01 00:00:00~2038ç»“æŸæ—¶é—´æ˜¯ç¬¬ <strong>2147483647</strong> ç§’ï¼ŒåŒ—äº¬æ—¶é—´ <strong>2038-1-19 11:14:07</strong>ï¼Œæ ¼æ—å°¼æ²»æ—¶é—´ 2038å¹´1æœˆ19æ—¥ å‡Œæ™¨ 03:14:07</td>
<td style="text-align:left">YYYYMMDD HHMMSS</td>
<td style="text-align:left">æ··åˆæ—¥æœŸå’Œæ—¶é—´å€¼ï¼Œæ—¶é—´æˆ³</td>
</tr>
</tbody>
</table>
</div>
<p><strong>å­—ç¬¦ä¸²ç±»å‹</strong></p>
<p>å­—ç¬¦ä¸²ç±»å‹æŒ‡ CHARã€VARCHARã€BINARYã€VARBINARYã€BLOBã€TEXTã€ENUM å’Œ SETã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">ç±»å‹</th>
<th style="text-align:left">å¤§å°ï¼ˆå­—èŠ‚ï¼‰</th>
<th style="text-align:left">ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">CHAR</td>
<td style="text-align:left">0 ~ 255</td>
<td style="text-align:left">å®šé•¿å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td style="text-align:left">VARCHAR</td>
<td style="text-align:left">0 ~ 65535</td>
<td style="text-align:left">å˜é•¿å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td style="text-align:left">TINYBLOB</td>
<td style="text-align:left">0 ~ 255</td>
<td style="text-align:left">ä¸è¶…è¿‡ 255 ä¸ªå­—ç¬¦çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td style="text-align:left">TINYTEXT</td>
<td style="text-align:left">0 ~ 255</td>
<td style="text-align:left">çŸ­æ–‡æœ¬å­—ç¬¦ä¸²</td>
</tr>
<tr>
<td style="text-align:left">BLOB</td>
<td style="text-align:left">0 ~ 65 535</td>
<td style="text-align:left">äºŒè¿›åˆ¶å½¢å¼çš„é•¿æ–‡æœ¬æ•°æ®</td>
</tr>
<tr>
<td style="text-align:left">TEXT</td>
<td style="text-align:left">0 ~ 65 535</td>
<td style="text-align:left">é•¿æ–‡æœ¬æ•°æ®</td>
</tr>
<tr>
<td style="text-align:left">MEDIUMBLOB</td>
<td style="text-align:left">0 ~ 16 777 215</td>
<td style="text-align:left">äºŒè¿›åˆ¶å½¢å¼çš„ä¸­ç­‰é•¿åº¦æ–‡æœ¬æ•°æ®</td>
</tr>
<tr>
<td style="text-align:left">MEDIUMTEXT</td>
<td style="text-align:left">0 ~ 16 777 215</td>
<td style="text-align:left">ä¸­ç­‰é•¿åº¦æ–‡æœ¬æ•°æ®</td>
</tr>
<tr>
<td style="text-align:left">LONGBLOB</td>
<td style="text-align:left">0 ~ 4 294 967 295</td>
<td style="text-align:left">äºŒè¿›åˆ¶å½¢å¼çš„æå¤§æ–‡æœ¬æ•°æ®</td>
</tr>
<tr>
<td style="text-align:left">LONGTEXT</td>
<td style="text-align:left">0 ~ 4 294 967 295</td>
<td style="text-align:left">æå¤§æ–‡æœ¬æ•°æ®</td>
</tr>
</tbody>
</table>
</div>
<p><strong>æ³¨æ„</strong>ï¼šchar(n) å’Œ varchar(n) ä¸­æ‹¬å·ä¸­ n ä»£è¡¨å­—ç¬¦çš„ä¸ªæ•°ï¼Œå¹¶ä¸ä»£è¡¨å­—èŠ‚ä¸ªæ•°ï¼Œæ¯”å¦‚ CHAR(30) å°±å¯ä»¥å­˜å‚¨ 30 ä¸ªå­—ç¬¦ã€‚</p>
<p>CHAR å’Œ VARCHAR ç±»å‹ç±»ä¼¼ï¼Œä½†å®ƒä»¬ä¿å­˜å’Œæ£€ç´¢çš„æ–¹å¼ä¸åŒã€‚<strong>å®ƒä»¬çš„æœ€å¤§é•¿åº¦å’Œæ˜¯å¦å°¾éƒ¨ç©ºæ ¼è¢«ä¿ç•™ç­‰æ–¹é¢ä¹Ÿä¸åŒ</strong>ã€‚åœ¨å­˜å‚¨æˆ–æ£€ç´¢è¿‡ç¨‹ä¸­ä¸è¿›è¡Œå¤§å°å†™è½¬æ¢ã€‚</p>
<p>BINARY å’Œ VARBINARY ç±»ä¼¼äº CHAR å’Œ VARCHARï¼Œä¸åŒçš„æ˜¯å®ƒä»¬åŒ…å«äºŒè¿›åˆ¶å­—ç¬¦ä¸²è€Œä¸è¦éäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å®ƒä»¬åŒ…å«å­—èŠ‚å­—ç¬¦ä¸²è€Œä¸æ˜¯å­—ç¬¦å­—ç¬¦ä¸²ã€‚è¿™è¯´æ˜å®ƒä»¬æ²¡æœ‰å­—ç¬¦é›†ï¼Œå¹¶ä¸”æ’åºå’Œæ¯”è¾ƒåŸºäºåˆ—å€¼å­—èŠ‚çš„æ•°å€¼å€¼</strong>ã€‚</p>
<p>BLOB æ˜¯ä¸€ä¸ª<strong>äºŒè¿›åˆ¶å¤§å¯¹è±¡</strong>ï¼Œ<strong>å¯ä»¥å®¹çº³å¯å˜æ•°é‡çš„æ•°æ®</strong>ã€‚æœ‰ 4 ç§ BLOB ç±»å‹ï¼šTINYBLOBã€BLOBã€MEDIUMBLOB å’Œ LONGBLOBã€‚å®ƒä»¬åŒºåˆ«åœ¨äºå¯å®¹çº³å­˜å‚¨èŒƒå›´ä¸åŒã€‚</p>
<p>æœ‰ 4 ç§ TEXT ç±»å‹ï¼šTINYTEXTã€TEXTã€MEDIUMTEXT å’Œ LONGTEXTã€‚å¯¹åº”çš„è¿™ 4 ç§ BLOB ç±»å‹ï¼Œå¯å­˜å‚¨çš„æœ€å¤§é•¿åº¦ä¸åŒï¼Œå¯æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ã€‚</p>
<div class="note success">
            <p>NULL å€¼</p>
          </div>
<ul>
<li>ç†è§£ä¸ºâ€æ²¡æœ‰å€¼â€æˆ–â€æœªçŸ¥å€¼â€</li>
<li>ä¸è¦ç”¨ NULL è¿›è¡Œç®—æœ¯è¿ç®—ï¼Œç»“æœä»ä¸º NULLï¼Œæ²¡æœ‰æ„ä¹‰</li>
</ul>
<h4 id="2ã€æ•°æ®å­—æ®µå±æ€§"><a href="#2ã€æ•°æ®å­—æ®µå±æ€§" class="headerlink" title="2ã€æ•°æ®å­—æ®µå±æ€§"></a>2ã€æ•°æ®å­—æ®µå±æ€§</h4><p><img src="https://z3.ax1x.com/2021/11/16/IhFag1.png" alt=""></p>
<p><strong>Unsigned</strong></p>
<ul>
<li>æ— ç¬¦å·çš„</li>
<li>å£°æ˜è¯¥æ•°æ®åˆ—ä¸å…è®¸è´Ÿæ•°</li>
</ul>
<p><strong>Zerofill</strong></p>
<ul>
<li>ä¸è¶³çš„ä½æ•°ç”¨0æ¥å¡«å……ï¼Œä¾‹å¦‚int(3)ï¼Œ5åˆ™ä¸º005</li>
</ul>
<p><strong>Auto_InCrement</strong></p>
<ul>
<li>è‡ªåŠ¨å¢é•¿çš„ï¼Œæ¯æ·»åŠ ä¸€æ¡æ•°æ®ï¼Œè‡ªåŠ¨åœ¨ä¸Šä¸€ä¸ªè®°å½•æ•°ä¸ŠåŠ 1ï¼ˆé»˜è®¤ï¼‰</li>
<li>é€šå¸¸ç”¨äºè®¾ç½®<code>ä¸»é”®</code>ï¼Œä¸”ä¸ºæ•´æ•°ç±»å‹</li>
<li>å¯å®šä¹‰èµ·å§‹å€¼å’Œæ­¥é•¿<ul>
<li>èµ·å§‹å€¼è®¾ç½®ï¼šAUTO_INCREMENT = 100ï¼Œåªå½±å“å½“å‰è¡¨ã€‚</li>
<li>æ­¥é•¿è®¾ç½®ï¼šSET @@auto_increment_increment = 5ï¼Œå½±å“æ‰€æœ‰ä½¿ç”¨è‡ªå¢çš„è¡¨ã€‚</li>
</ul>
</li>
</ul>
<p><strong>NULL å’Œ NOTE NULL</strong></p>
<ul>
<li>é»˜è®¤ä¸º NULLï¼Œå³æ²¡æœ‰æ’å…¥è¯¥åˆ—çš„æ•°å€¼ã€‚</li>
<li>å¦‚æœè®¾ç½®ä¸º NOT NULLï¼Œåˆ™è¯¥åˆ—å¿…é¡»æœ‰å€¼ã€‚</li>
</ul>
<p><strong>DEFAULT</strong></p>
<ul>
<li>ç”¨äºè®¾ç½®é»˜è®¤å€¼</li>
<li>ä¾‹å¦‚ï¼Œæ€§åˆ«å­—æ®µï¼Œé»˜è®¤ä¸ºâ€ç”·â€ï¼Œè‹¥æ— æŒ‡å®šè¯¥åˆ—çš„å€¼ï¼Œåˆ™é»˜è®¤ä¸ºâ€ç”·â€ã€‚</li>
</ul>
<h4 id="3ã€æ•°æ®è¡¨å¼•æ“"><a href="#3ã€æ•°æ®è¡¨å¼•æ“" class="headerlink" title="3ã€æ•°æ®è¡¨å¼•æ“"></a>3ã€æ•°æ®è¡¨å¼•æ“</h4><p>MySQLçš„æ•°æ®è¡¨çš„ç±»å‹ : <strong>MyISAM</strong> , <strong>InnoDB</strong> , HEAP , BOB , CSVç­‰â€¦</p>
<p>å¸¸è§çš„ MyISAM ä¸ InnoDB ç±»å‹ï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>åç§°</th>
<th>MyISAM</th>
<th>InnoDB</th>
</tr>
</thead>
<tbody>
<tr>
<td>äº‹åŠ¡å¤„ç†</td>
<td>ä¸æ”¯æŒ</td>
<td>æ”¯æŒ</td>
</tr>
<tr>
<td>æ•°æ®è¡Œé”å®š</td>
<td>ä¸æ”¯æŒ</td>
<td>æ”¯æŒ</td>
</tr>
<tr>
<td>å¤–é”®çº¦æŸ</td>
<td>ä¸æ”¯æŒ</td>
<td>æ”¯æŒ</td>
</tr>
<tr>
<td>å…¨æ–‡ç´¢å¼•</td>
<td>æ”¯æŒ</td>
<td>ä¸æ”¯æŒ</td>
</tr>
<tr>
<td>è¡¨ç©ºé—´å¤§å°</td>
<td>è¾ƒå°</td>
<td>çº¦ä¸º MyISAM ä¸¤å€</td>
</tr>
</tbody>
</table>
</div>
<p>é€‚ç”¨åœºåˆï¼š</p>
<ul>
<li>MyISAMï¼šèŠ‚çº¦ç©ºé—´ï¼Œé€Ÿåº¦è¾ƒå¿«ã€‚</li>
<li>InnoDBï¼šå®‰å…¨æ€§ï¼Œäº‹åŠ¡å¤„ç†åŠå¤šç”¨æˆ·æ“ä½œæ•°æ®è¡¨ã€‚</li>
</ul>
<h4 id="4ã€æ•°æ®è¡¨çš„ç‰©ç†å­˜å‚¨"><a href="#4ã€æ•°æ®è¡¨çš„ç‰©ç†å­˜å‚¨" class="headerlink" title="4ã€æ•°æ®è¡¨çš„ç‰©ç†å­˜å‚¨"></a>4ã€æ•°æ®è¡¨çš„ç‰©ç†å­˜å‚¨</h4><p>MySQL æ•°æ®è¡¨ä»¥æ–‡ä»¶æ–¹å¼å­˜å‚¨åœ¨ç£ç›˜ä¸­</p>
<ul>
<li>åŒ…æ‹¬è¡¨æ–‡ä»¶ï¼Œæ•°æ®æ–‡ä»¶ï¼Œä»¥åŠæ•°æ®åº“çš„é€‰é¡¹æ–‡ä»¶</li>
<li>ä½ç½®ï¼šMySQL\dataï¼Œç›®å½•åå¯¹åº”æ•°æ®åº“åï¼Œè¯¥ç›®å½•ä¸‹æ–‡ä»¶åå¯¹åº”æ•°æ®è¡¨</li>
</ul>
<p><strong>InnoDB</strong></p>
<p><img src="https://z3.ax1x.com/2021/11/16/Ih1RuF.png" alt=""></p>
<ul>
<li>.frm æ–‡ä»¶ â€” è¡¨ç»“æ„å®šä¹‰æ–‡ä»¶</li>
<li>.idb æ–‡ä»¶  â€” MySQLæ•°æ®æ–‡ä»¶ã€ç´¢å¼•æ–‡ä»¶</li>
</ul>
<p>InnoDB ç±»å‹æ•°æ®è¡¨åªæœ‰ä¸€ä¸ª *.frm æ–‡ä»¶ï¼ˆä¸ç®— .idb å¤‡ä»½æ–‡ä»¶ï¼‰, ä»¥åŠä¸Šä¸€çº§ç›®å½•çš„ ibdata1æ–‡ä»¶ã€‚</p>
<p><strong>MyISAM</strong></p>
<p><img src="https://z3.ax1x.com/2021/11/16/Ih3FKS.png" alt=""></p>
<ul>
<li>. frm   â€” è¡¨ç»“æ„å®šä¹‰æ–‡ä»¶</li>
<li>. MYD â€” æ•°æ®æ–‡ä»¶ ( data )</li>
<li>. MYI   â€” ç´¢å¼•æ–‡ä»¶ ( index )</li>
</ul>
<h4 id="5ã€å­—ç¬¦é›†"><a href="#5ã€å­—ç¬¦é›†" class="headerlink" title="5ã€å­—ç¬¦é›†"></a>5ã€å­—ç¬¦é›†</h4><p>å­—ç¬¦é›†æ˜¯ä¸€å¥—ç¬¦åˆå’Œç¼–ç ï¼Œ<strong>æ ¡éªŒè§„åˆ™ï¼ˆcollationï¼‰æ˜¯åœ¨å­—ç¬¦é›†å†…ç”¨äºæ¯”è¾ƒå­—ç¬¦çš„ä¸€å¥—è§„åˆ™</strong>ï¼Œå³å­—ç¬¦é›†çš„<code>æ’åº</code>è§„åˆ™ã€‚MySQLå¯ä»¥ä½¿ç”¨å„ç§å­—ç¬¦é›†å’Œæ£€éªŒè§„åˆ™æ¥ç»„ç»‡å­—ç¬¦ã€‚</p>
<p>MySQLæœåŠ¡å™¨å¯ä»¥æ”¯æŒå¤šç§å­—ç¬¦é›†ï¼Œåœ¨åŒä¸€å°æœåŠ¡å™¨ï¼ŒåŒä¸€ä¸ªæ•°æ®åº“ï¼Œ<strong>ç”šè‡³åŒä¸€ä¸ªè¡¨çš„ä¸åŒå­—æ®µéƒ½å¯ä»¥æŒ‡å®šä½¿ç”¨ä¸åŒçš„å­—ç¬¦é›†</strong>ï¼Œç›¸æ¯”oracleç­‰å…¶ä»–æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œåœ¨åŒä¸€ä¸ªæ•°æ®åº“åªèƒ½ä½¿ç”¨ç›¸åŒçš„å­—ç¬¦é›†ï¼ŒMySQLæ˜æ˜¾å­˜åœ¨æ›´å¤§çš„çµæ´»æ€§ã€‚</p>
<p>æ¯ç§å­—ç¬¦é›†éƒ½å¯èƒ½æœ‰å¤šç§æ ¡å¯¹è§„åˆ™ï¼Œå¹¶ä¸”éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„æ ¡å¯¹è§„åˆ™ï¼Œå¹¶ä¸”æ¯ä¸ªæ ¡å¯¹è§„åˆ™åªæ˜¯é’ˆå¯¹æŸä¸ªå­—ç¬¦é›†ï¼Œå’Œå…¶ä»–çš„å­—ç¬¦é›†æ²¡æœ‰å…³ç³»ã€‚</p>
<div class="note danger">
            <p>è€Œ MySQL é»˜è®¤çš„å­—ç¬¦é›†ä½¿ç”¨çš„æ˜¯ Latin1ï¼Œä¼šå¯¼è‡´ä¸­æ–‡ä¹±ç ï¼å› æ­¤éœ€è¦ä¸ºæ•°æ®åº“ã€æ•°æ®è¡¨ã€ç”šè‡³æ•°æ®åˆ—æ˜¾å¼è®¾å®šä¸åŒçš„å­—ç¬¦é›†ã€‚æˆ–è€…åœ¨ my.ini ä¸­ä¿®æ”¹é»˜è®¤çš„å­—ç¬¦é›†ã€‚</p>
          </div>
<figure class="highlight ini"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">character-set-server</span> = utf8</span><br></pre></td></tr></tbody></table></figure>
<h2 id="ä¸‰ã€åŸºæœ¬æ“ä½œ"><a href="#ä¸‰ã€åŸºæœ¬æ“ä½œ" class="headerlink" title="ä¸‰ã€åŸºæœ¬æ“ä½œ"></a>ä¸‰ã€åŸºæœ¬æ“ä½œ</h2><h4 id="1ã€æ•°æ®åº“"><a href="#1ã€æ•°æ®åº“" class="headerlink" title="1ã€æ•°æ®åº“"></a>1ã€æ•°æ®åº“</h4><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line">åˆ›å»ºæ•°æ®åº“ : <span class="keyword">create</span> database [if <span class="keyword">not</span> <span class="keyword">exists</span>] æ•°æ®åº“å;</span><br><span class="line"></span><br><span class="line">åˆ é™¤æ•°æ®åº“ : <span class="keyword">drop</span> database [if <span class="keyword">exists</span>] æ•°æ®åº“å;</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹æ•°æ®åº“ : <span class="keyword">show</span> databases;</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨æ•°æ®åº“ : use æ•°æ®åº“å;</span><br></pre></td></tr></tbody></table></figure>
<h4 id="2ã€åˆ›å»ºæ•°æ®è¡¨"><a href="#2ã€åˆ›å»ºæ•°æ®è¡¨" class="headerlink" title="2ã€åˆ›å»ºæ•°æ®è¡¨"></a>2ã€åˆ›å»ºæ•°æ®è¡¨</h4><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- ç›®æ ‡ : åˆ›å»ºä¸€ä¸ªschoolæ•°æ®åº“</span></span><br><span class="line"><span class="comment">-- åˆ›å»ºå­¦ç”Ÿè¡¨(åˆ—,å­—æ®µ)</span></span><br><span class="line"><span class="comment">-- å­¦å·int ç™»å½•å¯†ç varchar(20) å§“å,æ€§åˆ«varchar(2),å‡ºç”Ÿæ—¥æœŸ(datatime),å®¶åº­ä½å€,email</span></span><br><span class="line"><span class="comment">-- åˆ›å»ºè¡¨ä¹‹å‰ , ä¸€å®šè¦å…ˆé€‰æ‹©æ•°æ®åº“</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `student` (</span><br><span class="line">`id` <span class="type">int</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">'å­¦å·'</span>,</span><br><span class="line">`name` <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'åŒ¿å'</span> COMMENT <span class="string">'å§“å'</span>,</span><br><span class="line">`pwd` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'123456'</span> COMMENT <span class="string">'å¯†ç '</span>,</span><br><span class="line">`sex` <span class="type">varchar</span>(<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'ç”·'</span> COMMENT <span class="string">'æ€§åˆ«'</span>,</span><br><span class="line">`birthday` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'ç”Ÿæ—¥'</span>,</span><br><span class="line">`address` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'åœ°å€'</span>,</span><br><span class="line">`email` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'é‚®ç®±'</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥çœ‹æ•°æ®åº“çš„å®šä¹‰</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> DATABASE school;</span><br><span class="line"><span class="comment">-- æŸ¥çœ‹æ•°æ®è¡¨çš„å®šä¹‰</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student;</span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºè¡¨ç»“æ„</span></span><br><span class="line"><span class="keyword">DESC</span> student;  </span><br><span class="line"><span class="comment">-- è®¾ç½®ä¸¥æ ¼æ£€æŸ¥æ¨¡å¼</span></span><br><span class="line"><span class="keyword">SET</span> sql_mode<span class="operator">=</span><span class="string">'STRICT_TRANS_TABLES'</span>;</span><br></pre></td></tr></tbody></table></figure>
<h4 id="3ã€ä¿®æ”¹æ•°æ®è¡¨"><a href="#3ã€ä¿®æ”¹æ•°æ®è¡¨" class="headerlink" title="3ã€ä¿®æ”¹æ•°æ®è¡¨"></a>3ã€ä¿®æ”¹æ•°æ®è¡¨</h4><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student RENAME <span class="keyword">AS</span> student1		<span class="comment">-- ä¿®æ”¹è¡¨å</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student1 <span class="keyword">ADD</span> newcol <span class="type">VARCHAR</span>(<span class="number">50</span>)	<span class="comment">-- æ·»åŠ å­—æ®µ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student1 MODIFY newcol <span class="type">INT</span>(<span class="number">10</span>)	<span class="comment">-- ä¿®æ”¹å­—æ®µ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student1 CHANGE newcol newnewcol <span class="type">VARCHAR</span>(<span class="number">10</span>)	<span class="comment">-- ä¿®æ”¹å­—æ®µ</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student1 <span class="keyword">DROP</span> newnewcol		<span class="comment">-- åˆ é™¤å­—æ®µ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> student1			<span class="comment">-- åˆ é™¤æ•°æ®è¡¨</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>å¯ä»¥ä½¿ç”¨```æ¥åŒ…è£¹æ ‡è¯†ç¬¦ï¼Œä»¥é¿å…å’Œå…³é”®å­—é‡åï¼</p>
          </div>
<h2 id="å››ã€å¤–é”®"><a href="#å››ã€å¤–é”®" class="headerlink" title="å››ã€å¤–é”®"></a>å››ã€å¤–é”®</h2><p>å¦‚æœå…¬å…±å…³é”®å­—åœ¨ä¸€ä¸ªå…³ç³»ä¸­æ˜¯ä¸»å…³é”®å­—ï¼Œé‚£ä¹ˆè¿™ä¸ªå…¬å…±å…³é”®å­—è¢«ç§°ä¸ºå¦ä¸€ä¸ªå…³ç³»çš„å¤–é”®ã€‚ç”±æ­¤å¯è§ï¼Œå¤–é”®è¡¨ç¤ºäº†ä¸¤ä¸ªå…³ç³»ä¹‹é—´çš„ç›¸äº’è”ç³»ã€‚ä»¥å¦ä¸€ä¸ªå…³ç³»çš„å¤–é”®ä½œä¸ºä¸»å…³é”®å­—çš„è¡¨ç§°ä¸º<code>ä¸»è¡¨</code>ï¼Œå…·æœ‰æ­¤å¤–å»ºçš„è¡¨è¢«ç§°ä¸ºä¸»è¡¨çš„<code>ä»è¡¨</code>ã€‚</p>
<p>åœ¨å®é™…æ“ä½œä¸­ï¼Œå°†ä¸€ä¸ªè¡¨çš„å€¼æ”¾å…¥ç¬¬äºŒä¸ªè¡¨æ¥è¡¨ç¤ºå…³è”ï¼Œæ‰€ä½¿ç”¨çš„çš„å€¼æ˜¯ç¬¬ä¸€ä¸ªè¡¨çš„ä¸»é”®å€¼ï¼ˆåœ¨å¿…è¦æ—¶å¯åŒ…æ‹¬å¤åˆä¸»é”®å€¼ï¼‰ã€‚æ­¤æ—¶ï¼Œç¬¬äºŒä¸ªè¡¨ä¸­ä¿å­˜è¿™äº›å€¼çš„å±æ€§ç§°ä¸ºå¤–é”®ï¼ˆ<strong>foreign key</strong>ï¼‰ã€‚</p>
<div class="note success">
            <p>å¤–é”®å¯ä»¥ä¿æŒæ•°æ®ä¸€è‡´æ€§ï¼Œå®Œæ•´æ€§ï¼Œä¸»è¦ç›®çš„æ˜¯çº¦æŸå­˜å‚¨åœ¨å¤–é”®è¡¨ä¸­çš„æ•°æ®ã€‚ä½¿ä¸¤å¼ è¡¨å½¢æˆå…³è”ï¼Œå¤–é”®åªèƒ½å¼•ç”¨ä¸»è¡¨ä¸­çš„åˆ—çš„å€¼æˆ–ä½¿ç”¨ç©ºå€¼ã€‚</p>
          </div>
<p><strong>1ã€å»ºè¡¨æ—¶æŒ‡å®šå¤–é”®çº¦æŸ</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student (</span><br><span class="line">id <span class="type">INT</span>(<span class="number">10</span>),</span><br><span class="line">`name` <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">tid <span class="type">INT</span>(<span class="number">11</span>),</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (id),</span><br><span class="line"><span class="keyword">CONSTRAINT</span> FK_tid</span><br><span class="line"><span class="keyword">FOREIGN</span> KEY (tid) <span class="keyword">REFERENCES</span> teacher(id)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ³¨æ„äº‹é¡¹</strong></p>
<ul>
<li>å…³è”çš„ä¸¤å¼ è¡¨å¼•æ“å¿…é¡»ç›¸åŒ</li>
<li>å¤–é”®åä¸èƒ½é‡å¤</li>
<li>å…³è”çš„ä¸¤ä¸ªç±»å‹å¿…é¡»ç›¸åŒ</li>
</ul>
<p><strong>2ã€å»ºè¡¨åæ·»åŠ å¤–é”®</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `study`.`student` <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> `FK_tid` <span class="keyword">FOREIGN</span> KEY (`tid`) <span class="keyword">REFERENCES</span> `study`.`teacher`(`id`); </span><br></pre></td></tr></tbody></table></figure>
<p><strong>3ã€åˆ é™¤å¤–é”®</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- åˆ é™¤å¤–é”®</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `study`.`student` <span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> KEY `FK_tid`; </span><br><span class="line"><span class="comment">-- åˆ é™¤å¤–é”®ç´¢å¼•ï¼Œè¿™ä¸ªç´¢å¼•æ˜¯å»ºç«‹å¤–é”®æ—¶è‡ªåŠ¨ç”Ÿæˆçš„</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `study`.`student` <span class="keyword">DROP</span> INDEX `FK_tid`;  </span><br></pre></td></tr></tbody></table></figure>
<p>ä»¥ä¸Šçš„æ“ä½œéƒ½æ˜¯ç‰©ç†å¤–é”®ï¼Œæ•°æ®åº“çº§åˆ«çš„å¤–é”®ï¼Œæˆ‘ä»¬ä¸å»ºè®®ä½¿ç”¨ï¼ï¼ˆé¿å…æ•°æ®åº“è¿‡å¤šé€ æˆå›°æ‰°ï¼Œäº†è§£å³å¯ï¼ï¼‰</p>
<p><strong>æœ€ä½³å®è·µ</strong></p>
<ul>
<li>æ•°æ®åº“å°±æ˜¯å•çº¯çš„è¡¨ï¼Œåªç”¨æ¥å­˜æ•°æ®ï¼Œåªæœ‰è¡Œï¼ˆæ•°æ®ï¼‰å’Œåˆ—ï¼ˆå­—æ®µï¼‰</li>
<li>æˆ‘ä»¬æƒ³ä½¿ç”¨å¤šå¼ è¡¨çš„æ•°æ®ï¼Œæƒ³ä½¿ç”¨å¤–é”®ä¸€èˆ¬ä½¿ç”¨ç¨‹åºå»å®ç°</li>
</ul>
<h2 id="äº”ã€DML"><a href="#äº”ã€DML" class="headerlink" title="äº”ã€DML"></a>äº”ã€DML</h2><p><strong>æ•°æ®åº“æ„ä¹‰</strong>ï¼šæ•°æ®å­˜å‚¨ã€æ•°æ®ç®¡ç†</p>
<p><strong>ç®¡ç†æ•°æ®åº“æ•°æ®æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>é€šè¿‡ SQLyog ç­‰ç®¡ç†å·¥å…·ç®¡ç†æ•°æ®åº“æ•°æ®</li>
<li>é€šè¿‡ <strong>DML</strong> è¯­å¥ç®¡ç†æ•°æ®åº“æ•°æ®</li>
</ul>
<p><strong><code>DML è¯­è¨€</code>ï¼šData Manipulaiton Languageï¼Œæ•°æ®æ“ä½œè¯­è¨€</strong></p>
<ul>
<li>ç”¨äºæ“ä½œæ•°æ®åº“å¯¹è±¡ä¸­æ‰€åŒ…å«çš„æ•°æ®</li>
<li>åŒ…æ‹¬ï¼š<ul>
<li>INSERTï¼ˆæ·»åŠ æ•°æ®è¯­å¥ï¼‰</li>
<li>UPDATEï¼ˆæ›´æ–°æ•°æ®è¯­å¥ï¼‰</li>
<li>DELETEï¼ˆåˆ é™¤æ•°æ®è¯­å¥ï¼‰</li>
</ul>
</li>
</ul>
<h4 id="1ã€INSERT"><a href="#1ã€INSERT" class="headerlink" title="1ã€INSERT"></a>1ã€INSERT</h4><p><strong>è¯­æ³•ï¼š</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> è¡¨å[(å­—æ®µ<span class="number">1</span>,å­—æ®µ<span class="number">2</span>,å­—æ®µ<span class="number">3</span>,...)] <span class="keyword">VALUES</span>(<span class="string">'å€¼1'</span>,<span class="string">'å€¼2'</span>,<span class="string">'å€¼3'</span>),(<span class="string">'å€¼1'</span>,<span class="string">'å€¼2'</span>,<span class="string">'å€¼3'</span>)...</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ³¨æ„ :</strong> </p>
<ul>
<li>å­—æ®µæˆ–å€¼ä¹‹é—´ç”¨è‹±æ–‡é€—å·éš”å¼€ .</li>
<li>â€˜ å­—æ®µ1,å­—æ®µ2â€¦â€™ è¯¥éƒ¨åˆ†å¯çœç•¥ , ä½†æ·»åŠ çš„å€¼åŠ¡å¿…ä¸è¡¨ç»“æ„,æ•°æ®åˆ—,é¡ºåºç›¸å¯¹åº”,ä¸”æ•°é‡ä¸€è‡´ .</li>
<li>å¯åŒæ—¶æ’å…¥å¤šæ¡æ•°æ® , values åç”¨è‹±æ–‡é€—å·éš”å¼€ .</li>
</ul>
<h4 id="2ã€UPDATE"><a href="#2ã€UPDATE" class="headerlink" title="2ã€UPDATE"></a>2ã€UPDATE</h4><p><strong>è¯­æ³•ï¼š</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line">UPDATE è¡¨å <span class="keyword">SET</span> column_name<span class="operator">=</span><span class="keyword">value</span> [column_name2<span class="operator">=</span>value2,...] [<span class="keyword">WHERE</span> <span class="keyword">condition</span>];</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ³¨æ„ :</strong> </p>
<ul>
<li>column_name ä¸ºè¦æ›´æ”¹çš„æ•°æ®åˆ—</li>
<li>value ä¸ºä¿®æ”¹åçš„æ•°æ® , å¯ä»¥ä¸ºå˜é‡ , å…·ä½“æŒ‡ , è¡¨è¾¾å¼æˆ–è€…åµŒå¥—çš„SELECTç»“æœ</li>
<li>condition ä¸ºç­›é€‰æ¡ä»¶ , å¦‚ä¸æŒ‡å®šåˆ™ä¿®æ”¹è¯¥è¡¨çš„æ‰€æœ‰åˆ—æ•°æ®</li>
</ul>
<h4 id="3ã€DELETE"><a href="#3ã€DELETE" class="headerlink" title="3ã€DELETE"></a>3ã€DELETE</h4><p><strong>è¯­æ³•ï¼š</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> è¡¨å [<span class="keyword">WHERE</span> <span class="keyword">condition</span>];</span><br></pre></td></tr></tbody></table></figure>
<p>æ³¨æ„ï¼šconditionä¸ºç­›é€‰æ¡ä»¶ , å¦‚ä¸æŒ‡å®šåˆ™åˆ é™¤è¯¥è¡¨çš„æ‰€æœ‰åˆ—æ•°æ®</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- åˆ é™¤idä¸º5çš„æ•°æ®</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> grade <span class="keyword">WHERE</span> gradeid <span class="operator">=</span> <span class="number">5</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="4ã€TRUNCATE"><a href="#4ã€TRUNCATE" class="headerlink" title="4ã€TRUNCATE"></a>4ã€TRUNCATE</h4><p>ç”¨äºå®Œå…¨æ¸…ç©ºè¡¨æ•°æ® , ä½†è¡¨ç»“æ„ , ç´¢å¼• , çº¦æŸç­‰ä¸å˜ ã€‚</p>
<p><strong>è¯­æ³•ï¼š</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> [<span class="keyword">TABLE</span>] table_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ¸…ç©ºå¹´çº§è¡¨</span></span><br><span class="line"><span class="keyword">TRUNCATE</span> grade</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ³¨æ„ï¼šåŒºåˆ«äºDELETEå‘½ä»¤</strong></p>
<ul>
<li><p>ç›¸åŒ : éƒ½èƒ½åˆ é™¤æ•°æ® , ä¸åˆ é™¤è¡¨ç»“æ„ , ä½† TRUNCATE <strong>é€Ÿåº¦æ›´å¿«</strong></p>
</li>
<li><p>ä¸åŒ :</p>
</li>
<li><ul>
<li>ä½¿ç”¨ TRUNCATE TABLE é‡æ–°è®¾ç½® AUTO_INCREMENT è®¡æ•°å™¨</li>
<li>ä½¿ç”¨ TRUNCATE TABLE ä¸ä¼šå¯¹äº‹åŠ¡æœ‰å½±å“</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºä¸€ä¸ªæµ‹è¯•è¡¨</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `test` (</span><br><span class="line">`id` <span class="type">INT</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">`coll` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥å‡ ä¸ªæµ‹è¯•æ•°æ®</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test(coll) <span class="keyword">VALUES</span>(<span class="string">'row1'</span>),(<span class="string">'row2'</span>),(<span class="string">'row3'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤è¡¨æ•°æ®(ä¸å¸¦whereæ¡ä»¶çš„delete)</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> test;</span><br><span class="line"><span class="comment">-- ç»“è®º:å¦‚ä¸æŒ‡å®šWhereåˆ™åˆ é™¤è¯¥è¡¨çš„æ‰€æœ‰åˆ—æ•°æ®,è‡ªå¢å½“å‰å€¼ä¾ç„¶ä»åŸæ¥åŸºç¡€ä¸Šè¿›è¡Œ,ä¼šè®°å½•æ—¥å¿—.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤è¡¨æ•°æ®(truncate)</span></span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> test;</span><br><span class="line"><span class="comment">-- ç»“è®º:truncateåˆ é™¤æ•°æ®,è‡ªå¢å½“å‰å€¼ä¼šæ¢å¤åˆ°åˆå§‹å€¼é‡æ–°å¼€å§‹;ä¸ä¼šè®°å½•æ—¥å¿—.</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ‹“å±•ï¼šä½¿ç”¨DELETEæ¸…ç©ºä¸åŒå¼•æ“çš„æ•°æ®åº“è¡¨æ•°æ®.é‡å¯æ•°æ®åº“æœåŠ¡å<br><strong>InnoDB</strong> : è‡ªå¢åˆ—ä»åˆå§‹å€¼é‡æ–°å¼€å§‹ (å­˜å‚¨åœ¨å†…å­˜ä¸­,æ–­ç”µå³å¤±)<br><strong>MyISAM</strong> : è‡ªå¢åˆ—ä¾ç„¶ä»ä¸Šä¸€ä¸ªè‡ªå¢æ•°æ®åŸºç¡€ä¸Šå¼€å§‹ (å­˜åœ¨æ–‡ä»¶ä¸­,ä¸ä¼šä¸¢å¤±)</p>
<h2 id="å…­ã€DQL-ã€é‡ç‚¹ã€‘"><a href="#å…­ã€DQL-ã€é‡ç‚¹ã€‘" class="headerlink" title="å…­ã€DQL ã€é‡ç‚¹ã€‘"></a>å…­ã€DQL ã€é‡ç‚¹ã€‘</h2><p><strong>DQLï¼ˆData Qeury Language æ•°æ®æŸ¥è¯¢è¯­è¨€ï¼‰</strong></p>
<ul>
<li>æŸ¥è¯¢æ•°æ®åº“æ•°æ®ï¼Œå¦‚ <strong>SELECT</strong> è¯­å¥</li>
<li>ç®€å•çš„å•è¡¨æŸ¥è¯¢æˆ–å¤šè¡¨çš„å¤æ‚æŸ¥è¯¢å’ŒåµŒå¥—æŸ¥è¯¢</li>
<li>æ˜¯æ•°æ®åº“è¯­è¨€ä¸­æœ€æ ¸å¿ƒã€æœ€é‡è¦çš„è¯­å¥</li>
<li>ä½¿ç”¨é¢‘ç‡æœ€é«˜çš„è¯­å¥</li>
</ul>
<p><code>SELECT è¯­æ³•</code></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span> <span class="operator">|</span> <span class="keyword">DISTINCT</span>]</span><br><span class="line">{<span class="operator">*</span> <span class="operator">|</span> table.<span class="operator">*</span> <span class="operator">|</span> [table.field1[<span class="keyword">as</span> alias1][,table.field2[<span class="keyword">as</span> alias2]][,...]]}</span><br><span class="line"><span class="keyword">FROM</span> table_name [<span class="keyword">as</span> table_alias]</span><br><span class="line">  [<span class="keyword">left</span> <span class="operator">|</span> <span class="keyword">right</span> <span class="operator">|</span> <span class="keyword">inner</span> <span class="keyword">join</span> table_name2]  <span class="comment">-- è”åˆæŸ¥è¯¢</span></span><br><span class="line">  [<span class="keyword">WHERE</span> ...]  <span class="comment">-- æŒ‡å®šç»“æœéœ€æ»¡è¶³çš„æ¡ä»¶</span></span><br><span class="line">  [<span class="keyword">GROUP</span> <span class="keyword">BY</span> ...]  <span class="comment">-- æŒ‡å®šç»“æœæŒ‰ç…§å“ªå‡ ä¸ªå­—æ®µæ¥åˆ†ç»„</span></span><br><span class="line">  [<span class="keyword">HAVING</span>]  <span class="comment">-- è¿‡æ»¤åˆ†ç»„çš„è®°å½•å¿…é¡»æ»¡è¶³çš„æ¬¡è¦æ¡ä»¶</span></span><br><span class="line">  [<span class="keyword">ORDER</span> <span class="keyword">BY</span> ...]  <span class="comment">-- æŒ‡å®šæŸ¥è¯¢è®°å½•æŒ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ¡ä»¶æ’åº</span></span><br><span class="line">  [LIMIT {[<span class="keyword">offset</span>,]row_count <span class="operator">|</span> row_countOFFSET <span class="keyword">offset</span>}];</span><br><span class="line">   <span class="comment">-- æŒ‡å®šæŸ¥è¯¢çš„è®°å½•ä»å“ªæ¡è‡³å“ªæ¡</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ³¨æ„ : [ ] æ‹¬å·ä»£è¡¨å¯é€‰çš„ , { }æ‹¬å·ä»£è¡¨å¿…é€‰å¾—</strong></p>
<h4 id="1ã€ç®€å•æŸ¥è¯¢è¯­å¥"><a href="#1ã€ç®€å•æŸ¥è¯¢è¯­å¥" class="headerlink" title="1ã€ç®€å•æŸ¥è¯¢è¯­å¥"></a>1ã€ç®€å•æŸ¥è¯¢è¯­å¥</h4><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢è¡¨ä¸­æ‰€æœ‰çš„æ•°æ®åˆ—ç»“æœï¼Œä½†æ˜¯æ•ˆç‡ä½ï¼Œä¸æ¨è</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢æŒ‡å®šåˆ—(å­¦å· , å§“å)</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,studentname <span class="keyword">FROM</span> student;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>AS  å­å¥ä½œä¸ºåˆ«å</strong></p>
<p><strong>ä½œç”¨ï¼š</strong></p>
<ul>
<li>å¯ç»™æ•°æ®åˆ—å–ä¸€ä¸ªæ–°åˆ«å</li>
<li>å¯ç»™è¡¨å–ä¸€ä¸ªæ–°åˆ«å</li>
<li>å¯æŠŠç»è®¡ç®—æˆ–æ€»ç»“çš„ç»“æœç”¨å¦ä¸€ä¸ªæ–°åç§°æ¥ä»£æ›¿</li>
</ul>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- ä¸ºåˆ—å’Œè¡¨å–åˆ«å</span></span><br><span class="line"><span class="comment">-- aså¯ä»¥çœç•¥ä¸å†™</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno <span class="keyword">AS</span> å­¦å·, studentname å§“å <span class="keyword">FROM</span> student s;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¸ºæŸ¥è¯¢ç»“æœå–ä¸€ä¸ªæ–°åå­—</span></span><br><span class="line"><span class="comment">-- concat()å‡½æ•°ç”¨äºæ‹¼æ¥å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="string">'å§“å:'</span>, studentname) æ–°å§“å <span class="keyword">FROM</span> student</span><br></pre></td></tr></tbody></table></figure>
<p><strong>DISTINCT å»é‡</strong></p>
<p><strong>ä½œç”¨ï¼šå»æ‰ SELECT æŸ¥è¯¢è¿”å›çš„è®°å½•ç»“æœä¸­é‡å¤çš„è®°å½•ï¼ˆè¿”å›æ‰€æœ‰åˆ—çš„å€¼éƒ½ç›¸åŒï¼‰</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥çœ‹å“ªå„¿äº›åŒå­¦å‚åŠ äº†è€ƒè¯•</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno <span class="keyword">FROM</span> <span class="keyword">result</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å»æ‰å‚åŠ å¤šé—¨è€ƒè¯•çš„åŒå­¦</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> studentno <span class="keyword">FROM</span> <span class="keyword">result</span>;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>è¡¨è¾¾å¼</strong></p>
<p><code>æ•°æ®åº“ä¸­çš„è¡¨è¾¾å¼ä¸€èˆ¬ç”±æ–‡æœ¬å€¼ï¼Œåˆ—å€¼ï¼ŒNULLï¼Œå‡½æ•°å’Œæ“ä½œç¬¦ç­‰ç»„æˆ</code>ã€‚</p>
<p>åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>SELECT è¯­å¥è¿”å›ç»“æœåˆ—ä¸­ä½¿ç”¨</li>
<li>SELECT è¯­å¥ä¸­çš„ ORDER BYï¼ŒHAVING ç­‰å­å¥ä¸­ä½¿ç”¨</li>
<li>DML è¯­å¥ä¸­çš„ where æ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨è¡¨è¾¾å¼</li>
</ul>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢è‡ªå¢æ­¥é•¿</span></span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@auto</span>_increment_increment;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬å·</span></span><br><span class="line"><span class="keyword">SELECT</span> VERSION()</span><br><span class="line"></span><br><span class="line"><span class="comment">-- è®¡ç®—</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span> <span class="operator">*</span> <span class="number">2</span> <span class="operator">-</span> <span class="number">1</span> è®¡ç®—ç»“æœ</span><br><span class="line"></span><br><span class="line"><span class="comment">-- è€ƒè¯•åˆ†æ•°å…¨éƒ¨åŠ 1åˆ†</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno å­¦å·, studentresult åŠ åˆ†å‰, (studentresult <span class="operator">+</span> <span class="number">1</span>) åŠ åˆ†å <span class="keyword">FROM</span> <span class="keyword">result</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="2ã€where-æ¡ä»¶è¯­å¥"><a href="#2ã€where-æ¡ä»¶è¯­å¥" class="headerlink" title="2ã€where æ¡ä»¶è¯­å¥"></a>2ã€where æ¡ä»¶è¯­å¥</h4><p>ä½œç”¨ï¼šç”¨äºæ£€ç´¢æ•°æ®åº“ä¸­<code>ç¬¦åˆæ¡ä»¶</code>çš„è®°å½•ã€‚</p>
<p>æœç´¢æ¡ä»¶å¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªé€»è¾‘è¡¨è¾¾å¼ç»„æˆï¼Œç»“æœä¸€èˆ¬ä¸ºçœŸæˆ–å‡ã€‚</p>
<p><strong>é€»è¾‘æ“ä½œç¬¦</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th><strong>é€»è¾‘æ“ä½œç¬¦</strong></th>
<th>è¯­æ³•</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>AND æˆ– &amp;&amp;</td>
<td>a AND b æˆ– a &amp;&amp; b</td>
<td>é€»è¾‘ä¸ï¼ŒåŒæ—¶ä¸ºçœŸç»“æœæ‰ä¸ºçœŸ</td>
</tr>
<tr>
<td>OR æˆ– \</td>
<td>\</td>
<td></td>
<td>a OR b æˆ– a \</td>
<td>\</td>
<td>b</td>
<td>é€»è¾‘æˆ–ï¼Œåªè¦ä¸€ä¸ªä¸ºçœŸï¼Œåˆ™ç»“æœä¸ºçœŸ</td>
</tr>
<tr>
<td>NOT æˆ– ï¼</td>
<td>NOT a æˆ– !a</td>
<td>é€»è¾‘éï¼Œè‹¥æ“ä½œæ•°ä¸ºå‡ï¼Œåˆ™ç»“æœä¸ºçœŸ</td>
</tr>
</tbody>
</table>
</div>
<p><strong>æ¯”è¾ƒè¿ç®—ç¬¦</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">æ¯”è¾ƒè¿ç®—ç¬¦</th>
<th style="text-align:left">æè¿°</th>
<th style="text-align:left">å®ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">=</td>
<td style="text-align:left">ç­‰å·ï¼Œæ£€æµ‹ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰è¿”å›true</td>
<td style="text-align:left">(A = B) è¿”å›falseã€‚</td>
</tr>
<tr>
<td style="text-align:left">&lt;&gt;, !=</td>
<td style="text-align:left">ä¸ç­‰äºï¼Œæ£€æµ‹ä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœä¸ç›¸ç­‰è¿”å›true</td>
<td style="text-align:left">(A != B) è¿”å› trueã€‚</td>
</tr>
<tr>
<td style="text-align:left">&gt;</td>
<td style="text-align:left">å¤§äºå·ï¼Œæ£€æµ‹å·¦è¾¹çš„å€¼æ˜¯å¦å¤§äºå³è¾¹çš„å€¼, å¦‚æœå·¦è¾¹çš„å€¼å¤§äºå³è¾¹çš„å€¼è¿”å›true</td>
<td style="text-align:left">(A &gt; B) è¿”å›falseã€‚</td>
</tr>
<tr>
<td style="text-align:left">&lt;</td>
<td style="text-align:left">å°äºå·ï¼Œæ£€æµ‹å·¦è¾¹çš„å€¼æ˜¯å¦å°äºå³è¾¹çš„å€¼, å¦‚æœå·¦è¾¹çš„å€¼å°äºå³è¾¹çš„å€¼è¿”å›true</td>
<td style="text-align:left">(A &lt; B) è¿”å› trueã€‚</td>
</tr>
<tr>
<td style="text-align:left">&gt;=</td>
<td style="text-align:left">å¤§äºç­‰äºå·ï¼Œæ£€æµ‹å·¦è¾¹çš„å€¼æ˜¯å¦å¤§äºæˆ–ç­‰äºå³è¾¹çš„å€¼, å¦‚æœå·¦è¾¹çš„å€¼å¤§äºæˆ–ç­‰äºå³è¾¹çš„å€¼è¿”å›true</td>
<td style="text-align:left">(A &gt;= B) è¿”å›falseã€‚</td>
</tr>
<tr>
<td style="text-align:left">&lt;=</td>
<td style="text-align:left">å°äºç­‰äºå·ï¼Œæ£€æµ‹å·¦è¾¹çš„å€¼æ˜¯å¦å°äºæˆ–ç­‰äºå³è¾¹çš„å€¼, å¦‚æœå·¦è¾¹çš„å€¼å°äºæˆ–ç­‰äºå³è¾¹çš„å€¼è¿”å›true</td>
<td style="text-align:left">(A &lt;= B) è¿”å› trueã€‚</td>
</tr>
</tbody>
</table>
</div>
<p><code>æ³¨æ„ï¼š&lt;&gt; å’Œ != éƒ½æ˜¯ä¸ç­‰äºçš„æ„æ€ã€‚</code></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢è€ƒè¯•æˆç»©åŒºé—´åœ¨[95, 100]</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> studentresult <span class="keyword">BETWEEN</span> <span class="number">95</span> <span class="keyword">AND</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä½¿ç”¨é€»è¾‘ä¸</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> studentresult <span class="operator">&gt;=</span> <span class="number">95</span> <span class="keyword">AND</span> studentresult <span class="operator">&lt;=</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- AND æ¢æˆ &amp;&amp;</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> studentresult <span class="operator">&gt;=</span> <span class="number">95</span> <span class="operator">&amp;&amp;</span> studentresult <span class="operator">&lt;=</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- é€»è¾‘æˆ–</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> studentresult <span class="operator">&lt;</span> <span class="number">60</span> <span class="keyword">OR</span> studentno <span class="operator">=</span> <span class="number">1003</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- OR æ¢æˆ ||</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> studentresult <span class="operator">&lt;</span> <span class="number">60</span> <span class="operator">||</span> studentno <span class="operator">=</span> <span class="number">1003</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- é€»è¾‘é</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> studentno <span class="operator">!=</span> <span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ! æ¢æˆ NOT</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> studentno <span class="operator">=</span> <span class="number">1000</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="3ã€æ¨¡ç³ŠæŸ¥è¯¢"><a href="#3ã€æ¨¡ç³ŠæŸ¥è¯¢" class="headerlink" title="3ã€æ¨¡ç³ŠæŸ¥è¯¢"></a>3ã€æ¨¡ç³ŠæŸ¥è¯¢</h4><div class="table-container">
<table>
<thead>
<tr>
<th>æ“ä½œç¬¦åç§°</th>
<th>è¯­æ³•</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>IS NULL</td>
<td>a IS NULL</td>
<td>è‹¥æ“ä½œç¬¦ä¸º NULLï¼Œåˆ™ç»“æœä¸ºçœŸ</td>
</tr>
<tr>
<td>IS NOT NULL</td>
<td>a IS NOT NULL</td>
<td>è‹¥æ“ä½œç¬¦ä¸ä¸º NULLï¼Œåˆ™ç»“æœä¸ºçœŸ</td>
</tr>
<tr>
<td>BETWEEN</td>
<td>a BETWEEN b AND c</td>
<td>è‹¥ a èŒƒå›´åœ¨ b ä¸ c ä¹‹é—´ï¼Œåˆ™ç»“æœä¸ºçœŸ</td>
</tr>
<tr>
<td>LIKE</td>
<td>a LIKE b</td>
<td>SQL æ¨¡å¼åŒ¹é…ï¼Œè‹¥a åŒ¹é… bï¼Œåˆ™ç»“æœä¸ºçœŸ</td>
</tr>
<tr>
<td>IN</td>
<td>a IN(a1, a2, a3, â€¦â€¦)</td>
<td>è‹¥ a ç­‰äº a1,a2â€¦â€¦ ä¸­çš„æŸä¸€ä¸ªï¼Œåˆ™ç»“æœä¸ºçœŸ</td>
</tr>
</tbody>
</table>
</div>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>æ•°æ®æ•°æ®ç±»å‹çš„è®°å½•ä¹‹é—´æ‰èƒ½è¿›è¡Œç®—æœ¯è¿ç®—</li>
<li>ç›¸åŒæ•°æ®ç±»å‹çš„æ•°æ®ä¹‹é—´æ‰èƒ½è¿›è¡Œæ¯”è¾ƒ</li>
</ul>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- =============================================</span></span><br><span class="line"><span class="comment">-- LIKE</span></span><br><span class="line"><span class="comment">-- =============================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å§“åˆ˜çš„åŒå­¦çš„å­¦å·åŠå§“å</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,studentname</span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> studentname <span class="keyword">LIKE</span> <span class="string">'å¼ %'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å§“åˆ˜ä¸”å§“åä¸¤ä¸ªå­—çš„åŒå­¦</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,studentname</span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> studentname <span class="keyword">LIKE</span> <span class="string">'å¼ _'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å§“åˆ˜ä¸”å§“åä¸‰ä¸ªå­—çš„åŒå­¦</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,studentname</span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> studentname <span class="keyword">LIKE</span> <span class="string">'å¼ __'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å§“åä¸­å«æœ‰å˜‰å­—çš„åŒå­¦</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,studentname</span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> studentname <span class="keyword">LIKE</span> <span class="string">'%å˜‰%'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- =============================================</span></span><br><span class="line"><span class="comment">-- IN</span></span><br><span class="line"><span class="comment">-- =============================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å­¦å·ä¸º1001,1002,1003çš„å­¦ç”Ÿå§“å</span></span><br><span class="line"><span class="keyword">SELECT</span> studentname <span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> studentno <span class="keyword">IN</span> (<span class="number">1001</span>, <span class="number">1002</span>, <span class="number">1003</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢åœ°å€åœ¨åŒ—äº¬ï¼Œå—äº¬ï¼Œæ²³å—æ´›é˜³çš„å­¦ç”Ÿ</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno, studentname, address</span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> address <span class="keyword">IN</span>(<span class="string">'åŒ—äº¬'</span>, <span class="string">'å—äº¬'</span>, <span class="string">'æ²³å—æ´›é˜³'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- =============================================</span></span><br><span class="line"><span class="comment">-- NULL</span></span><br><span class="line"><span class="comment">-- =============================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å‡ºç”Ÿæ—¥æœŸæ²¡æœ‰å¡«å†™çš„åŒå­¦</span></span><br><span class="line"><span class="comment">-- ä¸èƒ½ç›´æ¥å†™=NULLï¼Œä¸€å®šè¦ç”¨IS NULL</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,studentname</span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> `borndate` <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å‡ºç”Ÿæ—¥æœŸå¡«å†™çš„åŒå­¦</span></span><br><span class="line"><span class="keyword">SELECT</span> studentname, borndate <span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> borndate <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢æ²¡æœ‰å†™å®¶åº­ä½å€çš„åŒå­¦</span></span><br><span class="line"><span class="comment">-- ç©ºå­—ç¬¦ä¸²ä¸ç­‰äºNULL</span></span><br><span class="line"><span class="keyword">SELECT</span> studentname, address <span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> address <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">OR</span> address <span class="operator">=</span> <span class="string">''</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>è¸©é›·</strong></p>
<ul>
<li>æ²¡æœ‰ <code>a = NULL</code>è¿™ç§å†™æ³•ï¼Œå¿…é¡»å†™æˆ <code>a IS NULL</code></li>
<li>ç©ºå­—ç¬¦ä¸²å³<strong>``</strong>ï¼Œå¹¶ä¸ç­‰äº <strong>NULL</strong></li>
</ul>
<h4 id="4ã€è¿æ¥æŸ¥è¯¢"><a href="#4ã€è¿æ¥æŸ¥è¯¢" class="headerlink" title="4ã€è¿æ¥æŸ¥è¯¢"></a>4ã€è¿æ¥æŸ¥è¯¢</h4><p><strong>Join</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>æ“ä½œç¬¦åç§°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>INNER JOIN</td>
<td>å¦‚æœå·¦å³è¡¨éƒ½åŒ¹é…åˆ°ï¼Œåˆ™è¿”å›è¡Œ</td>
</tr>
<tr>
<td>LEFT JOIN</td>
<td>å³ä½¿å³è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œä¹Ÿä»å·¦è¡¨ä¸­è¿”å›æ‰€æœ‰çš„è¡Œ</td>
</tr>
<tr>
<td>RIGHT JOIN</td>
<td>å³ä½¿å·¦è¾¹ä¸­æ²¡æœ‰åŒ¹é…ï¼Œä¹Ÿä»å³è¡¨ä¸­è¿”å›æ‰€æœ‰çš„è¡Œ</td>
</tr>
</tbody>
</table>
</div>
<p><img src="https://z3.ax1x.com/2021/11/18/II1hFJ.png" alt=""></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">è¿æ¥æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">    å¦‚æœéœ€è¦å¤šå¼ æ•°æ®è¡¨çš„æ•°æ®è¿›è¡ŒæŸ¥è¯¢ï¼Œåˆ™å¯ä»¥é€šè¿‡è¿æ¥è¿ç®—ç¬¦å®ç°å¤šä¸ªæŸ¥è¯¢</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">å†…è¿æ¥ INNER JOIN</span></span><br><span class="line"><span class="comment">    æŸ¥è¯¢ä¸¤ä¸ªè¡¨ä¸­çš„ç»“æœé›†ä¸­çš„äº¤é›†</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">å¤–è¿æ¥ OUTER JOIN</span></span><br><span class="line"><span class="comment">    å·¦å¤–è¿æ¥ LEFT JOIN</span></span><br><span class="line"><span class="comment">        ä»¥å·¦è¡¨ä¸ºåŸºå‡†ï¼Œå³è¡¨æ¥ä¸€ä¸€åŒ¹é…ï¼ŒåŒ¹é…ä¸ä¸Šçš„ï¼Œè¿”å›å·¦è¡¨çš„è®°å½•ï¼Œå³è¡¨ä»¥NULLå¡«å……</span></span><br><span class="line"><span class="comment">    å³å¤–è¿æ¥ RIGHT JOIN</span></span><br><span class="line"><span class="comment">        ä»¥å³è¡¨ä¸ºåŸºå‡†ï¼Œå·¦è¡¨æ¥ä¸€ä¸€åŒ¹é…ï¼ŒåŒ¹é…ä¸ä¸Šçš„ï¼Œè¿”å›å³è¡¨çš„è®°å½•ï¼Œå·¦è¡¨ä»¥NULLå¡«å……    </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å‚åŠ äº†è€ƒè¯•çš„åŒå­¦ä¿¡æ¯(å­¦å·,å­¦ç”Ÿå§“å,ç§‘ç›®ç¼–å·,åˆ†æ•°)</span></span><br><span class="line"><span class="comment">-- INNER JOIN</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, subjectno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.`studentno` <span class="operator">=</span> r.`studentno`</span><br><span class="line"></span><br><span class="line"><span class="comment">-- RIGHT JOIN</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, subjectno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.`studentno` <span class="operator">=</span> r.`studentno`</span><br><span class="line"></span><br><span class="line"><span class="comment">-- LEFT JOIN</span></span><br><span class="line"><span class="comment">-- æ­¤æ—¶ä¼šå‡ºç°é—®é¢˜ï¼Œä¼šå°†å­˜åœ¨äºstudentä¸­ä½†æ²¡æœ‰å‚åŠ è€ƒè¯•çš„å­¦ç”Ÿä¹Ÿä¸€å¹¶æ‰“å°</span></span><br><span class="line"><span class="comment">-- å¯ä»¥ä½¿ç”¨whereè¿›ä¸€æ­¥ç­›é€‰</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, subjectno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.`studentno` <span class="operator">=</span> r.`studentno`</span><br><span class="line"><span class="keyword">WHERE</span> r.`studentresult` <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- LEFT JOIN</span></span><br><span class="line"><span class="comment">-- å°†å·¦è¡¨æ›´æ¢ä¸ºresultå³å¯ï¼Œé‡ç‚¹æ˜¯å‚åŠ è€ƒè¯•çš„åŒå­¦</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, subjectno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> student s</span><br><span class="line"><span class="keyword">ON</span> s.`studentno` <span class="operator">=</span> r.`studentno`</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢ç¼ºè€ƒçš„åŒå­¦</span></span><br><span class="line"><span class="comment">-- LEFT JOIN</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, subjectno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.`studentno` <span class="operator">=</span> r.`studentno`</span><br><span class="line"><span class="keyword">WHERE</span> r.`studentresult` <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- INNER JOIN</span></span><br><span class="line"><span class="comment">-- éœ€è¦åŒæ–¹éƒ½åŒ¹é…åˆ°ï¼Œè€Œç¼ºè€ƒå¹¶æ²¡æœ‰è®°å½•åœ¨æˆç»©è¡¨ä¸­</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, subjectno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.`studentno` <span class="operator">=</span> r.`studentno`</span><br><span class="line"><span class="keyword">WHERE</span> r.`studentresult` <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- RIGHT JOIN</span></span><br><span class="line"><span class="comment">-- åŒä¸Šï¼Œç¼ºè€ƒæ²¡æœ‰è®°å½•åœ¨æˆç»©è¡¨ä¸­</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, subjectno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.`studentno` <span class="operator">=</span> r.`studentno`</span><br><span class="line"><span class="keyword">WHERE</span> r.`studentresult` <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å‚åŠ äº†è€ƒè¯•çš„åŒå­¦ä¿¡æ¯(å­¦å·,å­¦ç”Ÿå§“å,ç§‘ç›®å,åˆ†æ•°)</span></span><br><span class="line"><span class="comment">-- ç¬¬ä¸€æ¬¡æŸ¥è¯¢ä»¥æˆç»©è¡¨ä¸ºä¸»ï¼ŒæŸ¥è¯¢ç»“æœä½œä¸ºå·¦è¡¨ï¼Œä½¿ç”¨RIGHT JOIN</span></span><br><span class="line"><span class="comment">-- ç¬¬äºŒæ¬¡æŸ¥è¯¢ä»¥å·¦è¡¨ï¼ˆç¬¬ä¸€æ¬¡çš„æŸ¥è¯¢ç»“æœï¼‰ä¸ºä¸»ï¼Œä½¿ç”¨LEFT JOIN</span></span><br><span class="line"><span class="comment">-- å½“ç„¶ï¼Œä¸¤æ¬¡éƒ½æ˜¯ç”¨INNER JOINä¹Ÿæ˜¯æ²¡é—®é¢˜çš„</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, subjectname, studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.`studentno` <span class="operator">=</span> r.`studentno`</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> `subject` u</span><br><span class="line"><span class="keyword">ON</span> r.`subjectno` <span class="operator">=</span> u.subjectno</span><br></pre></td></tr></tbody></table></figure>
<p>åŠ å¼ºç»ƒä¹ </p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢å‚åŠ äº†è€ƒè¯•çš„åŒå­¦ä¿¡æ¯(å­¦å·,å­¦ç”Ÿå§“å,ç§‘ç›®å,åˆ†æ•°)</span></span><br><span class="line"><span class="keyword">SELECT</span> r.studentno, studentname, subjectname, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> student s</span><br><span class="line"><span class="keyword">ON</span> r.studentno <span class="operator">=</span> s.studentno</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> `subject` u</span><br><span class="line"><span class="keyword">ON</span> r.subjectno <span class="operator">=</span> u.subjectno</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å­¦å‘˜åŠæ‰€å±çš„å¹´çº§(å­¦å·,å­¦ç”Ÿå§“å,å¹´çº§å)</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno, studentname, gradename</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> grade g</span><br><span class="line"><span class="keyword">ON</span> s.gradeid <span class="operator">=</span> g.gradeid</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢ç§‘ç›®åŠæ‰€å±çš„å¹´çº§(ç§‘ç›®åç§°,å¹´çº§åç§°)</span></span><br><span class="line"><span class="keyword">SELECT</span> subjectname, gradename</span><br><span class="line"><span class="keyword">FROM</span> `subject` s</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> grade g</span><br><span class="line"><span class="keyword">ON</span> s.gradeid <span class="operator">=</span> g.gradeid</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢ Cè¯­è¨€-2 çš„æ‰€æœ‰è€ƒè¯•ç»“æœ(å­¦å· å­¦ç”Ÿå§“å ç§‘ç›®åç§° æˆç»©)</span></span><br><span class="line"><span class="keyword">SELECT</span> t.studentno, studentname, subjectname, studentresult</span><br><span class="line"><span class="keyword">FROM</span> `<span class="keyword">result</span>` r</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> `subject` s</span><br><span class="line"><span class="keyword">ON</span> s.subjectno <span class="operator">=</span> r.subjectno</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> student t</span><br><span class="line"><span class="keyword">ON</span> t.studentno <span class="operator">=</span> r.studentno</span><br><span class="line"><span class="keyword">WHERE</span> s.subjectname <span class="operator">=</span> <span class="string">'Cè¯­è¨€-2'</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note danger">
            <p>WHERE ä¸èƒ½å†™åœ¨ä¸¤ä¸ª JOIN è¯­å¥ä¹‹é—´ï¼Œè¦æ”¾åœ¨åé¢ï¼è¯¦æƒ…è¯·çœ‹è¿™èŠ‚å¼€å¤´çš„ <code>SELECT è¯­æ³•</code></p>
          </div>
<h4 id="5ã€è‡ªæŸ¥è¯¢"><a href="#5ã€è‡ªæŸ¥è¯¢" class="headerlink" title="5ã€è‡ªæŸ¥è¯¢"></a>5ã€è‡ªæŸ¥è¯¢</h4><p>é¡¾åæ€ä¹‰ï¼Œå³æ•°æ®è¡¨ä¸è‡ªèº«è¿›è¡Œè¿æ¥ã€‚</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºä¸€ä¸ªè¡¨</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `category` (</span><br><span class="line">`categoryid` <span class="type">INT</span>(<span class="number">10</span>) UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">'ä¸»é¢˜id'</span>,</span><br><span class="line">`pid` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'çˆ¶id'</span>,</span><br><span class="line">`categoryName` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'ä¸»é¢˜åå­—'</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`categoryid`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB AUTO_INCREMENT<span class="operator">=</span><span class="number">9</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥æ•°æ®</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `category` (`categoryid`, `pid`, `categoryName`)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">'2'</span>,<span class="string">'1'</span>,<span class="string">'ä¿¡æ¯æŠ€æœ¯'</span>),</span><br><span class="line">(<span class="string">'3'</span>,<span class="string">'1'</span>,<span class="string">'è½¯ä»¶å¼€å‘'</span>),</span><br><span class="line">(<span class="string">'4'</span>,<span class="string">'3'</span>,<span class="string">'æ•°æ®åº“'</span>),</span><br><span class="line">(<span class="string">'5'</span>,<span class="string">'1'</span>,<span class="string">'ç¾æœ¯è®¾è®¡'</span>),</span><br><span class="line">(<span class="string">'6'</span>,<span class="string">'3'</span>,<span class="string">'webå¼€å‘'</span>),</span><br><span class="line">(<span class="string">'7'</span>,<span class="string">'5'</span>,<span class="string">'psæŠ€æœ¯'</span>),</span><br><span class="line">(<span class="string">'8'</span>,<span class="string">'2'</span>,<span class="string">'åŠå…¬ä¿¡æ¯'</span>);</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- ç¼–å†™SQLè¯­å¥,å°†æ ç›®çš„çˆ¶å­å…³ç³»å‘ˆç°å‡ºæ¥ (çˆ¶æ ç›®åç§°,å­æ ç›®åç§°)</span></span><br><span class="line"><span class="comment">-- æ ¸å¿ƒæ€æƒ³:æŠŠä¸€å¼ è¡¨çœ‹æˆä¸¤å¼ ä¸€æ¨¡ä¸€æ ·çš„è¡¨,ç„¶åå°†è¿™ä¸¤å¼ è¡¨è¿æ¥æŸ¥è¯¢(è‡ªè¿æ¥)</span></span><br><span class="line"><span class="keyword">SELECT</span> a.categoryName <span class="keyword">AS</span> <span class="string">'çˆ¶æ ç›®'</span>,b.categoryName <span class="keyword">AS</span> <span class="string">'å­æ ç›®'</span></span><br><span class="line"><span class="keyword">FROM</span> category <span class="keyword">AS</span> a,category <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">WHERE</span> a.`categoryid`<span class="operator">=</span>b.`pid`</span><br></pre></td></tr></tbody></table></figure>
<h4 id="6ã€æ’åºå’Œåˆ†é¡µ"><a href="#6ã€æ’åºå’Œåˆ†é¡µ" class="headerlink" title="6ã€æ’åºå’Œåˆ†é¡µ"></a>6ã€æ’åºå’Œåˆ†é¡µ</h4><p><strong>ORDER BY</strong></p>
<ul>
<li>ç”¨äºæ ¹æ®æŒ‡å®šçš„åˆ—å¯¹ç»“æœé›†è¿›è¡Œæ’åº</li>
<li>é»˜è®¤æŒ‰ç…§ <code>ASC</code> å‡åºè¿›è¡Œæ’åº</li>
<li>å¦‚æœéœ€è¦è¿›è¡Œé™åºæ’åºï¼Œå¯ä»¥ä½¿ç”¨ DESC å…³é”®å­—</li>
</ul>
<p><strong>LIMIT</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line">è¯­æ³•ï¼š<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">table</span> LIMIT [<span class="keyword">offset</span>,] <span class="keyword">rows</span> <span class="operator">|</span> <span class="keyword">rows</span> <span class="keyword">OFFSET</span> <span class="keyword">offset</span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šç¬¬ä¸€ä¸ªè¿”å›è®°å½•è¡Œçš„åç§»é‡ï¼Œæ³¨æ„ä»<code>0</code>å¼€å§‹</li>
<li>ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šè¿”å›è®°å½•è¡Œçš„æœ€å¤§æ•°ç›®</li>
<li>å¦‚æœåªç»™å®šä¸€ä¸ªå‚æ•°ï¼šå®ƒè¡¨ç¤ºè¿”å›æœ€å¤§çš„è®°å½•è¡Œæ•°ç›®</li>
<li>ç¬¬äºŒä¸ªå‚æ•°ä¸º -1 è¡¨ç¤ºæ£€ç´¢ä»æŸä¸€ä¸ªåç§»é‡åˆ°è®°å½•é›†çš„ç»“æŸæ‰€æœ‰çš„è®°å½•è¡Œ</li>
<li>åˆå§‹è®°å½•è¡Œçš„åç§»é‡æ˜¯ 0(è€Œä¸æ˜¯ 1)</li>
</ul>
<p><strong>åˆ†é¡µä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>ç”¨æˆ·ä½“éªŒ</li>
<li>ç½‘ç»œä¼ è¾“</li>
<li>æŸ¥è¯¢å‹åŠ›</li>
</ul>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢ æ•°æ®åº“ç»“æ„-1 çš„æ‰€æœ‰è€ƒè¯•ç»“æœ(å­¦å· å­¦ç”Ÿå§“å ç§‘ç›®åç§° æˆç»©)</span></span><br><span class="line"><span class="comment">-- æ³¨æ„æ˜¯ LEFT JOIN è€Œä¸æ˜¯ JOIN LEFT</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, subjectname, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> student s</span><br><span class="line"><span class="keyword">ON</span> r.`studentno` <span class="operator">=</span> s.studentno</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> `subject` u</span><br><span class="line"><span class="keyword">ON</span> r.`subjectno` <span class="operator">=</span> u.subjectno</span><br><span class="line"><span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">'Cè¯­è¨€-2'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŒ‰æˆç»©å‡åºæ’åº</span></span><br><span class="line"><span class="comment">-- ORDER BY é»˜è®¤å°±æ˜¯å‡åº</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, subjectname, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> student s</span><br><span class="line"><span class="keyword">ON</span> r.`studentno` <span class="operator">=</span> s.studentno</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> `subject` u</span><br><span class="line"><span class="keyword">ON</span> r.`subjectno` <span class="operator">=</span> u.subjectno</span><br><span class="line"><span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">'Cè¯­è¨€-2'</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> studentresult <span class="keyword">ASC</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ¯é¡µæ˜¾ç¤º5æ¡æ•°æ®</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, subjectname, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> student s</span><br><span class="line"><span class="keyword">ON</span> r.`studentno` <span class="operator">=</span> s.studentno</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> `subject` u</span><br><span class="line"><span class="keyword">ON</span> r.`subjectno` <span class="operator">=</span> u.subjectno</span><br><span class="line"><span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">'Cè¯­è¨€-2'</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> studentresult <span class="keyword">ASC</span></span><br><span class="line">LIMIT <span class="number">0</span>, <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢ JAVAç¬¬ä¸€å­¦å¹´ è¯¾ç¨‹æˆç»©å‰10åå¹¶ä¸”åˆ†æ•°å¤§äº80çš„å­¦ç”Ÿä¿¡æ¯(å­¦å·,å§“å,è¯¾ç¨‹å,åˆ†æ•°)</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, subjectname, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> student s</span><br><span class="line"><span class="keyword">ON</span> s.`studentno` <span class="operator">=</span> r.`studentno`</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> `subject` u</span><br><span class="line"><span class="keyword">ON</span> u.`subjectno` <span class="operator">=</span> r.`subjectno`</span><br><span class="line"><span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">'Javaç¨‹åºè®¾è®¡-1'</span> <span class="keyword">AND</span> studentresult <span class="operator">&gt;</span> <span class="number">80</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> studentresult <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">0</span>, <span class="number">10</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="7ã€å­æŸ¥è¯¢"><a href="#7ã€å­æŸ¥è¯¢" class="headerlink" title="7ã€å­æŸ¥è¯¢"></a>7ã€å­æŸ¥è¯¢</h4><p>å­æŸ¥è¯¢å°±æ˜¯åœ¨æŸ¥è¯¢è¯­å¥çš„ WHERE æ¡ä»¶å­å¥ä¸­ï¼ŒåˆåµŒå¥—äº†å¦ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼ŒåµŒå¥—æŸ¥è¯¢å¯ç”±å¤šä¸ªå­æŸ¥è¯¢ç»„æˆï¼Œæ±‚è§£çš„æ–¹å¼æ˜¯ç”±é‡ŒåŠå¤–ã€‚å­æŸ¥è¯¢è¿”å›çš„ç»“æœä¸€èˆ¬éƒ½æ˜¯é›†åˆï¼Œæ•…è€Œå»ºè®®ä½¿ç”¨ IN å…³é”®å­—ã€‚</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢ Javaç¨‹åºè®¾è®¡-1 çš„æ‰€æœ‰è€ƒè¯•ç»“æœ(å­¦å·,ç§‘ç›®ç¼–å·,æˆç»©),å¹¶ä¸”æˆç»©é™åºæ’åˆ—</span></span><br><span class="line"><span class="comment">-- è¿æ¥æŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno, r.subjectno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> `subject` s</span><br><span class="line"><span class="keyword">ON</span> s.`subjectno` <span class="operator">=</span> r.`subjectno`</span><br><span class="line"><span class="keyword">WHERE</span> s.`subjectname` <span class="operator">=</span> <span class="string">'Javaç¨‹åºè®¾è®¡-1'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å­æŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno, subjectno, studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> subjectno <span class="operator">=</span> (<span class="keyword">SELECT</span> subjectno <span class="keyword">FROM</span> `subject` <span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">'Javaç¨‹åºè®¾è®¡-1'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢è¯¾ç¨‹ä¸º Javaç¨‹åºè®¾è®¡-1 ä¸”åˆ†æ•°ä¸å°äº90åˆ†çš„å­¦ç”Ÿçš„å­¦å·å’Œå§“å</span></span><br><span class="line"><span class="comment">-- è¿æ¥æŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">SELECT</span> r.studentno, studentname</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> `subject` s</span><br><span class="line"><span class="keyword">ON</span> r.`subjectno` <span class="operator">=</span> s.`subjectno`</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> student stu</span><br><span class="line"><span class="keyword">ON</span> r.`studentno` <span class="operator">=</span> stu.studentno</span><br><span class="line"><span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">'Javaç¨‹åºè®¾è®¡-1'</span> <span class="keyword">AND</span> studentresult <span class="operator">&gt;=</span> <span class="number">90</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å­æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">-- ç”±äºåˆ†æ•°ä¸å°äº90çš„åŒå­¦æ˜¯ä¸€ä¸ªé›†åˆï¼ˆæ•°é‡å¤§äº1ï¼‰ï¼Œå› æ­¤åœ¨å¤–å±‚åµŒå¥—ä¸­éœ€è¦ä½¿ç”¨IN</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno, studentname <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> studentno <span class="keyword">IN</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> studentno <span class="keyword">FROM</span> <span class="keyword">result</span> <span class="keyword">WHERE</span> subjectno <span class="operator">=</span> (</span><br><span class="line">		<span class="keyword">SELECT</span> subjectno <span class="keyword">FROM</span> `subject` <span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">'Javaç¨‹åºè®¾è®¡-1'</span>) </span><br><span class="line">	<span class="keyword">AND</span> studentresult <span class="operator">&gt;=</span> <span class="number">90</span>)</span><br><span class="line">	</span><br><span class="line"><span class="comment">-- è¿æ¥æŸ¥è¯¢ + å­æŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">SELECT</span> r.studentno, studentname</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> `student` s</span><br><span class="line"><span class="keyword">ON</span> r.`studentno` <span class="operator">=</span> s.`studentno`</span><br><span class="line"><span class="keyword">WHERE</span> subjectno <span class="operator">=</span> (<span class="keyword">SELECT</span> subjectno <span class="keyword">FROM</span> `subject` <span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">'Javaç¨‹åºè®¾è®¡-1'</span>) <span class="keyword">AND</span> studentresult <span class="operator">&gt;=</span> <span class="number">90</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥Javaç¨‹åºè®¾è®¡-1 çš„å‰5åå­¦ç”Ÿçš„æˆç»©ä¿¡æ¯(å­¦å·,å§“å,åˆ†æ•°)</span></span><br><span class="line"><span class="comment">-- è¿æ¥æŸ¥è¯¢</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno, studentname, studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.studentno <span class="operator">=</span> r.studentno</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> `subject` sub</span><br><span class="line"><span class="keyword">ON</span> r.`subjectno` <span class="operator">=</span> sub.subjectno</span><br><span class="line"><span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">'Javaç¨‹åºè®¾è®¡-1'</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> studentresult <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">0</span>,<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å¼ ä¼ŸåŒå­¦æ‰€åœ¨çš„å¹´çº§åç§°</span></span><br><span class="line"><span class="keyword">SELECT</span> studentname, gradename</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> grade g</span><br><span class="line"><span class="keyword">ON</span> s.`gradeid` <span class="operator">=</span> g.gradeid</span><br><span class="line"><span class="keyword">WHERE</span> studentname <span class="operator">=</span> <span class="string">'å¼ ä¼Ÿ'</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="8ã€åˆ†ç»„æŸ¥è¯¢"><a href="#8ã€åˆ†ç»„æŸ¥è¯¢" class="headerlink" title="8ã€åˆ†ç»„æŸ¥è¯¢"></a>8ã€åˆ†ç»„æŸ¥è¯¢</h4><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"> <span class="comment">-- æŸ¥è¯¢ä¸åŒè¯¾ç¨‹çš„è¯¾ç¨‹ç¼–å·ï¼Œè¯¾ç¨‹åç§°ï¼Œå¹³å‡åˆ†(å¤§äº60),æœ€é«˜åˆ†,æœ€ä½åˆ†</span></span><br><span class="line"><span class="keyword">SELECT</span> r.subjectno è¯¾ç¨‹ç¼–å·, subjectname è¯¾ç¨‹åç§°, <span class="built_in">MAX</span>(studentresult) æœ€é«˜åˆ†, <span class="built_in">MIN</span>(studentresult) æœ€ä½åˆ†, <span class="built_in">AVG</span>(studentresult) å¹³å‡åˆ†</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> `subject` s</span><br><span class="line"><span class="keyword">ON</span> r.subjectno <span class="operator">=</span> s.subjectno</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> è¯¾ç¨‹ç¼–å·</span><br><span class="line"><span class="keyword">HAVING</span> å¹³å‡åˆ† <span class="operator">&gt;</span> <span class="number">60</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>WHERE å¿…é¡»å†™åœ¨ GROUP BY å‰é¢ï¼Œåˆ†ç»„åç­›é€‰è¦ä½¿ç”¨ HAVINGï¼Œå› ä¸º HAVING æ˜¯æ ¹æ®å‰é¢ç­›é€‰çš„å­—æ®µå†ç­›é€‰ï¼Œè€Œ WHERE æ˜¯æ ¹æ®æ•°æ®è¡¨ä¸­çš„å­—æ®µç›´æ¥è¿›è¡Œç­›é€‰ã€‚</p>
          </div>
<h2 id="ä¸ƒã€MySQL-å‡½æ•°"><a href="#ä¸ƒã€MySQL-å‡½æ•°" class="headerlink" title="ä¸ƒã€MySQL å‡½æ•°"></a>ä¸ƒã€MySQL å‡½æ•°</h2><h4 id="1ã€æ²¡é‚£ä¹ˆå¸¸ç”¨çš„å¸¸ç”¨å‡½æ•°"><a href="#1ã€æ²¡é‚£ä¹ˆå¸¸ç”¨çš„å¸¸ç”¨å‡½æ•°" class="headerlink" title="1ã€æ²¡é‚£ä¹ˆå¸¸ç”¨çš„å¸¸ç”¨å‡½æ•°"></a>1ã€æ²¡é‚£ä¹ˆå¸¸ç”¨çš„å¸¸ç”¨å‡½æ•°</h4><p><strong>æ•°æ®å‡½æ•°</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">ABS</span>(<span class="number">-8</span>);  <span class="comment">/*ç»å¯¹å€¼*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CEILING</span>(<span class="number">9.4</span>); <span class="comment">/*å‘ä¸Šå–æ•´*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">FLOOR</span>(<span class="number">9.4</span>);   <span class="comment">/*å‘ä¸‹å–æ•´*/</span></span><br><span class="line"><span class="keyword">SELECT</span> RAND();  <span class="comment">/*éšæœºæ•°,è¿”å›ä¸€ä¸ª0-1ä¹‹é—´çš„éšæœºæ•°*/</span></span><br><span class="line"><span class="keyword">SELECT</span> SIGN(<span class="number">0</span>); <span class="comment">/*ç¬¦å·å‡½æ•°: è´Ÿæ•°è¿”å›-1,æ­£æ•°è¿”å›1,0è¿”å›0*/</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>å­—ç¬¦ä¸²å‡½æ•°</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CHAR_LENGTH</span>(<span class="string">'ç‹‚ç¥è¯´åšæŒå°±èƒ½æˆåŠŸ'</span>); <span class="comment">/*è¿”å›å­—ç¬¦ä¸²åŒ…å«çš„å­—ç¬¦æ•°*/</span></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="string">'æˆ‘'</span>,<span class="string">'çˆ±'</span>,<span class="string">'ç¨‹åº'</span>);  <span class="comment">/*åˆå¹¶å­—ç¬¦ä¸²,å‚æ•°å¯ä»¥æœ‰å¤šä¸ª*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">INSERT</span>(<span class="string">'æˆ‘çˆ±ç¼–ç¨‹helloworld'</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="string">'è¶…çº§çƒ­çˆ±'</span>);  <span class="comment">/*æ›¿æ¢å­—ç¬¦ä¸²,ä»æŸä¸ªä½ç½®å¼€å§‹æ›¿æ¢æŸä¸ªé•¿åº¦*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">LOWER</span>(<span class="string">'KuangShen'</span>); <span class="comment">/*å°å†™*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">UPPER</span>(<span class="string">'KuangShen'</span>); <span class="comment">/*å¤§å†™*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">LEFT</span>(<span class="string">'hello,world'</span>,<span class="number">5</span>);   <span class="comment">/*ä»å·¦è¾¹æˆªå–*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">RIGHT</span>(<span class="string">'hello,world'</span>,<span class="number">5</span>);  <span class="comment">/*ä»å³è¾¹æˆªå–*/</span></span><br><span class="line"><span class="keyword">SELECT</span> REPLACE(<span class="string">'ç‹‚ç¥è¯´åšæŒå°±èƒ½æˆåŠŸ'</span>,<span class="string">'åšæŒ'</span>,<span class="string">'åŠªåŠ›'</span>);  <span class="comment">/*æ›¿æ¢å­—ç¬¦ä¸²*/</span></span><br><span class="line"><span class="keyword">SELECT</span> SUBSTR(<span class="string">'ç‹‚ç¥è¯´åšæŒå°±èƒ½æˆåŠŸ'</span>,<span class="number">4</span>,<span class="number">6</span>); <span class="comment">/*æˆªå–å­—ç¬¦ä¸²,å¼€å§‹å’Œé•¿åº¦*/</span></span><br><span class="line"><span class="keyword">SELECT</span> REVERSE(<span class="string">'ç‹‚ç¥è¯´åšæŒå°±èƒ½æˆåŠŸ'</span>); <span class="comment">/*åè½¬*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å§“å‘¨çš„åŒå­¦,æ”¹æˆé‚¹</span></span><br><span class="line"><span class="keyword">SELECT</span> REPLACE(studentname,<span class="string">'å‘¨'</span>,<span class="string">'é‚¹'</span>) <span class="keyword">AS</span> æ–°åå­—</span><br><span class="line"><span class="keyword">FROM</span> student <span class="keyword">WHERE</span> studentname <span class="keyword">LIKE</span> <span class="string">'å‘¨%'</span>;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ—¥æœŸå’Œæ—¶é—´å‡½æ•°</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CURRENT_DATE</span>();   <span class="comment">/*è·å–å½“å‰æ—¥æœŸ*/</span></span><br><span class="line"><span class="keyword">SELECT</span> CURDATE();   <span class="comment">/*è·å–å½“å‰æ—¥æœŸ*/</span></span><br><span class="line"><span class="keyword">SELECT</span> NOW();   <span class="comment">/*è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">LOCALTIME</span>();   <span class="comment">/*è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´*/</span></span><br><span class="line"><span class="keyword">SELECT</span> SYSDATE();   <span class="comment">/*è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- è·å–å¹´æœˆæ—¥,æ—¶åˆ†ç§’</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">YEAR</span>(NOW());</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MONTH</span>(NOW());</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DAY</span>(NOW());</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">HOUR</span>(NOW());</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MINUTE</span>(NOW());</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SECOND</span>(NOW());</span><br></pre></td></tr></tbody></table></figure>
<p><strong>ç³»ç»Ÿä¿¡æ¯å‡½æ•°</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> VERSION();  <span class="comment">/*ç‰ˆæœ¬*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>();     <span class="comment">/*ç”¨æˆ·*/</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="2ã€èšåˆå‡½æ•°"><a href="#2ã€èšåˆå‡½æ•°" class="headerlink" title="2ã€èšåˆå‡½æ•°"></a>2ã€èšåˆå‡½æ•°</h4><div class="table-container">
<table>
<thead>
<tr>
<th>å‡½æ•°åç§°</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>COUNT()</td>
<td>è¿”å›æ»¡è¶³Selectæ¡ä»¶çš„è®°å½•æ€»å’Œæ•°ï¼Œå¦‚ select count(*)</td>
</tr>
<tr>
<td>SUM()</td>
<td>è¿”å›æ•°å­—å­—æ®µæˆ–è¡¨è¾¾å¼åˆ—ä½œç»Ÿè®¡ï¼Œè¿”å›ä¸€åˆ—çš„æ€»å’Œã€‚</td>
</tr>
<tr>
<td>AVG()</td>
<td>é€šå¸¸ä¸ºæ•°å€¼å­—æ®µæˆ–è¡¨è¾¾åˆ—ä½œç»Ÿè®¡ï¼Œè¿”å›ä¸€åˆ—çš„å¹³å‡å€¼</td>
</tr>
<tr>
<td>MAX()</td>
<td>å¯ä»¥ä¸ºæ•°å€¼å­—æ®µï¼Œå­—ç¬¦å­—æ®µæˆ–è¡¨è¾¾å¼åˆ—ä½œç»Ÿè®¡ï¼Œè¿”å›æœ€å¤§çš„å€¼ã€‚</td>
</tr>
<tr>
<td>MIN()</td>
<td>å¯ä»¥ä¸ºæ•°å€¼å­—æ®µï¼Œå­—ç¬¦å­—æ®µæˆ–è¡¨è¾¾å¼åˆ—ä½œç»Ÿè®¡ï¼Œè¿”å›æœ€å°çš„å€¼ã€‚</td>
</tr>
</tbody>
</table>
</div>
<p><strong>COUNT</strong></p>
<p>ä»¥ä¸‹ä¸‰ç§ç»Ÿè®¡è¡¨è¡Œæ•°çš„æ–¹æ³•ï¼Œè¿”å›çš„ç»“æœéƒ½æ˜¯ä¸€è‡´çš„ï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(studentno) <span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> student</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>COUNT(ColumnName)<ul>
<li>æŸ¥è¯¢æŸä¸€å­—æ®µçš„è®°å½•æ•°ï¼Œä¼šå¿½ç•¥æ‰ä¸º NULL çš„è®°å½•ã€‚</li>
<li>å¦‚æœä¸Šé¢æŸ¥è¯¢çš„æ˜¯ sex åˆ—ï¼Œå°±ä¼šå‘ç°è®°å½•æ•°åªæœ‰ä¸¤æ¡ã€‚</li>
</ul>
</li>
<li>COUNT(*)<ul>
<li>å› ä¸ºæ˜¯ SQL92 å®šä¹‰çš„æ ‡å‡†ç»Ÿè®¡è¡Œæ•°çš„è¯­æ³•ï¼Œå› æ­¤ MySQL å¯¹ä»–è¿›è¡Œäº†å¾ˆå¤šä¼˜åŒ–ã€‚</li>
<li>MyISAM ä¼šå°†è¡¨çš„æ€»è¡Œæ•°å•ç‹¬è®°å½•ä¸‹æ¥ä¾› <code>COUNT(*)</code> æŸ¥è¯¢ã€‚</li>
<li>InnoDB ä¼šåœ¨æ‰«è¡¨çš„æ—¶å€™é€‰æ‹©æœ€å°çš„ç´¢å¼•æ¥é™ä½æˆæœ¬ã€‚</li>
<li>ä¸Šè¿°ä¸¤ä¸ªå¼•æ“ä¼˜åŒ–çš„å‰ææ˜¯<strong>æ²¡æœ‰è¿›è¡Œ WHERE å’Œ GROUP çš„æ¡ä»¶æŸ¥è¯¢</strong>ã€‚</li>
</ul>
</li>
</ul>
<p>åœ¨ InnoDB ä¸­ <code>COUNT(*)</code> å’Œ <code>COUNT(1)</code> å®ç°ä¸Šæ²¡æœ‰åŒºåˆ«ï¼Œè€Œä¸”æ•ˆç‡ä¸€æ ·ï¼Œä½†æ˜¯ <code>COUNT(å­—æ®µ)</code> éœ€è¦è¿›è¡Œå­—æ®µçš„é NULL åˆ¤æ–­ï¼Œæ‰€ä»¥æ•ˆç‡ä¼šä½ä¸€äº›ã€‚</p>
<p>å› ä¸º <code>COUNT(*)</code> æ˜¯ SQL92 å®šä¹‰çš„æ ‡å‡†ç»Ÿè®¡è¡Œæ•°çš„è¯­æ³•ï¼Œå¹¶ä¸”æ•ˆç‡é«˜ï¼Œæ‰€ä»¥è¯·ç›´æ¥ä½¿ç”¨ <code>COUNT(*)</code> æŸ¥è¯¢è¡¨çš„è¡Œæ•°ï¼</p>
<p><strong>ç»ƒä¹ </strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- æ€»å’Œ</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(StudentResult) <span class="keyword">AS</span> æ€»å’Œ <span class="keyword">FROM</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="comment">-- å¹³å‡åˆ†</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(StudentResult) <span class="keyword">AS</span> å¹³å‡åˆ† <span class="keyword">FROM</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="comment">-- æœ€é«˜åˆ†</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(StudentResult) <span class="keyword">AS</span> æœ€é«˜åˆ† <span class="keyword">FROM</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="comment">-- æœ€ä½åˆ†</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(StudentResult) <span class="keyword">AS</span> æœ€ä½åˆ† <span class="keyword">FROM</span> <span class="keyword">result</span>;</span><br></pre></td></tr></tbody></table></figure>
<h4 id="3ã€MD5åŠ å¯†"><a href="#3ã€MD5åŠ å¯†" class="headerlink" title="3ã€MD5åŠ å¯†"></a>3ã€MD5åŠ å¯†</h4><p>MD5å³Message-Digest Algorithm 5ï¼ˆä¿¡æ¯-æ‘˜è¦ç®—æ³•5ï¼‰ï¼Œç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ã€‚æ˜¯è®¡ç®—æœºå¹¿æ³›ä½¿ç”¨çš„æ‚å‡‘ç®—æ³•ä¹‹ä¸€ï¼ˆåˆè¯‘æ‘˜è¦ç®—æ³•ã€å“ˆå¸Œç®—æ³•ï¼‰ï¼Œä¸»æµç¼–ç¨‹è¯­è¨€æ™®éå·²æœ‰MD5å®ç°ã€‚å°†æ•°æ®ï¼ˆå¦‚æ±‰å­—ï¼‰è¿ç®—ä¸ºå¦ä¸€å›ºå®šé•¿åº¦å€¼ï¼Œæ˜¯æ‚å‡‘ç®—æ³•çš„åŸºç¡€åŸç†ï¼ŒMD5çš„å‰èº«æœ‰MD2ã€MD3å’ŒMD4ã€‚</p>
<p><strong>å®ç°æ•°æ®åŠ å¯†</strong></p>
<p>æ–°å»ºä¸€ä¸ªæµ‹è¯•è¡¨</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `testmd5` (</span><br><span class="line"> `id` <span class="type">INT</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> `name` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> `pwd` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br></pre></td></tr></tbody></table></figure>
<p>æ’å…¥æ•°æ®</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> testmd5 <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">'yqx'</span>,<span class="string">'123456'</span>),(<span class="number">2</span>,<span class="string">'yqx'</span>,<span class="string">'456789'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>åŠ å¯†</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line">update testmd5 <span class="keyword">set</span> pwd <span class="operator">=</span> md5(pwd);</span><br></pre></td></tr></tbody></table></figure>
<p>æˆ–è€…åœ¨æ’å…¥æ•°æ®æ—¶åŠ å¯†</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> testmd5 <span class="keyword">VALUES</span>(<span class="number">3</span>,<span class="string">'yqx3'</span>,md5(<span class="string">'123456'</span>));</span><br></pre></td></tr></tbody></table></figure>
<p>ç”¨æˆ·ç™»å½•ï¼ˆå°†ç”¨æˆ·è¾“å…¥çš„å¯†ç åŠ å¯†åä¸æ•°æ®åº“çš„å¯†ç è¿›è¡Œæ¯”å¯¹ï¼‰</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> testmd5 <span class="keyword">WHERE</span> `name`<span class="operator">=</span><span class="string">'yqx'</span> <span class="keyword">AND</span> pwd<span class="operator">=</span>MD5(<span class="string">'123456'</span>);</span><br></pre></td></tr></tbody></table></figure>
<h4 id="4ã€å°ç»“"><a href="#4ã€å°ç»“" class="headerlink" title="4ã€å°ç»“"></a>4ã€å°ç»“</h4><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- ================ å†…ç½®å‡½æ•° ================</span></span><br><span class="line"><span class="comment">-- æ•°å€¼å‡½æ•°</span></span><br><span class="line"><span class="built_in">abs</span>(x)            <span class="comment">-- ç»å¯¹å€¼ abs(-10.9) = 10</span></span><br><span class="line">format(x, d)    <span class="comment">-- æ ¼å¼åŒ–åƒåˆ†ä½æ•°å€¼ format(1234567.456, 2) = 1,234,567.46</span></span><br><span class="line"><span class="built_in">ceil</span>(x)            <span class="comment">-- å‘ä¸Šå–æ•´ ceil(10.1) = 11</span></span><br><span class="line"><span class="built_in">floor</span>(x)        <span class="comment">-- å‘ä¸‹å–æ•´ floor (10.1) = 10</span></span><br><span class="line">round(x)        <span class="comment">-- å››èˆäº”å…¥å»æ•´</span></span><br><span class="line"><span class="built_in">mod</span>(m, n)        <span class="comment">-- m%n m mod n æ±‚ä½™ 10%3=1</span></span><br><span class="line">pi()            <span class="comment">-- è·å¾—åœ†å‘¨ç‡</span></span><br><span class="line">pow(m, n)        <span class="comment">-- m^n</span></span><br><span class="line"><span class="built_in">sqrt</span>(x)            <span class="comment">-- ç®—æœ¯å¹³æ–¹æ ¹</span></span><br><span class="line">rand()            <span class="comment">-- éšæœºæ•°</span></span><br><span class="line"><span class="keyword">truncate</span>(x, d)    <span class="comment">-- æˆªå–dä½å°æ•°</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">-- æ—¶é—´æ—¥æœŸå‡½æ•°</span></span><br><span class="line">now(), <span class="built_in">current_timestamp</span>();     <span class="comment">-- å½“å‰æ—¥æœŸæ—¶é—´</span></span><br><span class="line"><span class="built_in">current_date</span>();                    <span class="comment">-- å½“å‰æ—¥æœŸ</span></span><br><span class="line"><span class="built_in">current_time</span>();                    <span class="comment">-- å½“å‰æ—¶é—´</span></span><br><span class="line"><span class="type">date</span>(<span class="string">'yyyy-mm-dd hh:ii:ss'</span>);    <span class="comment">-- è·å–æ—¥æœŸéƒ¨åˆ†</span></span><br><span class="line"><span class="type">time</span>(<span class="string">'yyyy-mm-dd hh:ii:ss'</span>);    <span class="comment">-- è·å–æ—¶é—´éƒ¨åˆ†</span></span><br><span class="line">date_format(<span class="string">'yyyy-mm-dd hh:ii:ss'</span>, <span class="string">'%d %y %a %d %m %b %j'</span>);    <span class="comment">-- æ ¼å¼åŒ–æ—¶é—´</span></span><br><span class="line">unix_timestamp();                <span class="comment">-- è·å¾—unixæ—¶é—´æˆ³</span></span><br><span class="line">from_unixtime();                <span class="comment">-- ä»æ—¶é—´æˆ³è·å¾—æ—¶é—´</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">-- å­—ç¬¦ä¸²å‡½æ•°</span></span><br><span class="line">length(string)            <span class="comment">-- stringé•¿åº¦ï¼Œå­—èŠ‚</span></span><br><span class="line"><span class="keyword">char_length</span>(string)        <span class="comment">-- stringçš„å­—ç¬¦ä¸ªæ•°</span></span><br><span class="line"><span class="built_in">substring</span>(str, position [,length])        <span class="comment">-- ä»strçš„positionå¼€å§‹,å–lengthä¸ªå­—ç¬¦</span></span><br><span class="line">replace(str ,search_str ,replace_str)    <span class="comment">-- åœ¨strä¸­ç”¨replace_stræ›¿æ¢search_str</span></span><br><span class="line">instr(string ,substring)    <span class="comment">-- è¿”å›substringé¦–æ¬¡åœ¨stringä¸­å‡ºç°çš„ä½ç½®</span></span><br><span class="line">concat(string [,...])    <span class="comment">-- è¿æ¥å­—ä¸²</span></span><br><span class="line">charset(str)            <span class="comment">-- è¿”å›å­—ä¸²å­—ç¬¦é›†</span></span><br><span class="line">lcase(string)            <span class="comment">-- è½¬æ¢æˆå°å†™</span></span><br><span class="line"><span class="keyword">left</span>(string, length)    <span class="comment">-- ä»string2ä¸­çš„å·¦è¾¹èµ·å–lengthä¸ªå­—ç¬¦</span></span><br><span class="line">load_file(file_name)    <span class="comment">-- ä»æ–‡ä»¶è¯»å–å†…å®¹</span></span><br><span class="line">locate(substring, string [,start_position])    <span class="comment">-- åŒinstr,ä½†å¯æŒ‡å®šå¼€å§‹ä½ç½®</span></span><br><span class="line">lpad(string, length, pad)    <span class="comment">-- é‡å¤ç”¨padåŠ åœ¨stringå¼€å¤´,ç›´åˆ°å­—ä¸²é•¿åº¦ä¸ºlength</span></span><br><span class="line">ltrim(string)            <span class="comment">-- å»é™¤å‰ç«¯ç©ºæ ¼</span></span><br><span class="line">repeat(string, count)    <span class="comment">-- é‡å¤countæ¬¡</span></span><br><span class="line">rpad(string, length, pad)    <span class="comment">--åœ¨stråç”¨padè¡¥å……,ç›´åˆ°é•¿åº¦ä¸ºlength</span></span><br><span class="line">rtrim(string)            <span class="comment">-- å»é™¤åç«¯ç©ºæ ¼</span></span><br><span class="line">strcmp(string1 ,string2)    <span class="comment">-- é€å­—ç¬¦æ¯”è¾ƒä¸¤å­—ä¸²å¤§å°</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">-- èšåˆå‡½æ•°</span></span><br><span class="line"><span class="built_in">count</span>()</span><br><span class="line"><span class="built_in">sum</span>();</span><br><span class="line"><span class="built_in">max</span>();</span><br><span class="line"><span class="built_in">min</span>();</span><br><span class="line"><span class="built_in">avg</span>();</span><br><span class="line">group_concat()</span><br><span class="line"> </span><br><span class="line"><span class="comment">-- å…¶ä»–å¸¸ç”¨å‡½æ•°</span></span><br><span class="line">md5();</span><br><span class="line"><span class="keyword">default</span>();</span><br></pre></td></tr></tbody></table></figure>
<h2 id="å…«ã€äº‹åŠ¡ï¼ˆtransactionï¼‰"><a href="#å…«ã€äº‹åŠ¡ï¼ˆtransactionï¼‰" class="headerlink" title="å…«ã€äº‹åŠ¡ï¼ˆtransactionï¼‰"></a>å…«ã€äº‹åŠ¡ï¼ˆtransactionï¼‰</h2><h4 id="1ã€ACID-åŸåˆ™"><a href="#1ã€ACID-åŸåˆ™" class="headerlink" title="1ã€ACID åŸåˆ™"></a>1ã€ACID åŸåˆ™</h4><p><strong>åŸå­æ€§ï¼ˆAtomicityï¼‰</strong></p>
<p>åŸå­æ€§æ˜¯æŒ‡äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿï¼Œè¦ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚</p>
<p><strong>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰</strong></p>
<p>ä¸€è‡´æ€§æ˜¯æŒ‡äº‹åŠ¡å‰åæ•°æ®çš„å®Œæ•´æ€§å¿…é¡»ä¿æŒä¸€è‡´ã€‚</p>
<p><strong>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</strong></p>
<p>äº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œæ•°æ®åº“ä¸ºæ¯ä¸€ä¸ªç”¨æˆ·å¼€å¯çš„äº‹åŠ¡ï¼Œä¸èƒ½è¢«å…¶ä»–äº‹ç‰©çš„æ“ä½œæ•°æ®æ‰€å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹ç‰©ä¹‹é—´è¦ç›¸äº’éš”ç¦»ã€‚</p>
<p><strong>æŒä¹…æ€§ï¼ˆDurabilityï¼‰</strong></p>
<p>æŒä¹…æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹ç‰©ä¸€æ—¦è¢«æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œæ¥ä¸‹æ¥å³ä½¿æ•°æ®åº“å‘ç”Ÿæ•…éšœä¹Ÿä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“ã€‚</p>
<p>æ¥ä¸‹æ¥ä¸¾ä¾‹è¿›è¡Œè¯´æ˜ã€‚</p>
<p><strong><font size="5px">åŸå­æ€§</font></strong></p>
<p>é’ˆå¯¹åŒä¸€ä¸ªäº‹åŠ¡</p>
<p><img src="https://z3.ax1x.com/2021/11/19/IbK26I.png" alt=""></p>
<p>åœ¨ä¸ªè¿‡ç¨‹åŒ…å«ä¸¤ä¸ªæ­¥éª¤</p>
<p>Aï¼š800 - 200 = 600</p>
<p>Bï¼š200 + 200 = 400</p>
<p>åŸå­æ€§è¡¨ç¤ºï¼Œè¿™ä¸¤ä¸ªæ­¥éª¤è¦ä¹ˆä¸€èµ·æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·å¤±è´¥ï¼Œä¸å¯èƒ½ A çš„é’±æ‰£æ‰äº†ï¼Œè€Œ B å´æ²¡æœ‰æ”¶åˆ°é’±ã€‚</p>
<p><strong><font size="5px">ä¸€è‡´æ€§</font></strong></p>
<p>é’ˆå¯¹ä¸€ä¸ªäº‹ç‰©æ“ä½œå‰ä¸æ“ä½œåçš„çŠ¶æ€ä¸€è‡´</p>
<p><img src="https://z3.ax1x.com/2021/11/19/IbK26I.png" alt=""></p>
<p>æ“ä½œå‰Aï¼š800ï¼ŒBï¼š200<br>æ“ä½œåAï¼š600ï¼ŒBï¼š400</p>
<p>ä¸€è‡´æ€§è¡¨ç¤ºäº‹åŠ¡å®Œæˆåï¼Œç¬¦åˆé€»è¾‘è¿ç®—ï¼ˆA + B = 1000ï¼‰</p>
<p><strong><font size="5px">æŒä¹…æ€§</font></strong></p>
<p>è¡¨ç¤ºäº‹åŠ¡ç»“æŸåçš„æ•°æ®ä¸éšç€å¤–ç•ŒåŸå› å¯¼è‡´æ•°æ®ä¸¢å¤±</p>
<p>æ“ä½œå‰Aï¼š800ï¼ŒBï¼š200<br>æ“ä½œåAï¼š600ï¼ŒBï¼š400<br>å¦‚æœåœ¨æ“ä½œå‰ï¼ˆäº‹åŠ¡è¿˜æ²¡æœ‰æäº¤ï¼‰æœåŠ¡å™¨å®•æœºæˆ–è€…æ–­ç”µï¼Œé‚£ä¹ˆé‡å¯æ•°æ®åº“ä»¥åï¼Œæ•°æ®çŠ¶æ€åº”è¯¥ä¸º<br>Aï¼š800ï¼ŒBï¼š200<br>å¦‚æœåœ¨æ“ä½œåï¼ˆäº‹åŠ¡å·²ç»æäº¤ï¼‰æœåŠ¡å™¨å®•æœºæˆ–è€…æ–­ç”µï¼Œé‚£ä¹ˆé‡å¯æ•°æ®åº“ä»¥åï¼Œæ•°æ®çŠ¶æ€åº”è¯¥ä¸º<br>Aï¼š600ï¼ŒBï¼š400</p>
<p><strong><font size="5px">éš”ç¦»æ€§</font></strong></p>
<p>é’ˆå¯¹å¤šä¸ªç”¨æˆ·åŒæ—¶æ“ä½œï¼Œä¸»è¦æ˜¯æ’é™¤å…¶ä»–äº‹åŠ¡å¯¹æœ¬æ¬¡äº‹åŠ¡çš„å½±å“</p>
<p><img src="https://z3.ax1x.com/2021/11/19/IbMIDx.png" alt=""></p>
<p>äº‹åŠ¡ä¸€ï¼‰Cå‘Bè½¬è´¦100<br>äº‹åŠ¡äºŒï¼‰Aå‘Bè½¬è´¦200</p>
<p>ä¸¤ä¸ªäº‹åŠ¡åŒæ—¶è¿›è¡Œï¼Œå…¶ä¸­ä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°å¦å¤–ä¸€ä¸ªäº‹åŠ¡è¿˜æ²¡æœ‰æäº¤çš„æ•°æ®ã€‚</p>
<p>ä¾‹å¦‚ C å…ˆç»™ B è½¬100å…ƒï¼Œåœ¨äº‹åŠ¡è¿˜æ²¡æœ‰æäº¤ä¹‹å‰ï¼ŒA ç»™ B è½¬äº†200å…ƒï¼Œè€Œæ­¤æ—¶æ•°æ®åº“ä¸­ B çš„é‡‘é¢ä»ç„¶æ˜¯ 200 å…ƒã€‚å¾… C ç»™ B çš„äº‹åŠ¡å®Œæˆåï¼ŒA ä¹Ÿå®Œæˆäº†ä»–çš„äº‹åŠ¡ï¼Œæ­¤æ—¶æ•°æ®åº“ä¸­ B çš„é‡‘é¢å°†ä¼šæ˜¯åæ‰‹äº‹åŠ¡äºŒæäº¤çš„ï¼Œä¹Ÿå°±æ˜¯200 + 200 = 400ï¼Œç›´æ¥å°‘äº†100å…ƒã€‚</p>
<p>éš”ç¦»æ€§ç”¨äºè§£å†³ä»¥ä¸Šé—®é¢˜ã€‚</p>
<h4 id="2ã€éš”ç¦»çº§åˆ«"><a href="#2ã€éš”ç¦»çº§åˆ«" class="headerlink" title="2ã€éš”ç¦»çº§åˆ«"></a>2ã€éš”ç¦»çº§åˆ«</h4><p><strong><font size="5px">è„è¯»ï¼š</font></strong></p>
<p>æŒ‡ä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®ã€‚ï¼ˆå…·ä½“æŸ¥çœ‹ä¸Šé¢çš„éš”ç¦»æ€§ï¼‰</p>
<p><img src="https://z3.ax1x.com/2021/11/19/IbMIDx.png" alt=""></p>
<p><strong><font size="5px">ä¸å¯é‡å¤è¯»ï¼š</font></strong></p>
<p>åœ¨ä¸€ä¸ªäº‹åŠ¡å†…è¯»å–è¡¨ä¸­çš„æŸä¸€è¡Œæ•°æ®ï¼Œå¤šæ¬¡è¯»å–ç»“æœä¸åŒã€‚ï¼ˆè¿™ä¸ªä¸ä¸€å®šæ˜¯é”™è¯¯ï¼Œåªæ˜¯æŸäº›åœºåˆä¸å¯¹ï¼‰</p>
<p>é¡µé¢ç»Ÿè®¡æŸ¥è¯¢å€¼</p>
<p><img src="https://z3.ax1x.com/2021/11/19/IblstU.png" alt=""></p>
<p>ç”ŸæˆæŠ¥è¡¨æ—¶ï¼Œæœ‰äººåˆè½¬ç»™ B 300 å…ƒ</p>
<p><img src="https://z3.ax1x.com/2021/11/19/IblstU.png" alt=""></p>
<p><strong><font size="5px">è™šè¯»ï¼š</font></strong></p>
<p>æ˜¯æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡å†…è¯»å–åˆ°äº†åˆ«çš„äº‹åŠ¡æ’å…¥çš„æ•°æ®ï¼Œå¯¼è‡´å‰åè¯»å–æ•°é‡æ€»é‡ä¸ä¸€è‡´ã€‚<br>ï¼ˆä¸€èˆ¬æ˜¯è¡Œå½±å“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå¤šäº†ä¸€è¡Œï¼‰</p>
<p><img src="https://z3.ax1x.com/2021/11/19/Ib1KCF.png" alt=""></p>
<p><strong><font size="5px">å››ç§éš”ç¦»çº§åˆ«è®¾ç½®</font></strong></p>
<p><strong>æ•°æ®åº“</strong></p>
<p>set transaction isolation level è®¾ç½®äº‹åŠ¡éš”ç¦»çº§åˆ«<br>select @@tx_isolation æŸ¥è¯¢å½“å‰äº‹åŠ¡éš”ç¦»çº§åˆ«</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>è®¾ç½®</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>Serializable</td>
<td>å¯é¿å…è„è¯»ã€ä¸å¯é‡å¤è¯»ã€è™šè¯»çš„å‘ç”Ÿã€‚ï¼ˆä¸²è¡ŒåŒ–ï¼‰</td>
</tr>
<tr>
<td>Repeatable read</td>
<td>å¯é¿å…è„è¯»ã€ä¸å¯é‡å¤è¯»æƒ…å†µçš„å‘ç”Ÿã€‚ï¼ˆå¯é‡å¤è¯»ï¼‰</td>
</tr>
<tr>
<td>Repeatable read</td>
<td>å¯é¿å…è„è¯»æƒ…å†µå‘ç”Ÿã€‚ï¼ˆè¯»å·²æäº¤ï¼‰</td>
</tr>
<tr>
<td>Read uncommitted</td>
<td>æœ€ä½çº§åˆ«ï¼Œä»¥ä¸Šæƒ…å†µå‡æ— æ³•ä¿è¯ã€‚(è¯»æœªæäº¤)</td>
</tr>
</tbody>
</table>
</div>
<p><strong>java</strong></p>
<p>é€‚å½“çš„ Connection æ–¹æ³•ï¼Œæ¯”å¦‚ setAutoCommit æˆ– setTransactionIsolation</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>è®¾ç½®</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>TRANSACTION_SERIALIZABLE</td>
<td>æŒ‡ç¤ºä¸å¯ä»¥å‘ç”Ÿè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œè™šè¯»çš„å¸¸é‡ã€‚</td>
</tr>
<tr>
<td>TRANSACTION_REPEATABLE_READ</td>
<td>æŒ‡ç¤ºä¸å¯ä»¥å‘ç”Ÿè„è¯»å’Œä¸å¯é‡å¤è¯»çš„å¸¸é‡ï¼›è™šè¯»å¯ä»¥å‘ç”Ÿã€‚</td>
</tr>
<tr>
<td>TRANSACTION_READ_UNCOMMITTED</td>
<td>æŒ‡ç¤ºå¯ä»¥å‘ç”Ÿè„è¯» (dirty read)ã€ä¸å¯é‡å¤è¯»å’Œè™šè¯» (phantom read) çš„å¸¸é‡ã€‚</td>
</tr>
<tr>
<td>TRANSACTION_READ_COMMITTED</td>
<td>æŒ‡ç¤ºä¸å¯ä»¥å‘ç”Ÿè„è¯»çš„å¸¸é‡ï¼›ä¸å¯é‡å¤è¯»å’Œè™šè¯»å¯ä»¥å‘ç”Ÿã€‚</td>
</tr>
</tbody>
</table>
</div>
<h4 id="3ã€åŸºæœ¬è¯­æ³•"><a href="#3ã€åŸºæœ¬è¯­æ³•" class="headerlink" title="3ã€åŸºæœ¬è¯­æ³•"></a>3ã€åŸºæœ¬è¯­æ³•</h4><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- ä½¿ç”¨setè¯­å¥æ¥æ”¹å˜äº‹åŠ¡è‡ªåŠ¨æäº¤</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">0</span> <span class="comment">-- å…³é—­äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">1</span> <span class="comment">-- å¼€å¯äº‹åŠ¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ³¨æ„ï¼š</span></span><br><span class="line"><span class="comment">-- 1. MySQLä¸­é»˜è®¤æ˜¯è‡ªåŠ¨æäº¤</span></span><br><span class="line"><span class="comment">-- 2. ä½¿ç”¨äº‹åŠ¡æ—¶åº”å…ˆå…³é—­è‡ªåŠ¨æäº¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œæ ‡è®°äº‹åŠ¡çš„èµ·å§‹ç‚¹</span></span><br><span class="line"><span class="keyword">START</span> TRANSACTION</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æäº¤äº‹åŠ¡åˆ°æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">COMMIT</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å°†äº‹åŠ¡å›æ»šï¼Œæ•°æ®å›åˆ°æœ¬æ¬¡äº‹åŠ¡çš„åˆå§‹çŠ¶æ€</span></span><br><span class="line"><span class="keyword">ROLLBACK</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- è¿˜åŸMySQLæ•°æ®åº“çš„è‡ªåŠ¨æäº¤</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿å­˜ç‚¹</span></span><br><span class="line"><span class="keyword">SAVEPOINT</span> pointname <span class="comment">-- è®¾ç½®ä¸€ä¸ªäº‹åŠ¡ä¿å­˜ç‚¹</span></span><br><span class="line"><span class="keyword">ROLLBACK</span> <span class="keyword">TO</span> <span class="keyword">SAVEPOINT</span> pointname <span class="comment">-- å›æ»šåˆ°ä¿å­˜ç‚¹</span></span><br><span class="line"><span class="keyword">RELEASE</span> <span class="keyword">SAVEPOINT</span> pointname <span class="comment">-- åˆ é™¤ä¿å­˜ç‚¹</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="4ã€æµ‹è¯•"><a href="#4ã€æµ‹è¯•" class="headerlink" title="4ã€æµ‹è¯•"></a>4ã€æµ‹è¯•</h4><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æµ‹è¯•é¢˜ç›®</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Aåœ¨çº¿è´­ä¹°ä¸€æ¬¾ä»·æ ¼ä¸º500å…ƒå•†å“ï¼Œç½‘ä¸Šé“¶è¡Œè½¬è´¦</span></span><br><span class="line"><span class="comment">Açš„é“¶è¡Œå¡ä½™é¢ä¸º2000å…ƒï¼Œç„¶åæ”¯ä»˜ç»™Bå•†å®¶500å…ƒ</span></span><br><span class="line"><span class="comment">å•†å®¶Bä¸€å¼€å§‹çš„é“¶è¡Œå¡ä½™é¢ä¸º10000</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ›å»ºæ•°æ®åº“shopå’Œåˆ›å»ºè¡¨accountå¹¶æ’å…¥2æ¡æ•°æ®</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE shop <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci;</span><br><span class="line">USE shop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> account(</span><br><span class="line">id <span class="type">INT</span>(<span class="number">11</span>) AUTO_INCREMENT,</span><br><span class="line">`name` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">cash <span class="type">DECIMAL</span>(<span class="number">9</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY(id)</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET <span class="operator">=</span> utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> account(`name`, cash) <span class="keyword">VALUES</span>(<span class="string">'A'</span>, <span class="number">2000</span>),(<span class="string">'B'</span>, <span class="number">10000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å…³é—­è‡ªåŠ¨æäº¤äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¼€å§‹äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- äº‹åŠ¡</span></span><br><span class="line">UPDATE account <span class="keyword">SET</span> cash <span class="operator">=</span> cash <span class="operator">-</span> <span class="number">500</span> <span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">'A'</span>;  <span class="comment">-- Aæ”¯ä»˜ç»™B 500å…ƒ</span></span><br><span class="line">UPDATE account <span class="keyword">SET</span> cash <span class="operator">=</span> cash <span class="operator">+</span> <span class="number">500</span> <span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">'B'</span>;  <span class="comment">-- Bæ”¶åˆ°Açš„ 500å…ƒ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æäº¤äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- äº‹åŠ¡å›æ»š(äº‹åŠ¡æäº¤å¤±è´¥æ—¶æ‰§è¡Œï¼ŒæˆåŠŸåˆ™ä¸ä¼šå‘ç”Ÿå›æ»š)</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¼€å¯è‡ªåŠ¨æäº¤äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></tbody></table></figure>
<h2 id="ä¹ã€ç´¢å¼•"><a href="#ä¹ã€ç´¢å¼•" class="headerlink" title="ä¹ã€ç´¢å¼•"></a>ä¹ã€ç´¢å¼•</h2><h4 id="1ã€ä»‹ç»"><a href="#1ã€ä»‹ç»" class="headerlink" title="1ã€ä»‹ç»"></a>1ã€ä»‹ç»</h4><p>ä¸€èˆ¬çš„åº”ç”¨ç³»ç»Ÿï¼Œè¯»å†™æ¯”ä¾‹åœ¨10:1å·¦å³ï¼Œè€Œä¸”æ’å…¥æ“ä½œå’Œä¸€èˆ¬çš„æ›´æ–°æ“ä½œå¾ˆå°‘å‡ºç°æ€§èƒ½é—®é¢˜ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬é‡åˆ°æœ€å¤šçš„ï¼Œä¹Ÿæ˜¯æœ€å®¹æ˜“å‡ºé—®é¢˜çš„ï¼Œè¿˜æ˜¯ä¸€äº›å¤æ‚çš„æŸ¥è¯¢æ“ä½œï¼Œå› æ­¤å¯¹æŸ¥è¯¢è¯­å¥çš„ä¼˜åŒ–æ˜¾ç„¶æ˜¯é‡ä¸­ä¹‹é‡ã€‚è¯´èµ·åŠ é€ŸæŸ¥è¯¢ï¼Œå°±ä¸å¾—ä¸æåˆ°ç´¢å¼•äº†ã€‚</p>
<p>ç´¢å¼•åœ¨MySQLä¸­ä¹Ÿå«åšâ€œé”®â€ï¼Œæ˜¯å­˜å‚¨å¼•æ“ç”¨äºå¿«é€Ÿæ‰¾åˆ°è®°å½•çš„ä¸€ç§æ•°æ®ç»“æ„ã€‚ç´¢å¼•å¯¹äºè‰¯å¥½çš„æ€§èƒ½éå¸¸å…³é”®ï¼Œå°¤å…¶æ˜¯å½“è¡¨ä¸­çš„æ•°æ®é‡è¶Šæ¥è¶Šå¤§æ—¶ï¼Œç´¢å¼•å¯¹äºæ€§èƒ½çš„å½±å“æ„ˆå‘é‡è¦ã€‚<br>ç´¢å¼•ä¼˜åŒ–åº”è¯¥æ˜¯å¯¹æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–æœ€æœ‰æ•ˆçš„æ‰‹æ®µäº†ã€‚ç´¢å¼•èƒ½å¤Ÿè½»æ˜“å°†æŸ¥è¯¢æ€§èƒ½æé«˜å¥½å‡ ä¸ªæ•°é‡çº§ã€‚</p>
<p>ç´¢å¼•ç›¸å½“äºå­—å…¸çš„éŸ³åºè¡¨ï¼Œå¦‚æœè¦æŸ¥æŸä¸ªå­—ï¼Œå¦‚æœä¸ä½¿ç”¨éŸ³åºè¡¨ï¼Œåˆ™éœ€è¦ä»å‡ ç™¾é¡µä¸­é€é¡µå»æŸ¥ã€‚</p>
<p><strong>ç´¢å¼•çš„ä½œç”¨</strong></p>
<ul>
<li>æé«˜æŸ¥è¯¢é€Ÿåº¦</li>
<li>ç¡®ä¿æ•°æ®çš„å”¯ä¸€æ€§</li>
<li>å¯ä»¥åŠ é€Ÿè¡¨å’Œè¡¨ä¹‹é—´çš„è¿æ¥ , å®ç°è¡¨ä¸è¡¨ä¹‹é—´çš„å‚ç…§å®Œæ•´æ€§</li>
<li>ä½¿ç”¨åˆ†ç»„å’Œæ’åºå­å¥è¿›è¡Œæ•°æ®æ£€ç´¢æ—¶ , å¯ä»¥æ˜¾è‘—å‡å°‘åˆ†ç»„å’Œæ’åºçš„æ—¶é—´</li>
<li>å…¨æ–‡æ£€ç´¢å­—æ®µè¿›è¡Œæœç´¢ä¼˜åŒ–.</li>
</ul>
<p><strong>åˆ†ç±»</strong></p>
<ul>
<li>ä¸»é”®ç´¢å¼• (Primary Key)</li>
<li>å”¯ä¸€ç´¢å¼• (Unique)</li>
<li>å¸¸è§„ç´¢å¼• (Index)</li>
<li>å…¨æ–‡ç´¢å¼• (FullText)</li>
</ul>
<h4 id="2ã€å„ç´¢å¼•åŒºåˆ«"><a href="#2ã€å„ç´¢å¼•åŒºåˆ«" class="headerlink" title="2ã€å„ç´¢å¼•åŒºåˆ«"></a>2ã€å„ç´¢å¼•åŒºåˆ«</h4><p><strong>ä¸»é”®ç´¢å¼•</strong></p>
<ul>
<li>æœ€å¸¸è§çš„ç´¢å¼•ç±»å‹</li>
<li>ç¡®ä¿æ•°æ®è®°å½•çš„å”¯ä¸€æ€§</li>
<li>ç¡®å®šç‰¹å®šæ•°æ®è®°å½•åœ¨æ•°æ®åº“ä¸­çš„ä½ç½®</li>
<li>ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ç´¢å¼•</li>
</ul>
<p><strong><code>ä¸å”¯ä¸€çš„</code>å”¯ä¸€ç´¢å¼•</strong></p>
<ul>
<li>é¿å…åŒä¸€ä¸ªè¡¨ä¸­æŸæ•°æ®åˆ—çš„å€¼é‡å¤</li>
<li>ä¸€å¼ è¡¨å¯ä»¥æœ‰å¤šä¸ªå”¯ä¸€ç´¢å¼•</li>
</ul>
<p><strong>å¸¸è§„ç´¢å¼•</strong></p>
<ul>
<li>å¿«é€Ÿå®šä½ç‰¹å®šæ•°æ®</li>
<li>index å’Œ key å…³é”®å­—éƒ½å¯ä»¥è®¾ç½®å¸¸è§„ç´¢å¼•</li>
<li>åº”åŠ åœ¨éœ€è¦æŸ¥è¯¢çš„å­—æ®µ</li>
<li>ä¸å®œæ·»åŠ å¤ªå¤šå¸¸è§„ç´¢å¼•ï¼Œä¼šå½±å“æ•°æ®å¢åˆ æ”¹çš„æ•ˆç‡ï¼Œå› ä¸ºæ›´æ–°è¡¨æ—¶ï¼ŒMySQLä¸ä»…è¦ä¿å­˜æ•°æ®ï¼Œè¿˜è¦ä¿å­˜ä¸€ä¸‹ç´¢å¼•æ–‡ä»¶ã€‚</li>
</ul>
<p><strong>å…¨æ–‡ç´¢å¼•</strong></p>
<ul>
<li><p>ç™¾åº¦æœç´¢</p>
</li>
<li><p>å¿«é€Ÿå®šä½ç‰¹å®šæ•°æ®</p>
</li>
<li>åªèƒ½ç”¨äº MyISAM ç±»å‹çš„æ•°æ®è¡¨ï¼ˆINNODB åœ¨ MySQL 5.6 ä¹‹åä¹Ÿæ”¯æŒå…¨æ–‡ç´¢å¼•)</li>
<li>åªèƒ½ç”¨äº CHARï¼ŒVARCHARï¼ŒTEXT ç­‰æ–‡æœ¬ç±»å‹æ•°æ®</li>
<li>é€‚åˆå¤§å‹æ•°æ®é›†</li>
</ul>
<div class="note success">
            <p>å»ºç«‹ç´¢å¼•ä¼šå ç”¨ç£ç›˜ç©ºé—´çš„ç´¢å¼•æ–‡ä»¶ã€‚</p>
          </div>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- æ–¹æ³•ä¸€ï¼šå»ºè¡¨æ—¶</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> è¡¨å (</span><br><span class="line">    å­—æ®µå<span class="number">1</span> æ•°æ®ç±»å‹ [å®Œæ•´æ€§çº¦æŸæ¡ä»¶â€¦],</span><br><span class="line">    å­—æ®µå<span class="number">2</span> æ•°æ®ç±»å‹ [å®Œæ•´æ€§çº¦æŸæ¡ä»¶â€¦],</span><br><span class="line">    [<span class="keyword">UNIQUE</span> <span class="operator">|</span> FULLTEXT <span class="operator">|</span> SPATIAL ]   INDEX <span class="operator">|</span> KEY</span><br><span class="line">    [ç´¢å¼•å] (å­—æ®µå[(é•¿åº¦)] [<span class="keyword">ASC</span> <span class="operator">|</span><span class="keyword">DESC</span>])</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ–¹æ³•äºŒï¼šå»ºè¡¨ååˆ›å»ºç´¢å¼•</span></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">UNIQUE</span> <span class="operator">|</span> FULLTEXT <span class="operator">|</span> SPATIAL ] INDEX ç´¢å¼•å <span class="keyword">ON</span> è¡¨å (å­—æ®µå[(é•¿åº¦)] [<span class="keyword">ASC</span> <span class="operator">|</span><span class="keyword">DESC</span>]) ;</span><br><span class="line">                    </span><br><span class="line"><span class="comment">-- æ–¹æ³•ä¸‰ï¼šå»ºè¡¨åä¿®æ”¹ç´¢å¼•</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">ADD</span> [<span class="keyword">UNIQUE</span> <span class="operator">|</span> FULLTEXT <span class="operator">|</span> SPATIAL ] INDEX ç´¢å¼•å (å­—æ®µå[(é•¿åº¦)] [<span class="keyword">ASC</span> <span class="operator">|</span><span class="keyword">DESC</span>]) ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤ç´¢å¼•</span></span><br><span class="line"><span class="keyword">DROP</span> INDEX ç´¢å¼•å <span class="keyword">ON</span> è¡¨åå­—;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤ä¸»é”®ç´¢å¼•</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> è¡¨å <span class="keyword">DROP</span> <span class="keyword">PRIMARY</span> KEY;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºç´¢å¼•ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">SHOW</span> INDEX <span class="keyword">FROM</span> è¡¨å</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ†æSQLè¯­å¥æ‰§è¡Œæ€§èƒ½</span></span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> studentno<span class="operator">=</span><span class="string">'1000'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä½¿ç”¨å…¨æ–‡ç´¢å¼•</span></span><br><span class="line"><span class="comment">-- å…¨æ–‡ç´¢å¼•é€šè¿‡MATCH()å‡½æ•°å®Œæˆ</span></span><br><span class="line"><span class="comment">-- æœç´¢å­—ç¬¦ä¸²ä½œä¸ºAGAINST()çš„å‚æ•°è¢«ç»™å®šã€‚</span></span><br><span class="line"><span class="comment">-- æœç´¢ä»¥å¿½ç•¥å­—æ¯å¤§å°å†™çš„æ–¹å¼æ‰§è¡Œã€‚</span></span><br><span class="line"><span class="comment">-- å¯¹äºè¡¨ä¸­çš„æ¯ä¸ªè®°å½•è¡Œï¼ŒMATHCH()ä¼šè¿”å›ä¸€ä¸ªç›¸å…³æ€§å€¼ã€‚å³åœ¨æœç´¢å­—ç¬¦ä¸²ä¸MATCH()å‚æ•°åˆ—è¡¨ä¸­æŒ‡å®šçš„åˆ—çš„æ–‡æœ¬ä¹‹é—´çš„ç›¸ä¼¼æ€§å°ºåº¦ã€‚</span></span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> studentno<span class="operator">=</span><span class="string">'1000'</span>;</span><br></pre></td></tr></tbody></table></figure>
<h4 id="3ã€æµ‹è¯•å„ç´¢å¼•æ€§èƒ½"><a href="#3ã€æµ‹è¯•å„ç´¢å¼•æ€§èƒ½" class="headerlink" title="3ã€æµ‹è¯•å„ç´¢å¼•æ€§èƒ½"></a>3ã€æµ‹è¯•å„ç´¢å¼•æ€§èƒ½</h4><p>å»ºç«‹æµ‹è¯•è¡¨</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `app_user` (</span><br><span class="line">`id` <span class="type">BIGINT</span>(<span class="number">20</span>) UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">`name` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="string">''</span> COMMENT <span class="string">'ç”¨æˆ·æ˜µç§°'</span>,</span><br><span class="line">`email` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'ç”¨æˆ·é‚®ç®±'</span>,</span><br><span class="line">`phone` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="string">''</span> COMMENT <span class="string">'æ‰‹æœºå·'</span>,</span><br><span class="line">`gender` TINYINT(<span class="number">4</span>) UNSIGNED <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">'æ€§åˆ«ï¼ˆ0:ç”·ï¼›1ï¼šå¥³ï¼‰'</span>,</span><br><span class="line">`password` <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'å¯†ç '</span>,</span><br><span class="line">`age` TINYINT(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">'å¹´é¾„'</span>,</span><br><span class="line">`create_time` DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">`update_time` <span class="type">TIMESTAMP</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> UPDATE <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 COMMENT<span class="operator">=</span><span class="string">'appç”¨æˆ·è¡¨'</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ’å…¥100W æµ‹è¯•æ•°æ®</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> IF <span class="keyword">EXISTS</span> mock_data;</span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> mock_data()</span><br><span class="line"><span class="keyword">RETURNS</span> <span class="type">INT</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">DECLARE</span> num <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1000000</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">WHILE i <span class="operator">&lt;</span> num DO</span><br><span class="line">  <span class="keyword">INSERT</span> <span class="keyword">INTO</span> app_user(`name`, `email`, `phone`, `gender`, `password`, `age`)</span><br><span class="line">   <span class="keyword">VALUES</span>(CONCAT(<span class="string">'ç”¨æˆ·'</span>, i), <span class="string">'24736743@qq.com'</span>, CONCAT(<span class="string">'18'</span>, <span class="built_in">FLOOR</span>(RAND()<span class="operator">*</span>(<span class="number">999999999</span><span class="number">-100000000</span>)<span class="operator">+</span><span class="number">100000000</span>)),<span class="built_in">FLOOR</span>(RAND()<span class="operator">*</span><span class="number">2</span>),UUID(), <span class="built_in">FLOOR</span>(RAND()<span class="operator">*</span><span class="number">100</span>));</span><br><span class="line">  <span class="keyword">SET</span> i <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span> WHILE;</span><br><span class="line"><span class="keyword">RETURN</span> i;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"><span class="keyword">SELECT</span> mock_data();</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•ç»“æœ</p>
<p>æ¯ä¸ªç´¢å¼•æ•ˆç‡éƒ½å·®ä¸å¤šï¼Œä¼šæ¯”æ²¡æœ‰ç´¢å¼•å¿«åå€ï¼Œåˆ›å»ºç´¢å¼•çš„æ—¶å€™ä¼šè€—ç‚¹æ—¶é—´ã€‚</p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- æ— ç´¢å¼•</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> app_user <span class="keyword">WHERE</span> NAME <span class="operator">=</span> <span class="string">'ç”¨æˆ·1000000'</span> <span class="comment">-- 4.564 sec</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> app_user <span class="keyword">WHERE</span> phone <span class="operator">=</span> <span class="string">'18586428336'</span> <span class="comment">-- 4.316 sec</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¸»é”®ç´¢å¼•</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> app_user <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2878891</span> <span class="comment">-- 0.392 sec</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å”¯ä¸€ç´¢å¼•</span></span><br><span class="line"><span class="comment">-- å…ˆæ·»åŠ å”¯ä¸€ç´¢å¼•ï¼Œå»ºç«‹ç´¢å¼•æ¯”è¾ƒè´¹æ—¶</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> app_user <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> INDEX uidx(`name`) <span class="comment">-- 23.014 sec</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> app_user <span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">'ç”¨æˆ·1234567'</span> <span class="comment">-- 0.341 sec</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¸¸è§„ç´¢å¼•</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> app_user <span class="keyword">ADD</span> INDEX idx(`phone`) <span class="comment">-- 24.027 sec</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> app_user <span class="keyword">WHERE</span> phone <span class="operator">=</span> <span class="string">'18586428336'</span> <span class="comment">-- 0.408 sec</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="4ã€å°ç»“-1"><a href="#4ã€å°ç»“-1" class="headerlink" title="4ã€å°ç»“"></a>4ã€å°ç»“</h4><p><strong>ç´¢å¼•å‡†åˆ™</strong></p>
<ul>
<li>ç´¢å¼•ä¸æ˜¯è¶Šå¤šè¶Šå¥½</li>
<li>ä¸è¦å¯¹ç»å¸¸å˜åŠ¨çš„æ•°æ®åŠ ç´¢å¼•</li>
<li>å°æ•°æ®é‡çš„è¡¨å»ºè®®ä¸è¦åŠ ç´¢å¼•</li>
<li>ç´¢å¼•ä¸€èˆ¬åº”åŠ åœ¨æŸ¥æ‰¾æ¡ä»¶çš„å­—æ®µ</li>
</ul>
<p><strong>ç´¢å¼•çš„æ•°æ®ç»“æ„</strong></p>
<p>æˆ‘ä»¬åœ¨åˆ›å»ºä¸Šè¿°ç´¢å¼•çš„æ—¶å€™ï¼Œå¯ä»¥ä¸ºå…¶æŒ‡å®šç´¢å¼•ç±»å‹</p>
<ul>
<li>hash ç±»å‹çš„ç´¢å¼•ï¼šæŸ¥è¯¢å•æ¡å¿«ï¼ŒèŒƒå›´æŸ¥è¯¢æ…¢</li>
<li>btree ç±»å‹çš„ç´¢å¼•ï¼šb+ æ•°ï¼Œå±‚æ•°è¶Šå¤šï¼Œæ•°æ®é‡å‘ˆæŒ‡æ•°çº§å¢é•¿ï¼ˆINNODB é»˜è®¤ï¼‰</li>
</ul>
<p>ä¸åŒçš„å­˜å‚¨å¼•æ“æ”¯æŒçš„ç´¢å¼•ç±»å‹ä¹Ÿä¸ä¸€æ ·</p>
<ul>
<li>INNODB æ”¯æŒäº‹åŠ¡ï¼Œæ”¯æŒè¡Œçº§åˆ«é”å®šï¼Œæ”¯æŒ B-treeã€Full-Text ç­‰ç´¢å¼•ï¼Œä¸æ”¯æŒ Hash ç´¢å¼•ã€‚</li>
<li>MyISAM ä¸æ”¯æŒäº‹åŠ¡ï¼Œæ”¯æŒè¡¨çº§åˆ«é”å®šï¼Œæ”¯æŒ B-treeã€Full-Textç­‰ç´¢å¼•ï¼Œä¸æ”¯æŒ Hash ç´¢å¼•ã€‚</li>
<li>Memory ä¸æ”¯æŒäº‹åŠ¡ï¼Œæ”¯æŒè¡¨çº§åˆ«é”å®šï¼Œæ”¯æŒB-treeã€Hash ç­‰ç´¢å¼•ï¼Œä¸æ”¯æŒ Full-Text ç´¢å¼•ã€‚</li>
<li>NDB æ”¯æŒäº‹åŠ¡ï¼Œæ”¯æŒè¡Œçº§åˆ«é”å®šï¼Œæ”¯æŒ Hash ç´¢å¼•ï¼Œä¸æ”¯æŒ B-treeã€Full-Text ç­‰ç´¢å¼•ã€‚</li>
<li>Archive ä¸æ”¯æŒäº‹åŠ¡ï¼Œæ”¯æŒè¡¨çº§åˆ«é”å®šï¼Œä¸æ”¯æŒ B-treeã€Hashã€Full-text ç­‰ç´¢å¼•ã€‚</li>
</ul>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html">CodingLabs - MySQLç´¢å¼•èƒŒåçš„æ•°æ®ç»“æ„åŠç®—æ³•åŸç†</a></p>
<h2 id="åã€æƒé™ç®¡ç†å’Œå¤‡ä»½"><a href="#åã€æƒé™ç®¡ç†å’Œå¤‡ä»½" class="headerlink" title="åã€æƒé™ç®¡ç†å’Œå¤‡ä»½"></a>åã€æƒé™ç®¡ç†å’Œå¤‡ä»½</h2><h4 id="1ã€æƒé™ç®¡ç†"><a href="#1ã€æƒé™ç®¡ç†" class="headerlink" title="1ã€æƒé™ç®¡ç†"></a>1ã€æƒé™ç®¡ç†</h4><figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/* ç”¨æˆ·å’Œæƒé™ç®¡ç† */</span></span><br><span class="line">ç”¨æˆ·ä¿¡æ¯è¡¨ï¼šmysql.user</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ·æ–°æƒé™</span></span><br><span class="line">FLUSH PRIVILEGES</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¢åŠ ç”¨æˆ· CREATE USER kuangshen IDENTIFIED BY '123456'</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> ç”¨æˆ·å IDENTIFIED <span class="keyword">BY</span> [PASSWORD] å¯†ç (å­—ç¬¦ä¸²)</span><br><span class="line">  <span class="operator">-</span> å¿…é¡»æ‹¥æœ‰mysqlæ•°æ®åº“çš„å…¨å±€<span class="keyword">CREATE</span> <span class="keyword">USER</span>æƒé™ï¼Œæˆ–æ‹¥æœ‰<span class="keyword">INSERT</span>æƒé™ã€‚</span><br><span class="line">  <span class="operator">-</span> åªèƒ½åˆ›å»ºç”¨æˆ·ï¼Œä¸èƒ½èµ‹äºˆæƒé™ã€‚</span><br><span class="line">  <span class="operator">-</span> ç”¨æˆ·åï¼Œæ³¨æ„å¼•å·ï¼šå¦‚ <span class="string">'user_name'</span>@<span class="string">'192.168.1.1'</span></span><br><span class="line">  <span class="operator">-</span> å¯†ç ä¹Ÿéœ€å¼•å·ï¼Œçº¯æ•°å­—å¯†ç ä¹Ÿè¦åŠ å¼•å·</span><br><span class="line">  <span class="operator">-</span> è¦åœ¨çº¯æ–‡æœ¬ä¸­æŒ‡å®šå¯†ç ï¼Œéœ€å¿½ç•¥PASSWORDå…³é”®è¯ã€‚è¦æŠŠå¯†ç æŒ‡å®šä¸ºç”±PASSWORD()å‡½æ•°è¿”å›çš„æ··ç¼–å€¼ï¼Œéœ€åŒ…å«å…³é”®å­—PASSWORD</span><br><span class="line"></span><br><span class="line"><span class="comment">-- é‡å‘½åç”¨æˆ· RENAME USER kuangshen TO kuangshen2</span></span><br><span class="line">RENAME <span class="keyword">USER</span> old_user <span class="keyword">TO</span> new_user</span><br><span class="line"></span><br><span class="line"><span class="comment">-- è®¾ç½®å¯†ç </span></span><br><span class="line"><span class="keyword">SET</span> PASSWORD <span class="operator">=</span> PASSWORD(<span class="string">'å¯†ç '</span>)    <span class="comment">-- ä¸ºå½“å‰ç”¨æˆ·è®¾ç½®å¯†ç </span></span><br><span class="line"><span class="keyword">SET</span> PASSWORD <span class="keyword">FOR</span> ç”¨æˆ·å <span class="operator">=</span> PASSWORD(<span class="string">'å¯†ç '</span>)    <span class="comment">-- ä¸ºæŒ‡å®šç”¨æˆ·è®¾ç½®å¯†ç </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤ç”¨æˆ· DROP USER kuangshen2</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> ç”¨æˆ·å</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ†é…æƒé™/æ·»åŠ ç”¨æˆ·</span></span><br><span class="line"><span class="keyword">GRANT</span> æƒé™åˆ—è¡¨ <span class="keyword">ON</span> è¡¨å <span class="keyword">TO</span> ç”¨æˆ·å [IDENTIFIED <span class="keyword">BY</span> [PASSWORD] <span class="string">'password'</span>]</span><br><span class="line">  <span class="operator">-</span> <span class="keyword">all</span> privileges è¡¨ç¤ºæ‰€æœ‰æƒé™</span><br><span class="line">  <span class="operator">-</span> <span class="operator">*</span>.<span class="operator">*</span> è¡¨ç¤ºæ‰€æœ‰åº“çš„æ‰€æœ‰è¡¨</span><br><span class="line">  <span class="operator">-</span> åº“å.è¡¨å è¡¨ç¤ºæŸåº“ä¸‹é¢çš„æŸè¡¨</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥çœ‹æƒé™   SHOW GRANTS FOR root@localhost;</span></span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> ç”¨æˆ·å</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥çœ‹å½“å‰ç”¨æˆ·æƒé™</span></span><br><span class="line"><span class="keyword">SHOW</span> GRANTS; </span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="built_in">CURRENT_USER</span>;</span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> <span class="built_in">CURRENT_USER</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’¤æ¶ˆæƒé™</span></span><br><span class="line"><span class="keyword">REVOKE</span> æƒé™åˆ—è¡¨ <span class="keyword">ON</span> è¡¨å <span class="keyword">FROM</span> ç”¨æˆ·å</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">ALL</span> PRIVILEGES, <span class="keyword">GRANT</span> OPTION <span class="keyword">FROM</span> ç”¨æˆ·å    <span class="comment">-- æ’¤é”€æ‰€æœ‰æƒé™</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>æƒé™è§£é‡Š</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- æƒé™åˆ—è¡¨</span></span><br><span class="line"><span class="keyword">ALL</span> [PRIVILEGES]    <span class="comment">-- è®¾ç½®é™¤GRANT OPTIONä¹‹å¤–çš„æ‰€æœ‰ç®€å•æƒé™</span></span><br><span class="line"><span class="keyword">ALTER</span>    <span class="comment">-- å…è®¸ä½¿ç”¨ALTER TABLE</span></span><br><span class="line"><span class="keyword">ALTER</span> ROUTINE    <span class="comment">-- æ›´æ”¹æˆ–å–æ¶ˆå·²å­˜å‚¨çš„å­ç¨‹åº</span></span><br><span class="line"><span class="keyword">CREATE</span>    <span class="comment">-- å…è®¸ä½¿ç”¨CREATE TABLE</span></span><br><span class="line"><span class="keyword">CREATE</span> ROUTINE    <span class="comment">-- åˆ›å»ºå·²å­˜å‚¨çš„å­ç¨‹åº</span></span><br><span class="line"><span class="keyword">CREATE</span> TEMPORARY TABLES        <span class="comment">-- å…è®¸ä½¿ç”¨CREATE TEMPORARY TABLE</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span>        <span class="comment">-- å…è®¸ä½¿ç”¨CREATE USER, DROP USER, RENAME USERå’ŒREVOKE ALL PRIVILEGESã€‚</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span>        <span class="comment">-- å…è®¸ä½¿ç”¨CREATE VIEW</span></span><br><span class="line"><span class="keyword">DELETE</span>    <span class="comment">-- å…è®¸ä½¿ç”¨DELETE</span></span><br><span class="line"><span class="keyword">DROP</span>    <span class="comment">-- å…è®¸ä½¿ç”¨DROP TABLE</span></span><br><span class="line"><span class="keyword">EXECUTE</span>        <span class="comment">-- å…è®¸ç”¨æˆ·è¿è¡Œå·²å­˜å‚¨çš„å­ç¨‹åº</span></span><br><span class="line">FILE    <span class="comment">-- å…è®¸ä½¿ç”¨SELECT...INTO OUTFILEå’ŒLOAD DATA INFILE</span></span><br><span class="line">INDEX     <span class="comment">-- å…è®¸ä½¿ç”¨CREATE INDEXå’ŒDROP INDEX</span></span><br><span class="line"><span class="keyword">INSERT</span>    <span class="comment">-- å…è®¸ä½¿ç”¨INSERT</span></span><br><span class="line">LOCK TABLES        <span class="comment">-- å…è®¸å¯¹æ‚¨æ‹¥æœ‰SELECTæƒé™çš„è¡¨ä½¿ç”¨LOCK TABLES</span></span><br><span class="line">PROCESS     <span class="comment">-- å…è®¸ä½¿ç”¨SHOW FULL PROCESSLIST</span></span><br><span class="line"><span class="keyword">REFERENCES</span>    <span class="comment">-- æœªè¢«å®æ–½</span></span><br><span class="line">RELOAD    <span class="comment">-- å…è®¸ä½¿ç”¨FLUSH</span></span><br><span class="line">REPLICATION CLIENT    <span class="comment">-- å…è®¸ç”¨æˆ·è¯¢é—®ä»å±æœåŠ¡å™¨æˆ–ä¸»æœåŠ¡å™¨çš„åœ°å€</span></span><br><span class="line">REPLICATION SLAVE    <span class="comment">-- ç”¨äºå¤åˆ¶å‹ä»å±æœåŠ¡å™¨ï¼ˆä»ä¸»æœåŠ¡å™¨ä¸­è¯»å–äºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶ï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span>    <span class="comment">-- å…è®¸ä½¿ç”¨SELECT</span></span><br><span class="line"><span class="keyword">SHOW</span> DATABASES    <span class="comment">-- æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">VIEW</span>    <span class="comment">-- å…è®¸ä½¿ç”¨SHOW CREATE VIEW</span></span><br><span class="line">SHUTDOWN    <span class="comment">-- å…è®¸ä½¿ç”¨mysqladmin shutdown</span></span><br><span class="line">SUPER    <span class="comment">-- å…è®¸ä½¿ç”¨CHANGE MASTER, KILL, PURGE MASTER LOGSå’ŒSET GLOBALè¯­å¥ï¼Œmysqladmin debugå‘½ä»¤ï¼›å…è®¸æ‚¨è¿æ¥ï¼ˆä¸€æ¬¡ï¼‰ï¼Œå³ä½¿å·²è¾¾åˆ°max_connectionsã€‚</span></span><br><span class="line">UPDATE    <span class="comment">-- å…è®¸ä½¿ç”¨UPDATE</span></span><br><span class="line">USAGE    <span class="comment">-- â€œæ— æƒé™â€çš„åŒä¹‰è¯</span></span><br><span class="line"><span class="keyword">GRANT</span> OPTION    <span class="comment">-- å…è®¸æˆäºˆæƒé™</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* è¡¨ç»´æŠ¤ */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ†æå’Œå­˜å‚¨è¡¨çš„å…³é”®å­—åˆ†å¸ƒ</span></span><br><span class="line">ANALYZE [<span class="keyword">LOCAL</span> <span class="operator">|</span> NO_WRITE_TO_BINLOG] <span class="keyword">TABLE</span> è¡¨å ...</span><br><span class="line"><span class="comment">-- æ£€æŸ¥ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨æ˜¯å¦æœ‰é”™è¯¯</span></span><br><span class="line"><span class="keyword">CHECK</span> <span class="keyword">TABLE</span> tbl_name [, tbl_name] ... [option] ...</span><br><span class="line">option <span class="operator">=</span> {QUICK <span class="operator">|</span> FAST <span class="operator">|</span> MEDIUM <span class="operator">|</span> EXTENDED <span class="operator">|</span> CHANGED}</span><br><span class="line"><span class="comment">-- æ•´ç†æ•°æ®æ–‡ä»¶çš„ç¢ç‰‡</span></span><br><span class="line">OPTIMIZE [<span class="keyword">LOCAL</span> <span class="operator">|</span> NO_WRITE_TO_BINLOG] <span class="keyword">TABLE</span> tbl_name [, tbl_name] </span><br></pre></td></tr></tbody></table></figure>
<h4 id="2ã€MySQL-å¤‡ä»½"><a href="#2ã€MySQL-å¤‡ä»½" class="headerlink" title="2ã€MySQL å¤‡ä»½"></a>2ã€MySQL å¤‡ä»½</h4><p><strong>æ•°æ®å¤‡ä»½çš„é‡è¦æ€§</strong></p>
<ul>
<li>ä¿è¯é‡è¦æ•°æ®ä¸ä¸¢å¤±</li>
<li>æ•°æ®è½¬ç§»</li>
</ul>
<p><strong>MySQL æ•°æ®åº“å¤‡ä»½æ–¹æ³•</strong></p>
<ul>
<li>æ•°æ®åº“ç®¡ç†å·¥å…·ï¼Œå¦‚ SQLyog</li>
<li>ç›´æ¥æ‹·è´æ•°æ®åº“ç‰©ç†æ–‡ä»¶ï¼ˆ/data/*ï¼‰</li>
<li>ä½¿ç”¨å‘½ä»¤è¡Œï¼Œmysqldump</li>
</ul>
<figure class="highlight sql"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">-- å¯¼å‡º</span></span><br><span class="line"><span class="number">1.</span> å¯¼å‡ºä¸€å¼ è¡¨ </span><br><span class="line"><span class="comment">-- mysqldump -uroot -p123456 school student &gt;D:/a.sql</span></span><br><span class="line">ã€€ã€€mysqldump <span class="operator">-</span>uç”¨æˆ·å <span class="operator">-</span>på¯†ç  åº“å è¡¨å <span class="operator">&gt;</span> æ–‡ä»¶å(D:<span class="operator">/</span>a.sql)</span><br><span class="line">ã€€ã€€</span><br><span class="line"><span class="number">2.</span> å¯¼å‡ºå¤šå¼ è¡¨ </span><br><span class="line"><span class="comment">-- mysqldump -uroot -p123456 school student result &gt;D:/a.sql</span></span><br><span class="line">ã€€ã€€mysqldump <span class="operator">-</span>uç”¨æˆ·å <span class="operator">-</span>på¯†ç  åº“å è¡¨<span class="number">1</span> è¡¨<span class="number">2</span> è¡¨<span class="number">3</span> <span class="operator">&gt;</span> æ–‡ä»¶å(D:<span class="operator">/</span>a.sql)</span><br><span class="line">ã€€ã€€</span><br><span class="line"><span class="number">3.</span> å¯¼å‡ºæ‰€æœ‰è¡¨ </span><br><span class="line"><span class="comment">-- mysqldump -uroot -p123456 school &gt;D:/a.sql</span></span><br><span class="line">ã€€ã€€mysqldump <span class="operator">-</span>uç”¨æˆ·å <span class="operator">-</span>på¯†ç  åº“å <span class="operator">&gt;</span> æ–‡ä»¶å(D:<span class="operator">/</span>a.sql)</span><br><span class="line">ã€€ã€€</span><br><span class="line"><span class="number">4.</span> å¯¼å‡ºä¸€ä¸ªåº“ </span><br><span class="line"><span class="comment">-- mysqldump -uroot -p123456 -B school &gt;D:/a.sql</span></span><br><span class="line">ã€€ã€€mysqldump <span class="operator">-</span>uç”¨æˆ·å <span class="operator">-</span>på¯†ç  <span class="operator">-</span>B åº“å <span class="operator">&gt;</span> æ–‡ä»¶å(D:<span class="operator">/</span>a.sql)</span><br><span class="line"></span><br><span class="line">å¯ä»¥<span class="operator">-</span>wæºå¸¦å¤‡ä»½æ¡ä»¶</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¯¼å…¥</span></span><br><span class="line"><span class="number">1.</span> åœ¨ç™»å½•mysqlçš„æƒ…å†µä¸‹ï¼š</span><br><span class="line"><span class="comment">-- source D:/a.sql</span></span><br><span class="line">ã€€ã€€source å¤‡ä»½æ–‡ä»¶</span><br><span class="line">ã€€ã€€</span><br><span class="line"><span class="number">2.</span> åœ¨ä¸ç™»å½•çš„æƒ…å†µä¸‹</span><br><span class="line"><span class="comment">-- mysqldump -uroot -p123456 school &lt;D:/a.sql</span></span><br><span class="line">ã€€ã€€mysql <span class="operator">-</span>uç”¨æˆ·å <span class="operator">-</span>på¯†ç  åº“å <span class="operator">&lt;</span> å¤‡ä»½æ–‡ä»¶</span><br></pre></td></tr></tbody></table></figure>
<h2 id="åä¸€ã€è§„èŒƒåŒ–æ•°æ®åº“è®¾è®¡"><a href="#åä¸€ã€è§„èŒƒåŒ–æ•°æ®åº“è®¾è®¡" class="headerlink" title="åä¸€ã€è§„èŒƒåŒ–æ•°æ®åº“è®¾è®¡"></a>åä¸€ã€è§„èŒƒåŒ–æ•°æ®åº“è®¾è®¡</h2><h4 id="1ã€ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®åº“è®¾è®¡"><a href="#1ã€ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®åº“è®¾è®¡" class="headerlink" title="1ã€ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®åº“è®¾è®¡"></a>1ã€ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®åº“è®¾è®¡</h4><blockquote>
<p>å½“æ•°æ®åº“æ¯”è¾ƒå¤æ‚æ—¶æˆ‘ä»¬éœ€è¦è®¾è®¡æ•°æ®åº“</p>
</blockquote>
<p><strong>ç³Ÿç³•çš„æ•°æ®åº“è®¾è®¡ :</strong> </p>
<ul>
<li>æ•°æ®å†—ä½™,å­˜å‚¨ç©ºé—´æµªè´¹</li>
<li>æ•°æ®æ›´æ–°å’Œæ’å…¥çš„å¼‚å¸¸</li>
<li>ç¨‹åºæ€§èƒ½å·®</li>
</ul>
<p><strong>è‰¯å¥½çš„æ•°æ®åº“è®¾è®¡ :</strong> </p>
<ul>
<li>èŠ‚çœæ•°æ®çš„å­˜å‚¨ç©ºé—´</li>
<li>èƒ½å¤Ÿä¿è¯æ•°æ®çš„å®Œæ•´æ€§</li>
<li>æ–¹ä¾¿è¿›è¡Œæ•°æ®åº“åº”ç”¨ç³»ç»Ÿçš„å¼€å‘</li>
</ul>
<p> <strong>è½¯ä»¶é¡¹ç›®å¼€å‘å‘¨æœŸä¸­æ•°æ®åº“è®¾è®¡ :</strong></p>
<ul>
<li>éœ€æ±‚åˆ†æé˜¶æ®µï¼šåˆ†æå®¢æˆ·çš„ä¸šåŠ¡å’Œæ•°æ®å¤„ç†éœ€æ±‚ã€‚</li>
<li>æ¦‚è¦è®¾è®¡é˜¶æ®µï¼šè®¾è®¡æ•°æ®åº“çš„E-Ræ¨¡å‹å›¾ , ç¡®è®¤éœ€æ±‚ä¿¡æ¯çš„æ­£ç¡®å’Œå®Œæ•´ã€‚</li>
</ul>
<p><strong>è®¾è®¡æ•°æ®åº“æ­¥éª¤</strong></p>
<ul>
<li>æ”¶é›†ä¿¡æ¯ï¼Œä¸è¯¥ç³»ç»Ÿæœ‰å…³äººå‘˜è¿›è¡Œäº¤æµ , åº§è°ˆ , å……åˆ†äº†è§£ç”¨æˆ·éœ€æ±‚ , ç†è§£æ•°æ®åº“éœ€è¦å®Œæˆçš„ä»»åŠ¡ã€‚</li>
<li>æ ‡è¯†æ•°æ®åº“è¦ç®¡ç†çš„å…³é”®å¯¹è±¡æˆ–å®ä½“,å®ä½“ä¸€èˆ¬æ˜¯åè¯ã€‚</li>
<li>æ ‡è¯†æ¯ä¸ªå®ä½“éœ€è¦å­˜å‚¨çš„è¯¦ç»†ä¿¡æ¯ã€‚</li>
<li>æ ‡è¯†å®ä½“ä¹‹é—´çš„å…³ç³»ã€‚</li>
</ul>
<h4 id="2ã€ä¸‰å¤§èŒƒå¼"><a href="#2ã€ä¸‰å¤§èŒƒå¼" class="headerlink" title="2ã€ä¸‰å¤§èŒƒå¼"></a>2ã€ä¸‰å¤§èŒƒå¼</h4><p><strong>é—®é¢˜ : ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®è§„èŒƒåŒ–?</strong></p>
<p>ä¸åˆè§„èŒƒçš„è¡¨è®¾è®¡ä¼šå¯¼è‡´çš„é—®é¢˜ï¼š</p>
<ul>
<li><p>ä¿¡æ¯é‡å¤</p>
</li>
<li><p>æ›´æ–°å¼‚å¸¸</p>
</li>
<li><p>æ’å…¥å¼‚å¸¸</p>
</li>
<li><ul>
<li>æ— æ³•æ­£ç¡®è¡¨ç¤ºä¿¡æ¯</li>
</ul>
</li>
<li><p>åˆ é™¤å¼‚å¸¸</p>
</li>
<li><ul>
<li>ä¸¢å¤±æœ‰æ•ˆä¿¡æ¯</li>
</ul>
</li>
</ul>
<p><strong>ç¬¬ä¸€èŒƒå¼ (1st NF)</strong></p>
<p>ç¬¬ä¸€èŒƒå¼æ˜¯æœ€åŸºæœ¬çš„èŒƒå¼ã€‚å¦‚æœ<strong>æ•°æ®åº“è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µå€¼éƒ½æ˜¯ä¸å¯åˆ†è§£çš„åŸå­å€¼</strong>ï¼Œå°±è¯´æ˜è¯¥æ•°æ®åº“è¡¨æ»¡è¶³äº†ç¬¬ä¸€èŒƒå¼ã€‚</p>
<p>ç¬¬ä¸€èŒƒå¼çš„åˆç†éµå¾ªéœ€è¦æ ¹æ®ç³»ç»Ÿçš„å®é™…éœ€æ±‚æ¥å®šã€‚æ¯”å¦‚æŸäº›æ•°æ®åº“ç³»ç»Ÿä¸­éœ€è¦ç”¨åˆ°â€œåœ°å€â€è¿™ä¸ªå±æ€§ï¼Œæœ¬æ¥ç›´æ¥å°†â€œåœ°å€â€å±æ€§è®¾è®¡æˆä¸€ä¸ªæ•°æ®åº“è¡¨çš„å­—æ®µå°±è¡Œã€‚ä½†æ˜¯å¦‚æœç³»ç»Ÿç»å¸¸ä¼šè®¿é—®â€œåœ°å€â€å±æ€§ä¸­çš„â€œåŸå¸‚â€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå°±éè¦å°†â€œåœ°å€â€è¿™ä¸ªå±æ€§é‡æ–°æ‹†åˆ†ä¸ºçœä»½ã€åŸå¸‚ã€è¯¦ç»†åœ°å€ç­‰å¤šä¸ªéƒ¨åˆ†è¿›è¡Œå­˜å‚¨ï¼Œè¿™æ ·åœ¨å¯¹åœ°å€ä¸­æŸä¸€éƒ¨åˆ†æ“ä½œçš„æ—¶å€™å°†éå¸¸æ–¹ä¾¿ã€‚è¿™æ ·è®¾è®¡æ‰ç®—æ»¡è¶³äº†æ•°æ®åº“çš„ç¬¬ä¸€èŒƒå¼ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/20/ILtAbQ.png" alt=""></p>
<p><strong>ç¬¬äºŒèŒƒå¼(2nd NF)</strong></p>
<p>ç¬¬äºŒèŒƒå¼åœ¨ç¬¬ä¸€èŒƒå¼çš„åŸºç¡€ä¹‹ä¸Šæ›´è¿›ä¸€å±‚ã€‚ç¬¬äºŒèŒƒå¼éœ€è¦<strong>ç¡®ä¿æ•°æ®åº“è¡¨ä¸­çš„æ¯ä¸€åˆ—éƒ½å’Œä¸»é”®ç›¸å…³</strong>ï¼Œè€Œä¸èƒ½åªä¸ä¸»é”®çš„æŸä¸€éƒ¨åˆ†ç›¸å…³ï¼ˆä¸»è¦é’ˆå¯¹è”åˆä¸»é”®è€Œè¨€ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€ä¸ªæ•°æ®åº“è¡¨ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­åªèƒ½ä¿å­˜ä¸€ç§æ•°æ®ï¼Œä¸å¯ä»¥æŠŠå¤šç§æ•°æ®ä¿å­˜åœ¨åŒä¸€å¼ æ•°æ®åº“è¡¨ä¸­ã€‚</p>
<p>æ¯”å¦‚è¦è®¾è®¡ä¸€ä¸ªè®¢å•ä¿¡æ¯è¡¨ï¼Œå› ä¸ºè®¢å•ä¸­å¯èƒ½ä¼šæœ‰å¤šç§å•†å“ï¼Œæ‰€ä»¥è¦å°†è®¢å•ç¼–å·å’Œå•†å“ç¼–å·ä½œä¸ºæ•°æ®åº“è¡¨çš„è”åˆä¸»é”®ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/20/ILte5n.png" alt=""></p>
<p>è¿™æ ·å°±äº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼šè¿™ä¸ªè¡¨ä¸­æ˜¯ä»¥è®¢å•ç¼–å·å’Œå•†å“ç¼–å·ä½œä¸ºè”åˆä¸»é”®ã€‚è¿™æ ·åœ¨è¯¥è¡¨ä¸­å•†å“åç§°ã€å•ä½ã€å•†å“ä»·æ ¼ç­‰ä¿¡æ¯ä¸ä¸è¯¥è¡¨çš„ä¸»é”®ç›¸å…³ï¼Œè€Œä»…ä»…æ˜¯ä¸å•†å“ç¼–å·ç›¸å…³ã€‚æ‰€ä»¥åœ¨è¿™é‡Œè¿åäº†ç¬¬äºŒèŒƒå¼çš„è®¾è®¡åŸåˆ™ã€‚</p>
<p>è€Œå¦‚æœæŠŠè¿™ä¸ªè®¢å•ä¿¡æ¯è¡¨è¿›è¡Œæ‹†åˆ†ï¼ŒæŠŠå•†å“ä¿¡æ¯åˆ†ç¦»åˆ°å¦ä¸€ä¸ªè¡¨ä¸­ï¼ŒæŠŠè®¢å•é¡¹ç›®è¡¨ä¹Ÿåˆ†ç¦»åˆ°å¦ä¸€ä¸ªè¡¨ä¸­ï¼Œå°±éå¸¸å®Œç¾äº†ã€‚å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/20/ILtNP1.png" alt=""></p>
<p>è¿™æ ·è®¾è®¡ï¼Œåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå‡å°äº†æ•°æ®åº“çš„å†—ä½™ã€‚å¦‚æœè¦è·å–è®¢å•çš„å•†å“ä¿¡æ¯ï¼Œä½¿ç”¨å•†å“ç¼–å·åˆ°å•†å“ä¿¡æ¯è¡¨ä¸­æŸ¥è¯¢å³å¯ã€‚</p>
<p><strong>ç¬¬ä¸‰èŒƒå¼(3rd NF)</strong></p>
<p>ç¬¬ä¸‰èŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®è¡¨ä¸­çš„æ¯ä¸€åˆ—æ•°æ®éƒ½<strong>å’Œä¸»é”®ç›´æ¥ç›¸å…³ï¼Œè€Œä¸èƒ½é—´æ¥ç›¸å…³</strong>ã€‚</p>
<p>æ¯”å¦‚åœ¨è®¾è®¡ä¸€ä¸ªè®¢å•æ•°æ®è¡¨çš„æ—¶å€™ï¼Œå¯ä»¥å°†å®¢æˆ·ç¼–å·ä½œä¸ºä¸€ä¸ªå¤–é”®å’Œè®¢å•è¡¨å»ºç«‹ç›¸åº”çš„å…³ç³»ã€‚è€Œä¸å¯ä»¥åœ¨è®¢å•è¡¨ä¸­æ·»åŠ å…³äºå®¢æˆ·å…¶å®ƒä¿¡æ¯ï¼ˆæ¯”å¦‚å§“åã€æ‰€å±å…¬å¸ç­‰ï¼‰çš„å­—æ®µã€‚å¦‚ä¸‹é¢è¿™ä¸¤ä¸ªè¡¨æ‰€ç¤ºçš„è®¾è®¡å°±æ˜¯ä¸€ä¸ªæ»¡è¶³ç¬¬ä¸‰èŒƒå¼çš„æ•°æ®åº“è¡¨ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/20/ILNPiR.png" alt=""></p>
<p>è¿™æ ·åœ¨æŸ¥è¯¢è®¢å•ä¿¡æ¯çš„æ—¶å€™ï¼Œå°±å¯ä»¥ä½¿ç”¨å®¢æˆ·ç¼–å·æ¥å¼•ç”¨å®¢æˆ·ä¿¡æ¯è¡¨ä¸­çš„è®°å½•ï¼Œä¹Ÿä¸å¿…åœ¨è®¢å•ä¿¡æ¯è¡¨ä¸­å¤šæ¬¡è¾“å…¥å®¢æˆ·ä¿¡æ¯çš„å†…å®¹ï¼Œå‡å°äº†æ•°æ®å†—ä½™ã€‚</p>
<p>ä½†å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼š<strong>ä¸ºäº†æ€§èƒ½è€ŒæŠ›å¼ƒè¿™äº›è§„èŒƒåŒ–çš„æ“ä½œ</strong>ï¼Œå› ä¸ºä¸€ä¸ªå¤æ‚çš„è¡¨å¦‚æœæŒ‰ç…§ä¸‰å¤§èŒƒå¼æ¥è®¾è®¡ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šæ‹†æˆåå¤šä¸ªè¡¨ï¼Œè¿™æ ·åœ¨æ•°æ®åº“æŸ¥è¯¢æ—¶ä¼šååˆ†å½±å“æ•ˆç‡ï¼ˆå¤šè¡¨æŸ¥è¯¢ï¼‰ã€‚</p>
<p><strong>è§„èŒƒåŒ–å’Œæ€§èƒ½çš„å…³ç³»</strong></p>
<ul>
<li><p>ä¸ºæ»¡è¶³æŸç§å•†ä¸šç›®æ ‡ , æ•°æ®åº“æ€§èƒ½æ¯”è§„èŒƒåŒ–æ•°æ®åº“æ›´é‡è¦</p>
</li>
<li><p>åœ¨æ•°æ®è§„èŒƒåŒ–çš„åŒæ—¶ , è¦ç»¼åˆè€ƒè™‘æ•°æ®åº“çš„æ€§èƒ½</p>
</li>
<li><p>é€šè¿‡åœ¨ç»™å®šçš„è¡¨ä¸­æ·»åŠ é¢å¤–çš„å­—æ®µ,ä»¥å¤§é‡å‡å°‘éœ€è¦ä»ä¸­æœç´¢ä¿¡æ¯æ‰€éœ€çš„æ—¶é—´</p>
</li>
<li><p>é€šè¿‡åœ¨ç»™å®šçš„è¡¨ä¸­æ’å…¥è®¡ç®—åˆ—,ä»¥æ–¹ä¾¿æŸ¥è¯¢</p>
</li>
</ul>
]]></content>
      <categories>
        <category>DataBase System</category>
      </categories>
      <tags>
        <tag>SQL</tag>
      </tags>
  </entry>
  <entry>
    <title>23ç§è®¾è®¡æ¨¡å¼</title>
    <url>/2021/11/29/23%E7%A7%8D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼</h1><h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h2><p>ç¼–å†™è½¯ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œç¨‹åºå‘˜é¢ä¸´ç€æ¥è‡ª<strong>è€¦åˆæ€§</strong>ã€<strong>å†…èšæ€§</strong>ã€<strong>å¯ç»´æŠ¤æ€§</strong>ã€<strong>å¯æ‹“å±•æ€§</strong>ã€<strong>é‡ç”¨æ€§</strong>ã€<strong>çµæ´»æ€§</strong>ç­‰å¤šæ–¹é¢çš„æŒ‘æˆ˜ï¼Œè€Œè®¾è®¡æ¨¡å¼æ˜¯ä¸ºäº†è®©è½¯ä»¶å…·æœ‰æ›´å¥½çš„</p>
<ul>
<li><strong>ä»£ç é‡ç”¨æ€§</strong>ï¼šç›¸åŒåŠŸèƒ½çš„ä»£ç ï¼Œä¸ç”¨å¤šæ¬¡ç¼–å†™</li>
<li><strong>å¯è¯»æ€§</strong>ï¼šç¼–ç¨‹è§„èŒƒæ€§ï¼Œä¾¿äºå…¶ä»–ç¨‹åºå‘˜çš„é˜…è¯»å’Œç†è§£</li>
<li><strong>å¯æ‹“å±•æ€§</strong>ï¼šå½“éœ€è¦å¢åŠ æ–°çš„åŠŸèƒ½æ—¶ï¼Œéå¸¸çš„æ–¹ä¾¿ï¼Œä¸ç”¨å¤§é‡ä¿®æ”¹åŸä»£ç </li>
<li><strong>å¯é æ€§</strong>ï¼šå½“å¢åŠ æ–°çš„åŠŸèƒ½åï¼Œå¯¹åŸæ¥çš„åŠŸèƒ½æ²¡æœ‰ä»»ä½•çš„å½±å“</li>
<li><strong>é«˜å†…èš</strong>ï¼šå°½é‡ä¸€ä¸ªæ–¹æ³•ï¼ˆç±»ï¼‰å®Œæˆä¸€ä¸ªï¼ˆç±»ï¼‰äº‹æƒ…</li>
<li><strong>ä½è€¦åˆ</strong>ï¼šå‡å°‘æ–¹æ³•ï¼ˆç±»ï¼‰å†…éƒ¨å¯¹å…¶ä»–æ–¹æ³•ï¼ˆç±»ï¼‰çš„ä½¿ç”¨ï¼Œé™ä½æ¨¡å—ä¹‹é—´çš„ä¾èµ–ä½œç”¨</li>
</ul>
<h2 id="2-ä¸ƒå¤§åŸåˆ™"><a href="#2-ä¸ƒå¤§åŸåˆ™" class="headerlink" title="2. ä¸ƒå¤§åŸåˆ™"></a>2. ä¸ƒå¤§åŸåˆ™</h2><h3 id="2-1-å•ä¸€èŒè´£åŸåˆ™"><a href="#2-1-å•ä¸€èŒè´£åŸåˆ™" class="headerlink" title="2.1 å•ä¸€èŒè´£åŸåˆ™"></a>2.1 å•ä¸€èŒè´£åŸåˆ™</h3><p>ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½é¢†åŸŸä¸­çš„ç›¸åº”èŒè´£ï¼Œæˆ–è€…å¯ä»¥å®šä¹‰ä¸ºï¼šå°±ä¸€ä¸ªç±»è€Œè¨€ï¼Œåº”è¯¥åªæœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› ã€‚</p>
<p>ä¾‹å¦‚ï¼Œç±» A è´Ÿè´£ä¸¤ä¸ªä¸åŒèŒè´£ï¼šèŒè´£1ï¼ŒèŒè´£2ã€‚å½“èŒè´£1éœ€æ±‚å˜æ›´è€Œæ”¹å˜ A æ—¶ï¼Œå¯èƒ½å¯¼è‡´èŒè´£ 2 å‡ºé”™ï¼Œæ‰€ä»¥è¦å°†ç±» A çš„ç²’åº¦åˆ†è§£ä¸º A1ï¼ŒA2ã€‚</p>
<p><strong>ä»£ç å¦‚ä¸‹</strong>ï¼Œæ‰€æœ‰çš„äº¤é€šå·¥å…·éƒ½ç”¨çš„ä¸€ä¸ªrunæ–¹æ³•ï¼Œä»¥è‡³äºæ½œè‰‡èƒ½åœ¨è·¯ä¸Šè·‘ï¼Œè¿™è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œå› æ­¤æˆ‘ä»¬è¦åŠ ä»¥ä¿®æ”¹ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingleResponsibility</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="keyword">new</span> Vehicle(<span class="string">"æ±½è½¦"</span>).run();</span><br><span class="line">        <span class="keyword">new</span> Vehicle(<span class="string">"é£æœº"</span>).run();</span><br><span class="line">        <span class="keyword">new</span> Vehicle(<span class="string">"æ½œè‰‡"</span>).run();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸æ»¡è¶³èŒè´£å•ä¸€</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span></span>{</span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Vehicle</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨è·¯ä¸Šè·‘"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">æ±½è½¦åœ¨è·¯ä¸Šè·‘</span><br><span class="line">é£æœºåœ¨è·¯ä¸Šè·‘</span><br><span class="line">æ½œè‰‡åœ¨è·¯ä¸Šè·‘</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ–¹æ¡ˆ1</strong>ï¼Œå°† <strong>Vehicle</strong> åˆ†è§£ä¸ºä¸‰ä¸ªç±»ï¼Œè¿™æ ·å­æ”¹åŠ¨éå¸¸å¤§ï¼Œè¿˜è¦åŒæ—¶ä¿®æ”¹å®¢æˆ·ç«¯ï¼</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.designpattern.principle.improve;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingleResponsibility1</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="keyword">new</span> LandVehicle(<span class="string">"æ±½è½¦"</span>).run();</span><br><span class="line">        <span class="keyword">new</span> SeaVehicle(<span class="string">"é£æœº"</span>).run();</span><br><span class="line">        <span class="keyword">new</span> SkyVehicle(<span class="string">"æ½œè‰‡"</span>).run();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LandVehicle</span></span>{</span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LandVehicle</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨è·¯ä¸Šè·‘"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SeaVehicle</span></span>{</span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SeaVehicle</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨æµ·é‡Œæ¸¸"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SkyVehicle</span></span>{</span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SkyVehicle</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨å¤©ä¸Šé£"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ–¹æ¡ˆ2</strong>ï¼Œå°†åŸ <strong>Vehicle</strong> ä¸­çš„ run æ–¹æ³•æ‹†è§£ä¸ºä¸‰ä¸ªæ–¹æ³•ï¼Œè™½ç„¶æ²¡æœ‰åœ¨ç±»ä¸Šéµå¾ªå•ä¸€èŒè´£çš„æ–¹æ³•ï¼Œä½†æ˜¯åœ¨æ–¹æ³•ä¸Šéµå®ˆäº†ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingleResponsibility2</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="keyword">new</span> Vehicle(<span class="string">"æ±½è½¦"</span>).run();</span><br><span class="line">        <span class="keyword">new</span> Vehicle(<span class="string">"é£æœº"</span>).swim();</span><br><span class="line">        <span class="keyword">new</span> Vehicle(<span class="string">"æ½œè‰‡"</span>).fly();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span></span>{</span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Vehicle</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨è·¯ä¸Šè·‘"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">swim</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨æµ·é‡Œæ¸¸"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨å¤©ä¸Šé£"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p><strong>å•ä¸€èŒè´£åŸåˆ™æ³¨æ„äº‹é¡¹ï¼š</strong></p>
          </div>
<ol>
<li>é™ä½ç±»çš„å¤æ‚åº¦ï¼Œä¸€ä¸ªç±»åªè´Ÿè´£ä¸€é¡¹èŒè´£ã€‚</li>
<li>æé«˜ç±»çš„å¯è¯»æ€§ï¼Œå¯ç»´æŠ¤æ€§ã€‚</li>
<li>é™ä½å˜æ›´å¼•èµ·çš„é£é™©ã€‚</li>
<li>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”å½“éµå®ˆå•ä¸€èŒè´£åŸåˆ™ï¼Œåªæœ‰å½“é€»è¾‘è¶³å¤Ÿç®€å•ä¸”ç±»ä¸­çš„æ–¹æ³•è¶³å¤Ÿå°‘æ—¶ï¼Œæ‰å¯ä»¥åœ¨ä»£ç çº§è¿åå•ä¸€èŒè´£åŸåˆ™ï¼ˆè§æ–¹æ¡ˆ2ï¼‰ã€‚</li>
</ol>
<p><br></p>
<h3 id="2-2-æ¥å£éš”ç¦»åŸåˆ™"><a href="#2-2-æ¥å£éš”ç¦»åŸåˆ™" class="headerlink" title="2.2 æ¥å£éš”ç¦»åŸåˆ™"></a>2.2 æ¥å£éš”ç¦»åŸåˆ™</h3><ol>
<li>åˆ›å»ºç±»æ—¶è¦ä½¿ç”¨å¤šä¸ªä¸“é—¨çš„æ¥å£ï¼Œè€Œä¸ä½¿ç”¨å•ä¸€çš„æ€»æ¥å£ï¼Œå³å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–é‚£äº›å®ƒä¸éœ€è¦çš„æ¥å£ã€‚</li>
<li>ç±»é—´çš„ä¾èµ–å…³ç³»åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Šã€‚</li>
</ol>
<p><strong>æ¥å£çš„å«ä¹‰</strong>ï¼š</p>
<ol>
<li>ä¸€ä¸ªæ¥å£ä»£è¡¨ä¸€ä¸ªè§’è‰²ï¼Œä¸åº”è¯¥å°†ä¸åŒçš„è§’è‰²éƒ½äº¤ç»™ä¸€ä¸ªæ¥å£ï¼Œå› ä¸ºè¿™æ ·å¯èƒ½ä¼šå½¢æˆä¸€ä¸ªè‡ƒè‚¿çš„å¤§æ¥å£ï¼ˆå‚è€ƒ jdk ä¸­çš„ stack ç±»ï¼‰</li>
<li>ç‰¹å®šè¯­è¨€çš„æ¥å£ï¼Œè¡¨ç¤ºæ¥å£ä»…ä»…æ˜¯æä¾›å®¢æˆ·ç«¯éœ€è¦çš„è¡Œä¸ºï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦çš„è¡Œä¸ºåˆ™éšè—èµ·æ¥ï¼Œåº”å½“ä¸ºå®¢æˆ·ç«¯æä¾›å°½å¯èƒ½å°çš„å•ç‹¬çš„æ¥å£ï¼Œè€Œä¸è¦æä¾›å¤§çš„æ€»æ¥å£ã€‚</li>
</ol>
<p><strong>ä»£ç å¦‚ä¸‹</strong>ï¼ŒåŠ¨ç‰©æ¥å£ä¸­å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•ï¼Œ<strong>eat</strong>ã€<strong>work</strong> å’Œ <strong>fly</strong>ï¼Œå¯æ˜¯å¯¹äºå®ç°ç±» <strong>Person</strong> è€Œè¨€ï¼Œæ ¹æœ¬å°±ç”¨ä¸åˆ° fly() è¿™ä¸ªæ–¹æ³•ã€‚åŒç†å®ç°ç±» <strong>Bird</strong> ä¹Ÿä¸éœ€è¦ work()ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IAnimal</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">IAnimal</span></span>{</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨åƒé¥­"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨å·¥ä½œ"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(name + <span class="string">"ä¸ä¼šé£"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bird</span> <span class="keyword">implements</span> <span class="title">IAnimal</span></span>{</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Bird</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨åƒé¥­"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(name + <span class="string">"ä¸å·¥ä½œ"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨ç¿±ç¿”"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™æ˜¯å¯¹åº”çš„ UML å›¾ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/12/01/oGTBs1.png" alt="image"></p>
<p><strong>ä¿®æ”¹å¦‚ä¸‹</strong>ï¼Œå°†ä½œä¸ºåŠ¨ç‰©éƒ½æ‹¥æœ‰çš„ <strong>eat</strong> æ–¹æ³•ä¿ç•™ä¸‹æ¥ï¼Œè€Œ <strong>fly</strong> å’Œ <strong>work</strong> åˆ™å•ç‹¬æ‹å‡ºæ¥ä½œä¸ºä¸¤ä¸ªæ¥å£ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IAnimal</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IWork</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IFly</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">IAnimal</span>, <span class="title">IWork</span></span>{</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨åƒé¥­"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨å·¥ä½œ"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bird</span> <span class="keyword">implements</span> <span class="title">IAnimal</span>, <span class="title">IFly</span></span>{</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Bird</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨åƒé¥­"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(name + <span class="string">"åœ¨ç¿±ç¿”"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>UML å›¾å¦‚ä¸‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/12/01/oGT3q0.png" alt="image"></p>
<p><br></p>
<h3 id="2-3-ä¾èµ–å€’è½¬åŸåˆ™"><a href="#2-3-ä¾èµ–å€’è½¬åŸåˆ™" class="headerlink" title="2.3 ä¾èµ–å€’è½¬åŸåˆ™"></a>2.3 ä¾èµ–å€’è½¬åŸåˆ™</h3><ol>
<li>é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–åº•å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ã€‚</li>
<li>æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼Œè€Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚</li>
<li>ä¾èµ–å€’è½¬çš„ä¸­å¿ƒæ€æƒ³æ˜¯<strong>é¢å‘æ¥å£ç¼–ç¨‹</strong>ã€‚</li>
<li>ç›¸è¾ƒäºç»†èŠ‚çš„å¤šå˜æ€§ï¼ŒæŠ½è±¡çš„ä¸œè¥¿è¦ç¨³å®šå¾—å¤šï¼Œä»¥æŠ½è±¡ä¸ºåŸºç¡€æ­å»ºçš„æ¶æ„è¦æ¯”ä»¥ç»†èŠ‚ä¸ºåŸºç¡€æ‰€æ­å»ºçš„æ¶æ„è¦ç¨³å®šå¾—å¤šã€‚</li>
<li>ä½¿ç”¨æ¥å£æˆ–æŠ½è±¡ç±»çš„ç›®çš„æ˜¯åˆ¶å®šå¥½è§„èŒƒï¼Œè€Œä¸æ¶‰åŠä»»ä½•å…·ä½“çš„æ“ä½œï¼Œ<strong>æŠŠå±•ç°ç»†èŠ‚çš„ä»»åŠ¡äº¤ç»™ä»–ä»¬çš„å®ç°ç±»</strong>å»å®Œæˆã€‚</li>
</ol>
<p><strong>ä»£ç å¦‚ä¸‹</strong>ï¼ŒPerson ç±»ä¸­æœ‰ <strong>receiveEmail()</strong> æ¥ä¸“é—¨æ¥å—é‚®ä»¶æ¶ˆæ¯ï¼Œå¯ä¸‡ä¸€åé¢ç¨‹åºæ‹“å±•ï¼Œéœ€è¦æ¥å—çŸ­ä¿¡ã€qqã€å¾®ä¿¡ç­‰æ¶ˆæ¯å‘¢ï¼Ÿé‚£å°±åªèƒ½æ·»åŠ æ•°ä¸ªæ–¹æ³•å¯¹åº”æ•°ä¸ªæ¥å—ä¿¡æ¯æ ¼å¼ï¼Œéº»çƒ¦ä¹‹è‡³ï¼</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReverseDependency</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="keyword">new</span> Person().receiveEmail(<span class="keyword">new</span> Email(<span class="string">"æ¯æ—¥ä¸€æŠ¥æœªå¡«æŠ¥!"</span>));</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Email</span></span>{</span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMsg</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Email</span><span class="params">(String msg)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.msg = msg;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveEmail</span><span class="params">(Email email)</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"æ”¶åˆ°ä¸€å°é‚®ä»¶ï¼š"</span> + email.getMsg());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>ä¿®æ”¹å¦‚ä¸‹</strong>ï¼Œæ–¹æ³•ä¸­åªéœ€ä¼ å…¥ç±»çš„æŠ½è±¡ç±»å‹ï¼ˆæ¥å£ï¼‰å³å¯ï¼Œè®©æ‰€æœ‰çš„å®ä½“ç±»å»å®ç°è¿™ä¸ªæŠ½è±¡ç±»å‹ï¼ˆæ¥å£ï¼‰ï¼Œè®°ä½ï¼š<strong>ä¾èµ–äºæ¥å£</strong>ï¼ï¼ï¼</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReverseDependency</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Person1 person1 = <span class="keyword">new</span> Person1();</span><br><span class="line">        Person2 person2 = <span class="keyword">new</span> Person2();</span><br><span class="line">        Person3 person3 = <span class="keyword">new</span> Person3(<span class="keyword">new</span> Wechat(<span class="string">"æ¯æ—¥ä¸€æŠ¥æœªå¡«æŠ¥!"</span>));</span><br><span class="line">        person1.receiveEmail(<span class="keyword">new</span> Email(<span class="string">"æ¯æ—¥ä¸€æŠ¥æœªå¡«æŠ¥!"</span>));</span><br><span class="line">        person2.setReceiver(<span class="keyword">new</span> QQ(<span class="string">"æ¯æ—¥ä¸€æŠ¥æœªå¡«æŠ¥!"</span>));</span><br><span class="line">        person2.receiveEmail();</span><br><span class="line">        person3.receiveEmail();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IReceiver</span></span>{</span><br><span class="line">    <span class="function">String <span class="title">getMsg</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">String <span class="title">getName</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Email</span> <span class="keyword">implements</span> <span class="title">IReceiver</span></span>{</span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMsg</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Email"</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Email</span><span class="params">(String msg)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.msg = msg;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QQ</span> <span class="keyword">implements</span> <span class="title">IReceiver</span></span>{</span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMsg</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"QQ"</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">QQ</span><span class="params">(String msg)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.msg = msg;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wechat</span> <span class="keyword">implements</span> <span class="title">IReceiver</span></span>{</span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMsg</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Wechat"</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Wechat</span><span class="params">(String msg)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.msg = msg;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. æ¥å£ä¼ é€’</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person1</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveEmail</span><span class="params">(IReceiver receiver)</span></span>{</span><br><span class="line">        System.out.println(receiver.getName() + <span class="string">"æ”¶åˆ°ä¸€æ¡æ¶ˆæ¯ï¼š"</span> + receiver.getMsg());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.setæ–¹æ³•ä¼ é€’</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person2</span></span>{</span><br><span class="line">    <span class="keyword">private</span> IReceiver receiver;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setReceiver</span><span class="params">(IReceiver receiver)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.receiver = receiver;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveEmail</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(receiver.getName() + <span class="string">"æ”¶åˆ°ä¸€æ¡æ¶ˆæ¯ï¼š"</span> + receiver.getMsg());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.æ„é€ æ–¹æ³•ä¼ é€’</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person3</span></span>{</span><br><span class="line">    <span class="keyword">private</span> IReceiver receiver;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person3</span><span class="params">(IReceiver receiver)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.receiver = receiver;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveEmail</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(receiver.getName() + <span class="string">"æ”¶åˆ°ä¸€æ¡æ¶ˆæ¯ï¼š"</span> + receiver.getMsg());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h3 id="2-4-é‡Œæ°æ›¿æ¢åŸåˆ™"><a href="#2-4-é‡Œæ°æ›¿æ¢åŸåˆ™" class="headerlink" title="2.4 é‡Œæ°æ›¿æ¢åŸåˆ™"></a>2.4 é‡Œæ°æ›¿æ¢åŸåˆ™</h3><div class="note success">
            <p><strong>Barbara Liskov</strong>æå‡ºï¼š</p><p>æ ‡å‡†å®šä¹‰ï¼šå¦‚æœå¯¹æ¯ä¸€ä¸ªç±»å‹ä¸º S çš„å¯¹è±¡ o1ï¼Œéƒ½æœ‰ç±»å‹ä¸º T çš„å¯¹è±¡ o2ï¼Œä½¿å¾—ä»¥ T å®šä¹‰çš„æ‰€æœ‰ç¨‹åº P åœ¨æ‰€æœ‰çš„å¯¹è±¡ o1 ä»£æ¢ o2 æ—¶ï¼Œç¨‹åº P çš„è¡Œä¸ºæ²¡æœ‰å˜åŒ–ï¼Œé‚£ä¹ˆç±»å‹ S æ˜¯ç±»å‹ T çš„å­ç±»å‹ã€‚</p>
          </div>
<p>è¯´äººè¯å°±æ˜¯ï¼Œ<strong>æ‰€æœ‰å¼•ç”¨åŸºç±»ï¼ˆçˆ¶ç±»çš„ï¼‰åœ°æ–¹éƒ½å¯ä»¥ç”¨å­ç±»æ¥æ›¿æ¢ï¼Œä¸”ç¨‹åºä¸ä¼šæœ‰ä»»ä½•çš„å¼‚å¸¸</strong>ï¼Œä½†åè¿‡æ¥é€šå¸¸æ¥è¯´å°±æ˜¯é”™è¯¯çš„ï¼ï¼ï¼æ¯•ç«Ÿå¯ä»¥è¯´äººæ˜¯åŠ¨ç‰©ï¼Œä½†ä¸èƒ½è¯´åŠ¨ç‰©æ˜¯äººã€‚</p>
<p>é‡Œæ°æ›¿æ¢åŸåˆ™æ˜¯å®ç°å¼€é—­åŸåˆ™çš„é‡è¦æ–¹å¼ä¹‹ä¸€ï¼Œç”±äºä½¿ç”¨åŸºç±»çš„æ‰€æœ‰åœ°æ–¹éƒ½å¯ä»¥ç”¨å­ç±»æ¥æ›¿æ¢ï¼Œå› æ­¤åœ¨ç¨‹åºä¸­å°½é‡ä½¿ç”¨åŸºç±»æ¥å®šä¹‰å¯¹è±¡ï¼Œåœ¨è¿è¡Œæ—¶ç¡®å®šå…¶å­ç±»ç±»å‹ã€‚</p>
<h4 id="2-4-1-é‡Œæ°æ›¿æ¢åŸåˆ™çº¦æŸ"><a href="#2-4-1-é‡Œæ°æ›¿æ¢åŸåˆ™çº¦æŸ" class="headerlink" title="2.4.1 é‡Œæ°æ›¿æ¢åŸåˆ™çº¦æŸ"></a>2.4.1 é‡Œæ°æ›¿æ¢åŸåˆ™çº¦æŸ</h4><ul>
<li>å­ç±»å¿…é¡»å®ç°çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ï¼Œä½†å°½é‡ä¸è¦é‡å†™ï¼ˆè¦†ç›–ï¼‰çˆ¶ç±»çš„éæŠ½è±¡ï¼ˆå·²å®ç°ï¼‰æ–¹æ³•ï¼Œä¼šè®©é€»è¾‘å…³ç³»å˜å¾—æ··ä¹±ã€‚</li>
<li>å­ç±»ä¸­å¯ä»¥æ·»åŠ ç‰¹æœ‰æ–¹æ³•ï¼Œæ­¤æ—¶åˆ™æ— æ³•åœ¨ä»¥çˆ¶ç±»å®šä¹‰çš„å¯¹è±¡ä¸­ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œé™¤éåœ¨ä½¿ç”¨çš„æ—¶å€™å¼ºè½¬æˆå­ç±»è¿›è¡Œè°ƒç”¨ã€‚</li>
<li><p>å½“å­ç±»è¦†ç›–æˆ–å®ç°çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œæ–¹æ³•çš„å‰ç½®æ¡ä»¶ï¼ˆå½¢å‚ï¼‰è¦æ¯”çˆ¶ç±»çš„å½¢å‚æ›´å®½æ¾ã€‚</p>
</li>
<li><p>å½“å­ç±»è¦†ç›–æˆ–å®ç°çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œæ–¹æ³•çš„åç½®æ¡ä»¶ï¼ˆè¿”å›å€¼ï¼‰è¦æ¯”çˆ¶ç±»çš„è¿”å›å€¼æ›´å®½æ¾ã€‚</p>
</li>
</ul>
<p><strong><font size="4px">ä¸ºä»€ä¹ˆå­ç±»çš„å‰ç½®æ¡ä»¶è¦æ¯”çˆ¶ç±»æ›´å®½æ¾ï¼Ÿ</font></strong></p>
<p>ä¸‹è¿°ä»£ç ä¸­ï¼ŒFather ç±»ä¸­çš„ doSomething() æ˜¯ HashMap ç±»å‹çš„ï¼Œè€Œå…¶å­ç±» Son åˆ™æ˜¯ HashMap çš„å®ç°æ¥å£ Map ç±»å‹ï¼Œæ˜¾ç„¶ï¼Œæ›´å®½æ¾äº†ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>{</span><br><span class="line">        Father father = <span class="keyword">new</span> Father();</span><br><span class="line">        Son son = <span class="keyword">new</span> Son();</span><br><span class="line">        HashMap map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        father.doSomething(map);</span><br><span class="line">        son.doSomething(map);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection <span class="title">doSomething</span><span class="params">(HashMap map)</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"çˆ¶ç±»è¢«æ‰§è¡Œ"</span>);</span><br><span class="line">        <span class="keyword">return</span> map.values();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son</span> <span class="keyword">extends</span> <span class="title">Father</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection <span class="title">doSomething</span><span class="params">(Map map)</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"å­ç±»è¢«æ‰§è¡Œ"</span>);</span><br><span class="line">        <span class="keyword">return</span> map.values();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ‰§è¡Œç»“æœæ­£å¦‚é‡Œæ°æ›¿æ¢åŸåˆ™è¯´çš„é‚£æ ·ï¼š<strong>æ‰€æœ‰å¼•ç”¨åŸºç±»ï¼ˆçˆ¶ç±»çš„ï¼‰åœ°æ–¹éƒ½å¯ä»¥ç”¨å­ç±»æ¥æ›¿æ¢ï¼Œä¸”ç¨‹åºä¸ä¼šæœ‰ä»»ä½•çš„å¼‚å¸¸</strong>ï¼Œå­ç±»ä»£æ›¿çˆ¶ç±»ï¼Œå­ç±»çš„æ–¹æ³•ä¸è¢«æ‰§è¡Œ</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">çˆ¶ç±»è¢«æ‰§è¡Œ</span><br><span class="line">çˆ¶ç±»è¢«æ‰§è¡Œ</span><br><span class="line">    </span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<p>ç»§æ‰¿åŒ…å«è¿™æ ·ä¸€å±‚å«ä¹‰ï¼šçˆ¶ç±»ä¸­å‡¡æ˜¯å·²ç»å®ç°å¥½çš„æ–¹æ³•ï¼ˆç›¸å¯¹äºæŠ½è±¡æ–¹æ³•è€Œè¨€ï¼‰ï¼Œå®é™…ä¸Šæ˜¯åœ¨è®¾å®šä¸€ç³»åˆ—çš„è§„èŒƒå’Œå¥‘çº¦ï¼Œè™½ç„¶å®ƒä¸å¼ºåˆ¶è¦æ±‚æ‰€æœ‰çš„å­ç±»å¿…é¡»éµä»è¿™äº›å¥‘çº¦ï¼Œä½†æ˜¯å¦‚æœå­ç±»å¯¹è¿™äº›éæŠ½è±¡æ–¹æ³•ä»»æ„ä¿®æ”¹ï¼Œå°±ä¼šå¯¹æ•´ä¸ªç»§æ‰¿ä½“ç³»é€ æˆç ´åã€‚è€Œé‡Œæ°æ›¿æ¢åŸåˆ™å°±æ˜¯è¡¨è¾¾äº†è¿™ä¸€å±‚å«ä¹‰ã€‚</p>
<p>è®¾ç½®å­ç±»çš„æ–¹æ³•æ¯”çˆ¶ç±»çš„å½¢å‚æ¡ä»¶æ›´å®½æ¾ï¼Œåœ¨æ²¡æœ‰é‡å†™çš„æƒ…å†µä¸‹ï¼Œçˆ¶ç±»å¯¹è±¡è°ƒç”¨æ–¹æ³•æ˜¯å°±ä¼šä¼˜å…ˆè°ƒç”¨çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯å­ç±»ä¸­é‡è½½çš„æ–¹æ³•ã€‚</p>
<p><strong>ä¸‹é¢æˆ‘ä»¬åè¿‡æ¥</strong>ï¼Œå‡å¦‚å­ç±»å‰ç½®æ¡ä»¶æ›´ä¸¥æ ¼å‘¢ï¼Ÿ</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>{</span><br><span class="line">        Father father = <span class="keyword">new</span> Father();</span><br><span class="line">        Son son = <span class="keyword">new</span> Son();</span><br><span class="line">        HashMap map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        father.doSomething(map);</span><br><span class="line">        son.doSomething(map);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection <span class="title">doSomething</span><span class="params">(Map map)</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"çˆ¶ç±»è¢«æ‰§è¡Œ"</span>);</span><br><span class="line">        <span class="keyword">return</span> map.values();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son</span> <span class="keyword">extends</span> <span class="title">Father</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Collection <span class="title">doSomething</span><span class="params">(HashMap map)</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"å­ç±»è¢«æ‰§è¡Œ"</span>);</span><br><span class="line">        <span class="keyword">return</span> map.values();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ¯«æ— ç–‘é—®åœ°ï¼Œä¼šæ‰§è¡Œå­ç±»çš„æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">çˆ¶ç±»è¢«æ‰§è¡Œ</span><br><span class="line">çˆ¶ç±»è¢«æ‰§è¡Œ</span><br><span class="line">    </span><br><span class="line">Process finished with exit code <span class="number">0</span></span><br></pre></td></tr></tbody></table></figure>
<p>è°ƒç”¨äº†å­ç±»ï¼Œå­ç±»åœ¨æ²¡æœ‰è¦†å†™çˆ¶ç±»çš„æ–¹æ³•çš„å‰æä¸‹ï¼Œå­ç±»æ–¹æ³•è¢«æ‰§è¡Œäº†ï¼Œè¿™ä¼šå¼•èµ·ä¸šåŠ¡é€»è¾‘æ··ä¹±ï¼Œå› ä¸ºåœ¨å®é™…åº”ç”¨ä¸­çˆ¶ç±»ä¸€èˆ¬æ˜¯æŠ½è±¡ç±»ï¼Œå­ç±»æ˜¯å®ç°ç±»ï¼Œä½ ä¼ é€’ä¸€ä¸ªè¿™æ ·çš„å®ç°ç±»å°±ä¼šæ­ªæ›²äº†çˆ¶ç±»çš„æ„å›¾ï¼Œå¼•èµ·ä¸šåŠ¡é€»è¾‘æ··ä¹±ï¼Œæ‰€ä»¥å­ç±»ä¸­æ–¹æ³•çš„å‰ç½®æ¡ä»¶å¿…é¡»ä¸è¶…ç±»ä¸­è¢«è¦†å†™çš„æ–¹æ³•çš„å‰ç½®æ¡ä»¶ç›¸åŒæˆ–æ›´å®½æ¾ã€‚</p>
<p><strong><font size="4px">ä¸ºä»€ä¹ˆå­ç±»çš„åç½®æ¡ä»¶è¦æ¯”çˆ¶ç±»æ›´ä¸¥æ ¼ï¼Ÿ</font></strong></p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>{</span><br><span class="line">        Father father = <span class="keyword">new</span> Father();</span><br><span class="line">        Son son = <span class="keyword">new</span> Son();</span><br><span class="line">        HashMap map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        father.doSomething(map);</span><br><span class="line">        son.doSomething(map);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ArrayList <span class="title">doSomething</span><span class="params">(Map map)</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"çˆ¶ç±»è¢«æ‰§è¡Œ"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList(map.values());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Son</span> <span class="keyword">extends</span> <span class="title">Father</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List <span class="title">doSomething</span><span class="params">(Map map)</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"å­ç±»è¢«æ‰§è¡Œ"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ArrayList(map.values());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è¿è¡Œç»“æœç›´æ¥æŠ¥å…¼å®¹å¼‚å¸¸çš„é”™è¯¯ï¼Œä¸è¿‡æƒ³æƒ³ä¹Ÿèƒ½çŸ¥é“</p>
<ul>
<li>å¦‚æœå­ç±»æ–¹æ³•è¿”å›å€¼ç±»å‹æ¯”çˆ¶ç±»æ›´ä¸¥æ ¼ï¼Œé‚£ä¹ˆå­ç±»çš„è¿”å›å€¼æ˜¯å¯ä»¥éšå¼è½¬æ¢ä¸ºçˆ¶ç±»çš„ã€‚</li>
<li>è€Œå¦‚æœå­ç±»æ–¹æ³•è¿”å›å€¼ç±»å‹æ¯”çˆ¶ç±»æ›´å®½æ¾ï¼Œé‚£ä¹ˆå­ç±»çš„è¿”å›å€¼åˆ™æ— æ³•ä¸åŸä»£ç å…¼å®¹ï¼ï¼ï¼éœ€è¦å¼ºè½¬ç­‰æ‰‹æ®µï¼Œä½†ç°åœ¨ä»ç¼–è¯‘æœŸé—´å°±è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œç›´æ¥æŠ¥é”™ã€‚</li>
</ul>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line">java: com.yqx.designpattern.Sonä¸­çš„doSomething(java.util.Map)æ— æ³•è¦†ç›–com.yqx.designpattern.Fatherä¸­çš„doSomething(java.util.Map)</span><br><span class="line">    è¿”å›ç±»å‹java.util.Listä¸java.util.ArrayListä¸å…¼å®¹</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h4 id="2-4-2-ä»£ç "><a href="#2-4-2-ä»£ç " class="headerlink" title="2.4.2 ä»£ç "></a>2.4.2 ä»£ç </h4><p>ä¸‹è¿°ä»£ç ä¸­ï¼Œå­ç±» B é‡å†™äº†çˆ¶ç±» A ä¸­çš„ func1() æ–¹æ³•ï¼Œè€Œè‡ªå·±å´ä¸è‡ªçŸ¥ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Liskov</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        A a = <span class="keyword">new</span> A();</span><br><span class="line">        B b = <span class="keyword">new</span> B();</span><br><span class="line">        System.out.println(<span class="string">"11 - 3 = "</span> + a.func1(<span class="number">11</span>, <span class="number">3</span>));</span><br><span class="line">        System.out.println(<span class="string">"1 - 8 = "</span> + a.func1(<span class="number">1</span>, <span class="number">8</span>));</span><br><span class="line">        System.out.println(<span class="string">"=================================="</span>);</span><br><span class="line">        System.out.println(<span class="string">"11 - 3 = "</span> + b.func1(<span class="number">11</span>, <span class="number">3</span>));</span><br><span class="line">        System.out.println(<span class="string">"1 - 8 = "</span> + b.func1(<span class="number">1</span>, <span class="number">8</span>));</span><br><span class="line">        System.out.println(<span class="string">"11 + 3 + 9 = "</span> + b.func2(<span class="number">11</span>, <span class="number">3</span>));</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>{</span><br><span class="line">    <span class="comment">// è¿”å›ä¸¤ä¸ªæ•°çš„å·®</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> num1 - num2;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span></span>{</span><br><span class="line">    <span class="comment">// è¿™é‡Œé‡å†™äº†Aç±»çš„æ–¹æ³•ï¼Œå¯èƒ½æ˜¯æ— æ„è¯†çš„</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> num1 + num2;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func2</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> func1(num1, num2) + <span class="number">9</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ‰§è¡Œç»“æœåˆ™å‡ºç°äº†å¾ˆç¦»è°±çš„æƒ…å†µï¼Œä»¥ä¸ºè‡ªå·±è¿˜è°ƒç”¨çš„æ˜¯çˆ¶ç±»çš„ func1()ï¼Œå¯¼è‡´åŠ å‡é¢ å€’ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="number">11</span> - <span class="number">3</span> = <span class="number">8</span></span><br><span class="line"><span class="number">1</span> - <span class="number">8</span> = -<span class="number">7</span></span><br><span class="line">==================================</span><br><span class="line"><span class="number">11</span> - <span class="number">3</span> = <span class="number">14</span></span><br><span class="line"><span class="number">1</span> - <span class="number">8</span> = <span class="number">9</span></span><br><span class="line"><span class="number">11</span> + <span class="number">3</span> + <span class="number">9</span> = <span class="number">23</span></span><br></pre></td></tr></tbody></table></figure>
<p>åœ¨å®é™…ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šé€šè¿‡é‡å†™çˆ¶ç±»çš„æ–¹æ³•æ¥å®Œæˆæ–°çš„åŠŸèƒ½ï¼Œè¿™æ ·å†™èµ·æ¥è™½ç„¶ç®€å•ï¼Œä½†æ•´ä¸ªç»§æ‰¿ä½“ç³»çš„å¤ç”¨æ€§ä¼šæ¯”è¾ƒå·®ï¼Œç‰¹åˆ«æ˜¯è¿è¡Œå¤šæ€æ¯”è¾ƒé¢‘ç¹çš„æ—¶å€™ã€‚</p>
<p>é€šç”¨çš„æ–¹æ³•æ˜¯ï¼š<strong>è®©åŸæ¥çš„çˆ¶ç±»å’Œå­ç±»éƒ½ç»§æ‰¿ä¸€ä¸ªæ›´é€šä¿—çš„åŸºç±»</strong>ï¼Œå°†åŸæœ‰çš„ç»§æ‰¿å…³ç³»å–æ¶ˆï¼Œè¿›è€Œé‡‡ç”¨<strong>ä¾èµ–ï¼Œç»„åˆï¼Œèšåˆ</strong>ç­‰å…³ç³»ä»£æ›¿ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Liskov</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        A a = <span class="keyword">new</span> A();</span><br><span class="line">        B b = <span class="keyword">new</span> B();</span><br><span class="line">        System.out.println(<span class="string">"11 - 3 = "</span> + a.func1(<span class="number">11</span>, <span class="number">3</span>));</span><br><span class="line">        System.out.println(<span class="string">"1 - 8 = "</span> + a.func1(<span class="number">1</span>, <span class="number">8</span>));</span><br><span class="line">        System.out.println(<span class="string">"=================================="</span>);</span><br><span class="line">        <span class="comment">// å› ä¸ºBç±»ä¸åœ¨ç»§æ‰¿Aç±»ï¼Œå› æ­¤è°ƒç”¨è€…å¾ˆæ¸…æ¥šï¼Œfunc1ä¸å†æ˜¯æ±‚å‡æ³•</span></span><br><span class="line">        System.out.println(<span class="string">"11 + 3 = "</span> + b.func1(<span class="number">11</span>, <span class="number">3</span>));</span><br><span class="line">        System.out.println(<span class="string">"1 + 8 = "</span> + b.func1(<span class="number">1</span>, <span class="number">8</span>));</span><br><span class="line">        System.out.println(<span class="string">"1 - 8 = "</span> + b.func3(<span class="number">1</span>, <span class="number">8</span>));</span><br><span class="line">        System.out.println(<span class="string">"11 + 3 + 9 = "</span> + b.func2(<span class="number">11</span>, <span class="number">3</span>));</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Base</span></span>{</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">extends</span> <span class="title">Base</span></span>{</span><br><span class="line">    <span class="comment">// è¿”å›ä¸¤ä¸ªæ•°çš„å·®</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> num1 - num2;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">Base</span></span>{</span><br><span class="line">    A a = <span class="keyword">new</span> A();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func1</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> num1 + num2;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func2</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> func1(num1, num2) + <span class="number">9</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯ä»¥ä½¿ç”¨ç»„åˆçš„æ–¹å¼æ¥è°ƒç”¨Açš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">func3</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span></span>{</span><br><span class="line">        <span class="keyword">return</span> a.func1(num1, num2);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>UML å›¾å¦‚ä¸‹ã€‚</p>
<p><img src="https://s1.ax1x.com/2021/12/01/oJayFO.png" alt="image"></p>
<p><br></p>
<h3 id="2-5-å¼€é—­åŸåˆ™"><a href="#2-5-å¼€é—­åŸåˆ™" class="headerlink" title="2.5 å¼€é—­åŸåˆ™"></a>2.5 å¼€é—­åŸåˆ™</h3><p>å¼€é—­åŸåˆ™æ˜¯é¢å‘å¯¹è±¡çš„å¯å¤ç”¨è®¾è®¡çš„ç¬¬ä¸€å—åŸºçŸ³ï¼Œå®ƒæ˜¯æœ€é‡è¦çš„é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p>
<blockquote>
<p> <strong>ä¸€ä¸ªè½¯ä»¶å®ä½“åº”å½“å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼Œå³è½¯ä»¶å®ä½“åº”å°½é‡åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç çš„æƒ…å†µä¸‹è¿›è¡Œæ‰©å±•ã€‚</strong></p>
</blockquote>
<p><strong>å¼€é—­åŸåˆ™çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li>å¯ä»¥ä½¿åŸæœ‰ä»£ç ä¾æ—§å¯ä»¥è¿è¡Œï¼Œåªéœ€è¦å¯¹æ‰©å±•çš„ä»£ç è¿›è¡Œæµ‹è¯•å³å¯</li>
<li>å¯ä»¥æé«˜ä»£ç çš„å¤ç”¨æ€§</li>
<li>å¯ä»¥æé«˜ç³»ç»Ÿçš„ç»´æŠ¤æ€§</li>
</ul>
<p><strong>å¦‚ä½•ä½¿ç”¨å¼€é—­åŸåˆ™ï¼š</strong></p>
<ul>
<li>æŠ½è±¡çº¦æŸ<ul>
<li>é€šè¿‡æ¥å£æˆ–è€…æŠ½è±¡ç±»çº¦æŸæ‰©å±•ï¼Œå¯¹æ‰©å±•è¿›è¡Œè¾¹ç•Œé™å®šï¼Œä¸å…è®¸å‡ºç°åœ¨æ¥å£æˆ–æŠ½è±¡ç±»ä¸­ä¸å­˜åœ¨çš„ public æ–¹æ³•ã€‚</li>
<li>å‚æ•°ç±»å‹ã€å¼•ç”¨å¯¹è±¡å°½é‡ä½¿ç”¨æ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼Œè€Œä¸æ˜¯å®ç°ç±»ã€‚</li>
<li>æŠ½è±¡å±‚å°½é‡ä¿æŒç¨³å®šï¼Œä¸€æ—¦ç¡®å®šå°±ä¸å…è®¸ä¿®æ”¹ã€‚</li>
</ul>
</li>
<li>å…ƒæ•°æ®æ§åˆ¶æ¨¡å—è¡Œä¸ºï¼Œé€šä¿—ç‚¹æ¥è¯´å°±æ˜¯é€šè¿‡é…ç½®æ–‡ä»¶æ¥æ“æ§æ•°æ®ï¼ˆSpringï¼‰</li>
<li>çº¦å®šç”±äºé…ç½®</li>
<li>å°è£…å˜åŒ–<ul>
<li>å°†ç›¸åŒçš„å˜åŒ–å°è£…åˆ°ä¸€ä¸ªæ¥å£æˆ–è€…ç±»ä¸­</li>
<li>å°†ä¸åŒçš„å˜åŒ–å°è£…åˆ°ä¸åŒçš„æ¥å£æˆ–è€…ç±»ä¸­</li>
</ul>
</li>
</ul>
<p><strong>ä»£ç éƒ¨åˆ†</strong></p>
<p>UML å›¾å¦‚ä¸‹ã€‚</p>
<p><img src="https://s1.ax1x.com/2021/12/01/oJDIJK.png" alt="image"></p>
<p>ä»£ç å¦‚ä¸‹ï¼Œä¸€ä¸ªç®€æ˜“ç»˜åˆ¶å›¾å½¢çš„ç±»ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yqx.designpattern.principle.ocp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Ocp</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        GraphicEditor graphicEditor = <span class="keyword">new</span> GraphicEditor();</span><br><span class="line">        graphicEditor.drawShape(<span class="keyword">new</span> Rectangle());</span><br><span class="line">        graphicEditor.drawShape(<span class="keyword">new</span> Circle());</span><br><span class="line">        graphicEditor.drawShape(<span class="keyword">new</span> Triangle());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GraphicEditor</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawShape</span><span class="params">(Shape s)</span></span>{</span><br><span class="line">        <span class="keyword">if</span> (s.type == <span class="number">1</span>){</span><br><span class="line">            drawRectangle();</span><br><span class="line">        }<span class="keyword">else</span> <span class="keyword">if</span>(s.type == <span class="number">2</span>){</span><br><span class="line">            drawCircle();</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            drawTriangle();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawRectangle</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"ç»˜åˆ¶çŸ©å½¢"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawCircle</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"ç»˜åˆ¶åœ†å½¢"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawTriangle</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"ç»˜åˆ¶ä¸‰è§’å½¢"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½¢çŠ¶åŸºç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shape</span></span>{</span><br><span class="line">    <span class="keyword">int</span> type;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Rectangle</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">super</span>.type = <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Circle</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">super</span>.type = <span class="number">2</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Triangle</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Triangle</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">super</span>.type = <span class="number">3</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å½“æˆ‘ä»¬æƒ³è¦æ‰©å±•æ€§å†…å®¹ï¼Œæ¯”å¦‚ç”»ä¸€ä¸ªäº”è§’æ˜Ÿæ—¶ï¼Œæ”¹åŠ¨éå¸¸å¤šï¼Œè¿˜è¿èƒŒäº† ocp åŸåˆ™ï¼ï¼ï¼</p>
<p>ä¿®æ”¹å¦‚ä¸‹ï¼Œæœ‰ç‚¹ç±»ä¼¼äºä¾èµ–å€’è½¬é‡Œé¢çš„ä¾‹å­ï¼Œè¿™ä¸è¿‡è¿™é‡Œæ”¹æˆäº†æŠ½è±¡ç±»ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Ocp</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        GraphicEditor graphicEditor = <span class="keyword">new</span> GraphicEditor();</span><br><span class="line">        graphicEditor.drawShape(<span class="keyword">new</span> Rectangle());</span><br><span class="line">        graphicEditor.drawShape(<span class="keyword">new</span> Circle());</span><br><span class="line">        graphicEditor.drawShape(<span class="keyword">new</span> Triangle());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GraphicEditor</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawShape</span><span class="params">(Shape s)</span></span>{</span><br><span class="line">        s.draw();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½¢çŠ¶åŸºç±»</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Shape</span></span>{</span><br><span class="line">    <span class="keyword">int</span> type;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Rectangle</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">super</span>.type = <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"ç»˜åˆ¶çŸ©å½¢"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Circle</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">super</span>.type = <span class="number">2</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"ç»˜åˆ¶åœ†å½¢"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Triangle</span> <span class="keyword">extends</span> <span class="title">Shape</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Triangle</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">super</span>.type = <span class="number">3</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"ç»˜åˆ¶ä¸‰è§’å½¢"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h3 id="2-6-è¿ªç±³ç‰¹æ³•åˆ™"><a href="#2-6-è¿ªç±³ç‰¹æ³•åˆ™" class="headerlink" title="2.6 è¿ªç±³ç‰¹æ³•åˆ™"></a>2.6 è¿ªç±³ç‰¹æ³•åˆ™</h3><ol>
<li>ä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡ä¿æŒæœ€å°‘çš„äº†è§£ã€‚</li>
<li>ç±»ä¸ç±»çš„å…³ç³»è¶Šå¯†åˆ‡ï¼Œè€¦åˆåº¦è¶Šå¤§ã€‚</li>
<li>è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆDemeter Principleï¼‰åˆå«æœ€å°‘çŸ¥é“åŸåˆ™ï¼Œå³<strong>ä¸€ä¸ªç±»å¯¹è‡ªå·±ä¾èµ–çš„ç±»çŸ¥é“çš„è¶Šå°‘è¶Šå¥½</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºè¢«ä¾èµ–çš„ç±»ä¸ç®¡å¤šä¹ˆå¤æ‚ï¼Œéƒ½å°½é‡å°†é€»è¾‘å°è£…åœ¨ç±»çš„å†…éƒ¨ã€‚å¯¹å¤–é™¤äº†æä¾›çš„ public æ–¹æ³•ï¼Œä¸å¯¹å¤–æ³„éœ²ä»»ä½•ä¿¡æ¯ã€‚</li>
<li>è¿ªç±³ç‰¹æ³•åˆ™è¿˜æœ‰ä¸ªæ›´ç®€å•çš„å®šä¹‰ï¼Œåªä¸<code>ç›´æ¥çš„æœ‹å‹</code>é€šä¿¡ã€‚</li>
<li><strong>ç›´æ¥çš„æœ‹å‹</strong>ï¼šæ¯ä¸ªå¯¹è±¡éƒ½ä¼šå’Œå…¶ä»–å¯¹è±¡æœ‰<strong>è€¦åˆå…³ç³»</strong>ï¼Œåªè¦ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´æœ‰è€¦åˆå…³ç³»ï¼Œé‚£æˆ‘ä»¬å°±è¯´è¿™ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´æ˜¯æœ‹å‹å…³ç³»ã€‚è€¦åˆçš„æ–¹å¼æœ‰å¾ˆå¤šä¸­ï¼šä¾èµ–ã€å…³è”ã€ç»„åˆã€èšåˆç­‰ã€‚å…¶ä¸­ï¼Œæˆ‘ä»¬ç§°å‡ºç°åœ¨<strong>æˆå‘˜å˜é‡ã€æ–¹æ³•å‚æ•°ã€æ–¹æ³•è¿”å›å€¼</strong>ä¸­çš„ç±»ä¸º<code>ç›´æ¥çš„æœ‹å‹</code>ï¼Œè€Œå‡ºç°åœ¨å±€éƒ¨å˜é‡ä¸­çš„ç±»ä¸º<code>é—´æ¥çš„æœ‹å‹</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>é™Œç”Ÿçš„ç±»æœ€å¥½ä¸è¦ä»¥å±€éƒ¨å˜é‡çš„å½¢å¼å‡ºç°åœ¨ç±»çš„å†…éƒ¨</strong>ã€‚</li>
</ol>
<p><strong>ä»£ç å¦‚ä¸‹</strong>ï¼Œåªèƒ½è¯´æ˜¯ç¨€ç¢çš„è€¦åˆåº¦äº†ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demeter</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="keyword">new</span> SchoolManager().printAllEmployee(<span class="keyword">new</span> CollegeManager());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CollegeEmployee</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥æœ‹å‹ï¼šCollegeEmployee</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CollegeManager</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;CollegeEmployee&gt; <span class="title">getAllEmployees</span><span class="params">()</span></span>{</span><br><span class="line">        List&lt;CollegeEmployee&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) {</span><br><span class="line">            CollegeEmployee manager = <span class="keyword">new</span> CollegeEmployee();</span><br><span class="line">            manager.setId(i + <span class="number">1</span>);</span><br><span class="line">            list.add(manager);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥æœ‹å‹ï¼šEmployeeï¼ŒCollegeManager</span></span><br><span class="line"><span class="comment">// é—´æ¥æœ‹å‹ï¼šCollegeEmployee</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SchoolManager</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getAllEmployees</span><span class="params">()</span></span>{</span><br><span class="line">        List&lt;Employee&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) {</span><br><span class="line">            Employee manager = <span class="keyword">new</span> Employee();</span><br><span class="line">            manager.setId(i + <span class="number">1</span>);</span><br><span class="line">            list.add(manager);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printAllEmployee</span><span class="params">(CollegeManager manager)</span></span>{</span><br><span class="line">        List&lt;CollegeEmployee&gt; list1 = manager.getAllEmployees();</span><br><span class="line">        System.out.println(<span class="string">"----------å­¦é™¢å‘˜å·¥---------"</span>);</span><br><span class="line">        <span class="keyword">for</span> (CollegeEmployee employee : list1) {</span><br><span class="line">            System.out.print(employee.getId() + <span class="string">" "</span>);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        System.out.println();</span><br><span class="line">        List&lt;Employee&gt; list2 = getAllEmployees();</span><br><span class="line">        System.out.println(<span class="string">"---------å­¦æ ¡æ€»éƒ¨å‘˜å·¥----------"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Employee employee : list2) {</span><br><span class="line">            System.out.print(employee.getId() + <span class="string">" "</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>SchoolManager è¿åäº†è¿ªç±³ç‰¹æ³•åˆ™ï¼Œå±€éƒ¨å˜é‡ä¸­è¿˜åŒ…å«äº†ä¸€ä¸ªé™Œç”Ÿçš„ç±»ï¼ï¼ï¼è¦é¿å…ç±»ä¸­å‡ºç°è¿™æ ·éç›´æ¥æœ‹å‹å…³ç³»çš„è€¦åˆã€‚</p>
<p><strong>ä¿®æ”¹å¦‚ä¸‹</strong>ï¼Œå°†æ‰“å°å­¦é™¢å‘˜å·¥çš„å®ç°æ”¾åœ¨ CollegeManager ç±»ä¸­ï¼Œè€Œåœ¨ SchoolEmployee ç±»ä¸­ç›´æ¥è°ƒç”¨ CollegeManager çš„æ‰“å°æ–¹æ³•å³å¯ï¼</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demeter</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="keyword">new</span> SchoolManager().printSchoolEmployee(<span class="keyword">new</span> CollegeManager());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Employee</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CollegeEmployee</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥æœ‹å‹ï¼šCollegeEmployee</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CollegeManager</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;CollegeEmployee&gt; <span class="title">getAllEmployees</span><span class="params">()</span></span>{</span><br><span class="line">        List&lt;CollegeEmployee&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) {</span><br><span class="line">            CollegeEmployee manager = <span class="keyword">new</span> CollegeEmployee();</span><br><span class="line">            manager.setId(i + <span class="number">1</span>);</span><br><span class="line">            list.add(manager);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printCollegeManager</span><span class="params">()</span></span>{</span><br><span class="line">        List&lt;CollegeEmployee&gt; list1 = getAllEmployees();</span><br><span class="line">        System.out.println(<span class="string">"----------å­¦é™¢å‘˜å·¥---------"</span>);</span><br><span class="line">        <span class="keyword">for</span> (CollegeEmployee employee : list1) {</span><br><span class="line">            System.out.print(employee.getId() + <span class="string">" "</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥æœ‹å‹ï¼šEmployeeï¼ŒCollegeManager</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SchoolManager</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Employee&gt; <span class="title">getAllEmployees</span><span class="params">()</span></span>{</span><br><span class="line">        List&lt;Employee&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) {</span><br><span class="line">            Employee manager = <span class="keyword">new</span> Employee();</span><br><span class="line">            manager.setId(i + <span class="number">1</span>);</span><br><span class="line">            list.add(manager);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printSchoolEmployee</span><span class="params">(CollegeManager manager)</span></span>{</span><br><span class="line">        manager.printCollegeManager();;</span><br><span class="line">        System.out.println();</span><br><span class="line">        List&lt;Employee&gt; list2 = getAllEmployees();</span><br><span class="line">        System.out.println(<span class="string">"---------å­¦æ ¡æ€»éƒ¨å‘˜å·¥----------"</span>);</span><br><span class="line">        <span class="keyword">for</span> (Employee employee : list2) {</span><br><span class="line">            System.out.print(employee.getId() + <span class="string">" "</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h3 id="2-7-åˆæˆå¤ç”¨åŸåˆ™"><a href="#2-7-åˆæˆå¤ç”¨åŸåˆ™" class="headerlink" title="2.7 åˆæˆå¤ç”¨åŸåˆ™"></a>2.7 åˆæˆå¤ç”¨åŸåˆ™</h3><p>åŸåˆ™æ˜¯å°½é‡ä½¿ç”¨åˆæˆ/èšåˆçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿å·²è¾¾åˆ°å¤ç”¨çš„æ•ˆæœã€‚</p>
<p>é€šè¿‡åˆæˆå¤ç”¨åŸåˆ™æ¥ä½¿ä¸€äº›å·²æœ‰çš„å¯¹è±¡ä½¿ä¹‹æˆä¸ºå¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œä¸€èˆ¬é€šè¿‡ç»„åˆ/èšåˆå…³ç³»æ¥å®ç°ï¼Œè€Œå°½é‡ä¸è¦ä½¿ç”¨ç»§æ‰¿ã€‚å› ä¸ºç»„åˆå’Œèšåˆå¯ä»¥é™ä½ç±»ä¹‹é—´çš„è€¦åˆåº¦ï¼Œè€Œç»§æ‰¿ä¼šè®©ç³»ç»Ÿæ›´åŠ å¤æ‚ï¼Œæœ€é‡è¦çš„ä¸€ç‚¹ä¼šç ´åç³»ç»Ÿçš„å°è£…æ€§ï¼Œå› ä¸ºç»§æ‰¿ä¼šæŠŠåŸºç±»çš„å®ç°ç»†èŠ‚æš´éœ²ç»™å­ç±»ï¼ŒåŒæ—¶å¦‚æœåŸºç±»å˜åŒ–ï¼Œå­ç±»ä¹Ÿå¿…é¡»è·Ÿç€æ”¹å˜ï¼Œè€Œä¸”è€¦åˆåº¦ä¼šå¾ˆé«˜ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/12/02/oYuqit.png" alt=""></p>
<p><br></p>
<h2 id="3-UML-ç±»å›¾"><a href="#3-UML-ç±»å›¾" class="headerlink" title="3. UML ç±»å›¾"></a>3. UML ç±»å›¾</h2><p>ç±»å›¾æ˜¯é¢å‘å¯¹è±¡ç³»ç»Ÿå»ºæ¨¡ä¸­æœ€å¸¸ç”¨å’Œæœ€é‡è¦çš„å›¾ï¼Œæ˜¯å®šä¹‰å…¶å®ƒå›¾çš„åŸºç¡€ã€‚ç±»å›¾ä¸»è¦æ˜¯ç”¨æ¥æ˜¾ç¤ºç³»ç»Ÿä¸­çš„ç±»ã€æ¥å£ä»¥åŠå®ƒä»¬ä¹‹é—´çš„é™æ€ç»“æ„å’Œå…³ç³»çš„ä¸€ç§é™æ€æ¨¡å‹ã€‚ç±»å›¾ä¸­æœ€åŸºæœ¬çš„å…ƒç´ æ˜¯ç±»ã€æ¥å£ã€‚è½¯ä»¶è®¾è®¡å¸ˆè®¾è®¡å‡ºç±»å›¾åï¼Œç¨‹åºå‘˜å°±å¯ä»¥ç”¨ä»£ç å®ç°ç±»å›¾ä¸­åŒ…å«çš„å†…å®¹ã€‚</p>
<h3 id="3-1-ç±»ï¼Œæ¥å£ï¼ŒåŒ…"><a href="#3-1-ç±»ï¼Œæ¥å£ï¼ŒåŒ…" class="headerlink" title="3.1 ç±»ï¼Œæ¥å£ï¼ŒåŒ…"></a>3.1 ç±»ï¼Œæ¥å£ï¼ŒåŒ…</h3><h4 id="3-1-1-å…·ä½“ç±»"><a href="#3-1-1-å…·ä½“ç±»" class="headerlink" title="3.1.1 å…·ä½“ç±»"></a>3.1.1 å…·ä½“ç±»</h4><p>å…·ä½“ç±»åœ¨ç±»å›¾ä¸­ç”¨çŸ©å½¢æ¡†è¡¨ç¤ºï¼ŒçŸ©å½¢æ¡†åˆ†ä¸ºä¸‰å±‚ï¼šç¬¬ä¸€å±‚æ˜¯ç±»åå­—ï¼›ç¬¬äºŒå±‚æ˜¯æˆå‘˜å˜é‡ï¼›ç¬¬ä¸‰å±‚æ˜¯ç±»çš„æ–¹æ³•ã€‚æˆå‘˜å˜é‡ä»¥åŠæ–¹æ³•å‰çš„è®¿é—®ä¿®é¥°ç¬¦ç”¨ç¬¦å·æ¥è¡¨ç¤ºï¼š</p>
<ul>
<li>â€œ<strong>+</strong>â€ è¡¨ç¤º <code>public</code></li>
<li>â€œ<strong>-</strong>â€ è¡¨ç¤º <code>private</code></li>
<li>â€œ<strong>#</strong>â€ è¡¨ç¤º <code>protected</code></li>
<li>æ²¡æœ‰ç¬¦å·è¡¨ç¤º <code>default</code></li>
</ul>
<p><img src="https://z3.ax1x.com/2021/12/02/otVKN6.png" alt="image"></p>
<h4 id="3-1-2-æŠ½è±¡ç±»"><a href="#3-1-2-æŠ½è±¡ç±»" class="headerlink" title="3.1.2 æŠ½è±¡ç±»"></a>3.1.2 æŠ½è±¡ç±»</h4><p>æŠ½è±¡ç±»åœ¨UMLç±»å›¾ä¸­åŒæ ·ç”¨çŸ©å½¢æ¡†è¡¨ç¤ºï¼Œä½†æ˜¯æŠ½è±¡ç±»çš„ç±»åä»¥åŠæŠ½è±¡æ–¹æ³•çš„åå­—éƒ½ç”¨æ–œä½“å­—è¡¨ç¤ºï¼š</p>
<p><img src="https://z3.ax1x.com/2021/12/02/otVUEt.png" alt="image"></p>
<h4 id="3-1-3-æ¥å£"><a href="#3-1-3-æ¥å£" class="headerlink" title="3.1.3 æ¥å£"></a>3.1.3 æ¥å£</h4><p>æ¥å£åœ¨ç±»å›¾ä¸­ä¹Ÿæ˜¯ç”¨çŸ©å½¢æ¡†è¡¨ç¤ºï¼Œä½†æ˜¯ä¸ç±»çš„è¡¨ç¤ºæ³•ä¸åŒçš„æ˜¯ï¼Œæ¥å£åœ¨ç±»å›¾ä¸­çš„ç¬¬ä¸€å±‚é¡¶ç«¯ç”¨æ„é€ å‹ &lt;\<interface\>&gt;è¡¨ç¤ºï¼Œä¸‹é¢æ˜¯æ¥å£çš„åå­—ï¼Œç¬¬äºŒå±‚æ˜¯æ–¹æ³•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</interface\></p>
<p><img src="https://z3.ax1x.com/2021/12/02/otVW5V.png" alt="image"></p>
<h4 id="3-1-4-åŒ…"><a href="#3-1-4-åŒ…" class="headerlink" title="3.1.4 åŒ…"></a>3.1.4 åŒ…</h4><p>ç±»å’Œæ¥å£ä¸€èˆ¬éƒ½å‡ºç°åœ¨åŒ…ä¸­ï¼ŒUMLç±»å›¾ä¸­åŒ…çš„è¡¨ç¤ºå½¢å¼å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://z3.ax1x.com/2021/12/02/otVHbR.png" alt="image"></p>
<p><br></p>
<h3 id="3-2-ç±»å›¾ä¸­çš„å…³ç³»"><a href="#3-2-ç±»å›¾ä¸­çš„å…³ç³»" class="headerlink" title="3.2 ç±»å›¾ä¸­çš„å…³ç³»"></a>3.2 ç±»å›¾ä¸­çš„å…³ç³»</h3><p>ç±»å’Œç±»ã€ç±»å’Œæ¥å£ã€æ¥å£å’Œæ¥å£ä¹‹é—´å­˜åœ¨ä¸€å®šå…³ç³»ï¼ŒUMLç±»å›¾ä¸­ä¸€èˆ¬ä¼šæœ‰è¿çº¿æŒ‡æ˜å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚å…³ç³»å…±æœ‰å…­ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯å®ç°å…³ç³»ã€æ³›åŒ–å…³ç³»ã€å…³è”å…³ç³»ã€ä¾èµ–å…³ç³»ã€èšåˆå…³ç³»ã€ç»„åˆå…³ç³»ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/12/02/oteFOJ.png" alt="image"></p>
<h4 id="3-2-1-å®ç°å…³ç³»"><a href="#3-2-1-å®ç°å…³ç³»" class="headerlink" title="3.2.1 å®ç°å…³ç³»"></a>3.2.1 å®ç°å…³ç³»</h4><p>å®ç°å…³ç³»æ˜¯æŒ‡æ¥å£åŠå…¶å®ç°ç±»ä¹‹é—´çš„å…³ç³»ã€‚åœ¨UMLç±»å›¾ä¸­ï¼Œå®ç°å…³ç³»ç”¨ç©ºå¿ƒä¸‰è§’å’Œè™šçº¿ç»„æˆçš„ç®­å¤´æ¥è¡¨ç¤ºï¼Œä»å®ç°ç±»æŒ‡å‘æ¥å£ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚åœ¨Javaä»£ç ä¸­ï¼Œå®ç°å…³ç³»å¯ä»¥ç›´æ¥ç¿»è¯‘ä¸ºå…³é”®å­— <code>implements</code>ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/12/02/ote80A.png" alt="image"></p>
<h4 id="3-2-2-æ³›åŒ–å…³ç³»"><a href="#3-2-2-æ³›åŒ–å…³ç³»" class="headerlink" title="3.2.2 æ³›åŒ–å…³ç³»"></a>3.2.2 æ³›åŒ–å…³ç³»</h4><p>æ³›åŒ–å…³ç³»ï¼ˆGeneralizationï¼‰æ˜¯æŒ‡å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ã€‚å¦‚æœå¯¹è±¡Aå’Œå¯¹è±¡Bä¹‹é—´çš„â€œis aâ€å…³ç³»æˆç«‹ï¼Œé‚£ä¹ˆäºŒè€…ä¹‹é—´å°±å­˜åœ¨ç»§æ‰¿å…³ç³»ï¼Œå¯¹è±¡Bæ˜¯çˆ¶å¯¹è±¡ï¼Œå¯¹è±¡Aæ˜¯å­å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¹´è–ªåˆ¶å‘˜å·¥â€œis aâ€å‘˜å·¥ï¼Œå¾ˆæ˜¾ç„¶å¹´è–ªåˆ¶å‘˜å·¥Salaryå¯¹è±¡å’Œå‘˜å·¥Employeeå¯¹è±¡ä¹‹é—´å­˜åœ¨ç»§æ‰¿å…³ç³»ï¼ŒEmployeeå¯¹è±¡æ˜¯çˆ¶å¯¹è±¡ï¼ŒSalaryå¯¹è±¡æ˜¯å­å¯¹è±¡ã€‚</p>
<p>åœ¨UMLç±»å›¾ä¸­ï¼Œæ³›åŒ–å…³ç³»ç”¨ç©ºå¿ƒä¸‰è§’å’Œå®çº¿ç»„æˆçš„ç®­å¤´è¡¨ç¤ºï¼Œä»å­ç±»æŒ‡å‘çˆ¶ç±»ï¼Œå¦‚å›¾8æ‰€ç¤ºã€‚åœ¨Javaä»£ç ä¸­ï¼Œå¯¹è±¡ä¹‹é—´çš„æ³›åŒ–å…³ç³»å¯ä»¥ç›´æ¥ç¿»è¯‘ä¸ºå…³é”®å­— <code>extends</code>ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/12/02/oter0s.png" alt="image"></p>
<h4 id="3-2-3-å…³è”å…³ç³»"><a href="#3-2-3-å…³è”å…³ç³»" class="headerlink" title="3.2.3 å…³è”å…³ç³»"></a>3.2.3 å…³è”å…³ç³»</h4><p>å…³è”å…³ç³»ï¼ˆAssociationï¼‰æ˜¯æŒ‡å¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´çš„è¿æ¥ï¼Œå®ƒä½¿ä¸€ä¸ªå¯¹è±¡çŸ¥é“å¦ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚åœ¨Javaä¸­ï¼Œå…³è”å…³ç³»çš„ä»£ç è¡¨ç°å½¢å¼ä¸ºä¸€ä¸ªå¯¹è±¡å«æœ‰å¦ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡çš„ç±»ä»£ç ä¸­ï¼ŒåŒ…å«æœ‰å¦ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´å°±æ˜¯å…³è”å…³ç³»ã€‚</p>
<p>å…³è”å…³ç³»æœ‰å•å‘å…³è”å’ŒåŒå‘å…³è”ã€‚å¦‚æœä¸¤ä¸ªå¯¹è±¡éƒ½çŸ¥é“ï¼ˆå³å¯ä»¥è°ƒç”¨ï¼‰å¯¹æ–¹çš„å…¬å…±å±æ€§å’Œæ“ä½œï¼Œé‚£ä¹ˆäºŒè€…å°±æ˜¯åŒå‘å…³è”ã€‚å¦‚æœåªæœ‰ä¸€ä¸ªå¯¹è±¡çŸ¥é“ï¼ˆå³å¯ä»¥è°ƒç”¨ï¼‰å¦ä¸€ä¸ªå¯¹è±¡çš„å…¬å…±å±æ€§å’Œæ“ä½œï¼Œé‚£ä¹ˆå°±æ˜¯å•å‘å…³è”ã€‚å¤§å¤šæ•°å…³è”éƒ½æ˜¯å•å‘å…³è”ï¼Œå•å‘å…³è”å…³ç³»æ›´å®¹æ˜“å»ºç«‹å’Œç»´æŠ¤ï¼Œæœ‰åŠ©äºå¯»æ‰¾å¯é‡ç”¨çš„ç±»ã€‚</p>
<p>åœ¨UMLå›¾ä¸­ï¼ŒåŒå‘å…³è”å…³ç³»ç”¨å¸¦åŒç®­å¤´çš„å®çº¿æˆ–è€…æ— ç®­å¤´çš„å®çº¿åŒçº¿è¡¨ç¤ºã€‚å•å‘å…³è”ç”¨ä¸€ä¸ªå¸¦ç®­å¤´çš„å®çº¿è¡¨ç¤ºï¼Œç®­å¤´æŒ‡å‘è¢«å…³è”çš„å¯¹è±¡ï¼Œå¦‚å›¾9æ‰€ç¤ºã€‚è¿™å°±æ˜¯å¯¼èˆªæ€§ï¼ˆNavigatityï¼‰ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/12/02/otehX4.png" alt="image"></p>
<p>ä¸€ä¸ªå¯¹è±¡å¯ä»¥æŒæœ‰å…¶å®ƒå¯¹è±¡çš„æ•°ç»„æˆ–è€…é›†åˆã€‚åœ¨UMLä¸­ï¼Œé€šè¿‡æ”¾ç½®å¤šé‡æ€§ï¼ˆmultipicityï¼‰è¡¨è¾¾å¼åœ¨å…³è”çº¿çš„æœ«ç«¯æ¥è¡¨ç¤ºã€‚å¤šé‡æ€§è¡¨è¾¾å¼å¯ä»¥æ˜¯ä¸€ä¸ªæ•°å­—ã€ä¸€æ®µèŒƒå›´æˆ–è€…æ˜¯å®ƒä»¬çš„ç»„åˆã€‚å¤šé‡æ€§å…è®¸çš„è¡¨è¾¾å¼ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ•°å­—ï¼šç²¾ç¡®çš„æ•°é‡</li>
<li><code>*</code>æˆ–è€…<code>0..*</code>ï¼šè¡¨ç¤º0åˆ°å¤šä¸ª</li>
<li><code>0..1</code>ï¼šè¡¨ç¤º0æˆ–è€…1ä¸ªï¼Œåœ¨Javaä¸­ç»å¸¸ç”¨ä¸€ä¸ªç©ºå¼•ç”¨æ¥å®ç°</li>
<li><code>1..*</code>ï¼šè¡¨ç¤º1åˆ°å¤šä¸ª</li>
</ul>
<p>å…³è”å…³ç³»åˆåˆ†ä¸ºä¾èµ–å…³è”ã€èšåˆå…³è”å’Œç»„åˆå…³è”ä¸‰ç§ç±»å‹ã€‚</p>
<h4 id="3-2-4-ä¾èµ–å…³ç³»"><a href="#3-2-4-ä¾èµ–å…³ç³»" class="headerlink" title="3.2.4 ä¾èµ–å…³ç³»"></a>3.2.4 ä¾èµ–å…³ç³»</h4><p>ä¾èµ–ï¼ˆDependencyï¼‰å…³ç³»æ˜¯ä¸€ç§å¼±å…³è”å…³ç³»ã€‚å¦‚æœå¯¹è±¡Aç”¨åˆ°å¯¹è±¡Bï¼Œä½†æ˜¯å’ŒBçš„å…³ç³»ä¸æ˜¯å¤ªæ˜æ˜¾çš„æ—¶å€™ï¼Œå°±å¯ä»¥æŠŠè¿™ç§å…³ç³»çœ‹ä½œæ˜¯ä¾èµ–å…³ç³»ã€‚å¦‚æœå¯¹è±¡Aä¾èµ–äºå¯¹è±¡Bï¼Œåˆ™ A â€œuse aâ€ Bã€‚æ¯”å¦‚é©¾é©¶å‘˜å’Œæ±½è½¦çš„å…³ç³»ï¼Œé©¾é©¶å‘˜ä½¿ç”¨æ±½è½¦ï¼ŒäºŒè€…ä¹‹é—´å°±æ˜¯ä¾èµ–å…³ç³»ã€‚</p>
<p>åœ¨ UML ç±»å›¾ä¸­ï¼Œä¾èµ–å…³ç³»ç”¨ä¸€ä¸ªå¸¦è™šçº¿çš„ç®­å¤´è¡¨ç¤ºï¼Œç”±ä½¿ç”¨æ–¹æŒ‡å‘è¢«ä½¿ç”¨æ–¹ï¼Œè¡¨ç¤ºä½¿ç”¨æ–¹å¯¹è±¡æŒæœ‰è¢«ä½¿ç”¨æ–¹å¯¹è±¡çš„å¼•ç”¨ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://z3.ax1x.com/2021/12/02/otmyKe.png" alt="image"></p>
<p>ä¾èµ–å…³ç³»åœ¨Javaä¸­çš„å…·ä½“ä»£ç è¡¨ç°å½¢å¼ä¸º<strong>Bä¸ºAçš„æ„é€ å™¨</strong>æˆ–<strong>æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡</strong>ã€<strong>æ–¹æ³•æˆ–æ„é€ å™¨çš„å‚æ•°</strong>ã€<strong>æ–¹æ³•çš„è¿”å›å€¼</strong>ï¼Œæˆ–è€…<strong>Aè°ƒç”¨Bçš„é™æ€æ–¹æ³•</strong>ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬ç”¨ä»£ç æ¸…å•1å’Œä»£ç æ¸…å•2æ‰€ç¤ºçš„Javaä»£ç æ¥æ¼”ç¤ºå¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p>
<p>ä»£ç æ¸…å•1æ‰€ç¤ºçš„<code>B</code>ç±»å®šä¹‰äº†ä¸€ä¸ªæˆå‘˜å˜é‡ <code>field1</code>ï¼Œä¸€ä¸ªæ™®é€šæ–¹æ³• <code>method1()</code> å’Œä¸€ä¸ªé™æ€æ–¹æ³• <code>method2()</code>ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">//ä»£ç æ¸…å•1 B.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>{</span><br><span class="line">  <span class="keyword">public</span> String field1;   <span class="comment">//æˆå‘˜å˜é‡</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span> </span>{</span><br><span class="line">    System.println(<span class="string">"åœ¨ç±»Bçš„æ–¹æ³•1ä¸­"</span>);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span> </span>{                 <span class="comment">//é™æ€æ–¹æ³•</span></span><br><span class="line">    System.out.println(<span class="string">"åœ¨ç±»Bçš„é™æ€æ–¹æ³•2ä¸­"</span>);</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä»£ç æ¸…å•2æ‰€ç¤ºçš„<code>A</code>ç±»ä¾èµ–äº<code>B</code>ç±»ï¼Œåœ¨<code>A</code>ç±»ä¸­å®šä¹‰äº†å››ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«æ¼”ç¤ºå››ç§ä¾èµ–å½¢å¼ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/* ä»£ç æ¸…å•2 A.java</span></span><br><span class="line"><span class="comment">  Aä¾èµ–äºB</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>{</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method1</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">//Aä¾èµ–äºBçš„ç¬¬ä¸€ç§è¡¨ç°å½¢å¼ï¼šBä¸ºAçš„å±€éƒ¨å˜é‡</span></span><br><span class="line">    B b = <span class="keyword">new</span> B();</span><br><span class="line">    b.method1();</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method2</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">//Aä¾èµ–äºBçš„ç¬¬äºŒç§è¡¨ç°å½¢å¼ï¼š è°ƒç”¨Bçš„é™æ€æ–¹æ³•</span></span><br><span class="line">    B.method2();</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method3</span><span class="params">(B b)</span>  </span>{</span><br><span class="line">    <span class="comment">//Aä¾èµ–äºBçš„ç¬¬ä¸‰ç§è¡¨ç°å½¢å¼ï¼šBä½œä¸ºAçš„æ–¹æ³•å‚æ•°</span></span><br><span class="line">    String s = b.field1;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Aä¾èµ–äºBçš„ç¬¬å››ç§è¡¨ç°å½¢å¼ï¼šBä½œä¸ºAçš„æ–¹æ³•çš„è¿”å›å€¼</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> B <span class="title">method4</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> B();</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="3-2-5-èšåˆå…³ç³»"><a href="#3-2-5-èšåˆå…³ç³»" class="headerlink" title="3.2.5 èšåˆå…³ç³»"></a>3.2.5 èšåˆå…³ç³»</h4><p>èšåˆï¼ˆAggregationï¼‰æ˜¯å…³è”å…³ç³»çš„ä¸€ç§ç‰¹ä¾‹ï¼Œå®ƒä½“ç°çš„æ˜¯æ•´ä½“ä¸éƒ¨åˆ†çš„æ‹¥æœ‰å…³ç³»ï¼Œå³ â€œhas aâ€ çš„å…³ç³»ã€‚æ­¤æ—¶æ•´ä½“ä¸éƒ¨åˆ†ä¹‹é—´æ˜¯å¯åˆ†ç¦»çš„ï¼Œå®ƒä»¬å¯ä»¥å…·æœ‰å„è‡ªçš„ç”Ÿå‘½å‘¨æœŸï¼Œéƒ¨åˆ†å¯ä»¥å±äºå¤šä¸ªæ•´ä½“å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ä¸ºå¤šä¸ªæ•´ä½“å¯¹è±¡å…±äº«ï¼Œæ‰€ä»¥èšåˆå…³ç³»ä¹Ÿå¸¸ç§°ä¸ºå…±äº«å…³ç³»ã€‚ä¾‹å¦‚ï¼Œå…¬å¸éƒ¨é—¨ä¸å‘˜å·¥çš„å…³ç³»ï¼Œä¸€ä¸ªå‘˜å·¥å¯ä»¥å±äºå¤šä¸ªéƒ¨é—¨ï¼Œä¸€ä¸ªéƒ¨é—¨æ’¤æ¶ˆäº†ï¼Œå‘˜å·¥å¯ä»¥è½¬åˆ°å…¶å®ƒéƒ¨é—¨ã€‚</p>
<p>åœ¨UMLå›¾ä¸­ï¼Œèšåˆå…³ç³»ç”¨ç©ºå¿ƒè±å½¢åŠ å®çº¿ç®­å¤´è¡¨ç¤ºï¼Œç©ºå¿ƒè±å½¢åœ¨æ•´ä½“ä¸€æ–¹ï¼Œç®­å¤´æŒ‡å‘éƒ¨åˆ†ä¸€æ–¹ï¼Œå¦‚å›¾11æ‰€ç¤ºã€‚</p>
<p><img src="https://z3.ax1x.com/2021/12/02/otmx2T.png" alt="image"></p>
<h4 id="3-2-6-ç»„åˆå…³ç³»"><a href="#3-2-6-ç»„åˆå…³ç³»" class="headerlink" title="3.2.6 ç»„åˆå…³ç³»"></a>3.2.6 ç»„åˆå…³ç³»</h4><p>ç»„åˆï¼ˆCompositionï¼‰ä¹Ÿæ˜¯å…³è”å…³ç³»çš„ä¸€ç§ç‰¹ä¾‹ï¼Œå®ƒåŒæ ·ä½“ç°æ•´ä½“ä¸éƒ¨åˆ†é—´çš„åŒ…å«å…³ç³»ï¼Œå³ â€œcontains aâ€ çš„å…³ç³»ã€‚ä½†æ­¤æ—¶æ•´ä½“ä¸éƒ¨åˆ†æ˜¯ä¸å¯åˆ†çš„ï¼Œéƒ¨åˆ†ä¹Ÿä¸èƒ½ç»™å…¶å®ƒæ•´ä½“å…±äº«ï¼Œä½œä¸ºæ•´ä½“çš„å¯¹è±¡è´Ÿè´£éƒ¨åˆ†çš„å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™ç§å…³ç³»æ¯”èšåˆæ›´å¼ºï¼Œä¹Ÿç§°ä¸ºå¼ºèšåˆã€‚å¦‚æœ<code>A</code>ç»„åˆ<code>B</code>ï¼Œåˆ™<code>A</code>éœ€è¦çŸ¥é“<code>B</code>çš„ç”Ÿå­˜å‘¨æœŸï¼Œå³å¯èƒ½<code>A</code>è´Ÿè´£ç”Ÿæˆæˆ–è€…é‡Šæ”¾<code>B</code>ï¼Œæˆ–è€…<code>A</code>é€šè¿‡æŸç§é€”å¾„çŸ¥é“<code>B</code>çš„ç”Ÿæˆå’Œé‡Šæ”¾ã€‚</p>
<p>ä¾‹å¦‚ï¼ŒäººåŒ…å«å¤´ã€èº¯å¹²ã€å››è‚¢ï¼Œå®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´ã€‚å½“äººå‡ºç”Ÿæ—¶ï¼Œå¤´ã€èº¯å¹²ã€å››è‚¢åŒæ—¶è¯ç”Ÿã€‚å½“äººæ­»äº¡æ—¶ï¼Œä½œä¸ºäººä½“ç»„æˆéƒ¨åˆ†çš„å¤´ã€èº¯å¹²ã€å››è‚¢åŒæ—¶æ­»äº¡ã€‚</p>
<p>åœ¨UMLå›¾ä¸­ï¼Œç»„åˆå…³ç³»ç”¨å®å¿ƒè±å½¢åŠ å®çº¿ç®­å¤´è¡¨ç¤ºï¼Œå®å¿ƒè±å½¢åœ¨æ•´ä½“ä¸€æ–¹ï¼Œç®­å¤´æŒ‡å‘éƒ¨åˆ†ä¸€æ–¹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/12/02/otniZ9.png" alt="image"></p>
<p>åœ¨Javaä»£ç å½¢å¼ä¸Šï¼Œèšåˆå’Œç»„åˆå…³ç³»ä¸­çš„éƒ¨åˆ†å¯¹è±¡æ˜¯æ•´ä½“å¯¹è±¡çš„ä¸€ä¸ªæˆå‘˜å˜é‡ã€‚ä½†æ˜¯ï¼Œåœ¨å®é™…åº”ç”¨å¼€å‘æ—¶ï¼Œä¸¤ä¸ªå¯¹è±¡ä¹‹é—´çš„å…³ç³»åˆ°åº•æ˜¯èšåˆè¿˜æ˜¯ç»„åˆï¼Œæœ‰æ—¶å€™å¾ˆéš¾åŒºåˆ«ã€‚åœ¨Javaä¸­ï¼Œä»…ä»ç±»ä»£ç æœ¬èº«æ˜¯åŒºåˆ†ä¸äº†èšåˆå’Œç»„åˆçš„ã€‚å¦‚æœä¸€å®šè¦åŒºåˆ†ï¼Œé‚£ä¹ˆå¦‚æœåœ¨åˆ é™¤æ•´ä½“å¯¹è±¡çš„æ—¶å€™ï¼Œå¿…é¡»åˆ æ‰éƒ¨åˆ†å¯¹è±¡ï¼Œé‚£ä¹ˆå°±æ˜¯ç»„åˆå…³ç³»ï¼Œå¦åˆ™å¯èƒ½å°±æ˜¯èšåˆå…³ç³»ã€‚ä»ä¸šåŠ¡è§’åº¦ä¸Šæ¥çœ‹ï¼Œå¦‚æœä½œä¸ºæ•´ä½“çš„å¯¹è±¡å¿…é¡»è¦éƒ¨åˆ†å¯¹è±¡çš„å‚ä¸ï¼Œæ‰èƒ½å®Œæˆè‡ªå·±çš„èŒè´£ï¼Œé‚£ä¹ˆäºŒè€…ä¹‹é—´å°±æ˜¯ç»„åˆå…³ç³»ï¼Œå¦åˆ™å°±æ˜¯èšåˆå…³ç³»ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæ±½è½¦ä¸è½®èƒï¼Œæ±½è½¦ä½œä¸ºæ•´ä½“ï¼Œè½®èƒä½œä¸ºéƒ¨åˆ†ã€‚å¦‚æœç”¨åœ¨äºŒæ‰‹è½¦é”€å”®ä¸šåŠ¡ç¯å¢ƒä¸‹ï¼ŒäºŒè€…ä¹‹é—´å°±æ˜¯èšåˆå…³ç³»ã€‚å› ä¸ºè½®èƒä½œä¸ºæ±½è½¦çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ï¼Œå®ƒå’Œæ±½è½¦å¯ä»¥åˆ†åˆ«ç”Ÿäº§ä»¥åè£…é…èµ·æ¥ä½¿ç”¨ï¼Œä½†æ±½è½¦å¯ä»¥æ¢æ–°è½®èƒï¼Œè½®èƒä¹Ÿå¯ä»¥å¸ä¸‹æ¥ç»™å…¶å®ƒæ±½è½¦ä½¿ç”¨ã€‚å¦‚æœç”¨åœ¨é©¾é©¶ç³»ç»Ÿä¸šåŠ¡ç¯å¢ƒä¸Šï¼Œæ±½è½¦å¦‚æœæ²¡æœ‰è½®èƒï¼Œå°±æ— æ³•å®Œæˆè¡Œé©¶ä»»åŠ¡ï¼ŒäºŒè€…ä¹‹é—´å°±æ˜¯ä¸€ä¸ªç»„åˆå…³ç³»ã€‚å†æ¯”å¦‚ç½‘ä¸Šä¹¦åº—ä¸šåŠ¡ä¸­çš„è®¢å•å’Œè®¢å•é¡¹ä¹‹é—´çš„å…³ç³»ï¼Œå¦‚æœè®¢å•æ²¡æœ‰è®¢å•é¡¹ï¼Œä¹Ÿå°±æ— æ³•å®Œæˆè®¢å•çš„ä¸šåŠ¡ï¼Œæ‰€ä»¥äºŒè€…ä¹‹é—´æ˜¯ç»„åˆå…³ç³»ã€‚è€Œè´­ç‰©è½¦å’Œå•†å“ä¹‹é—´çš„å…³ç³»ï¼Œå› ä¸ºå•†å“çš„ç”Ÿå‘½å‘¨æœŸå¹¶ä¸è¢«è´­ç‰©è½¦æ§åˆ¶ï¼Œå•†å“å¯ä»¥è¢«å¤šä¸ªè´­ç‰©è½¦å…±äº«ï¼Œå› æ­¤ï¼ŒäºŒè€…ä¹‹é—´æ˜¯èšåˆå…³ç³»ã€‚</p>
<p><br></p>
<h2 id="4-è®¾è®¡æ¨¡å¼è¯¦è§£"><a href="#4-è®¾è®¡æ¨¡å¼è¯¦è§£" class="headerlink" title="4. è®¾è®¡æ¨¡å¼è¯¦è§£"></a>4. è®¾è®¡æ¨¡å¼è¯¦è§£</h2><p>è®¾è®¡æ¨¡å¼æ˜¯ç¨‹åºå‘˜åœ¨é¢å¯¹åŒç±»è½¯ä»¶å·¥ç¨‹è®¾è®¡é—®é¢˜æ‰€æ€»ç»“å‡ºæ¥çš„æœ‰ç”¨çš„ç»éªŒï¼Œ<strong>æ¨¡å¼ä¸æ˜¯ä»£ç </strong>ï¼Œè€Œæ˜¯<strong>æŸç±»é—®é¢˜çš„é€šç”¨è§£å†³æ–¹æ³•</strong>ï¼Œç±»ä¼¼äºç®—æ³•ã€‚è®¾è®¡æ¨¡å¼ä»£è¡¨äº†æœ€ä½³çš„å®è·µï¼Œè¿™æ˜¯ä¼—å¤šè½¯ä»¶å¼€å‘äººå‘˜åœ¨ç»è¿‡ç›¸å½“é•¿çš„ä¸€æ®µæ—¶é—´çš„è¯•éªŒå’Œé”™è¯¯æ€»ç»“å‡ºæ¥çš„ã€‚</p>
<p>è®¾è®¡æ¨¡å¼çš„æœ¬æ„æ˜¯æé«˜ <strong>è½¯ä»¶çš„ç»´æŠ¤æ€§ï¼Œé€šç”¨æ€§å’Œæ‰©å±•æ€§ï¼Œå¹¶é™ä½è½¯ä»¶çš„å¤æ‚åº¦ã€‚</strong></p>
<p>è®¾è®¡æ¨¡å¼å¹¶ä¸å±€é™äºæŸç§è¯­è¨€ï¼Œjavaï¼Œphpï¼Œc++ éƒ½æœ‰è®¾è®¡æ¨¡å¼ã€‚</p>
<h3 id="4-1-è®¾è®¡æ¨¡å¼ç±»å‹"><a href="#4-1-è®¾è®¡æ¨¡å¼ç±»å‹" class="headerlink" title="4.1 è®¾è®¡æ¨¡å¼ç±»å‹"></a>4.1 è®¾è®¡æ¨¡å¼ç±»å‹</h3><p>è®¾è®¡æ¨¡å¼åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼Œå…±23ä¸ªã€‚</p>
<ol>
<li><strong>åˆ›å»ºå‹æ¨¡å¼ï¼š</strong>å•ä¾‹æ¨¡å¼ã€æŠ½è±¡å·¥å‚æ¨¡å¼ã€åŸå‹æ¨¡å¼ã€å»ºé€ è€…æ¨¡å¼ã€å·¥å‚æ¨¡å¼ã€‚</li>
<li><strong>ç»“æ„å‹æ¨¡å¼</strong>ï¼šé€‚é…å™¨æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ã€è£…é¥°æ¨¡å¼ã€ç»„åˆæ¨¡å¼ã€å¤–è§‚æ¨¡å¼ã€äº«å…ƒæ¨¡å¼ã€ä»£ç†æ¨¡å¼ã€‚</li>
<li><strong>è¡Œä¸ºå‹æ¨¡å¼</strong>ï¼šæ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ã€è®¿é—®è€…æ¨¡å¼ã€è¿­ä»£å™¨æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€ä¸­ä»‹è€…æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ã€çŠ¶æ€æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€èŒè´£é“¾æ¨¡å¼ã€‚</li>
</ol>
<h3 id="4-2-å•ä¾‹æ¨¡å¼"><a href="#4-2-å•ä¾‹æ¨¡å¼" class="headerlink" title="4.2 å•ä¾‹æ¨¡å¼"></a>4.2 å•ä¾‹æ¨¡å¼</h3><p>å•ä¾‹æ¨¡å¼ï¼Œå°±æ˜¯é‡‡å–ä¸€å®šçš„æ–¹æ³•ä¿è¯<strong>åœ¨æ•´ä¸ªè½¯ä»¶ç³»ç»Ÿä¸­ï¼Œå¯¹æŸä¸ªç±»åªèƒ½å­˜åœ¨ä¸€ä¸ªå¯¹è±¡å®ä¾‹</strong>ï¼Œé¢‘ç¹åˆ›å»ºé”€æ¯ä¼šæ¶ˆè€—å¤§é‡èµ„æºï¼å¹¶ä¸”è¯¥ç±»åªæä¾›ä¸€ä¸ªå–å¾—å…¶å¯¹è±¡å®ä¾‹çš„æ–¹æ³•ï¼ˆé™æ€æ–¹æ³•ï¼‰ã€‚</p>
<p>è€Œå•ä¾‹æ¨¡å¼çš„å®ç°æ–¹æ³•è¶³è¶³æœ‰8ç§ä¹‹å¤šï¼Œä¸‹é¢å°±ä¸€ä¸€è®²è§£ã€‚</p>
<h4 id="4-2-1-é¥¿æ±‰å¼ï¼ˆé™æ€å¸¸é‡ï¼‰"><a href="#4-2-1-é¥¿æ±‰å¼ï¼ˆé™æ€å¸¸é‡ï¼‰" class="headerlink" title="4.2.1 é¥¿æ±‰å¼ï¼ˆé™æ€å¸¸é‡ï¼‰"></a>4.2.1 é¥¿æ±‰å¼ï¼ˆé™æ€å¸¸é‡ï¼‰</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton1</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Test1 test1 = Test1.getInstance();</span><br><span class="line">        Test1 test2 = Test1.getInstance();</span><br><span class="line">        System.out.println(test1.hashCode());</span><br><span class="line">        System.out.println(test2.hashCode());</span><br><span class="line">        System.out.println(test1 == test2);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test1</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Test1 test = <span class="keyword">new</span> Test1();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç§æœ‰çš„æ„é€ æ–¹æ³•å¾ˆé‡è¦ï¼å¯ä»¥é˜²æ­¢å¤–éƒ¨åˆ›å»ºå¯¹è±¡ï¼</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Test1</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Test1 <span class="title">getInstance</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> test;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>è¿™ç§å†™æ³•æ¯”è¾ƒç®€å•</li>
<li>åœ¨ç±»è£…è½½çš„æ—¶å€™ä¾¿å®Œæˆäº†å®ä¾‹åŒ–ï¼Œé¿å…äº†çº¿ç¨‹åŒæ­¥çš„é—®é¢˜ã€‚</li>
<li>çº¿ç¨‹å®‰å…¨</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ä¹Ÿæ­£æ˜¯å› ä¸ºåœ¨ç±»è£…è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹åŒ–ï¼Œå› æ­¤æ— æ³•å®ç°æ‡’åŠ è½½çš„æ•ˆæœã€‚</li>
<li>å¦‚æœè‡ªå§‹è‡³ç»ˆéƒ½æ²¡æœ‰ä½¿ç”¨è¿‡è¿™ä¸ªå®ä¾‹ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆå†…å­˜çš„æµªè´¹ã€‚</li>
</ul>
<p>ç»“è®ºï¼šè¿™ç§å•ä¾‹æ¨¡å¼å¯ä»¥ä½¿ç”¨ï¼Œä½†å¯èƒ½ä¼šé€ æˆå†…å­˜æµªè´¹ã€‚</p>
<h4 id="4-2-2-é¥¿æ±‰å¼ï¼ˆé™æ€ä»£ç å—ï¼‰"><a href="#4-2-2-é¥¿æ±‰å¼ï¼ˆé™æ€ä»£ç å—ï¼‰" class="headerlink" title="4.2.2 é¥¿æ±‰å¼ï¼ˆé™æ€ä»£ç å—ï¼‰"></a>4.2.2 é¥¿æ±‰å¼ï¼ˆé™æ€ä»£ç å—ï¼‰</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test2</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Test2 test;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Test2</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é™æ€ä»£ç å—</span></span><br><span class="line">    <span class="keyword">static</span> {</span><br><span class="line">        test = <span class="keyword">new</span> Test2();</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Test2 <span class="title">getInstance</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> test;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>åŒä¸Šä¸è§£é‡Šï¼Œä»…ä»…æ˜¯å°†ç±»çš„å®ä¾‹åŒ–æ”¾åœ¨äº†é™æ€ä»£ç å—ä¸­ã€‚</p>
<h4 id="4-2-3-æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰"><a href="#4-2-3-æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰" class="headerlink" title="4.2.3 æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰"></a>4.2.3 æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test3</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Test3 test;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Test3</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Test3 <span class="title">getInstance</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (test == <span class="keyword">null</span>) {</span><br><span class="line">            test = <span class="keyword">new</span> Test3();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> test;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å®ç°äº†æ‡’åŠ è½½çš„æ•ˆæœï¼Œé¿å…äº†ç©ºé—´æµªè´¹ã€‚</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li><p>å¦‚æœåœ¨å¤šçº¿ç¨‹ä¸­ï¼Œå¯èƒ½ä¼š<strong>äº§ç”Ÿå¤šä¸ªå®ä¾‹</strong>ï¼</p>
</li>
<li><p>çº¿ç¨‹ä¸å®‰å…¨</p>
</li>
</ul>
<p>ç»“è®ºï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œ<code>ä¸èƒ½ä½¿ç”¨</code>è¿™ç§æ–¹å¼ï¼</p>
<h4 id="4-2-4-æ‡’æ±‰å¼ï¼ˆåŒæ­¥æ–¹æ³•ï¼‰"><a href="#4-2-4-æ‡’æ±‰å¼ï¼ˆåŒæ­¥æ–¹æ³•ï¼‰" class="headerlink" title="4.2.4 æ‡’æ±‰å¼ï¼ˆåŒæ­¥æ–¹æ³•ï¼‰"></a>4.2.4 æ‡’æ±‰å¼ï¼ˆåŒæ­¥æ–¹æ³•ï¼‰</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test4</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Test4 test;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Test4</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Test4 <span class="title">getInstance</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (test == <span class="keyword">null</span>) {</span><br><span class="line">            test = <span class="keyword">new</span> Test4();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> test;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>å¯¹æ¯”ä¸Šè¿°å®ç°ï¼Œåªæ˜¯åœ¨æ–¹æ³•å‰æ·»åŠ äº† <code>synchronized</code> ä¿®é¥°ï¼Œä¾¿å¯ä»¥è§£å†³çº¿ç¨‹ä¸å®‰å…¨çš„é—®é¢˜ã€‚</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li><p>åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œå¿…é¡»è¦ç­‰å‰é¢ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œè¯¥æ–¹æ³•ï¼Œæ‰èƒ½è½®åˆ°åé¢çš„çº¿ç¨‹ã€‚</p>
</li>
<li><p>æ•ˆç‡æå…¶ä½ä¸‹ï¼</p>
</li>
</ul>
<p>ç»“è®ºï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œ<strong>ä¸æ¨è</strong>ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚</p>
<h4 id="4-25-æ‡’æ±‰å¼ï¼ˆåŒæ­¥ä»£ç å—ï¼‰"><a href="#4-25-æ‡’æ±‰å¼ï¼ˆåŒæ­¥ä»£ç å—ï¼‰" class="headerlink" title="4.25 æ‡’æ±‰å¼ï¼ˆåŒæ­¥ä»£ç å—ï¼‰"></a>4.25 æ‡’æ±‰å¼ï¼ˆåŒæ­¥ä»£ç å—ï¼‰</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test5</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Test5 test;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Test5</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Test5 <span class="title">getInstance</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (test == <span class="keyword">null</span>) {</span><br><span class="line">            <span class="keyword">synchronized</span> (Test5.class){</span><br><span class="line">                test = <span class="keyword">new</span> Test5();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> test;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™ä¸ª <code>synchronized</code> å®Œå…¨æ²¡æœ‰ç”¨ï¼</p>
<p>å› æ­¤ä¼˜ç¼ºç‚¹å’Œ <strong>4.2.3 æ‡’æ±‰å¼</strong> ä¸€æ ·ï¼Œç”šè‡³å› ä¸ºåŠ äº†åŒæ­¥é”ï¼Œæ€§èƒ½è¿˜æ›´å·®äº†ï¼</p>
<p>ç»“è®ºï¼šçæï¼</p>
<h4 id="4-2-6-æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æŸ¥ï¼‰"><a href="#4-2-6-æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æŸ¥ï¼‰" class="headerlink" title="4.2.6 æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æŸ¥ï¼‰"></a>4.2.6 æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æŸ¥ï¼‰</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test6</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Test6 test;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Test6</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Test6 <span class="title">getInstance</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (test == <span class="keyword">null</span>) {</span><br><span class="line">            <span class="keyword">synchronized</span> (Test6.class){</span><br><span class="line">                <span class="keyword">if</span> (test == <span class="keyword">null</span>){</span><br><span class="line">                    test = <span class="keyword">new</span> Test6();</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> test;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Double-Check æ¦‚å¿µæ˜¯å¤šçº¿ç¨‹å¼€å‘ä¸­å¸¸ä½¿ç”¨åˆ°çš„ï¼Œå¦‚ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬è¿›è¡Œäº†ä¸¤ä¸ª <strong>if(test == null)</strong> çš„æ£€æŸ¥ï¼Œè¿™æ ·å°±èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨äº†ã€‚</p>
<p>è¿™æ ·ï¼Œå®ä¾‹åŒ–ä»£ç ä¹Ÿåªæ‰§è¡Œäº†ä¸€æ¬¡ï¼Œåç»­è®¿é—®æ—¶ï¼Œåˆ¤æ–­ <strong>test != null</strong>ï¼Œä¾¿ä¼šç›´æ¥ return å®ä¾‹åŒ–å¯¹è±¡ï¼Œä¹Ÿé¿å…äº†åå¤è¿›è¡Œæ–¹æ³•åŒæ­¥ã€‚</p>
<p><code>volatile</code> è²Œä¼¼æ˜¯ä¸ºäº†è§£å†³æŒ‡ä»¤é‡æ‹çš„é—®é¢˜ï¼Œç­‰åç»­æˆ‘å­¦äº† <strong>JUC</strong> å†å›æ¥ç ”ç©¶ç ”ç©¶ã€‚</p>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>çº¿ç¨‹å®‰å…¨</li>
<li>å®ç°æ‡’åŠ è½½</li>
<li>æ•ˆç‡è¾ƒé«˜</li>
</ul>
<p>ç»“è®ºï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œ<code>æ¨èä½¿ç”¨</code>è¿™ç§å•ä¾‹æ¨¡å¼å®ç°æ–¹å¼ï¼</p>
<h4 id="4-2-7-é™æ€å†…éƒ¨ç±»"><a href="#4-2-7-é™æ€å†…éƒ¨ç±»" class="headerlink" title="4.2.7 é™æ€å†…éƒ¨ç±»"></a>4.2.7 é™æ€å†…éƒ¨ç±»</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test7</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Test7</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Test7 <span class="title">getInstance</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> StaticInnerClass.test;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">StaticInnerClass</span></span>{</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Test7 test = <span class="keyword">new</span> Test7();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™ç§æ–¹å¼é‡‡ç”¨äº†ç±»è£…è½½çš„æœºåˆ¶æ¥ä¿è¯åˆå§‹åŒ–å®ä¾‹æ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚</p>
<p>é™æ€å†…éƒ¨ç±»æ–¹å¼ <strong>StaticInnerClass</strong> åœ¨ <strong>Test7</strong> è¢«è£…è½½æ—¶å¹¶ä¸ä¼šç«‹åˆ»å®ä¾‹åŒ–ï¼Œè€Œæ˜¯åœ¨éœ€è¦å®ä¾‹åŒ–æ—¶ï¼Œè°ƒç”¨ <strong>getInstance</strong> æ–¹æ³•ï¼Œè¿™æ—¶æ‰å¼€å§‹è£…è½½ <strong>StaticInnerClass</strong> ç±»ï¼Œä»è€Œå®Œæˆ Test7 çš„å®ä¾‹åŒ–ã€‚</p>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>é¿å…äº†çº¿ç¨‹ä¸å®‰å…¨ã€‚</li>
<li>åˆ©ç”¨é™æ€å†…éƒ¨ç±»çš„ç‰¹ç‚¹å®ç°å»¶è¿ŸåŠ è½½ï¼Œæ•ˆç‡é«˜ã€‚</li>
</ul>
<p>ç»“è®ºï¼š<code>æ¨è</code>ä½¿ç”¨ï¼</p>
<h4 id="4-2-8-æšä¸¾"><a href="#4-2-8-æšä¸¾" class="headerlink" title="4.2.8 æšä¸¾"></a>4.2.8 æšä¸¾</h4><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Test8</span> </span>{</span><br><span class="line">    test8;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>è¿™æ˜¯å€ŸåŠ© JDK1.5 ä¸­æ·»åŠ çš„æšä¸¾æ¥å®ç°å•ä¾‹æ¨¡å¼ï¼Œé¿å…äº†å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ã€‚</li>
<li><p>é˜²æ­¢ååºåˆ—åŒ–é‡æ–°åˆ›å»ºå¯¹è±¡ã€‚</p>
</li>
<li><p><strong>Effective Java</strong> ä½œè€… <strong>Josh Bloch</strong> æ‰€æå€¡çš„æ–¹å¼ã€‚</p>
</li>
</ul>
<p>ç»“è®ºï¼š<code>æ¨è</code>ä½¿ç”¨ï¼</p>
<h4 id="4-2-9-å•ä¾‹æ¨¡å¼åœ¨-JDK-ä¸­çš„åº”ç”¨"><a href="#4-2-9-å•ä¾‹æ¨¡å¼åœ¨-JDK-ä¸­çš„åº”ç”¨" class="headerlink" title="4.2.9 å•ä¾‹æ¨¡å¼åœ¨ JDK ä¸­çš„åº”ç”¨"></a>4.2.9 å•ä¾‹æ¨¡å¼åœ¨ JDK ä¸­çš„åº”ç”¨</h4><p>åœ¨ JDK ä¸­ï¼ŒRuntime å°±æ˜¯å…¸å‹çš„å•ä¾‹æ¨¡å¼ï¼Œè¿˜æ˜¯é¥¿æ±‰å¼çš„ï¼æ¯•ç«Ÿç¨‹åºè¿è¡Œè‚¯å®šä¼šæœ‰æŠ¥è¿è¡Œæ—¶å¼‚å¸¸çš„æ—¶å€™ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/12/03/oUPJH0.png" alt="image"></p>
<h4 id="4-2-10-å°ç»“"><a href="#4-2-10-å°ç»“" class="headerlink" title="4.2.10 å°ç»“"></a>4.2.10 å°ç»“</h4><ol>
<li>å•ä¾‹æ¨¡å¼ä¿è¯äº†ç³»ç»Ÿå†…å­˜ä¸­è¯¥ç±»åªå­˜åœ¨ä¸€ä¸ªå¯¹è±¡ï¼ŒèŠ‚çœäº†ç³»ç»Ÿèµ„æºï¼Œå¯¹äºä¸€äº›éœ€è¦é¢‘ç¹åˆ›å»ºé”€æ¯çš„å¯¹è±¡ï¼Œä½¿ç”¨å•ä¾‹æ¨¡å¼å¯ä»¥æé«˜ç³»ç»Ÿæ€§èƒ½ã€‚</li>
<li>æƒ³è¦å®ä¾‹åŒ–å•ä¾‹ç±»çš„æ—¶å€™ï¼Œè¦ä½¿ç”¨è·å–å¯¹è±¡çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ <strong>new</strong>ï¼</li>
<li>åˆ›å»ºå•ä¾‹ç±»çš„æ—¶å€™ï¼Œå¿…é¡»è¦å°†æ„é€ æ–¹æ³•ç§æœ‰åŒ–ï¼ï¼ï¼</li>
<li>å•ä¾‹æ¨¡å¼ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦é¢‘ç¹è¿›è¡Œåˆ›å»ºé”€æ¯çš„å¯¹è±¡ã€åˆ›å»ºå¯¹è±¡æ—¶è€—æ—¶è¿‡å¤šæˆ–è€—è´¹èµ„æºè¿‡å¤šï¼Œä½†åˆç»å¸¸ç”¨åˆ°çš„å¯¹è±¡ï¼ˆå·¥å…·ç±»å¯¹è±¡ï¼‰ä»¥åŠé¢‘ç¹è®¿é—®æ•°æ®åº“æˆ–æ–‡ä»¶çš„å¯¹è±¡ï¼ˆæ•°æ®æºã€session å·¥å‚ï¼‰ã€‚</li>
</ol>
<h3 id="4-3-å·¥å‚æ¨¡å¼"><a href="#4-3-å·¥å‚æ¨¡å¼" class="headerlink" title="4.3 å·¥å‚æ¨¡å¼"></a>4.3 å·¥å‚æ¨¡å¼</h3><h4 id="4-3-1-å¼€ä¸€å®¶æŠ«è¨åº—ï¼"><a href="#4-3-1-å¼€ä¸€å®¶æŠ«è¨åº—ï¼" class="headerlink" title="4.3.1 å¼€ä¸€å®¶æŠ«è¨åº—ï¼"></a>4.3.1 å¼€ä¸€å®¶æŠ«è¨åº—ï¼</h4><p>å…ˆæ¥çœ‹ä¸€ä¸ªæŠ«è¨çš„é¡¹ç›®</p>
<p>1ï¼‰ æŠ«è¨çš„ç§ç±»æœ‰å¾ˆå¤šï¼ˆæ¯”å¦‚ GreekPizzaã€CheesePizza ç­‰ï¼‰</p>
<p>2ï¼‰ æŠ«è¨çš„åˆ¶ä½œæµç¨‹æœ‰ prepareï¼Œbakeï¼Œcutï¼Œbox</p>
<p>3ï¼‰ å®ŒæˆæŠ«è¨åº—è®¢è´­åŠŸèƒ½</p>
<p><br></p>
<p><strong>ä¼ ç»Ÿä»£ç å¦‚ä¸‹</strong>ï¼ŒæŠ«è¨åŸºç±»ä»¥åŠå®ƒçš„å®ç°ç±»ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Pizza</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Pizza</span><span class="params">(String name)</span></span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"å‡†å¤‡"</span> + name + <span class="string">"æŠ«è¨çš„åŸææ–™..."</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"çƒ˜çƒ¤"</span> + name + <span class="string">"æŠ«è¨..."</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cut</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"åˆ‡å‰²"</span> + name + <span class="string">"æŠ«è¨..."</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">box</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"æ‰“åŒ…"</span> + name + <span class="string">"æŠ«è¨..."</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreekPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GreekPizza</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">"å¸Œè…Š"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CheesePizza</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">"å¥¶é…ª"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PepperPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PepperPizza</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">"èƒ¡æ¤’"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æŠ«è¨åº—ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">orderPizza</span><span class="params">(String name)</span></span>{</span><br><span class="line">        Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (name){</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¸Œè…Š"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> GreekPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¥¶é…ª"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> CheesePizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"èƒ¡æ¤’"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> PepperPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (pizza == <span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        }</span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        PizzaStore pizzaStore = <span class="keyword">new</span> PizzaStore();</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>){</span><br><span class="line">            String name = sc.nextLine();</span><br><span class="line">            Pizza pizza = pizzaStore.orderPizza(name);</span><br><span class="line">            <span class="keyword">if</span> (pizza == <span class="keyword">null</span>){</span><br><span class="line">                System.out.println(<span class="string">"å¾ˆæŠ±æ­‰ï¼Œæœ¬åº—æ²¡æœ‰"</span>+ name +<span class="string">"æŠ«è¨"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä»¥ä¸Šä»£ç è™½ç„¶ä¹Ÿå¯ä»¥æ­£å¸¸å·¥ä½œï¼Œå¯æ˜¯å‡å¦‚å“ªå„¿å¤©è€æ¿è§‰å¾—å¸Œè…ŠæŠ«è¨å–å¾—ä¸å¥½ï¼Œæˆ–è€…è¦æ·»åŠ æ–°å£å‘³å¦‚è›¤èœŠæŠ«è¨ï¼Œé‚£å°±éœ€è¦ä¿®æ”¹ <strong>orderPizza()</strong> ä¸­çš„ä»£ç ï¼Œè¿åäº†<code>å¼€é—­åŸåˆ™</code>ï¼ˆå¯¹ä¿®æ”¹å…³é—­ï¼Œå¯¹æ‰©å±•å¼€å¯ï¼‰ã€‚</p>
<p>UML å¦‚ä¸‹ï¼Œè€¦åˆä¸¥é‡ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/06/orVt1A.png" alt="image"></p>
<h4 id="4-3-2-ç®€å•å·¥å‚å®ç°"><a href="#4-3-2-ç®€å•å·¥å‚å®ç°" class="headerlink" title="4.3.2 ç®€å•å·¥å‚å®ç°"></a>4.3.2 ç®€å•å·¥å‚å®ç°</h4><p>æ²¡æœ‰ä»€ä¹ˆæ˜¯åŠ ä¸€å±‚ä¸èƒ½è§£å†³çš„ï¼Œå¦‚æœæœ‰å°±åŠ ä¸¤å±‚ï¼å°†åˆ¶ä½œæŠ«è¨å•ç‹¬äº¤ç»™æŠ«è¨å·¥å‚å³å¯ï¼Œä»¥ä¸‹æ˜¯ç®€å•å·¥å‚çš„ UML å›¾ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/06/orueLn.png" alt="image"></p>
<p><strong>ä»£ç å®ç°</strong></p>
<p><strong>Pizza</strong> åŸºç±»å’Œå®ç°ç±»æ²¡æœ‰æ›´æ”¹ï¼Œæ–°å¢äº† <strong>PizzaFactory</strong> ç±»ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaFactory</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String name)</span></span>{</span><br><span class="line">        Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (name){</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¸Œè…Š"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> GreekPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¥¶é…ª"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> CheesePizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"èƒ¡æ¤’"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> PepperPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>PizzaStore</strong> ç±»ï¼Œç»„åˆäº† <strong>PizzaFactory</strong>ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨èšåˆï¼Œåç»­å†³å®šä½¿ç”¨ä»€ä¹ˆå·¥å‚ï¼Œäº¦æˆ–æ˜¯ä½¿ç”¨å•ä¾‹å·¥å‚æ¨¡å¼ï¼ˆç»“åˆä¸Šä¸€è®²ï¼‰ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>{</span><br><span class="line">    <span class="comment">// ç»„åˆ</span></span><br><span class="line">    PizzaFactory pizzaFactory = <span class="keyword">new</span> PizzaFactory();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">orderPizza</span><span class="params">(String name)</span></span>{</span><br><span class="line">        Pizza pizza = pizzaFactory.createPizza(name);</span><br><span class="line">        <span class="keyword">if</span> (pizza == <span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        }</span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        PizzaStore pizzaStore = <span class="keyword">new</span> PizzaStore();</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>){</span><br><span class="line">            String name = sc.nextLine();</span><br><span class="line">            Pizza pizza = pizzaStore.orderPizza(name);</span><br><span class="line">            <span class="keyword">if</span> (pizza == <span class="keyword">null</span>){</span><br><span class="line">                System.out.println(<span class="string">"å¾ˆæŠ±æ­‰ï¼Œæœ¬åº—æ²¡æœ‰"</span>+ name +<span class="string">"æŠ«è¨"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™æ ·å’‹ä¸€çœ‹æ„Ÿè§‰å’ŒåŸå…ˆå·®ä¸äº†å¤šå°‘ï¼Œå¯æ˜¯ç›®å‰åªæœ‰ä¸€å®¶æŠ«è¨åº—ï¼Œå½“æœ‰æ•°åå®¶æŠ«è¨åº—æ—¶ï¼Œå®ƒä»¬ä¹Ÿéƒ½åªéœ€è¦ç»„åˆ <strong>PizzaFactory</strong> å³å¯ï¼Œè€Œä¸æ˜¯æ¯å®¶å„è‡ªåˆ›å»ºæŠ«è¨ï¼ï¼ï¼</p>
<p><img src="https://s4.ax1x.com/2021/12/06/oruVMj.png" alt="image"></p>
<h4 id="4-3-3-æ·»åŠ æ–°é£å‘³ï¼"><a href="#4-3-3-æ·»åŠ æ–°é£å‘³ï¼" class="headerlink" title="4.3.3 æ·»åŠ æ–°é£å‘³ï¼"></a>4.3.3 æ·»åŠ æ–°é£å‘³ï¼</h4><p>å„ç§å£å‘³çš„æŠ«è¨æˆ‘ä»¬å·²ç»ä¼šåˆ›å»ºäº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥åœ¨è¿™åŸºç¡€ä¹‹ä¸Šå†æ·»åŠ ä¸åŒçš„é£å‘³ï¼Œå¦‚å¢¨è¥¿å“¥å¥¶é…ªæŠ«è¨ï¼Œè€åŒ—äº¬èƒ¡æ¤’æŠ«è¨ç­‰ã€‚</p>
<p>æ–¹æ¡ˆä¸€ï¼Œåˆ¶ä½œå¤šä¸ªå·¥å‚ç±»ç»„åˆåˆ° <strong>PizzaStore</strong> ç±»ä¸­ï¼Œä¸è¿‡è¿™ç§æ–¹æ¡ˆç¼ºé™·åŒä¸€å¼€å§‹ä¼ ç»Ÿä»£ç ä¸€æ ·ï¼Œæ–°å¢æˆ–å‡å°‘å¤šç§é£å‘³éƒ½éœ€è¦ä¿®æ”¹ <strong>PizzaStore</strong> ä¸­çš„ä»£ç ï¼</p>
<p><img src="https://s4.ax1x.com/2021/12/06/orQneA.png" alt="image"></p>
<p>æ–¹æ¡ˆäºŒï¼Œå†åŠ ä¸€å±‚ï¼è¿™æ ·æ— è®ºå¦‚ä½•ä¿®æ”¹é£å‘³ï¼Œ<strong>PizzaStore</strong> ä¸­çš„ä»£ç éƒ½ç»ä¸ä¼šå†å˜äº†ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/06/orQeLd.png" alt="image"></p>
<p>æŠ«è¨åŸºç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Pizza</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Pizza</span><span class="params">(String name)</span></span>{</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">prepare</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"å‡†å¤‡"</span> + name + <span class="string">"æŠ«è¨çš„åŸææ–™..."</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">bake</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"çƒ˜çƒ¤"</span> + name + <span class="string">"æŠ«è¨..."</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cut</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"åˆ‡å‰²"</span> + name + <span class="string">"æŠ«è¨..."</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">box</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"æ‰“åŒ…"</span> + name + <span class="string">"æŠ«è¨..."</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æŠ«è¨å®ä½“ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeijingCheesePizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BeijingCheesePizza</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">"è€åŒ—äº¬é£å‘³å¥¶é…ª"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeijingGreekPizza</span> <span class="keyword">extends</span> <span class="title">Pizza</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BeijingGreekPizza</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">"è€åŒ—äº¬é£å‘³å¸Œè…Š"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>BeijingPizzaFactory</strong> ç±»ï¼Œåˆ›å»ºè€åŒ—äº¬é£å‘³çš„æŠ«è¨ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeijingPizzaFactory</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String name)</span></span>{</span><br><span class="line">        Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (name){</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¸Œè…Š"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> BeijingGreekPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¥¶é…ª"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> BeijingCheesePizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"èƒ¡æ¤’"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> BeijingPepperPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>MexicoPizzaFactory</strong> ç±»ï¼Œåˆ›å»ºå¢¨è¥¿å“¥é£å‘³çš„æŠ«è¨ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MexicoPizzaFactory</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String name)</span></span>{</span><br><span class="line">        Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (name){</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¸Œè…Š"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> MexicoGreekPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¥¶é…ª"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> MexicoCheesePizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"èƒ¡æ¤’"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> MexicoPepperPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>é£å‘³æŠ«è¨å·¥å‚çš„å·¥å‚ç±»ï¼Œåˆ›å»ºé£å‘³æŠ«è¨å·¥å‚ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaFactory</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String style, String name)</span></span>{</span><br><span class="line">        Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (style){</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¢¨è¥¿å“¥"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> MexicoPizzaFactory().createPizza(name);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"è€åŒ—äº¬"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> BeijingPizzaFactory().createPizza(name);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>PizzaStore</strong> æµ‹è¯•ç±»ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>{</span><br><span class="line">    PizzaFactory pizzaFactory = <span class="keyword">new</span> PizzaFactory();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">orderPizza</span><span class="params">(String style, String name)</span></span>{</span><br><span class="line">        Pizza pizza = pizzaFactory.createPizza(style, name);</span><br><span class="line">        <span class="keyword">if</span> (pizza == <span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        }</span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        PizzaStore pizzaStore = <span class="keyword">new</span> PizzaStore();</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>){</span><br><span class="line">            String style = sc.next();</span><br><span class="line">            String name = sc.next();</span><br><span class="line">            Pizza pizza = pizzaStore.orderPizza(style, name);</span><br><span class="line">            <span class="keyword">if</span> (pizza == <span class="keyword">null</span>){</span><br><span class="line">                System.out.println(<span class="string">"å¾ˆæŠ±æ­‰ï¼Œæœ¬åº—æ²¡æœ‰"</span>+ style + <span class="string">"é£å‘³"</span> + name +<span class="string">"æŠ«è¨"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-3-4-å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#4-3-4-å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="4.3.4 å·¥å‚æ–¹æ³•æ¨¡å¼"></a>4.3.4 å·¥å‚æ–¹æ³•æ¨¡å¼</h4><p><strong>å·¥å‚æ–¹æ³•æ¨¡å¼ï¼š</strong>å®šä¹‰äº†ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æŠ½è±¡æ–¹æ³•ï¼Œç”±å­ç±»å†³å®šè¦å®ä¾‹åŒ–çš„ç±»ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼<code>å°†å¯¹è±¡çš„å®ä¾‹åŒ–æ¨è¿Ÿåˆ°å­ç±»</code>ã€‚ï¼ˆè¿™é‡Œå°† <strong>orderPizza()</strong> æ–¹æ³•åˆ›å»ºåœ¨å·¥å‚åŸºç±»ä¸­ï¼Œä¾¿äºå­¦ä¹ è¯¥æ¨¡å¼æ•ˆæœï¼‰</p>
<p><strong>å·¥å‚æ–¹æ³•æ¨¡å¼è®¾è®¡æ–¹æ¡ˆï¼š</strong>å°†æŠ«è¨é¡¹ç›®çš„å®ä¾‹åŒ–åŠŸèƒ½æŠ½è±¡æˆæŠ½è±¡æ–¹æ³•ï¼Œåœ¨ä¸åŒçš„å£å‘³å­ç±»ä¸­å…·ä½“å®ç°ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/06/oy00y9.png" alt="image"></p>
<p>æŠ«è¨åº— UML å¦‚ä¸‹ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/06/osFtHS.png" alt="image"></p>
<p>å·¥å‚åŸºç±»ï¼Œ<strong>createPizza()</strong> æ–¹æ³•ç­‰å­ç±»æ¥å®ç°ï¼Œå¯ä»¥åœ¨<strong>orderPizza()</strong> ä¸­å…ˆç”¨èµ·æ¥ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaFactory</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> Pizza <span class="title">createPizza</span><span class="params">(String name)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é˜²æ­¢å­ç±»é‡å†™</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Pizza <span class="title">orderPizza</span><span class="params">(String name)</span></span>{</span><br><span class="line">        Pizza pizza = createPizza(name);</span><br><span class="line">        <span class="keyword">if</span> (pizza == <span class="keyword">null</span>){</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        }</span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å·¥å‚å­ç±»ï¼Œå®ç°å¯¹è±¡çš„å®ä¾‹åŒ–ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeijingPizzaFactory</span> <span class="keyword">extends</span> <span class="title">PizzaFactory</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String name)</span></span>{</span><br><span class="line">        Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (name){</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¸Œè…Š"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> BeijingGreekPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¥¶é…ª"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> BeijingCheesePizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"èƒ¡æ¤’"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> BeijingPepperPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MexicoPizzaFactory</span> <span class="keyword">extends</span> <span class="title">PizzaFactory</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String name)</span></span>{</span><br><span class="line">        Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (name){</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¸Œè…Š"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> MexicoGreekPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¥¶é…ª"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> MexicoCheesePizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"èƒ¡æ¤’"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> MexicoPepperPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>PizzaStore</strong> æµ‹è¯•ç±»ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> PizzaFactory pizzaFactory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>){</span><br><span class="line">            Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">            String style = sc.next();</span><br><span class="line">            String name = sc.next();</span><br><span class="line">            <span class="keyword">switch</span> (style){</span><br><span class="line">                <span class="keyword">case</span> <span class="string">"å¢¨è¥¿å“¥"</span>:</span><br><span class="line">                    pizzaFactory = <span class="keyword">new</span> MexicoPizzaFactory();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">"è€åŒ—äº¬"</span>:</span><br><span class="line">                    pizzaFactory = <span class="keyword">new</span> BeijingPizzaFactory();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">            pizza = pizzaFactory.orderPizza(name);</span><br><span class="line">            <span class="keyword">if</span> (pizza == <span class="keyword">null</span>){</span><br><span class="line">                System.out.println(<span class="string">"å¾ˆæŠ±æ­‰ï¼Œæœ¬åº—æ²¡æœ‰"</span>+ style + <span class="string">"é£å‘³"</span> + name +<span class="string">"æŠ«è¨"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-3-5-æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#4-3-5-æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="4.3.5 æŠ½è±¡å·¥å‚æ¨¡å¼"></a>4.3.5 æŠ½è±¡å·¥å‚æ¨¡å¼</h4><p>æŠ½è±¡å·¥å‚æ¨¡å¼æä¾›ä¸€ä¸ªæ¥å£ï¼Œç”¨äºåˆ›å»ºç›¸å…³æˆ–ä¾èµ–å¯¹è±¡çš„å®¶æ—ï¼Œè€Œä¸éœ€è¦æŒ‡å®šå…·ä½“ç±»ã€‚</p>
<p>æŠ½è±¡å·¥å‚å…è®¸å®¢æˆ·ä½¿ç”¨æŠ½è±¡çš„æ¥å£æ¥åˆ›å»º<code>ä¸€ç»„</code>ç›¸å…³çš„äº§å“ï¼Œè€Œä¸éœ€è¦çŸ¥é“ï¼ˆæˆ–å…³å¿ƒï¼‰å®é™…äº§å‡ºçš„å…·ä½“äº§å“æ˜¯ä»€ä¹ˆã€‚è¿™æ ·ä¸€æ¥ï¼Œå®¢æˆ·å°±ä»å…·ä½“çš„äº§å“ä¸­è¢«è§£è€¦ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/06/oy0WSe.png" alt="image"></p>
<p>é£å‘³æŠ«è¨åº—ä¿®æ”¹å¦‚ä¸‹ï¼Œä¸ºæ‰€æœ‰å·¥å‚æ·»åŠ æŠ½è±¡ç±»ï¼ˆæ¥å£ï¼‰ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/06/oy09Re.png" alt="image"></p>
<p>æŠ½è±¡å·¥å‚ç±»ï¼ˆæ¥å£ï¼‰</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PizzaFactory</span> </span>{</span><br><span class="line">    <span class="function">Pizza <span class="title">createPizza</span><span class="params">(String name)</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å®ç°å·¥å‚ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MexicoPizzaFactory</span> <span class="keyword">implements</span> <span class="title">PizzaFactory</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">createPizza</span><span class="params">(String name)</span></span>{</span><br><span class="line">        Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (name){</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¸Œè…Š"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> MexicoGreekPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¥¶é…ª"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> MexicoCheesePizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"èƒ¡æ¤’"</span>:</span><br><span class="line">                pizza = <span class="keyword">new</span> MexicoPepperPizza();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PizzaStore</span> </span>{</span><br><span class="line">    <span class="comment">// èšåˆ</span></span><br><span class="line">    <span class="keyword">private</span> PizzaFactory pizzaFactory;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// é‡‡ç”¨ä¾èµ–ç¿»è½¬</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setPizzaFactory</span><span class="params">(PizzaFactory pizzaFactory)</span></span>{</span><br><span class="line">        <span class="keyword">this</span>.pizzaFactory = pizzaFactory;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Pizza <span class="title">orderPizza</span><span class="params">(String type, String name)</span></span>{</span><br><span class="line">        <span class="keyword">switch</span> (type){</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"å¢¨è¥¿å“¥"</span>:</span><br><span class="line">                setPizzaFactory(<span class="keyword">new</span> MexicoPizzaFactory());</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"è€åŒ—äº¬"</span>:</span><br><span class="line">                setPizzaFactory(<span class="keyword">new</span> BeijingPizzaFactory());</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">        Pizza pizza = pizzaFactory.createPizza(name);</span><br><span class="line">        pizza.prepare();</span><br><span class="line">        pizza.bake();</span><br><span class="line">        pizza.cut();</span><br><span class="line">        pizza.box();</span><br><span class="line">        <span class="keyword">return</span> pizza;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>){</span><br><span class="line">            Pizza pizza = <span class="keyword">null</span>;</span><br><span class="line">            String style = sc.next();</span><br><span class="line">            String name = sc.next();</span><br><span class="line">            PizzaStore pizzaStore = <span class="keyword">new</span> PizzaStore();</span><br><span class="line">            pizza = pizzaStore.orderPizza(style, name);</span><br><span class="line">            <span class="keyword">if</span> (pizza == <span class="keyword">null</span>){</span><br><span class="line">                System.out.println(<span class="string">"å¾ˆæŠ±æ­‰ï¼Œæœ¬åº—æ²¡æœ‰"</span>+ style + <span class="string">"é£å‘³"</span> + name +<span class="string">"æŠ«è¨"</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id=""><a href="#" class="headerlink" title=" "></a> </h4><h4 id="4-3-6-å·¥å‚æ–¹æ³•æ¨¡å¼-vs-æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#4-3-6-å·¥å‚æ–¹æ³•æ¨¡å¼-vs-æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="4.3.6 å·¥å‚æ–¹æ³•æ¨¡å¼ vs æŠ½è±¡å·¥å‚æ¨¡å¼"></a>4.3.6 å·¥å‚æ–¹æ³•æ¨¡å¼ vs æŠ½è±¡å·¥å‚æ¨¡å¼</h4><ol>
<li><p><strong>äº§å“ vs äº§å“é›†</strong></p>
<ul>
<li>å·¥å‚æ–¹æ³•æ¨¡å¼ä¸€èˆ¬ç”¨äºç”Ÿäº§ä¸€ä¸ªäº§å“ã€‚</li>
<li>æŠ½è±¡å·¥å‚æ¨¡å¼ä¸€èˆ¬ç”¨äºç”Ÿæˆä¸€ä¸ªäº§å“å®¶æ—ã€‚</li>
</ul>
</li>
<li><p><strong>ç»§æ‰¿ vs ç»„åˆ</strong></p>
<ul>
<li><p>å·¥å‚æ–¹æ³•æ¨¡å¼ä¾èµ–ç»§æ‰¿æ¥å†³å®šç”Ÿäº§ä»€ä¹ˆäº§å“ï¼Œåœ¨å·¥å‚å®ç°ç±»ä¸­ä¸ä»…æœ‰ç”¨äºåˆ›å»ºäº§å“çš„æ–¹æ³•ï¼ˆå®ç°çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ï¼‰ï¼Œè¿˜æœ‰å…¶å®ƒæ–¹æ³•ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„å·¥å‚å®ç°ç±»æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸åŒçš„äº§å“ï¼Œè€Œä¸å¯èƒ½åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ç”¨äºç”Ÿäº§äº§å“çš„ä¸“ç”¨ç±»ã€‚</p>
</li>
<li><p>è€Œåœ¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸­ï¼Œæœ‰ä¸€ä¸ªä¸“é—¨çš„ç±»ç”¨äºåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³çš„äº§å“ï¼Œå®ƒçš„å­ç±»å·¥å‚å¯¹è±¡å¯ä»¥ä¼ é€’ç»™ä½¿ç”¨å®ƒçš„å®¢æˆ·ç«¯ï¼ˆç»„åˆï¼‰ã€‚ç”±æ­¤ï¼Œå®¢æˆ·ç«¯å¯ä»¥è·å¾—ä¸€ä¸ªä¸åŒçš„å¯¹è±¡ï¼ˆå·¥å‚ï¼‰æ¥åˆ›å»ºäº§å“ï¼Œè€Œä¸æ˜¯åƒå·¥å‚æ–¹æ³•åˆ›å»ºè‡ªå·±ï¼ˆä¾‹å¦‚ä½¿ç”¨ factoryMethod() å¼ºåˆ¶ç»§æ‰¿ï¼‰ã€‚</p>
</li>
</ul>
</li>
</ol>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// factory method</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">anOperation</span><span class="params">()</span> </span>{</span><br><span class="line">        Product p = Factorymethod();</span><br><span class="line">        p.dosomething();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> Product <span class="title">FactoryMethod</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">newclient</span> <span class="keyword">extends</span> <span class="title">Client</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Product <span class="title">Factorymethod</span><span class="params">()</span> </span>{	<span class="comment">// overriding</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> specificProduct();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// abstract factory</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> Factory factory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">client</span><span class="params">(Factory factory)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.factory = factory;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">anOperation</span><span class="params">()</span> </span>{</span><br><span class="line">        Product p = factory.createProductA();</span><br><span class="line">        p.dosomething();	<span class="comment">// other products and operations as well</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Factory</span> </span>{</span><br><span class="line">    <span class="function">Producta <span class="title">createProductA</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">Productb <span class="title">createProductB</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// concrete factories also, implementing factory interface</span></span><br></pre></td></tr></tbody></table></figure>
<ol>
<li><strong>æ–¹æ³• vs å¯¹è±¡</strong></li>
</ol>
<ul>
<li>å·¥å‚æ–¹æ³•ä»…ä»…åªæ˜¯ä¸ªæ–¹æ³•ï¼Œä½†å«æœ‰å·¥å‚æ–¹æ³•çš„ç±»å¹¶ä¸åªèƒ½åˆ›å»ºäº§å“ï¼Œå®ƒè¿˜åšå…¶ä»–çš„å·¥ä½œã€‚</li>
<li>è€ŒæŠ½è±¡å·¥å‚å”¯ä¸€çš„ä»»åŠ¡å°±æ˜¯åˆ›å»ºä¸€ä¸ªäº§å“å®¶æ—ã€‚</li>
</ul>
<h4 id="4-3-7-å•ä¾‹æ¨¡å¼åœ¨-JDK-ä¸­çš„åº”ç”¨"><a href="#4-3-7-å•ä¾‹æ¨¡å¼åœ¨-JDK-ä¸­çš„åº”ç”¨" class="headerlink" title="4.3.7 å•ä¾‹æ¨¡å¼åœ¨ JDK ä¸­çš„åº”ç”¨"></a>4.3.7 å•ä¾‹æ¨¡å¼åœ¨ JDK ä¸­çš„åº”ç”¨</h4><p>ç®€å•å·¥å‚åº”ç”¨</p>
<p><img src="https://s4.ax1x.com/2021/12/08/o2UUV1.png" alt="image"></p>
<h4 id="-1"><a href="#-1" class="headerlink" title=" "></a> </h4><h4 id="4-3-8-å·¥å‚æ¨¡å¼å°ç»“"><a href="#4-3-8-å·¥å‚æ¨¡å¼å°ç»“" class="headerlink" title="4.3.8 å·¥å‚æ¨¡å¼å°ç»“"></a>4.3.8 å·¥å‚æ¨¡å¼å°ç»“</h4><p>å·¥å‚æ¨¡å¼å°±æ˜¯å°†å®ä¾‹åŒ–å¯¹è±¡çš„ä»£ç æå–å‡ºæ¥ï¼Œæ”¾åˆ°ä¸€ä¸ªç±»ä¸­ç»Ÿä¸€ç®¡ç†å’Œç»´æŠ¤ï¼Œè¾¾åˆ°å’Œä¸»é¡¹ç›®çš„ä¾èµ–å…³ç³»çš„è§£è€¦ï¼Œä»è€Œæé«˜é¡¹ç›®çš„æ‰©å±•å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<h3 id="4-4-åŸå‹æ¨¡å¼"><a href="#4-4-åŸå‹æ¨¡å¼" class="headerlink" title="4.4 åŸå‹æ¨¡å¼"></a>4.4 åŸå‹æ¨¡å¼</h3><h4 id="4-4-1-å…‹éš†ç¾Šé—®é¢˜"><a href="#4-4-1-å…‹éš†ç¾Šé—®é¢˜" class="headerlink" title="4.4.1 å…‹éš†ç¾Šé—®é¢˜"></a>4.4.1 å…‹éš†ç¾Šé—®é¢˜</h4><p>ç°åœ¨æœ‰ä¸€åªç¾Šï¼Œå§“åä¸º:tomï¼Œå¹´é¾„ä¸ºï¼š1ï¼Œé¢œè‰²ä¸ºï¼šç™½è‰²ï¼Œè¯·ç¼–å†™ç¨‹åºåˆ›å»ºå’Œ tom ç¾Šå±æ€§å®Œå…¨ç›¸åŒçš„ 10 åªç¾Šã€‚</p>
<p><strong>ä¼ ç»Ÿä»£ç </strong>å¦‚ä¸‹</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SheepClone</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"tom"</span>, <span class="number">1</span>, <span class="string">"white"</span>);</span><br><span class="line">        Sheep sheep1 = <span class="keyword">new</span> Sheep(sheep.getName(), sheep.getAge(), sheep.getColor());</span><br><span class="line">        Sheep sheep2 = <span class="keyword">new</span> Sheep(sheep.getName(), sheep.getAge(), sheep.getColor());</span><br><span class="line">        Sheep sheep3 = <span class="keyword">new</span> Sheep(sheep.getName(), sheep.getAge(), sheep.getColor());</span><br><span class="line">        Sheep sheep4 = <span class="keyword">new</span> Sheep(sheep.getName(), sheep.getAge(), sheep.getColor());</span><br><span class="line">        Sheep sheep5 = <span class="keyword">new</span> Sheep(sheep.getName(), sheep.getAge(), sheep.getColor());</span><br><span class="line">        Sheep sheep6 = <span class="keyword">new</span> Sheep(sheep.getName(), sheep.getAge(), sheep.getColor());</span><br><span class="line">        Sheep sheep7 = <span class="keyword">new</span> Sheep(sheep.getName(), sheep.getAge(), sheep.getColor());</span><br><span class="line">        Sheep sheep8 = <span class="keyword">new</span> Sheep(sheep.getName(), sheep.getAge(), sheep.getColor());</span><br><span class="line">        Sheep sheep9 = <span class="keyword">new</span> Sheep(sheep.getName(), sheep.getAge(), sheep.getColor());</span><br><span class="line">        Sheep sheep10 = <span class="keyword">new</span> Sheep(sheep.getName(), sheep.getAge(), sheep.getColor());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>ä¾¿äºç†è§£ï¼Œç®€å•æ˜“æ“ä½œã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>åˆ›å»ºå¯¹è±¡æ€»æ˜¯éœ€è¦è·å–åŸå§‹å¯¹è±¡çš„å±æ€§ï¼Œå¦‚æœåŸå¯¹è±¡æœ‰å‡ åä¸ªå±æ€§å‘¢ï¼Ÿ</li>
<li>æ€»æ˜¯éœ€è¦é‡æ–°åˆå§‹åŒ–å¯¹è±¡ï¼Œè€Œä¸æ˜¯åŠ¨æ€åœ°è·å¾—å¯¹è±¡è¿è¡Œæ—¶çš„çŠ¶æ€ï¼Œä¸å¤Ÿçµæ´»ã€‚</li>
</ul>
<h4 id="4-4-2-å…‹éš†æŠ€æœ¯çš„ä½¿ç”¨"><a href="#4-4-2-å…‹éš†æŠ€æœ¯çš„ä½¿ç”¨" class="headerlink" title="4.4.2 å…‹éš†æŠ€æœ¯çš„ä½¿ç”¨"></a>4.4.2 å…‹éš†æŠ€æœ¯çš„ä½¿ç”¨</h4><p>åœ¨ Java ä¸­ Object ç±»æ˜¯æ‰€æœ‰ç±»çš„æ ¹ç±»ï¼ŒObject ç±»æä¾›äº†ä¸€ä¸ª <strong>clone()</strong> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥å°†ä¸€ä¸ª Java å¯¹è±¡å¤åˆ¶ä¸€ä»½ï¼Œä½†æ˜¯éœ€è¦å®ç°ä¸€ä¸ªæ¥å£ <code>Cloneable</code>ï¼Œè¯¥æ¥å£è¡¨ç¤ºè¯¥ç±»èƒ½å¤Ÿå¤åˆ¶ä¸”å…·æœ‰å¤åˆ¶çš„èƒ½åŠ›ï¼Œè¿™å°±æ˜¯åŸå‹æ¨¡å¼ã€‚</p>
<p>Object ä¸­çš„ <strong>clone()</strong> æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// nativeå…³é”®å­—è¯´æ˜å…¶ä¿®é¥°çš„æ–¹æ³•æ˜¯ä¸€ä¸ªåŸç”Ÿæ€æ–¹æ³•ï¼Œæ–¹æ³•å¯¹åº”çš„å®ç°ä¸æ˜¯åœ¨å½“å‰æ–‡ä»¶ï¼Œè€Œæ˜¯åœ¨ç”¨å…¶ä»–è¯­è¨€ï¼ˆå¦‚Cå’ŒC++ï¼‰å®ç°çš„æ–‡ä»¶ä¸­ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">native</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException</span>;</span><br></pre></td></tr></tbody></table></figure>
<p>å‡å¦‚ä¸å®ç° <strong>Cloneable</strong> æ¥å£å°±è°ƒç”¨ <strong>clone()</strong> ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// æœªå®ç°Cloneable</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sheep</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String color;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.clone();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•å¦‚ä¸‹ï¼Œ<code>CloneNotSupportedException</code> ä¸æ”¯æŒå…‹éš†å¼‚å¸¸ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"tom"</span>, <span class="number">1</span>, <span class="string">"white"</span>);</span><br><span class="line">Sheep sheep1 = (Sheep) sheep.clone();</span><br><span class="line"></span><br><span class="line">Exception in thread <span class="string">"main"</span> java.lang.CloneNotSupportedException: </span><br></pre></td></tr></tbody></table></figure>
<p>æ‰€ä»¥è¿˜æ˜¯è€è€å®å®åŠ ä¸Šå§ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sheep</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>{}</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•ï¼Œ<strong>clone()</strong> ä¼šè‡ªåŠ¨å¤åˆ¶å¯¹è±¡å±æ€§åˆ°æ–°çš„å¯¹è±¡ä¸Šã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SheepClone</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">        Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"tom"</span>, <span class="number">1</span>, <span class="string">"white"</span>);</span><br><span class="line">        Sheep sheep1 = (Sheep) sheep.clone();</span><br><span class="line">        System.out.println(sheep.hashCode());		<span class="comment">// 1836019240</span></span><br><span class="line">        System.out.println(sheep1.hashCode());		<span class="comment">// 325040804</span></span><br><span class="line">        <span class="comment">// åˆ¤æ–­åœ°å€</span></span><br><span class="line">        System.out.println(sheep == sheep1);		<span class="comment">// false</span></span><br><span class="line">        <span class="comment">//é‡å†™equalsæ–¹æ³•ç”¨äºåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„å±æ€§å€¼æ˜¯å¦ç›¸ç­‰</span></span><br><span class="line">        System.out.println(sheep.equals(sheep1));	<span class="comment">// true</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-4-3-å…‹éš†ç¾Šçš„å…‹éš†ç¾Šæœ‹å‹"><a href="#4-4-3-å…‹éš†ç¾Šçš„å…‹éš†ç¾Šæœ‹å‹" class="headerlink" title="4.4.3 å…‹éš†ç¾Šçš„å…‹éš†ç¾Šæœ‹å‹"></a>4.4.3 å…‹éš†ç¾Šçš„å…‹éš†ç¾Šæœ‹å‹</h4><p>æœ‰æ—¶å…‹éš†ç¾Šä¼šè§‰å¾—åªæœ‰ä¸€ä¸ªäººå¾ˆå­¤å•ï¼Œå› æ­¤æˆ‘ä»¬è¦ç»™å®ƒæ‰¾ä¸ªæœ‹å‹ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sheep</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>{</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String color;</span><br><span class="line">    <span class="keyword">private</span> Sheep friend;	<span class="comment">// å…‹éš†ç¾Šæœ‹å‹</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•ï¼Œå…‹éš†ç¾Šæœ‹å‹ä¼šä¸ä¼šå…‹éš†å‘¢ï¼Ÿ</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SheepClone</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">        Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"tom"</span>, <span class="number">1</span>, <span class="string">"white"</span>);</span><br><span class="line">        sheep.setFriend(<span class="keyword">new</span> Sheep(<span class="string">"friend"</span>, <span class="number">2</span>, <span class="string">"black"</span>));</span><br><span class="line">        Sheep sheep1 = (Sheep) sheep.clone();</span><br><span class="line">        System.out.println(sheep.getFriend().hashCode());	<span class="comment">// 1836019240</span></span><br><span class="line">        System.out.println(sheep1.getFriend().hashCode());	<span class="comment">// 1836019240</span></span><br><span class="line">        System.out.println(sheep.getFriend() == sheep1.getFriend());	<span class="comment">// true</span></span><br><span class="line">        System.out.println(sheep.getFriend().equals(sheep1.getFriend()));	<span class="comment">// true</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ˜¾ç„¶ï¼Œè¿™é‡Œå…‹éš†ç¾Šæœ‹å‹åªæ˜¯å¤åˆ¶äº†å¼•ç”¨è€Œå·²ï¼Œä¿—ç§°<code>æµ…æ‹·è´</code>ã€‚</p>
<p>ä½†æµ…æ‹·è´è™½ç„¶æ•ˆç‡é«˜äº†ï¼ˆå¯¹äºå¼•ç”¨ç±»å‹åªéœ€è¦å¤åˆ¶å¼•ç”¨ï¼‰ï¼Œä½†å®ƒä¹Ÿå¸¦æ¥äº†å¦å¤–çš„é—®é¢˜ï¼Œå¦‚ä¸‹è¿°ä»£ç æ‰€ç¤ºã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SheepClone</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">        Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"tom"</span>, <span class="number">1</span>, <span class="string">"white"</span>);</span><br><span class="line">        sheep.setFriend(<span class="keyword">new</span> Sheep(<span class="string">"friend"</span>, <span class="number">2</span>, <span class="string">"black"</span>));</span><br><span class="line">        Sheep sheep1 = (Sheep) sheep.clone();</span><br><span class="line">        sheep.getFriend().setName(<span class="string">"renamed friend"</span>);</span><br><span class="line">        System.out.println(sheep1.getFriend().getName());	<span class="comment">// renamed friend</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å½“æ›´æ”¹åŸå…‹éš†ç¾Šçš„å…‹éš†ç¾Šæœ‹å‹åå­—æ—¶ï¼Œæ–°å…‹éš†ç¾Šçš„å…‹éš†ç¾Šæœ‹å‹åå­—ä¹Ÿå‘ç”Ÿäº†æ›´æ”¹ï¼Œæœ‰çš„æ—¶å€™æˆ‘ä»¬å¹¶ä¸å¸Œæœ›çœ‹åˆ°è¿™æ ·ï¼è¿™å°±å¼•å‡ºäº†<code>æ·±æ‹·è´</code>ã€‚</p>
<h4 id="4-4-4-èµ‹å€¼-vs-æµ…æ‹·è´-vs-æ·±æ‹·è´"><a href="#4-4-4-èµ‹å€¼-vs-æµ…æ‹·è´-vs-æ·±æ‹·è´" class="headerlink" title="4.4.4 èµ‹å€¼ vs æµ…æ‹·è´ vs æ·±æ‹·è´"></a>4.4.4 èµ‹å€¼ vs æµ…æ‹·è´ vs æ·±æ‹·è´</h4><p><strong>èµ‹å€¼ï¼š</strong></p>
<p>å½“æˆ‘ä»¬æŠŠä¸€ä¸ªå¯¹è±¡èµ‹å€¼ç»™ä¸€ä¸ªæ–°çš„å˜é‡æ—¶ï¼Œ<strong>èµ‹çš„å…¶å®æ˜¯è¯¥å¯¹è±¡çš„åœ¨æ ˆä¸­çš„åœ°å€ï¼Œè€Œä¸æ˜¯å †ä¸­çš„æ•°æ®</strong>ã€‚ä¹Ÿå°±æ˜¯ä¸¤ä¸ªå¯¹è±¡æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå­˜å‚¨ç©ºé—´ï¼Œæ— è®ºå“ªä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜ï¼Œå…¶å®éƒ½æ˜¯æ”¹å˜çš„å­˜å‚¨ç©ºé—´çš„å†…å®¹ï¼Œå› æ­¤ï¼Œä¸¤ä¸ªå¯¹è±¡æ˜¯è”åŠ¨çš„ã€‚</p>
<p><strong>æµ…æ‹·è´ï¼š</strong></p>
<p>æµ…æ‹·è´æ˜¯æŒ‰ä½æ‹·è´å¯¹è±¡ï¼Œ<strong>å®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡</strong>ï¼Œè¿™ä¸ªå¯¹è±¡æœ‰ç€åŸå§‹å¯¹è±¡å±æ€§å€¼çš„ä¸€ä»½ç²¾ç¡®æ‹·è´ã€‚å¦‚æœå±æ€§æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ‹·è´çš„å°±æ˜¯åŸºæœ¬ç±»å‹çš„å€¼ï¼›å¦‚æœå±æ€§æ˜¯å†…å­˜åœ°å€ï¼ˆå¼•ç”¨ç±»å‹ï¼‰ï¼Œæ‹·è´çš„å°±æ˜¯å†…å­˜åœ°å€ ï¼Œå› æ­¤å¦‚æœå…¶ä¸­ä¸€ä¸ªå¯¹è±¡æ”¹å˜äº†è¿™ä¸ªåœ°å€ï¼Œå°±ä¼šå½±å“åˆ°å¦ä¸€ä¸ªå¯¹è±¡ã€‚å³é»˜è®¤æ‹·è´æ„é€ å‡½æ•°åªæ˜¯å¯¹å¯¹è±¡è¿›è¡Œæµ…æ‹·è´å¤åˆ¶(é€ä¸ªæˆå‘˜ä¾æ¬¡æ‹·è´)ï¼Œå³åªå¤åˆ¶å¯¹è±¡ç©ºé—´è€Œä¸å¤åˆ¶èµ„æºã€‚</p>
<p><strong>æ·±æ‹·è´ï¼š</strong></p>
<p>è€Œæ·±æ‹·è´åˆ™ä¸åŒï¼Œå®ƒä¸ä»…å°†åŸå¯¹è±¡çš„å„ä¸ªå±æ€§é€ä¸ªå¤åˆ¶å‡ºå»ï¼Œè€Œä¸”å°†åŸå¯¹è±¡å„ä¸ªå±æ€§æ‰€åŒ…å«çš„å¯¹è±¡ä¹Ÿä¾æ¬¡é‡‡ç”¨æ·±å¤åˆ¶çš„æ–¹æ³•<strong>é€’å½’å¤åˆ¶</strong>åˆ°æ–°å¯¹è±¡ä¸Šã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/08/oR92mq.png" alt="image"></p>
<h4 id="4-4-5-å®ç°æ·±æ‹·è´"><a href="#4-4-5-å®ç°æ·±æ‹·è´" class="headerlink" title="4.4.5 å®ç°æ·±æ‹·è´"></a>4.4.5 å®ç°æ·±æ‹·è´</h4><p><strong>æ–¹æ¡ˆä¸€</strong>ï¼šé‡å†™ <strong>clone()</strong> æ–¹æ³•</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">    Sheep sheepClone = (Sheep) <span class="keyword">super</span>.clone();</span><br><span class="line">    <span class="comment">// å¦‚æœæœ‰å…‹éš†ç¾Šæœ‹å‹ï¼Œåˆ™å¯¹å…‹éš†ç¾Šæœ‹å‹è¿›è¡Œclone()</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.friend != <span class="keyword">null</span>){</span><br><span class="line">        sheepClone.setFriend((Sheep) <span class="keyword">this</span>.friend.clone());</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> sheepClone;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•å¦‚ä¸‹ï¼Œè¿™ä¸‹åŸå…‹éš†ç¾Šçš„å…‹éš†ç¾Šæœ‹å‹ä¹Ÿè¢«å…‹éš†æˆäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ˆç»•å£ä»¤ï¼‰ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SheepClone</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">        Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"tom"</span>, <span class="number">1</span>, <span class="string">"white"</span>);</span><br><span class="line">        sheep.setFriend(<span class="keyword">new</span> Sheep(<span class="string">"friend"</span>, <span class="number">2</span>, <span class="string">"friend"</span>));</span><br><span class="line">        Sheep sheep1 = (Sheep) sheep.clone();</span><br><span class="line">        System.out.println(sheep.getFriend().hashCode());	<span class="comment">// 1836019240</span></span><br><span class="line">        System.out.println(sheep1.getFriend().hashCode());	<span class="comment">// 325040804</span></span><br><span class="line">        System.out.println(sheep.getFriend() == sheep1.getFriend());	<span class="comment">// false</span></span><br><span class="line">        System.out.println(sheep.getFriend().equals(sheep1.getFriend()));	<span class="comment">// true</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// extra</span></span><br><span class="line">        <span class="comment">// test String</span></span><br><span class="line">        System.out.println(sheep.getName().hashCode());	<span class="comment">// 115026</span></span><br><span class="line">        System.out.println(sheep1.getName().hashCode());	<span class="comment">// 115026</span></span><br><span class="line">        System.out.println(sheep.getName() == sheep1.getName());	<span class="comment">// true</span></span><br><span class="line">        System.out.println(sheep.getName().equals(sheep1.getName()));	<span class="comment">// true</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<p>æ¯æœ‰ä¸€ä¸ªå¼•ç”¨ç±»å‹å°±è¦å•ç‹¬è¿›è¡Œä¸€æ¬¡ <strong>clone()</strong> æ“ä½œï¼Œéå¸¸éº»çƒ¦ï¼è€Œä¸”å¦‚æœå¼•ç”¨ç±»å‹ä¸­çš„å±æ€§è¿˜æœ‰å¼•ç”¨ç±»å‹çš„è¯ï¼Œå°±è¿˜å¾—å†å†™ä¸€å±‚ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼ä¹Ÿå«<code>äºŒé‡æµ…æ‹·è´</code>ã€‚</p>
<p>&lt;% note success %&gt;è¿™é‡Œ Sheep ç±»çš„ name æ˜¯ String ç±»å‹çš„ï¼Œè™½ç„¶ String è™½ç„¶ä¹Ÿæ˜¯å¼•ç”¨ç±»å‹ï¼Œä½†å®ƒå¹¶æ²¡æœ‰å®ç° <strong>Cloneable</strong> æ¥å£ï¼Œä¸èƒ½è¿›è¡Œæ·±æ‹·è´ï¼Œåªèƒ½æµ…æ‹·è´ï¼Œå› æ­¤åœ°å€éƒ½æ˜¯ä¸€æ ·çš„ï¼&lt;% endnote %&gt;</p>
<p>ä½†å¦‚æœæœ‰ä¸€åªå…‹éš†ç¾Šè§‰å¾—å®ƒä¸éœ€è¦æœ‹å‹ï¼Œå®ƒå”¯ä¸€çš„æœ‹å‹å°±æ˜¯è‡ªå·±ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SheepClone</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">        Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"tom"</span>, <span class="number">1</span>, <span class="string">"white"</span>);</span><br><span class="line">        sheep.setFriend(sheep);</span><br><span class="line">        Sheep sheep1 = (Sheep) sheep.clone();</span><br><span class="line">        System.out.println(sheep.getFriend().hashCode());</span><br><span class="line">        System.out.println(sheep1.getFriend().hashCode());</span><br><span class="line">        System.out.println(sheep.getFriend() == sheep1.getFriend());</span><br><span class="line">        System.out.println(sheep.getFriend().equals(sheep1.getFriend()));  </span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™æ—¶å†è¿›è¡Œ <strong>clone()</strong>ï¼Œç”±äºä¼šä¸æ–­è¿›è¡Œé€’å½’ï¼Œè€Œä¸”æ²¡æœ‰å°½å¤´ï¼ï¼ï¼ä¸ä¸€ä¼šå„¿å°±ä¼šæŠ›å‡º <code>StackOverFlowError</code> æ ˆæº¢å‡ºé”™è¯¯ï¼Œå¿…é¡»è¦é¿å…è¿™ç§æƒ…å†µï¼Œä¸è¦æŠŠå¼•ç”¨æŒ‡å‘è‡ªå·±ï¼</p>
<p><br></p>
<p><strong>æ–¹æ¡ˆäºŒ</strong>ï¼šåºåˆ—åŒ– + ååºåˆ—åŒ–ï¼ˆè¦å®ç°åºåˆ—åŒ–æ¥å£ï¼‰</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sheep</span> <span class="keyword">implements</span> <span class="title">Cloneable</span>, <span class="title">Serializable</span></span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">        ByteArrayOutputStream bos = <span class="keyword">null</span>;</span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">null</span>;</span><br><span class="line">        ByteArrayInputStream bis = <span class="keyword">null</span>;</span><br><span class="line">        ObjectInputStream ois = <span class="keyword">null</span>;</span><br><span class="line">        Sheep sheepClone = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="comment">// åºåˆ—åŒ–</span></span><br><span class="line">            bos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">            oos = <span class="keyword">new</span> ObjectOutputStream(bos);</span><br><span class="line">            oos.writeObject(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ååºåˆ—åŒ–</span></span><br><span class="line">            bis = <span class="keyword">new</span> ByteArrayInputStream(bos.toByteArray());</span><br><span class="line">            ois = <span class="keyword">new</span> ObjectInputStream(bis);</span><br><span class="line">            sheepClone = (Sheep) ois.readObject();</span><br><span class="line">        }<span class="keyword">catch</span> (Exception e){</span><br><span class="line">            System.out.println(e.getMessage());</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">finally</span> {</span><br><span class="line">            <span class="keyword">try</span> {</span><br><span class="line">                ois.close();</span><br><span class="line">                bis.close();</span><br><span class="line">                oos.close();</span><br><span class="line">                bos.close();</span><br><span class="line">            } <span class="keyword">catch</span> (IOException e) {</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> sheepClone;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•å¦‚ä¸‹ï¼ŒåŒæ ·èƒ½å¾ˆå¥½åœ°å°†å¼•ç”¨ç±»å‹è¿›è¡Œæ·±æ‹·è´ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SheepClone</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">        Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"tom"</span>, <span class="number">1</span>, <span class="string">"white"</span>);</span><br><span class="line">        sheep.setFriend(<span class="keyword">new</span> Sheep(<span class="string">"friend"</span>, <span class="number">2</span>, <span class="string">"friend"</span>));</span><br><span class="line">        Sheep sheep1 = (Sheep) sheep.clone();</span><br><span class="line">        System.out.println(sheep.getFriend().hashCode());	<span class="comment">// 1627674070</span></span><br><span class="line">        System.out.println(sheep1.getFriend().hashCode());	<span class="comment">// 1531448569</span></span><br><span class="line">        System.out.println(sheep.getFriend() == sheep1.getFriend());	<span class="comment">// false</span></span><br><span class="line">        System.out.println(sheep.getFriend().equals(sheep1.getFriend()));	<span class="comment">// true</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è€Œä¸”ç”±äºä¸ä¼šä½¿ç”¨é€’å½’è¿›è¡Œæ·±æ‹·è´ï¼Œå³ä½¿å¼•ç”¨ç±»å‹æŒ‡å‘è‡ªå·±ä¹Ÿä¸ä¼šå‘ç”Ÿæ ˆæº¢å‡ºçš„é”™è¯¯ï¼</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SheepClone</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException </span>{</span><br><span class="line">        Sheep sheep = <span class="keyword">new</span> Sheep(<span class="string">"tom"</span>, <span class="number">1</span>, <span class="string">"white"</span>);</span><br><span class="line">        sheep.setFriend(sheep);</span><br><span class="line">        Sheep sheep1 = (Sheep) sheep.clone();</span><br><span class="line">        System.out.println(sheep.getFriend().hashCode());	<span class="comment">// 312714112</span></span><br><span class="line">        System.out.println(sheep1.getFriend().hashCode());	<span class="comment">// 1595428806</span></span><br><span class="line">        System.out.println(sheep.getFriend() == sheep1.getFriend());	<span class="comment">// false</span></span><br><span class="line">        System.out.println(sheep.getFriend().equals(sheep1.getFriend()));	<span class="comment">// true</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-4-6-åŸå‹æ¨¡å¼åœ¨-Spring-ä¸­çš„åº”ç”¨"><a href="#4-4-6-åŸå‹æ¨¡å¼åœ¨-Spring-ä¸­çš„åº”ç”¨" class="headerlink" title="4.4.6 åŸå‹æ¨¡å¼åœ¨ Spring ä¸­çš„åº”ç”¨"></a>4.4.6 åŸå‹æ¨¡å¼åœ¨ Spring ä¸­çš„åº”ç”¨</h4><p>Spring ä¸­å¯ä»¥é…ç½® bean çš„ä½œç”¨åŸŸæ˜¯åŸå‹è¿˜æ˜¯å•ä¾‹ï¼Œé»˜è®¤å•ä¾‹ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.yqx.pojo.User"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://s1.ax1x.com/2021/12/09/ofCc2F.png" alt="image"></p>
<h4 id="4-4-7-å°ç»“"><a href="#4-4-7-å°ç»“" class="headerlink" title="4.4.7 å°ç»“"></a>4.4.7 å°ç»“</h4><p>åŸå‹æ¨¡å¼ï¼ˆPrototype Patternï¼‰æ˜¯ç”¨äºåˆ›å»ºé‡å¤çš„å¯¹è±¡ï¼ŒåŒæ—¶åˆèƒ½ä¿è¯æ€§èƒ½ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ã€‚</p>
<p>è¿™ç§æ¨¡å¼æ˜¯å®ç°äº†ä¸€ä¸ªåŸå‹æ¥å£ï¼Œè¯¥æ¥å£ç”¨äºåˆ›å»ºå½“å‰å¯¹è±¡çš„å…‹éš†ã€‚å½“ç›´æ¥åˆ›å»ºå¯¹è±¡çš„ä»£ä»·æ¯”è¾ƒå¤§æ—¶ï¼Œåˆ™é‡‡ç”¨è¿™ç§æ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¯¹è±¡éœ€è¦åœ¨ä¸€ä¸ªé«˜ä»£ä»·çš„æ•°æ®åº“æ“ä½œä¹‹åè¢«åˆ›å»ºã€‚æˆ‘ä»¬å¯ä»¥ç¼“å­˜è¯¥å¯¹è±¡ï¼Œåœ¨ä¸‹ä¸€ä¸ªè¯·æ±‚æ—¶è¿”å›å®ƒçš„å…‹éš†ï¼Œåœ¨éœ€è¦çš„æ—¶å€™æ›´æ–°æ•°æ®åº“ï¼Œä»¥æ­¤æ¥å‡å°‘æ•°æ®åº“è°ƒç”¨ã€‚</p>
<p>ä¸è¿‡ç¼ºç‚¹å°±æ˜¯ï¼Œéœ€è¦ä¸ºæ¯ä¸€ä¸ªç±»éƒ½å®ç°ä¸€ä¸ªå…‹éš†æ–¹æ³•ï¼Œå½“ç„¶ï¼Œè¿™å¯¹ä¸€ä¸ªå…¨æ–°çš„ç±»æ¥è¯´ä¸æ˜¯å¾ˆéš¾ï¼Œä½†å¯¹å·²æœ‰çš„ç±»è¿›è¡Œæ”¹é€ æ—¶ï¼Œå°±éœ€è¦ä¿®æ”¹å…¶æºä»£ç ï¼Œè¿™è¿èƒŒäº† <strong>ocp</strong> åŸåˆ™ï¼</p>
<h3 id="4-5-å»ºé€ è€…æ¨¡å¼"><a href="#4-5-å»ºé€ è€…æ¨¡å¼" class="headerlink" title="4.5 å»ºé€ è€…æ¨¡å¼"></a>4.5 å»ºé€ è€…æ¨¡å¼</h3><h4 id="4-5-1-ç›–æˆ¿é¡¹ç›®éœ€æ±‚"><a href="#4-5-1-ç›–æˆ¿é¡¹ç›®éœ€æ±‚" class="headerlink" title="4.5.1 ç›–æˆ¿é¡¹ç›®éœ€æ±‚"></a>4.5.1 ç›–æˆ¿é¡¹ç›®éœ€æ±‚</h4><p>1ï¼‰ å»ºæˆ¿å­è¿‡ç¨‹ï¼šæ‰“åœ°åŸºï¼Œç Œå¢™é¢ï¼Œç›–æˆ¿é¡¶ã€‚</p>
<p>2ï¼‰ æˆ¿å­æ ·å¼ï¼šç“¦æˆ¿ï¼Œé«˜æ¥¼ï¼Œåˆ«å¢…ç­‰â€¦</p>
<p><strong>ä¼ ç»Ÿæ€è·¯ï¼š</strong></p>
<p><img src="https://s1.ax1x.com/2021/12/09/ofiwt0.png" alt="image"></p>
<p><strong>ä»£ç å®ç°</strong>ï¼Œç›–æˆ¿åŸºç±»ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractHouse</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildBase</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildRoof</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildWall</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span>{</span><br><span class="line">        buildBase();</span><br><span class="line">        buildWall();</span><br><span class="line">        buildRoof();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å®ç°ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommonHouse</span> <span class="keyword">extends</span> <span class="title">AbstractHouse</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildBase</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"æ™®é€šæˆ¿æ‰“åœ°åŸº"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildRoof</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"æ™®é€šæˆ¿ç›–æˆ¿é¡¶"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildWall</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"æ™®é€šæˆ¿ç Œå¢™é¢"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HighBuilding</span> <span class="keyword">extends</span> <span class="title">AbstractHouse</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildBase</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"é«˜æ¥¼æ‰“åœ°åŸº"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildRoof</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"é«˜æ¥¼ç›–æˆ¿é¡¶"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildWall</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"é«˜æ¥¼ç Œå¢™é¢"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        AbstractHouse house = <span class="keyword">new</span> CommonHouse();</span><br><span class="line">        house.build();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>å¥½ç†è§£ï¼Œç®€å•æ˜“æ“ä½œ</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>è®¾è®¡çš„ç¨‹åºç»“æ„è¿‡äºç®€å•ï¼Œæ²¡æœ‰è®¾è®¡ç¼“å­˜å±‚å¯¹è±¡ï¼Œç¨‹åºçš„æ‰©å±•å’Œç»´æŠ¤ä¸å¥½ã€‚</li>
<li>è¿™ç§è®¾è®¡æ–¹æ¡ˆå°†äº§å“ï¼ˆæˆ¿å­ï¼‰å’Œåˆ›å»ºäº§å“çš„è¿‡ç¨‹ï¼ˆç›–æˆ¿ï¼‰å°è£…åœ¨ä¸€èµ·ï¼Œè€¦åˆæ€§å¢å¼ºäº†ã€‚</li>
</ul>
<p><strong>æ”¹è¿›</strong>ï¼š</p>
<ul>
<li>å°†äº§å“å’Œäº§å“å»ºé€ è¿‡ç¨‹è¿›è¡Œç»“æ„ â€”&gt; <strong>å»ºé€ è€…æ¨¡å¼</strong></li>
</ul>
<h4 id="4-5-2-å»ºé€ è€…æ¨¡å¼"><a href="#4-5-2-å»ºé€ è€…æ¨¡å¼" class="headerlink" title="4.5.2 å»ºé€ è€…æ¨¡å¼"></a>4.5.2 å»ºé€ è€…æ¨¡å¼</h4><p>å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder Patternï¼‰åˆå«<strong>ç”Ÿæˆå™¨æ¨¡å¼</strong>ï¼Œæ˜¯ä¸€ç§å¯¹è±¡æ„å»ºæ¨¡å¼ï¼Œå®ƒå¯ä»¥å°†å¤æ‚å¯¹è±¡çš„å»ºé€ è¿‡ç¨‹æŠ½è±¡å‡ºæ¥ï¼Œä½¿è¿™ä¸ªæŠ½è±¡è¿‡ç¨‹çš„ä¸åŒå®ç°æ–¹æ³•å¯ä»¥æ„é€ å‡ºä¸åŒè¡¨ç°ï¼ˆå±æ€§ï¼‰çš„å¯¹è±¡ã€‚</p>
<p>å»ºé€ è€…æ¨¡å¼æ˜¯ä¸€æ­¥ä¸€æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œå®ƒå…è®¸ç”¨æˆ·åªé€šè¿‡æŒ‡å®šå¤æ‚å¯¹è±¡çš„ç±»å‹å’Œå†…å®¹å°±å¯ä»¥æ„å»ºå®ƒä»¬ï¼Œç”¨æˆ·ä¸éœ€è¦çŸ¥é“å†…éƒ¨çš„å…·ä½“æ„å»ºç»†èŠ‚ã€‚</p>
<p>å»ºé€ è€…æ¨¡å¼æ‹¥æœ‰å››ä¸ªè§’è‰²</p>
<ol>
<li>Productï¼ˆäº§å“è§’è‰²ï¼‰ï¼šä¸€ä¸ªå…·ä½“çš„äº§å“å¯¹è±¡ã€‚</li>
<li>Builderï¼ˆæŠ½è±¡å»ºé€ è€…ï¼‰ï¼šåˆ›å»º <strong>Product</strong> å¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶æŒ‡å®šçš„ <strong>æ¥å£/æŠ½è±¡ç±»</strong>ã€‚</li>
<li>ConcreteBuilderï¼ˆå…·ä½“å»ºé€ è€…ï¼‰ï¼šå®ç°æ¥å£ï¼Œæ„å»ºå’Œè£…é…å„ä¸ªéƒ¨ä»¶ã€‚</li>
<li>Directorï¼ˆæŒ‡æŒ¥è€…ï¼‰ï¼šæ„å»ºä¸€ä¸ªä½¿ç”¨ Builder æ¥å£çš„å¯¹è±¡ã€‚å®ƒä¸»è¦æ˜¯ç”¨äºåˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚å®ƒä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨ï¼Œä¸€æ˜¯ï¼šéš”ç¦»äº†å®¢æˆ·ä¸å¯¹è±¡çš„ç”Ÿäº§è¿‡ç¨‹ï¼ŒäºŒæ˜¯ï¼šè´Ÿè´£æ§åˆ¶äº§å“å¯¹è±¡çš„ç”Ÿäº§è¿‡ç¨‹ã€‚</li>
</ol>
<p><strong>UML</strong> å›¾å¦‚ä¸‹</p>
<p><img src="https://s1.ax1x.com/2021/12/09/ofJgzD.png" alt="image"></p>
<p>äº§å“è§’è‰²</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">House</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> String base;</span><br><span class="line">    <span class="keyword">private</span> String roof;</span><br><span class="line">    <span class="keyword">private</span> String wall;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æŠ½è±¡å»ºé€ è€…</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// æŠ½è±¡çš„å»ºé€ è€…</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractHouseBuilder</span> </span>{</span><br><span class="line">    <span class="keyword">protected</span> House house = <span class="keyword">new</span> House();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å»ºé€ æµç¨‹</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildBase</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildRoof</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">buildWall</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å»ºé€ å®Œæ¯•ï¼Œè¿”å›äº§å“</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> House <span class="title">build</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> house;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å…·ä½“å»ºé€ è€…</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommonHouseBuilder</span> <span class="keyword">extends</span> <span class="title">AbstractHouseBuilder</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildBase</span><span class="params">()</span> </span>{</span><br><span class="line">        house.setBase(<span class="string">"10m"</span>);</span><br><span class="line">        System.out.println(<span class="string">"æ™®é€šæˆ¿æ‰“åœ°åŸº"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildRoof</span><span class="params">()</span> </span>{</span><br><span class="line">        house.setRoof(<span class="string">"red"</span>);</span><br><span class="line">        System.out.println(<span class="string">"æ™®é€šæˆ¿ç›–æˆ¿é¡¶"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildWall</span><span class="params">()</span> </span>{</span><br><span class="line">        house.setWall(<span class="string">"10cm"</span>);</span><br><span class="line">        System.out.println(<span class="string">"æ™®é€šæˆ¿ç Œå¢™é¢"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HighBuildingBuilder</span> <span class="keyword">extends</span> <span class="title">AbstractHouseBuilder</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildBase</span><span class="params">()</span> </span>{</span><br><span class="line">        house.setBase(<span class="string">"20m"</span>);</span><br><span class="line">        System.out.println(<span class="string">"é«˜æ¥¼æ‰“åœ°åŸº"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildRoof</span><span class="params">()</span> </span>{</span><br><span class="line">        house.setRoof(<span class="string">"transparent"</span>);</span><br><span class="line">        System.out.println(<span class="string">"é«˜æ¥¼ç›–æˆ¿é¡¶"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">buildWall</span><span class="params">()</span> </span>{</span><br><span class="line">        house.setWall(<span class="string">"20cm"</span>);</span><br><span class="line">        System.out.println(<span class="string">"é«˜æ¥¼ç Œå¢™é¢"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æŒ‡æŒ¥è€…</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HouseDirector</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> AbstractHouseBuilder houseBuilder;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HouseDirector</span><span class="params">(AbstractHouseBuilder houseBuilder)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.houseBuilder = houseBuilder;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHouseBuilder</span><span class="params">(AbstractHouseBuilder houseBuilder)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.houseBuilder = houseBuilder;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚ä½•å¤„ç†å»ºé€ æˆ¿å­çš„æµç¨‹ï¼Œäº¤ç»™æŒ‡æŒ¥è€…</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> House <span class="title">constructHouse</span><span class="params">()</span></span>{</span><br><span class="line">        houseBuilder.buildBase();</span><br><span class="line">        houseBuilder.buildWall();</span><br><span class="line">        houseBuilder.buildRoof();</span><br><span class="line">        <span class="keyword">return</span> houseBuilder.build();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å®¢æˆ·ç«¯</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        HouseDirector houseDirector = <span class="keyword">new</span> HouseDirector(<span class="keyword">new</span> CommonHouseBuilder());</span><br><span class="line">        System.out.println(houseDirector.constructHouse());</span><br><span class="line">        houseDirector.setHouseBuilder(<span class="keyword">new</span> HighBuildingBuilder());</span><br><span class="line">        System.out.println(houseDirector.constructHouse());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹å°è£…èµ·æ¥ã€‚</li>
<li>å…è®¸å¯¹è±¡é€šè¿‡å¤šä¸ªæ­¥éª¤æ¥åˆ›å»ºï¼Œå¹¶ä¸”å¯ä»¥æ”¹å˜è¿‡ç¨‹ï¼ˆè¿™å’Œåªæœ‰ä¸€ä¸ªæ­¥éª¤çš„å·¥å‚æ¨¡å¼ä¸åŒï¼‰ã€‚</li>
<li>å‘å®¢æˆ·ç«¯éšè—äº§å“å†…éƒ¨çš„å®ç°ã€‚</li>
<li>äº§å“çš„å®ç°å¯ä»¥è¢«æ›¿æ¢ï¼Œå› ä¸ºç”¨æˆ·åªçœ‹åˆ°ä¸€ä¸ªæŠ½è±¡çš„æ¥å£ã€‚</li>
</ul>
<p><strong>ç”¨é€”</strong>ï¼š</p>
<ul>
<li>ç»å¸¸è¢«ç”¨æ¥åˆ›å»ºç»„åˆç»“æ„ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>å’Œå·¥å‚æ¨¡å¼ç›¸æ¯”ï¼Œé‡‡ç”¨å»ºé€ è€…æ¨¡å¼åˆ›å»ºå¯¹è±¡çš„å®¢æˆ·ï¼Œéœ€è¦å…·å¤‡æ›´å¤šçš„é¢†åŸŸçŸ¥è¯†ã€‚</li>
</ul>
<h4 id="4-5-3-å»ºé€ è€…æ¨¡å¼åœ¨-JDK-ä¸­çš„åº”ç”¨"><a href="#4-5-3-å»ºé€ è€…æ¨¡å¼åœ¨-JDK-ä¸­çš„åº”ç”¨" class="headerlink" title="4.5.3 å»ºé€ è€…æ¨¡å¼åœ¨ JDK ä¸­çš„åº”ç”¨"></a>4.5.3 å»ºé€ è€…æ¨¡å¼åœ¨ JDK ä¸­çš„åº”ç”¨</h4><p>æ‹¿ <strong>StringBuilder</strong> ä¸¾ä¾‹ã€‚</p>
<p><strong>Appendable</strong> æ¥å£å®šä¹‰äº†å¤šä¸ª append æ–¹æ³•ï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰ï¼Œæ‰®æ¼”æŠ½è±¡å»ºé€ è€…çš„èº«ä»½ï¼Œå®šä¹‰äº†æŠ½è±¡æ–¹æ³•ã€‚</p>
<p><img src="https://s1.ax1x.com/2021/12/09/ofdTFs.png" alt="image"></p>
<p><strong>AbstractStringBuilder</strong> å®ç°äº† <strong>Appendable</strong> æ¥å£ï¼Œæ‰®æ¼”è€…å»ºé€ è€…çš„èº«ä»½ï¼Œä½†ç”±äºæ˜¯æŠ½è±¡ç±»ï¼Œå¹¶ä¸èƒ½å®ä¾‹åŒ–ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractStringBuilder</span> <span class="keyword">implements</span> <span class="title">Appendable</span>, <span class="title">CharSequence</span> </span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AbstractStringBuilder <span class="title">append</span><span class="params">(<span class="keyword">char</span> c)</span> </span>{</span><br><span class="line">        ensureCapacityInternal(count + <span class="number">1</span>);</span><br><span class="line">        value[count++] = c;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>StringBuilder</strong> å……å½“äº†æŒ‡æŒ¥è€…çš„è§’è‰²ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å…·ä½“çš„å»ºé€ è€…ï¼Œå»ºé€ æ–¹æ³•çš„å®ç°å®¤å‹ <strong>AbstractStringBuilder</strong> å®ç°ï¼Œè€Œ <strong>StringBuilder</strong> ç»§æ‰¿äº† <strong>AbstractStringBuilder</strong>ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">StringBuilder</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractStringBuilder</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">CharSequence</span></span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> StringBuilder <span class="title">append</span><span class="params">(<span class="keyword">char</span> c)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.append(c);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    }</span><br><span class="line">    ...</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-5-4-æŠ½è±¡å·¥å‚æ¨¡å¼-vs-å»ºé€ è€…æ¨¡å¼"><a href="#4-5-4-æŠ½è±¡å·¥å‚æ¨¡å¼-vs-å»ºé€ è€…æ¨¡å¼" class="headerlink" title="4.5.4 æŠ½è±¡å·¥å‚æ¨¡å¼ vs å»ºé€ è€…æ¨¡å¼"></a>4.5.4 æŠ½è±¡å·¥å‚æ¨¡å¼ vs å»ºé€ è€…æ¨¡å¼</h4><ul>
<li><p>æŠ½è±¡å·¥å‚æ¨¡å¼å®ç°å¯¹äº§å“å®¶æ—çš„åˆ›å»ºï¼Œä¸€ä¸ªäº§å“å®¶æ—æ˜¯ä¸€ç³»åˆ—äº§å“ï¼Œå…·æœ‰ä¸åŒåˆ†ç±»ç»´åº¦çš„äº§å“ç»„åˆï¼Œé‡‡ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸éœ€è¦å…³å¿ƒæ„å»ºè¿‡ç¨‹ï¼Œåªå…³å¿ƒä»€ä¹ˆäº§å“ç”±ä»€ä¹ˆå·¥å‚ç”Ÿäº§å³å¯ã€‚</p>
</li>
<li><p>è€Œå»ºé€ è€…æ¨¡å¼åˆ™æ˜¯è¦æ±‚æŒ‰ç…§æŒ‡å®šçš„è“å›¾å»ºé€ äº§å“ï¼Œå®ƒçš„ä¸»è¦ç›®çš„æ˜¯é€šè¿‡ç»„è£…é›¶é…ä»¶è€Œäº§ç”Ÿä¸€ä¸ªæ–°äº§å“ï¼</p>
</li>
</ul>
<h4 id="4-5-5-å°ç»“"><a href="#4-5-5-å°ç»“" class="headerlink" title="4.5.5 å°ç»“"></a>4.5.5 å°ç»“</h4><ol>
<li>å®¢æˆ·ç«¯ä½¿ç”¨ç¨‹åºä¸å¿…çŸ¥é“äº§å“å†…éƒ¨ç»„æˆçš„ç»†èŠ‚ï¼Œå°†äº§å“æœ¬èº«ä¸äº§å“çš„åˆ›å»ºè¿‡ç¨‹è§£è€¦ï¼Œä½¿å¾—ç›¸åŒçš„åˆ›å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“å¯¹è±¡ã€‚</li>
<li>æ¯ä¸€ä¸ªå…·ä½“å»ºé€ è€…éƒ½ç›¸å¯¹ç‹¬ç«‹ï¼Œè€Œä¸å…¶ä»–çš„å…·ä½“å»ºé€ è€…æ— å…³ï¼Œå› æ­¤å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ›¿æ¢å…·ä½“å»ºé€ è€…æˆ–å¢åŠ æ–°çš„å…·ä½“å»ºé€ è€…ã€‚ç”¨æˆ·ä½¿ç”¨ä¸åŒçš„å…·ä½“å»ºé€ è€…å°±å¯ä»¥å¾—åˆ°ä¸åŒçš„äº§å“å¯¹è±¡ã€‚</li>
<li>å¯ä»¥æ›´åŠ ç²¾ç»†åœ°æ§åˆ¶äº§å“çš„åˆ›å»ºè¿‡ç¨‹ï¼Œå°†å¤æ‚çš„åˆ›å»ºè¿‡ç¨‹åˆ†è§£åœ¨ä¸åŒçš„æ–¹æ³•ä¸­ï¼Œä½¿å¾—åˆ›å»ºè¿‡ç¨‹æ›´åŠ æ¸…æ™°ï¼Œä¹Ÿæ›´æ–¹ä¾¿ä½¿ç”¨ç¨‹åºæ¥æ§åˆ¶åˆ›å»ºè¿‡ç¨‹ã€‚</li>
<li>å¢åŠ æ–°çš„å…·ä½“å»ºé€ è€…æ— é¡»ä¿®æ”¹åŸæœ‰ç±»åº“çš„ä»£ç ï¼ŒæŒ‡æŒ¥è€…ç±»é’ˆå¯¹æŠ½è±¡å»ºé€ è€…ç±»ç¼–ç¨‹ï¼Œç³»ç»Ÿæ‰©å±•æ–¹ä¾¿ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</li>
<li>å»ºé€ è€…æ¨¡å¼æ‰€åˆ›å»ºçš„äº§å“ä¸€èˆ¬å…·æœ‰è¾ƒå¤šçš„å…±åŒç‚¹ï¼Œå…¶ç»„æˆéƒ¨åˆ†ç›¸ä¼¼ï¼Œå¦‚æœäº§å“ä¹‹é—´çš„å·®å¼‚æ€§å¾ˆå¤§ï¼Œåˆ™ä¸é€‚åˆä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œå› æ­¤å…¶ä½¿ç”¨èŒƒå›´å—åˆ°ä¸€å®šçš„é™åˆ¶ã€‚</li>
<li>å¦‚æœäº§å“çš„å†…éƒ¨å˜åŒ–å¤æ‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´éœ€è¦å®šä¹‰å¾ˆå¤šå…·ä½“å»ºé€ è€…ç±»æ¥å®ç°è¿™ç§å˜åŒ–ï¼Œå¯¼è‡´ç³»ç»Ÿå˜å¾—å¾ˆåºå¤§ï¼Œå› æ­¤åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¦è€ƒè™‘æ˜¯å¦é€‰æ‹©å»ºé€ è€…æ¨¡å¼ã€‚</li>
</ol>
<h3 id="4-6-é€‚é…å™¨æ¨¡å¼"><a href="#4-6-é€‚é…å™¨æ¨¡å¼" class="headerlink" title="4.6 é€‚é…å™¨æ¨¡å¼"></a>4.6 é€‚é…å™¨æ¨¡å¼</h3><p>é€‚é…å™¨æ¨¡å¼å°†æŸä¸ªç±»çš„æ¥å£è½¬æ¢ä¸ºå®¢æˆ·ç«¯æœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£è¡¨ç¤ºï¼Œä¸»è¦ç›®çš„æ˜¯å…¼å®¹æ€§ã€‚è®©åŸæœ¬å› æ¥å£ä¸åŒ¹é…çš„ä¸¤ä¸ªç±»å¯ä»¥ååŒå·¥ä½œï¼Œåˆ«ååŒ…è£…å™¨ã€‚</p>
<p>é€‚é…å™¨ä¸»è¦æœ‰ä¸‰ç§å®ç°æ–¹å¼ï¼šç±»é€‚é…å™¨æ¨¡å¼ã€å¯¹è±¡é€‚é…å™¨æ¨¡å¼ã€æ¥å£é€‚é…å™¨æ¨¡å¼ã€‚</p>
<p>ä»¥ç”Ÿæ´»ä¸­å……ç”µå™¨çš„ä¾‹å­æ¥è¯´æ˜é€‚é…å™¨æ¨¡å¼ï¼Œå……ç”µå™¨æœ¬èº«ç›¸å½“äº <strong>Adapter</strong>ï¼Œ220V äº¤æµç”µ ç›¸å½“äº <strong>src</strong>ï¼ˆè¢«é€‚é…è€…ï¼‰ï¼Œè€Œæˆ‘ä»¬çš„ç›®æ ‡ <strong>dst</strong> æ˜¯ 5V ç›´æµç”µã€‚</p>
<h4 id="4-6-1-ç±»é€‚é…å™¨"><a href="#4-6-1-ç±»é€‚é…å™¨" class="headerlink" title="4.6.1 ç±»é€‚é…å™¨"></a>4.6.1 ç±»é€‚é…å™¨</h4><p><img src="https://s4.ax1x.com/2021/12/14/ojivPx.png" alt="image"></p>
<p>220Vï¼Œéœ€è¦è¢«é€‚é…çš„ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// è¢«é€‚é…ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Voltage220V</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output220V</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">int</span> src = <span class="number">220</span>;</span><br><span class="line">        System.out.println(<span class="string">"è¾“å‡º"</span> + src + <span class="string">"V..."</span>);</span><br><span class="line">        <span class="keyword">return</span> src;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>5Vï¼Œé€‚é…çš„ç›®æ ‡ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// é€‚é…ç›®æ ‡</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IVoltage5V</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">output5V</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>20Vï¼Œä¹Ÿæ˜¯é€‚é…çš„ç›®æ ‡ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// é€‚é…ç›®æ ‡</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IVoltage20V</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">output20V</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>é€‚é…å™¨ï¼Œå°† 220V äº¤æµç”µè½¬åŒ–ä¸ºå„ç§ç›´æµç”µã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VoltageAdapter</span> <span class="keyword">extends</span> <span class="title">Voltage220V</span> <span class="keyword">implements</span> <span class="title">IVoltage5V</span>, <span class="title">IVoltage20V</span></span>{</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output5V</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">int</span> src = output220V();</span><br><span class="line">        <span class="keyword">int</span> dst = src / <span class="number">44</span>; <span class="comment">// è½¬æˆ5V</span></span><br><span class="line">        System.out.println(<span class="string">"è½¬æ¢ä¸º"</span> + dst + <span class="string">"V..."</span>);</span><br><span class="line">        <span class="keyword">return</span> dst;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output20V</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">int</span> src = output220V();</span><br><span class="line">        <span class="keyword">int</span> dst = src/<span class="number">11</span>; <span class="comment">// è½¬æˆ20V</span></span><br><span class="line">        System.out.println(<span class="string">"è½¬æ¢ä¸º"</span> + dst + <span class="string">"Vå¿«å……..."</span>);</span><br><span class="line">        <span class="keyword">return</span> dst;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ‰‹æœºï¼Œä½¿ç”¨ç›®æ ‡çš„ç±»ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Phone</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">charging</span><span class="params">(IVoltage5V iVoltage5V)</span></span>{</span><br><span class="line">        <span class="keyword">if</span> (iVoltage5V.output5V() == <span class="number">5</span>){</span><br><span class="line">            System.out.println(<span class="string">"ç”µå‹ä¸º5Vï¼Œå¯ä»¥å……ç”µ~~"</span>);</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            System.out.println(<span class="string">"ç”µå‹ä¸ä¸º5Vï¼Œä¸èƒ½å……ç”µ~~"</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">chargingFast</span><span class="params">(IVoltage20V iVoltage20V)</span></span>{</span><br><span class="line">        <span class="keyword">if</span> (iVoltage20V.output20V() == <span class="number">20</span>){</span><br><span class="line">            System.out.println(<span class="string">"ç”µå‹ä¸º20Vï¼Œå¯ä»¥è¿›è¡Œå¿«å……~~"</span>);</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            System.out.println(<span class="string">"ç”µå‹ä¸ä¸º20Vï¼Œä¸èƒ½è¿›è¡Œå¿«å……ï¼Œå°†è‡ªåŠ¨è½¬æ¢ä¸ºæ™®é€šå……ç”µ~~"</span>);</span><br><span class="line">            charging((VoltageAdapter)iVoltage20V);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•ç±»ï¼Œè°ƒç”¨å……ç”µæ–¹æ³•åªéœ€è¦ä¼ å…¥ <strong>VoltageAdapter</strong> é€‚é…å™¨å¯¹è±¡å³å¯ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AdapterTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        <span class="keyword">new</span> Phone().charging(<span class="keyword">new</span> VoltageAdapter());</span><br><span class="line">        <span class="keyword">new</span> Phone().chargingFast(<span class="keyword">new</span> VoltageAdapter());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>ç”±äºç»§æ‰¿äº† src ç±»ï¼Œæ‰€ä»¥å®ƒå¯ä»¥æ ¹æ®éœ€æ±‚é‡å†™ src ç±»çš„æ–¹æ³•ï¼Œä½¿å¾— <strong>Adapter</strong> çš„çµæ´»æ€§å¢å¼ºã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>Java æ˜¯å•ç»§æ‰¿æœºåˆ¶ï¼Œæ‰€ä»¥ç±»é€‚é…å™¨éœ€è¦ç»§æ‰¿ src ç±»ä»è¿™ä¸€ç‚¹æ¥è¯´ç®—æ˜¯ä¸€ä¸ªç¼ºç‚¹ï¼Œå› ä¸ºè¿™è¦æ±‚ dst å¿…é¡»æ˜¯æ¥å£ï¼Œæœ‰ä¸€å®šçš„å±€é™æ€§ã€‚</li>
<li>src ç±»ä¸­çš„æ–¹æ³•åœ¨ <strong>Adapter</strong> ä¸­éƒ½ä¼šæš´éœ²å‡ºæ¥ï¼Œå¢åŠ ä½¿ç”¨çš„æˆæœ¬ã€‚</li>
</ul>
<h4 id="4-6-2-å¯¹è±¡é€‚é…å™¨"><a href="#4-6-2-å¯¹è±¡é€‚é…å™¨" class="headerlink" title="4.6.2 å¯¹è±¡é€‚é…å™¨"></a>4.6.2 å¯¹è±¡é€‚é…å™¨</h4><p>ä¸æ˜¯é‡‡ç”¨ç»§æ‰¿çš„æ–¹å¼ï¼Œè€Œæ˜¯ä½¿ç”¨ç»„åˆï¼ˆèšåˆï¼‰ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VoltageAdapter</span> <span class="keyword">implements</span> <span class="title">IVoltage5V</span>, <span class="title">IVoltage20V</span> </span>{</span><br><span class="line">    Voltage220V voltage220V = <span class="keyword">new</span> Voltage220V();</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output5V</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">int</span> src = voltage220V.output220V();</span><br><span class="line">        <span class="keyword">int</span> dst = src / <span class="number">44</span>; <span class="comment">// è½¬æˆ5V</span></span><br><span class="line">        System.out.println(<span class="string">"è½¬æ¢ä¸º"</span> + dst + <span class="string">"V..."</span>);</span><br><span class="line">        <span class="keyword">return</span> dst;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">output20V</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">int</span> src = voltage220V.output220V();</span><br><span class="line">        <span class="keyword">int</span> dst = src/<span class="number">11</span>; <span class="comment">// è½¬æˆ20V</span></span><br><span class="line">        System.out.println(<span class="string">"è½¬æ¢ä¸º"</span> + dst + <span class="string">"Vå¿«å……..."</span>);</span><br><span class="line">        <span class="keyword">return</span> dst;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å¯¹è±¡é€‚é…å™¨å’Œç±»é€‚é…å™¨å…¶å®æ˜¯åŒä¸€ç§æ€æƒ³ï¼Œåªä¸è¿‡å®ç°æ–¹å¼ä¸åŒã€‚æ ¹æ®åˆæˆå¤ç”¨åŸåˆ™ï¼Œä½¿ç”¨ç»„åˆæ›¿ä»£ç»§æ‰¿ï¼Œä½¿ç”¨æˆæœ¬æ›´ä½ä¹Ÿæ›´çµæ´»ï¼Œè§£å†³äº†ç±»é€‚é…å™¨å¿…é¡»ç»§æ‰¿ <strong>src</strong> çš„å±€é™æ€§é—®é¢˜ï¼Œä¹Ÿä¸å†è¦æ±‚ <strong>dst</strong> å¿…é¡»æ˜¯æ¥å£ã€‚</p>
<h4 id="4-6-3-æ¥å£é€‚é…å™¨"><a href="#4-6-3-æ¥å£é€‚é…å™¨" class="headerlink" title="4.6.3 æ¥å£é€‚é…å™¨"></a>4.6.3 æ¥å£é€‚é…å™¨</h4><p>å®ç°æ¥å£å°±éœ€è¦å®ç°å…¶ä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼Œä½†å¾ˆå¤šæ—¶å€™æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨åˆ°å…¶ä¸­ä¸€ä¸¤ä¸ªæ–¹æ³•è€Œå·²ï¼Œå†é‡å†™æ‰€æœ‰æ–¹æ³•å°±æ˜¾å¾—æœ‰äº›å¤šæ­¤ä¸€ä¸¾äº†ï¼Œè¿™ä¹Ÿå°±å¼•å‡ºäº†æ¥å£é€‚é…å™¨ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ä»…ä»…åªæƒ³å®ç°ä¸€ä¸ªé¼ æ ‡çš„ç‚¹å‡»äº‹ä»¶å´è¦æŠŠç§»å…¥ç§»å‡ºç­‰æ–¹æ³•éƒ½è¦å®ç°ä¸€éï¼Œä»£ç çœ‹èµ·æ¥ä¹Ÿä¼šæ¯”è¾ƒå†—é•¿ã€‚</span></span><br><span class="line"><span class="keyword">new</span> MouseListener() {</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseClicked</span><span class="params">(MouseEvent e)</span> </span>{</span><br><span class="line">        </span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mousePressed</span><span class="params">(MouseEvent e)</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseReleased</span><span class="params">(MouseEvent e)</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseEntered</span><span class="params">(MouseEvent e)</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseExited</span><span class="params">(MouseEvent e)</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨äº†æ¥å£é€‚é…å™¨å°±å¯ä»¥å®ç°æŒ‡å®šçš„æ–¹æ³•äº†</span></span><br><span class="line"><span class="keyword">new</span> MouseAdapter(){</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseClicked</span><span class="params">(MouseEvent e)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>.mouseClicked(e);</span><br><span class="line">    }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸è¿‡æ¥å£é€‚é…å™¨å¹¶ä¸æ˜¯ä»€ä¹ˆå¾ˆé«˜å¤§ä¸Šçš„æ€æƒ³ï¼Œåªæ˜¯åŠ äº†ä¸€å±‚æŠ½è±¡ç±»æ¥å¯¹æ–¹æ³•è¿›è¡Œç©ºå®ç°ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// å®ç°äº†MouseListeneræ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">MouseAdapter</span> <span class="keyword">implements</span> <span class="title">MouseListener</span>, <span class="title">MouseWheelListener</span>, <span class="title">MouseMotionListener</span> </span>{</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * {<span class="doctag">@inheritDoc</span>}</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseClicked</span><span class="params">(MouseEvent e)</span> </span>{}</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * {<span class="doctag">@inheritDoc</span>}</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mousePressed</span><span class="params">(MouseEvent e)</span> </span>{}</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * {<span class="doctag">@inheritDoc</span>}</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseReleased</span><span class="params">(MouseEvent e)</span> </span>{}</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * {<span class="doctag">@inheritDoc</span>}</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseEntered</span><span class="params">(MouseEvent e)</span> </span>{}</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * {<span class="doctag">@inheritDoc</span>}</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseExited</span><span class="params">(MouseEvent e)</span> </span>{}</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * {<span class="doctag">@inheritDoc</span>}</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.6</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseWheelMoved</span><span class="params">(MouseWheelEvent e)</span></span>{}</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * {<span class="doctag">@inheritDoc</span>}</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.6</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseDragged</span><span class="params">(MouseEvent e)</span></span>{}</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * {<span class="doctag">@inheritDoc</span>}</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 1.6</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseMoved</span><span class="params">(MouseEvent e)</span></span>{}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ¥å£</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Interface</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">m1</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">m2</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">m3</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">m4</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æŠ½è±¡ç±»ç©ºå®ç°</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbsAdapter</span> <span class="keyword">implements</span> <span class="title">Interface</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m1</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m2</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m3</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m4</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä»£ç å®ç°</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">    <span class="keyword">new</span> AbsAdapter(){</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m1</span><span class="params">()</span> </span>{</span><br><span class="line">            <span class="keyword">super</span>.m1();</span><br><span class="line">        }</span><br><span class="line">    };</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">new</span> Interface(){</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m1</span><span class="params">()</span> </span>{</span><br><span class="line">            </span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m2</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m3</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">m4</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">        }</span><br><span class="line">    };</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-6-4-é€‚é…å™¨æ¨¡å¼åœ¨-Spring-Mvcä¸­çš„åº”ç”¨"><a href="#4-6-4-é€‚é…å™¨æ¨¡å¼åœ¨-Spring-Mvcä¸­çš„åº”ç”¨" class="headerlink" title="4.6.4 é€‚é…å™¨æ¨¡å¼åœ¨ Spring Mvcä¸­çš„åº”ç”¨"></a>4.6.4 é€‚é…å™¨æ¨¡å¼åœ¨ Spring Mvcä¸­çš„åº”ç”¨</h4><p><img src="https://s4.ax1x.com/2021/12/14/ojIluD.png" alt="image"></p>
<p><img src="https://s4.ax1x.com/2021/12/14/ojIU8P.png" alt="image"></p>
<p><img src="https://s4.ax1x.com/2021/12/14/ojIyUs.png" alt="image"></p>
<p>å¯èƒ½çœ‹ç€ä¼šè§‰å¾—å¤šæ­¤ä¸€ä¸¾ï¼Œä¸€å¼€å§‹å°±è·å–äº†å¤„ç†å™¨ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥è°ƒç”¨å®ƒçš„æ–¹æ³•å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºé€‚é…å™¨è°ƒç”¨å¤„ç†å™¨çš„æ–¹æ³•å¯ä»¥æ·»åŠ <strong>é€‚é…åŠŸèƒ½</strong>ä½¿å¾—è¢«ä½¿ç”¨è€…æ‰€éœ€è¦ã€‚</p>
<ul>
<li>Spring å®šä¹‰äº†ä¸€ä¸ªé€‚é…æ¥å£ï¼Œä½¿å¾—æ¯ä¸€ç§ Controller éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„é€‚é…å™¨å®ç°ç±»</li>
<li>é€‚é…å™¨ä»£æ›¿ Controller æ‰§è¡Œå“åº”çš„æ–¹æ³•</li>
<li>æ‰©å±• Controller æ—¶ï¼Œåªéœ€è¦å¢åŠ ä¸€ä¸ªé€‚é…å™¨çš„ç±»å°±å®Œæˆäº† SpringMVC çš„æ‰©å±•ã€‚</li>
</ul>
<h4 id="4-6-5-æ¨¡æ‹Ÿ-HandlerAdapter-çš„å®ç°"><a href="#4-6-5-æ¨¡æ‹Ÿ-HandlerAdapter-çš„å®ç°" class="headerlink" title="4.6.5 æ¨¡æ‹Ÿ HandlerAdapter çš„å®ç°"></a>4.6.5 æ¨¡æ‹Ÿ HandlerAdapter çš„å®ç°</h4><p>Controller å¤„ç†å™¨ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// è™½ç„¶æŠ½è±¡ç±»æ±‡æ€»æ²¡æœ‰æ–¹æ³•ï¼Œä½†å¯ä»¥ä½¿å¾—å„ä¸ªå­ç±»å¯ä»¥å¤šæ€ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Controller</span> </span>{</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HttpController</span> <span class="keyword">implements</span> <span class="title">Controller</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doHttpHandler</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"http..."</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleController</span> <span class="keyword">implements</span> <span class="title">Controller</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doSimpleHandler</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"simple..."</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnnotationController</span> <span class="keyword">implements</span> <span class="title">Controller</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAnnotationHandler</span><span class="params">()</span></span>{</span><br><span class="line">        System.out.println(<span class="string">"annotation..."</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Adapter é€‚é…å™¨ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HandlerAdapter</span> </span>{</span><br><span class="line">    <span class="comment">// æ£€æµ‹é€‚é…å™¨å’Œå¤„ç†å™¨æ˜¯å¦æ”¯æŒ</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span></span>;</span><br><span class="line">    <span class="comment">// è°ƒç”¨å¹¶æ‰§è¡Œå¤„ç†å™¨æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">handle</span><span class="params">(Object handler)</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HttpAdapter</span> <span class="keyword">implements</span> <span class="title">HandlerAdapter</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> handler <span class="keyword">instanceof</span> HttpController;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(Object handler)</span> </span>{</span><br><span class="line">        ((HttpController)handler).doHttpHandler();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleAdapter</span> <span class="keyword">implements</span> <span class="title">HandlerAdapter</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> handler <span class="keyword">instanceof</span> SimpleController;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(Object handler)</span> </span>{</span><br><span class="line">        ((SimpleController)handler).doSimpleHandler();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnnotationAdapter</span> <span class="keyword">implements</span> <span class="title">HandlerAdapter</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supports</span><span class="params">(Object handler)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> handler <span class="keyword">instanceof</span> AnnotationController;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(Object handler)</span> </span>{</span><br><span class="line">        ((AnnotationController)handler).doAnnotationHandler();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>DispatcherServlet åˆ†å‘å™¨</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DispatcherServlet</span> </span>{</span><br><span class="line">    <span class="comment">// æ‰€æœ‰é€‚é…å™¨é›†åˆ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;HandlerAdapter&gt; handlerAdapters = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> {</span><br><span class="line">        handlerAdapters.add(<span class="keyword">new</span> AnnotationAdapter());</span><br><span class="line">        handlerAdapters.add(<span class="keyword">new</span> SimpleAdapter());</span><br><span class="line">        handlerAdapters.add(<span class="keyword">new</span> HttpAdapter());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ‹ŸSpringMVCä»requestå–handlerçš„å¯¹è±¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doDispatch</span><span class="params">(Controller controller)</span></span>{</span><br><span class="line">        <span class="comment">// è·å–å¤„ç†å™¨å¯¹åº”çš„é€‚é…å™¨</span></span><br><span class="line">        HandlerAdapter adapter = getHandler(controller);</span><br><span class="line">        <span class="comment">// é€‚é…å™¨è°ƒç”¨å¹¶æ‰§è¡Œå¤„ç†å™¨</span></span><br><span class="line">        adapter.handle(controller);</span><br><span class="line">    }</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// éå†é€‚é…å™¨é›†åˆï¼Œæ‰¾åˆ°å…¼å®¹è¯¥å¤„ç†å™¨çš„é€‚é…å™¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HandlerAdapter <span class="title">getHandler</span><span class="params">(Controller controller)</span></span>{</span><br><span class="line">        <span class="keyword">for</span> (HandlerAdapter handlerAdapter : handlerAdapters) {</span><br><span class="line">            <span class="keyword">if</span> (handlerAdapter.supports(controller)){</span><br><span class="line">                <span class="keyword">return</span> handlerAdapter;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        DispatcherServlet servlet = <span class="keyword">new</span> DispatcherServlet();</span><br><span class="line">        servlet.doDispatch(<span class="keyword">new</span> HttpController());</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-6-6-å°ç»“"><a href="#4-6-6-å°ç»“" class="headerlink" title="4.6.6 å°ç»“"></a>4.6.6 å°ç»“</h4><ul>
<li>ç±»é€‚é…å™¨ï¼šä»¥ç±»ç»™åˆ°ï¼Œåœ¨ <strong>Adapter</strong> ä¸­ï¼Œå°±æ˜¯å°† src å½“åšç±»ï¼Œ<strong>ç»§æ‰¿</strong>ã€‚</li>
<li>å¯¹è±¡é€‚é…å™¨ï¼šä»¥å¯¹è±¡ç»™åˆ°ï¼Œåœ¨ <strong>Adapter</strong> ä¸­ï¼Œå°±æ˜¯å°† src å½“åšå¯¹è±¡ï¼Œ<strong>æŒæœ‰</strong>ã€‚</li>
<li>æ¥å£é€‚é…å™¨ï¼šä»¥æ¥å£ç»™åˆ°ï¼Œåœ¨ <strong>Adapter</strong> ä¸­ï¼Œå°±æ˜¯å°† src å½“åšæ¥å£ï¼Œ<strong>å®ç°</strong>ã€‚</li>
</ul>
<p><strong>Adapter</strong> æ¨¡å¼æœ€å¤§çš„ä½œç”¨è¿˜æ˜¯å°†åŸæœ¬ä¸å…¼å®¹çš„æ¥å£èåˆåœ¨ä¸€èµ·å·¥ä½œã€‚</p>
<p>å®é™…å¼€å‘ä¸­ï¼Œå®ç°èµ·æ¥ä¸æ‹˜æ³¥äºä»¥ä¸Šä¸‰ç§ç»å…¸æ–¹å¼ã€‚</p>
<h3 id="4-7-æ¡¥æ¥æ¨¡å¼"><a href="#4-7-æ¡¥æ¥æ¨¡å¼" class="headerlink" title="4.7 æ¡¥æ¥æ¨¡å¼"></a>4.7 æ¡¥æ¥æ¨¡å¼</h3><h4 id="4-7-1-åŸºæœ¬ä»‹ç»"><a href="#4-7-1-åŸºæœ¬ä»‹ç»" class="headerlink" title="4.7.1 åŸºæœ¬ä»‹ç»"></a>4.7.1 åŸºæœ¬ä»‹ç»</h4><p>1ï¼‰ æ¡¥æ¥æ¨¡å¼ï¼ˆBridgeï¼‰æ˜¯æŒ‡ï¼šå°†<strong>å®ç°</strong>å’ŒæŠ½è±¡æ”¾åœ¨ä¸¤ä¸ªä¸åŒçš„ç±»å±‚æ¬¡ä¸­ï¼Œä½¿ä¸¤ä¸ªå±‚æ¬¡å¯ä»¥ç‹¬ç«‹æ”¹å˜ã€‚</p>
<p>2ï¼‰ æ¡¥æ¥æ¨¡å¼æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ã€‚</p>
<p>3ï¼‰ æ¡¥æ¥æ¨¡å¼åŸºäº<code>ç±»çš„æœ€å°è®¾è®¡åŸåˆ™</code>ï¼Œé€šè¿‡ä½¿ç”¨å°è£…ã€èšåˆåŠç»§æ‰¿ç­‰è¡Œä¸ºè®©ä¸åŒçš„ç±»æ‰¿æ‹…ä¸åŒçš„èŒè´£ã€‚å®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯æŠŠ<strong>æŠ½è±¡</strong>ä¸<strong>å®ç°</strong>åˆ†ç¦»å¼€æ¥ï¼Œä»è€Œå¯ä»¥ä¿æŒå„éƒ¨åˆ†çš„ç‹¬ç«‹æ€§ä»¥åŠå¯¹ä»–ä»¬çš„åŠŸèƒ½æ‹“å±•ã€‚</p>
<h4 id="4-7-2-æ‰‹æœºæ‹“å±•é—®é¢˜"><a href="#4-7-2-æ‰‹æœºæ‹“å±•é—®é¢˜" class="headerlink" title="4.7.2 æ‰‹æœºæ‹“å±•é—®é¢˜"></a>4.7.2 æ‰‹æœºæ‹“å±•é—®é¢˜</h4><p>ä½¿ç”¨æ¡¥æ¥æ¨¡å¼æ”¹è¿›ä¼ ç»Ÿæ–¹å¼ï¼Œè®©ç¨‹åºå…·æœ‰æ›´å¥½çš„æ‹“å±•æ€§ï¼Œåˆ©äºç¨‹åºç»´æŠ¤ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/25/TUeIJO.png" alt="image"></p>
<p>ä¼ ç»Ÿæ–¹å¼éœ€è¦ mï¼ˆæ‰‹æœºæ ·å¼ï¼‰ * nï¼ˆæ‰‹æœºå“ç‰Œï¼‰ ä¸ªç±»ï¼Œææ˜“äº§ç”Ÿç±»çˆ†ç‚¸çš„é—®é¢˜ï¼Œè€Œä¸”æ¯æ–°å¢ä¸€ä¸ªæ‰‹æœºæ ·å¼å°±åˆè¦å¢åŠ  n ä¸ªç±»ï¼Œæ‹“å±•æå…¶ç¹çã€‚</p>
<p>è€Œé‡‡ç”¨äº†æ¡¥æ¥æ¨¡å¼ä¹‹åï¼Œå¯ä»¥å°† m * n é™ä¸º m + nï¼Œå¹³æ–¹é™çº¿æ€§ã€‚</p>
<h4 id="4-7-3-ä»£ç å®ç°"><a href="#4-7-3-ä»£ç å®ç°" class="headerlink" title="4.7.3 ä»£ç å®ç°"></a>4.7.3 ä»£ç å®ç°</h4><p>UML å›¾å¦‚ä¸‹</p>
<p><img src="https://s4.ax1x.com/2021/12/25/TU6lJP.png" alt="image"></p>
<p>æ ·å¼åŸºç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IStyle</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ ·å¼æ¥å£ç±»ï¼ˆæ­¤å¤„å¯ä»¥çœç•¥ï¼‰</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IFold</span> <span class="keyword">extends</span> <span class="title">IStyle</span> </span>{</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ISpread</span> <span class="keyword">extends</span> <span class="title">IStyle</span> </span>{</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IStand</span> <span class="keyword">extends</span> <span class="title">IStyle</span> </span>{</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ ·å¼å®ä½“ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FoldStyle</span> <span class="keyword">implements</span> <span class="title">IFold</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"æ‰‹æœºæŠ˜å "</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"æŠ˜å æ‰‹æœºå¼€æœº"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"æŠ˜å æ‰‹æœºå…³æœº"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpreadStyle</span> <span class="keyword">implements</span> <span class="title">ISpread</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"æ‰‹æœºæ—‹è½¬"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"æ—‹è½¬æ‰‹æœºå¼€æœº"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"æ—‹è½¬æ‰‹æœºå…³æœº"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StandStyle</span> <span class="keyword">implements</span> <span class="title">IStand</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"æ‰‹æœºç›´ç«‹"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"ç›´ç«‹æ‰‹æœºå¼€æœº"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"ç›´ç«‹æ‰‹æœºå…³æœº"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ‰‹æœºæŠ½è±¡ç±»ï¼Œèšåˆæ ·å¼åŸºç±»ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Phone</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> IStyle stylePhone;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Phone</span><span class="params">(IStyle stylePhone)</span></span>{</span><br><span class="line">        <span class="keyword">this</span>.stylePhone = stylePhone;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>{</span><br><span class="line">        stylePhone.show();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span></span>{</span><br><span class="line">        stylePhone.open();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span>{</span><br><span class="line">        stylePhone.close();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æ‰‹æœºå®ä½“ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HuaWeiPhone</span> <span class="keyword">extends</span> <span class="title">Phone</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HuaWeiPhone</span><span class="params">(IStyle stylePhone)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(stylePhone);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"åä¸ºæ‰‹æœº~"</span>);</span><br><span class="line">        <span class="keyword">super</span>.show();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"åä¸ºæ‰‹æœº~"</span>);</span><br><span class="line">        <span class="keyword">super</span>.open();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"åä¸ºæ‰‹æœº~"</span>);</span><br><span class="line">        <span class="keyword">super</span>.open();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OppoPhone</span> <span class="keyword">extends</span> <span class="title">Phone</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OppoPhone</span><span class="params">(IStyle stylePhone)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(stylePhone);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"Oppoæ‰‹æœº~"</span>);</span><br><span class="line">        <span class="keyword">super</span>.show();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"Oppoæ‰‹æœº~"</span>);</span><br><span class="line">        <span class="keyword">super</span>.open();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"Oppoæ‰‹æœº~"</span>);</span><br><span class="line">        <span class="keyword">super</span>.open();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">XiaoMiPhone</span> <span class="keyword">extends</span> <span class="title">Phone</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">XiaoMiPhone</span><span class="params">(IStyle stylePhone)</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(stylePhone);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"å°ç±³æ‰‹æœº~"</span>);</span><br><span class="line">        <span class="keyword">super</span>.show();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">open</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"å°ç±³æ‰‹æœº~"</span>);</span><br><span class="line">        <span class="keyword">super</span>.open();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>{</span><br><span class="line">        System.out.println(<span class="string">"å°ç±³æ‰‹æœº~"</span>);</span><br><span class="line">        <span class="keyword">super</span>.open();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PhoneTest</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        Phone phone1 = <span class="keyword">new</span> HuaWeiPhone(<span class="keyword">new</span> SpreadStyle());</span><br><span class="line">        phone1.open();</span><br><span class="line"></span><br><span class="line">        Phone phone2 = <span class="keyword">new</span> OppoPhone(<span class="keyword">new</span> FoldStyle());</span><br><span class="line">        phone2.show();</span><br><span class="line"></span><br><span class="line">        Phone phone3 = <span class="keyword">new</span> XiaoMiPhone(<span class="keyword">new</span> StandStyle());</span><br><span class="line">        phone3.close();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>è¾“å‡ºç»“æœ</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">åä¸ºæ‰‹æœº~</span><br><span class="line">æ—‹è½¬æ‰‹æœºå¼€æœº</span><br><span class="line">Oppoæ‰‹æœº~</span><br><span class="line">æ‰‹æœºæŠ˜å </span><br><span class="line">å°ç±³æ‰‹æœº~</span><br><span class="line">ç›´ç«‹æ‰‹æœºå¼€æœº</span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-7-4-æ¡¥æ¥æ¨¡å¼åœ¨-JDBC-çš„è¿ç”¨"><a href="#4-7-4-æ¡¥æ¥æ¨¡å¼åœ¨-JDBC-çš„è¿ç”¨" class="headerlink" title="4.7.4 æ¡¥æ¥æ¨¡å¼åœ¨ JDBC çš„è¿ç”¨"></a>4.7.4 æ¡¥æ¥æ¨¡å¼åœ¨ JDBC çš„è¿ç”¨</h4><p>åœ¨ JDBC ä¸­å¹¶ä¸æ˜¯çœŸæ­£çš„æ¡¥æ¥æ¨¡å¼ï¼Œæ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œ<strong>DriverManager</strong> ç›´æ¥å°±æ˜¯å®ä½“ç±»äº†ï¼Œå¹¶ä¸æ˜¯æŠ½è±¡ç±»ä¹Ÿæ²¡æœ‰å­ç±»ï¼Œä½†å…·ä½“æ€æƒ³è¿˜æ˜¯ä¸€æ ·çš„ã€‚</p>
<p><img src="https://s4.ax1x.com/2021/12/25/TU27OU.png" alt="image"></p>
<h4 id="4-7-5-æ¡¥æ¥æ¨¡å¼é€‚ç”¨åœºæ™¯"><a href="#4-7-5-æ¡¥æ¥æ¨¡å¼é€‚ç”¨åœºæ™¯" class="headerlink" title="4.7.5 æ¡¥æ¥æ¨¡å¼é€‚ç”¨åœºæ™¯"></a>4.7.5 æ¡¥æ¥æ¨¡å¼é€‚ç”¨åœºæ™¯</h4><ul>
<li>å¯¹äºé‚£äº›ä¸å¸Œæœ›é€‚ç”¨ç»§æ‰¿æˆ–å› ä¸ºå¤šå±‚æ¬¡ç»§æ‰¿è€Œå¯¼è‡´ç³»ç»Ÿç±»çš„ä¸ªæ•°å‰§å¢åŠ çš„ç³»ç»Ÿï¼Œæ¡¥æ¥æ¨¡å¼å°¤ä¸ºé€‚ç”¨ã€‚</li>
<li>å¸¸è§çš„åº”ç”¨åœºæ™¯<ul>
<li>JDBC é©±åŠ¨ç¨‹åº</li>
<li>é“¶è¡Œè½¬è´¦ç³»ç»Ÿ<ul>
<li>è½¬è´¦åˆ†ç±»ï¼šç½‘ä¸Šè½¬è´¦ï¼ŒæŸœå°è½¬è´¦ï¼ŒATMè½¬è´¦ã€‚</li>
<li>è½¬è´¦ç”¨æˆ·ç±»å‹ï¼šæ™®é€šç”¨æˆ·ï¼Œé“¶è¡Œå¡ç”¨æˆ·ï¼ŒVIP ç”¨æˆ·ã€‚</li>
</ul>
</li>
<li>æ¶ˆæ¯ç®¡ç†<ul>
<li>æ¶ˆæ¯ç±»å‹ï¼šå³æ—¶æ¶ˆæ¯ï¼Œå»¶æ—¶æ¶ˆæ¯ã€‚</li>
<li>æ¶ˆæ¯åˆ†ç±»ï¼šæ‰‹æœºçŸ­ä¿¡ï¼Œé‚®ä»¶æ¶ˆæ¯ï¼Œqq æ¶ˆæ¯ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="4-7-6-å°ç»“"><a href="#4-7-6-å°ç»“" class="headerlink" title="4.7.6 å°ç»“"></a>4.7.6 å°ç»“</h4><ul>
<li>æ¡¥æ¥æ¨¡å¼å®ç°äº†æŠ½è±¡å’Œå®ç°éƒ¨åˆ†çš„åˆ†ç¦»ï¼Œä»è€Œæå¤§çš„æä¾›äº†ç³»ç»Ÿçš„çµæ´»æ€§ï¼Œè®©æŠ½è±¡éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†ç‹¬ç«‹å¼€æ¥ï¼Œè¿™æœ‰åŠ©äºç³»ç»Ÿè¿›è¡Œåˆ†å±‚è®¾è®¡ï¼Œä»è€Œäº§ç”Ÿæ›´å¥½çš„ç»“æ„åŒ–ç³»ç»Ÿã€‚</li>
<li>å¯¹äºç³»ç»Ÿçš„é«˜å±‚éƒ¨åˆ†ï¼Œåªéœ€è¦çŸ¥é“æŠ½è±¡éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†çš„æ¥å£å°±è¡Œäº†ï¼Œå…¶å®ƒçš„éƒ¨åˆ†ç”±å…·ä½“ä¸šåŠ¡æ¥å®Œæˆã€‚</li>
<li>æ¡¥æ¥æ¨¡å¼æ›¿ä»£å¤šå±‚ç»§æ‰¿æ–¹æ¡ˆï¼Œæœ‰æ•ˆå‡å°‘äº†å­ç±»çš„ä¸ªæ•°ï¼Œé™ä½ç³»ç»Ÿçš„ç®¡ç†å’Œç»´æŠ¤æˆæœ¬ã€‚</li>
<li>æ¡¥æ¥æ¨¡å¼çš„å¼•å…¥å¢åŠ äº†ç³»ç»Ÿçš„ç†è§£å’Œè®¾è®¡éš¾åº¦ï¼Œç”±äºèšåˆå…³è”å…³ç³»å»ºç«‹åœ¨æŠ½è±¡å±‚ï¼Œè¦æ±‚å¼€å‘è€…é’ˆå¯¹æŠ½æ˜‚è¿›è¡Œè®¾è®¡å’Œç¼–ç¨‹ã€‚</li>
<li>æ¡¥æ¥æ¨¡å¼è¦æ±‚æ­£ç¡®è¯†åˆ«å‡ºç³»ç»Ÿä¸­ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œå› æ­¤å…¶ä½¿ç”¨èŒƒå›´æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œå³éœ€è¦æœ‰è¿™æ ·çš„åº”ç”¨åœºæ™¯ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>DesignPattern</category>
      </categories>
  </entry>
  <entry>
    <title>Redis</title>
    <url>/2021/11/24/Redis/</url>
    <content><![CDATA[<h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯-Redisï¼Ÿ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯-Redisï¼Ÿ" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯ Redisï¼Ÿ"></a>ä¸€ã€ä»€ä¹ˆæ˜¯ Redisï¼Ÿ</h2><h4 id="1-1ã€ç®€ä»‹"><a href="#1-1ã€ç®€ä»‹" class="headerlink" title="1.1ã€ç®€ä»‹"></a>1.1ã€ç®€ä»‹</h4><p>REmote DIctionary Server(Redis) æ˜¯ä¸€ä¸ªç”± Salvatore Sanfilippo å†™çš„ key-value å­˜å‚¨ç³»ç»Ÿï¼Œæ˜¯è·¨å¹³å°çš„éå…³ç³»å‹æ•°æ®åº“ã€‚</p>
<p>Redis æ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ ANSI C è¯­è¨€ç¼–å†™ã€éµå®ˆ BSD åè®®ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜ã€åˆ†å¸ƒå¼ã€å¯é€‰æŒä¹…æ€§çš„é”®å€¼å¯¹(Key-Value)å­˜å‚¨æ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„ APIã€‚</p>
<p>Redis é€šå¸¸è¢«ç§°ä¸ºæ•°æ®ç»“æ„æœåŠ¡å™¨ï¼Œå› ä¸ºå€¼ï¼ˆvalueï¼‰å¯ä»¥æ˜¯å­—ç¬¦ä¸²(String)ã€å“ˆå¸Œ(Hash)ã€åˆ—è¡¨(list)ã€é›†åˆ(sets)å’Œæœ‰åºé›†åˆ(sorted sets)ç­‰ç±»å‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/24/oCz0ld.png" alt=""></p>
<h4 id="1-2ã€ç‰¹ç‚¹"><a href="#1-2ã€ç‰¹ç‚¹" class="headerlink" title="1.2ã€ç‰¹ç‚¹"></a>1.2ã€ç‰¹ç‚¹</h4><p>Redis æ˜¯å®Œå…¨å¼€æºçš„ï¼Œéµå®ˆ BSD åè®®ï¼ˆå¯ä»¥è‡ªç”±çš„ä½¿ç”¨ï¼Œä¿®æ”¹æºä»£ç ï¼Œä¹Ÿå¯ä»¥å°†ä¿®æ”¹åçš„ä»£ç ä½œä¸ºå¼€æºæˆ–è€…ä¸“æœ‰è½¯ä»¶å†å‘å¸ƒï¼‰ï¼Œæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ key-value æ•°æ®åº“ã€‚</p>
<p>Redis ä¸å…¶ä»– key - value ç¼“å­˜äº§å“æœ‰ä»¥ä¸‹ä¸‰ä¸ªç‰¹ç‚¹ï¼š</p>
<ul>
<li>Redisæ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ã€‚</li>
<li>Redisä¸ä»…ä»…æ”¯æŒç®€å•çš„key-valueç±»å‹çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜æä¾›listï¼Œsetï¼Œzsetï¼Œhashç­‰æ•°æ®ç»“æ„çš„å­˜å‚¨ã€‚</li>
<li>Redisæ”¯æŒæ•°æ®çš„å¤‡ä»½ï¼Œå³ master-slave æ¨¡å¼çš„æ•°æ®å¤‡ä»½ã€‚</li>
</ul>
<span id="more"></span>
<h4 id="1-3ã€ä¼˜åŠ¿"><a href="#1-3ã€ä¼˜åŠ¿" class="headerlink" title="1.3ã€ä¼˜åŠ¿"></a>1.3ã€ä¼˜åŠ¿</h4><ul>
<li>æ€§èƒ½æé«˜ â€“ Redis èƒ½è¯»çš„é€Ÿåº¦æ˜¯110000æ¬¡/s,å†™çš„é€Ÿåº¦æ˜¯81000æ¬¡/s ã€‚</li>
<li>ä¸°å¯Œçš„æ•°æ®ç±»å‹ â€“ Redis æ”¯æŒäºŒè¿›åˆ¶æ¡ˆä¾‹çš„ Strings, Lists, Hashes, Sets åŠ Ordered Sets æ•°æ®ç±»å‹æ“ä½œã€‚</li>
<li>åŸå­ â€“ Redis çš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ï¼Œæ„æ€å°±æ˜¯è¦ä¹ˆæˆåŠŸæ‰§è¡Œè¦ä¹ˆå¤±è´¥å®Œå…¨ä¸æ‰§è¡Œã€‚å•ä¸ªæ“ä½œæ˜¯åŸå­æ€§çš„ã€‚å¤šä¸ªæ“ä½œä¹Ÿæ”¯æŒäº‹åŠ¡ï¼Œå³åŸå­æ€§ï¼Œé€šè¿‡ MULTI å’Œ EXEC æŒ‡ä»¤åŒ…èµ·æ¥ã€‚</li>
<li>ä¸°å¯Œçš„ç‰¹æ€§ â€“ Redis è¿˜æ”¯æŒ publish/subscribe, é€šçŸ¥, key è¿‡æœŸç­‰ç­‰ç‰¹æ€§ã€‚</li>
</ul>
<h4 id="1-4ã€ä¸å…¶å®ƒ-key-value-å­˜å‚¨æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"><a href="#1-4ã€ä¸å…¶å®ƒ-key-value-å­˜å‚¨æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ" class="headerlink" title="1.4ã€ä¸å…¶å®ƒ key-value å­˜å‚¨æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"></a>1.4ã€ä¸å…¶å®ƒ key-value å­˜å‚¨æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h4><ul>
<li>Redisæœ‰ç€æ›´ä¸ºå¤æ‚çš„æ•°æ®ç»“æ„å¹¶ä¸”æä¾›å¯¹ä»–ä»¬çš„åŸå­æ€§æ“ä½œï¼Œè¿™æ˜¯ä¸€ä¸ªä¸åŒäºå…¶ä»–æ•°æ®åº“çš„è¿›åŒ–è·¯å¾„ã€‚Redisçš„æ•°æ®ç±»å‹éƒ½æ˜¯åŸºäºåŸºæœ¬æ•°æ®ç»“æ„çš„åŒæ—¶å¯¹ç¨‹åºå‘˜é€æ˜ï¼Œæ— éœ€è¿›è¡Œé¢å¤–çš„æŠ½è±¡ã€‚</li>
<li>Redisè¿è¡Œåœ¨å†…å­˜ä¸­ä½†æ˜¯å¯ä»¥æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ‰€ä»¥åœ¨å¯¹ä¸åŒæ•°æ®é›†è¿›è¡Œé«˜é€Ÿè¯»å†™æ—¶éœ€è¦æƒè¡¡å†…å­˜ï¼Œå› ä¸ºæ•°æ®é‡ä¸èƒ½å¤§äºç¡¬ä»¶å†…å­˜ã€‚åœ¨å†…å­˜æ•°æ®åº“æ–¹é¢çš„å¦ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œç›¸æ¯”åœ¨ç£ç›˜ä¸Šç›¸åŒçš„å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œåœ¨å†…å­˜ä¸­æ“ä½œèµ·æ¥éå¸¸ç®€å•ï¼Œè¿™æ ·Rediså¯ä»¥åšå¾ˆå¤šå†…éƒ¨å¤æ‚æ€§å¾ˆå¼ºçš„äº‹æƒ…ã€‚åŒæ—¶ï¼Œåœ¨ç£ç›˜æ ¼å¼æ–¹é¢ä»–ä»¬æ˜¯ç´§å‡‘çš„ä»¥è¿½åŠ çš„æ–¹å¼äº§ç”Ÿçš„ï¼Œå› ä¸ºä»–ä»¬å¹¶ä¸éœ€è¦è¿›è¡Œéšæœºè®¿é—®ã€‚</li>
</ul>
<h2 id="äºŒã€Redis-å®‰è£…"><a href="#äºŒã€Redis-å®‰è£…" class="headerlink" title="äºŒã€Redis å®‰è£…"></a>äºŒã€Redis å®‰è£…</h2><h4 id="2-1ã€å®‰è£…"><a href="#2-1ã€å®‰è£…" class="headerlink" title="2.1ã€å®‰è£…"></a>2.1ã€å®‰è£…</h4><p>å…ˆä¸‹è½½ Redis çš„å‹ç¼©åŒ…ï¼Œ<a href="https://download.redis.io/releases/redis-6.2.6.tar.gz">Redis 6.2.6 is the latest stable version.</a></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">tar -zxvf redis-6.2.6.tar.gz -C /usr <span class="comment"># è§£å‹æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cd</span> /usr/redis-6.2.6 <span class="comment"># è¿›å…¥è¯¥ç›®å½•</span></span><br><span class="line">make <span class="comment"># ç¼–è¯‘</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ‰§è¡Œå®Œ <strong>make</strong> å‘½ä»¤åï¼Œredis-6.2.6 çš„ <strong>src</strong> ç›®å½•ä¸‹ä¼šå‡ºç°ç¼–è¯‘åçš„ redis æœåŠ¡ç¨‹åº redis-serverï¼Œè¿˜æœ‰ç”¨äºæµ‹è¯•çš„å®¢æˆ·ç«¯ç¨‹åº redis-cliï¼š</p>
<p>ä¸‹é¢å¯åŠ¨ redis æœåŠ¡ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> src</span><br><span class="line">./redis-server</span><br></pre></td></tr></tbody></table></figure>
<p>æ³¨æ„è¿™ç§æ–¹å¼å¯åŠ¨ redis ä½¿ç”¨çš„æ˜¯é»˜è®¤é…ç½®ã€‚ä¹Ÿå¯ä»¥é€šè¿‡å¯åŠ¨å‚æ•°å‘Šè¯‰ redis ä½¿ç”¨æŒ‡å®šé…ç½®æ–‡ä»¶ä½¿ç”¨ä¸‹é¢å‘½ä»¤å¯åŠ¨ï¼ˆæºæ–‡ä»¶å°±å½“å¤‡ä»½äº†ï¼Œä¸è¦ä¹±æ”¹ï¼‰ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">./redis-server MyRedis.conf</span><br></pre></td></tr></tbody></table></figure>
<p>é»˜è®¤é…ç½®æ–‡ä»¶æ˜¯å‰å°æ‰§è¡Œï¼Œéœ€è¦æ‰‹åŠ¨é…ç½®æˆåå°æ‰§è¡Œã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/24/oPiTB9.png" alt=""></p>
<p>ä¹‹åå¯åŠ¨å°±æ˜¯åœ¨åå°å¯åŠ¨äº†</p>
<p><img src="https://z3.ax1x.com/2021/11/24/oPF3CV.png" alt="image"></p>
<p>æ¥å°è¯•è¿æ¥ä¸€ä¸‹ Redis æ•°æ®åº“</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@deflory src]<span class="comment"># ./redis-cli -p 6379</span></span><br><span class="line"><span class="comment"># è¿æ¥æˆåŠŸï¼</span></span><br><span class="line">127.0.0.1:6379&gt;   </span><br></pre></td></tr></tbody></table></figure>
<h4 id="2-2ã€redis-benchmark-æµ‹è¯•æ€§èƒ½"><a href="#2-2ã€redis-benchmark-æµ‹è¯•æ€§èƒ½" class="headerlink" title="2.2ã€redis-benchmark æµ‹è¯•æ€§èƒ½"></a>2.2ã€redis-benchmark æµ‹è¯•æ€§èƒ½</h4><p>benchmark å¯é€‰å‚æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">åºå·</th>
<th style="text-align:left">é€‰é¡¹</th>
<th style="text-align:left">æè¿°</th>
<th style="text-align:left">é»˜è®¤å€¼</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left"><strong>-h</strong></td>
<td style="text-align:left">æŒ‡å®šæœåŠ¡å™¨ä¸»æœºå</td>
<td style="text-align:left">127.0.0.1</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left"><strong>-p</strong></td>
<td style="text-align:left">æŒ‡å®šæœåŠ¡å™¨ç«¯å£</td>
<td style="text-align:left">6379</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left"><strong>-s</strong></td>
<td style="text-align:left">æŒ‡å®šæœåŠ¡å™¨ socket</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left"><strong>-c</strong></td>
<td style="text-align:left">æŒ‡å®šå¹¶å‘è¿æ¥æ•°</td>
<td style="text-align:left">50</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left"><strong>-n</strong></td>
<td style="text-align:left">æŒ‡å®šè¯·æ±‚æ•°</td>
<td style="text-align:left">10000</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:left"><strong>-d</strong></td>
<td style="text-align:left">ä»¥å­—èŠ‚çš„å½¢å¼æŒ‡å®š SET/GET å€¼çš„æ•°æ®å¤§å°</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">7</td>
<td style="text-align:left"><strong>-k</strong></td>
<td style="text-align:left">1=keep alive 0=reconnect</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">8</td>
<td style="text-align:left"><strong>-r</strong></td>
<td style="text-align:left">SET/GET/INCR ä½¿ç”¨éšæœº key, SADD ä½¿ç”¨éšæœºå€¼</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">9</td>
<td style="text-align:left"><strong>-P</strong></td>
<td style="text-align:left">é€šè¿‡ç®¡é“ä¼ è¾“ <numreq> è¯·æ±‚</numreq></td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">10</td>
<td style="text-align:left"><strong>-q</strong></td>
<td style="text-align:left">å¼ºåˆ¶é€€å‡º redisã€‚ä»…æ˜¾ç¤º query/sec å€¼</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">11</td>
<td style="text-align:left"><strong>â€”csv</strong></td>
<td style="text-align:left">ä»¥ CSV æ ¼å¼è¾“å‡º</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">12</td>
<td style="text-align:left"><strong><em>-l\</em>ï¼ˆL çš„å°å†™å­—æ¯ï¼‰</strong></td>
<td style="text-align:left">ç”Ÿæˆå¾ªç¯ï¼Œæ°¸ä¹…æ‰§è¡Œæµ‹è¯•</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">13</td>
<td style="text-align:left"><strong>-t</strong></td>
<td style="text-align:left">ä»…è¿è¡Œä»¥é€—å·åˆ†éš”çš„æµ‹è¯•å‘½ä»¤åˆ—è¡¨ã€‚</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">14</td>
<td style="text-align:left"><strong><em>-I\</em>ï¼ˆi çš„å¤§å†™å­—æ¯ï¼‰</strong></td>
<td style="text-align:left">Idle æ¨¡å¼ã€‚ä»…æ‰“å¼€ N ä¸ª idle è¿æ¥å¹¶ç­‰å¾…ã€‚</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@deflory src]<span class="comment"># ./redis-benchmark -h 127.0.0.1 -p 6379 -n 100000 -c 100 -q</span></span><br><span class="line">PING_INLINE: 70521.86 requests per second, p50=0.999 msec                   </span><br><span class="line">PING_MBULK: 72150.07 requests per second, p50=0.967 msec                   </span><br><span class="line">SET: 62972.29 requests per second, p50=1.103 msec                   </span><br><span class="line">GET: 71839.09 requests per second, p50=0.975 msec                   </span><br><span class="line">INCR: 67340.07 requests per second, p50=1.039 msec                   </span><br><span class="line">LPUSH: 66401.06 requests per second, p50=1.071 msec                   </span><br><span class="line">RPUSH: 64061.50 requests per second, p50=1.103 msec                   </span><br><span class="line">LPOP: 62539.09 requests per second, p50=1.135 msec                   </span><br><span class="line">RPOP: 68634.18 requests per second, p50=1.031 msec                   </span><br><span class="line">SADD: 72098.05 requests per second, p50=0.975 msec                   </span><br><span class="line">HSET: 68259.38 requests per second, p50=1.031 msec                   </span><br><span class="line">SPOP: 71428.57 requests per second, p50=0.983 msec                   </span><br><span class="line">ZADD: 64850.84 requests per second, p50=1.087 msec                   </span><br><span class="line">ZPOPMIN: 71994.23 requests per second, p50=0.975 msec                   </span><br><span class="line">LPUSH (needed to benchmark LRANGE): 67476.38 requests per second, p50=1.055 msec                   </span><br><span class="line">LRANGE_100 (first 100 elements): 35893.75 requests per second, p50=1.967 msec                   </span><br><span class="line">LRANGE_300 (first 300 elements): 15257.86 requests per second, p50=4.439 msec                   </span><br><span class="line">LRANGE_500 (first 500 elements): 9705.91 requests per second, p50=6.943 msec                   </span><br><span class="line">LRANGE_600 (first 600 elements): 8294.62 requests per second, p50=8.167 msec                  </span><br><span class="line">MSET (10 keys): 59488.40 requests per second, p50=1.247 msec         </span><br></pre></td></tr></tbody></table></figure>
<h2 id="ä¸‰ã€Redis-åŸºæœ¬çŸ¥è¯†"><a href="#ä¸‰ã€Redis-åŸºæœ¬çŸ¥è¯†" class="headerlink" title="ä¸‰ã€Redis åŸºæœ¬çŸ¥è¯†"></a>ä¸‰ã€Redis åŸºæœ¬çŸ¥è¯†</h2><h4 id="3-1ã€æ•°æ®åº“ç›¸å…³"><a href="#3-1ã€æ•°æ®åº“ç›¸å…³" class="headerlink" title="3.1ã€æ•°æ®åº“ç›¸å…³"></a>3.1ã€æ•°æ®åº“ç›¸å…³</h4><p>Redis é»˜è®¤æœ‰16ä¸ªæ•°æ®åº“ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯0å·æ•°æ®åº“ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/24/oP3oRg.png" alt=""></p>
<p><br></p>
<div class="note success">
            <p>select index åˆ‡æ¢æ•°æ®åº“</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; select 1	<span class="comment"># åˆ‡æ¢1å·æ•°æ®åº“</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[1]&gt; select 0 <span class="comment"># åˆ‡æ¢ä¸ºé»˜è®¤æ•°æ®åº“</span></span><br><span class="line">OK</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>dbsize æŸ¥çœ‹å½“å‰æ•°æ®åº“å¤§å°</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; dbsize		<span class="comment"># æŸ¥çœ‹æ•°æ®åº“å¤§å°</span></span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>set æ·»åŠ é”®å€¼å¯¹ï¼Œget è·å–é”®å€¼å¯¹</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; select 3</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[3]&gt; <span class="built_in">set</span> name yqx	<span class="comment"># æ·»åŠ é”®å€¼å¯¹{nameï¼šyqx}</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[3]&gt; get name		<span class="comment"># è·å–é”®ä¸ºnameçš„å€¼</span></span><br><span class="line"><span class="string">"yqx"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>keys * è·å–æ‰€æœ‰çš„é”®</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379[3]&gt; keys *		<span class="comment"># è·å–æ‰€æœ‰çš„é”®</span></span><br><span class="line">1) <span class="string">"name"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>flushdb æ¸…ç©ºå½“å‰æ•°æ®åº“</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379[3]&gt; flushdb		<span class="comment"># æ¸…ç©ºæ•°æ®åº“ï¼Œflushallæ¸…ç©ºæ‰€æœ‰æ•°æ®åº“</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[3]&gt; keys *		<span class="comment"># å†æ¬¡æŸ¥çœ‹æ•°æ®åº“å†…å®¹</span></span><br><span class="line">(empty array)</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>flushall æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379[3]&gt; <span class="built_in">set</span> hello world</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[3]&gt; keys *</span><br><span class="line">1) <span class="string">"hello"</span></span><br><span class="line">127.0.0.1:6379[3]&gt; select 2</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[2]&gt; flushall	<span class="comment"># æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[2]&gt; select 3</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[3]&gt; keys *</span><br><span class="line">(empty array)</span><br></pre></td></tr></tbody></table></figure>
<h4 id="3-2ã€Redis-Key"><a href="#3-2ã€Redis-Key" class="headerlink" title="3.2ã€Redis-Key"></a>3.2ã€Redis-Key</h4><p>å‘½ä»¤å¾ˆå¤šï¼Œè¿™é‡Œåªä»‹ç»å¸¸ç”¨çš„å‘½ä»¤ï¼Œå¦‚æœä¹‹åç¢°åˆ°æ–°çš„å‘½ä»¤å¯ä»¥åˆ°å®˜ç½‘æŸ¥çœ‹ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/24/oPd3in.png" alt=""></p>
<div class="note success">
            <p>del key åˆ é™¤ key</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> name yqx</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) <span class="string">"name"</span></span><br><span class="line">127.0.0.1:6379&gt; del name	<span class="comment"># åˆ é™¤keyä¸ºnameçš„é”®å€¼å¯¹</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">(empty array)</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>exists key æ˜¯å¦å­˜åœ¨è¯¥é”®å€¼å¯¹ï¼Œå­˜åœ¨åˆ™è¿”å›1ï¼Œä¸å­˜åœ¨åˆ™è¿”å›0</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; exists name	<span class="comment"># æ˜¯å¦å­˜åœ¨é”®ä¸ºnameçš„é”®å€¼å¯¹</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> name yqx</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; exists name</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>expire key time ä¸ºè¯¥é”®å€¼å¯¹è®¾ç½®æœ‰æ•ˆæ—¶é—´ï¼Œå•ä½ä¸ºç§’</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; expire name 5 <span class="comment"># è®¾ç½®nameçš„æœ‰æ•ˆæ—¶é—´ä¸º5ç§’</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; ttl name	  <span class="comment"># æŸ¥çœ‹nameçš„æœ‰æ•ˆæ—¶é—´</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">(<span class="built_in">integer</span>) -2</span><br><span class="line">127.0.0.1:6379&gt; get name	  <span class="comment"># æœ‰æ•ˆæ—¶é—´è¿‡äº†ï¼Œåˆ™æ— æ³•è·å–name</span></span><br><span class="line">(nil)</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>type key æŸ¥çœ‹é”®å€¼å¯¹çš„å­˜å‚¨ç±»å‹</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> hello world</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">type</span> hello	<span class="comment"># æŸ¥çœ‹helloçš„ç±»å‹</span></span><br><span class="line">string</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>rename key newkey é‡å‘½åé”®</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; rename hello hi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) <span class="string">"hi"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>persist key ç§»é™¤è¯¥é”®å€¼å¯¹çš„è¿‡æœŸæ—¶é—´ï¼Œæ”¹ä¸ºæŒä¹…ä¿å­˜</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> name yqx</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; expire name 30	<span class="comment"># è®¾ç½®è¿‡æœŸæ—¶é—´</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; persist name	<span class="comment"># ç§»é™¤è¿‡æœŸæ—¶é—´</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; ttl name</span><br><span class="line">(<span class="built_in">integer</span>) -1</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line"><span class="string">"yqx"</span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="å››ã€äº”å¤§åŸºæœ¬ç±»å‹"><a href="#å››ã€äº”å¤§åŸºæœ¬ç±»å‹" class="headerlink" title="å››ã€äº”å¤§åŸºæœ¬ç±»å‹"></a>å››ã€äº”å¤§åŸºæœ¬ç±»å‹</h2><h4 id="4-1ã€å­—ç¬¦ä¸²ï¼ˆStringï¼‰"><a href="#4-1ã€å­—ç¬¦ä¸²ï¼ˆStringï¼‰" class="headerlink" title="4.1ã€å­—ç¬¦ä¸²ï¼ˆStringï¼‰"></a>4.1ã€å­—ç¬¦ä¸²ï¼ˆStringï¼‰</h4><div class="note success">
            <p>getrange key start end è·å–å­ä¸²</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> key1 <span class="string">"hello,my name is LiHua!"</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get key1</span><br><span class="line"><span class="string">"hello,my name is LiHua!"</span></span><br><span class="line">127.0.0.1:6379&gt; getrange key1 2 5				<span class="comment"># è·å–å­ä¸²ï¼Œå·¦é—­å³é—­</span></span><br><span class="line"><span class="string">"llo,"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>getset key value å…ˆè·å–å€¼ï¼Œå†è®¾ç½®å€¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; getset key1 <span class="string">"it's new string"</span>	<span class="comment"># å…ˆè·å–ï¼Œå†è®¾ç½®å€¼</span></span><br><span class="line"><span class="string">"hello,my name is LiHua!"</span>						<span class="comment"># æ³¨ï¼šæœ‰ç‰¹æ®Šå­—ç¬¦å¿…é¡»åŠ ""</span></span><br><span class="line">127.0.0.1:6379&gt; get key1</span><br><span class="line"><span class="string">"it's new string"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>strlen è·å–å­—ç¬¦ä¸²é•¿åº¦</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; strlen key1						<span class="comment"># è·å–å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">(<span class="built_in">integer</span>) 17									<span class="comment"># æ­¤é•¿åº¦ä¸åŒ…å«åŒå¼•å·</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>mset key1 value1 key2 value2â€¦ æ‰¹é‡è®¾ç½®é”®å€¼å¯¹</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; mset k1 v1 k2 v2 k3 v3			<span class="comment"># æ‰¹é‡è®¾ç½®é”®å€¼å¯¹</span></span><br><span class="line">OK</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>mget key1 key2â€¦</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; mget k1 k2 k3					<span class="comment"># æ‰¹é‡è·å–é”®å€¼å¯¹</span></span><br><span class="line">1) <span class="string">"v1"</span></span><br><span class="line">2) <span class="string">"v2"</span></span><br><span class="line">3) <span class="string">"v3"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>setex key time value å¦‚æœå­˜åœ¨è¯¥é”®å€¼å¯¹ï¼Œåˆ™ä¿®æ”¹å€¼ï¼›ä¸å­˜åœ¨åˆ™æ·»åŠ è¯¥é”®å€¼å¯¹ã€‚æœ€åè®¾ç½®æœ‰æ•ˆæ—¶é—´</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; setex key1 10 value1			<span class="comment"># set expire</span></span><br><span class="line">OK												<span class="comment"># å¦‚æœæ²¡æœ‰è¯¥é”®å€¼å¯¹åˆ™ä¼šåˆ›å»ºå¹¶æ·»åŠ æœ‰æ•ˆæ—¶é—´</span></span><br><span class="line">127.0.0.1:6379&gt; get key1						</span><br><span class="line"><span class="string">"value1"</span></span><br><span class="line">127.0.0.1:6379&gt; ttl key1				</span><br><span class="line">(<span class="built_in">integer</span>) 7</span><br><span class="line">127.0.0.1:6379&gt; setex key1 10 value2			<span class="comment"># å¦‚æœæœ‰è¯¥é”®å€¼å¯¹åˆ™ä¼šä¿®æ”¹å¹¶æ·»åŠ æœ‰æ•ˆæ—¶é—´</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; ttl key1				</span><br><span class="line">(<span class="built_in">integer</span>) 9</span><br><span class="line">127.0.0.1:6379&gt; get key1						</span><br><span class="line"><span class="string">"value2"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>setnx key value å¦‚æœä¸å­˜åœ¨è¯¥é”®å€¼å¯¹ï¼Œåˆ™æ·»åŠ ï¼›å­˜åœ¨åˆ™ä¸æ“ä½œï¼Œä¸ä¼šä¿®æ”¹å€¼ï¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; setnx key2 value2				<span class="comment"># set if not exists</span></span><br><span class="line">(<span class="built_in">integer</span>) 1										<span class="comment"># å¦‚æœæ²¡æœ‰è¯¥é”®å€¼å¯¹åˆ™æˆåŠŸåˆ›å»º</span></span><br><span class="line">127.0.0.1:6379&gt; setnx key2 value3				<span class="comment"># æœ‰åˆ™åˆ›å»ºå¤±è´¥ï¼Œä¸ä¼šä¿®æ”¹å€¼ï¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; get key2						</span><br><span class="line"><span class="string">"value2"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>incr key è‡ªå¢åŠ 1ï¼Œå¿…é¡»æ˜¯æ•´æ•°æˆ–æ˜¯å¯ä»¥è½¬æ¢ä¸ºæ•´æ•°çš„å­—ç¬¦ä¸²ï¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> num 1</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; incr num</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; incr num</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; get num</span><br><span class="line"><span class="string">"3"</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 v1</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; incr k1		<span class="comment"># ç»™å­—ç¬¦ä¸²è‡ªå¢ï¼Œç»“æœæŠ¥é”™ï¼ï¼ˆéæ•´æ•°éƒ½ä¸€æ ·ï¼‰</span></span><br><span class="line">(error) ERR value is not an <span class="built_in">integer</span> or out of range</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>incrby key increment è®¾ç½®å¢é‡</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; INCRBY num 10</span><br><span class="line">(<span class="built_in">integer</span>) 13</span><br><span class="line">127.0.0.1:6379&gt; get num</span><br><span class="line"><span class="string">"13"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>decr key è‡ªå‡1ï¼Œå¿…é¡»æ˜¯æ•´æ•°ï¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; decr num</span><br><span class="line">(<span class="built_in">integer</span>) 12</span><br><span class="line">127.0.0.1:6379&gt; decr num</span><br><span class="line">(<span class="built_in">integer</span>) 11</span><br><span class="line">127.0.0.1:6379&gt; get num</span><br><span class="line"><span class="string">"11"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>decrby key increment è®¾ç½®å‡é‡</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; decrby num 5</span><br><span class="line">(<span class="built_in">integer</span>) 6</span><br><span class="line">127.0.0.1:6379&gt; get num</span><br><span class="line"><span class="string">"6"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>append key value è¿½åŠ å€¼åˆ°è¯¥é”®å€¼å¯¹ä¸­</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> name yqx</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; append name deflory		<span class="comment"># è¿½åŠ defloryåˆ°keyä¸ºnameçš„é”®å€¼å¯¹ä¸­</span></span><br><span class="line">(<span class="built_in">integer</span>) 10</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line"><span class="string">"yqxdeflory"</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="4-2ã€å“ˆå¸Œï¼ˆHashï¼‰"><a href="#4-2ã€å“ˆå¸Œï¼ˆHashï¼‰" class="headerlink" title="4.2ã€å“ˆå¸Œï¼ˆHashï¼‰"></a>4.2ã€å“ˆå¸Œï¼ˆHashï¼‰</h4><p>Redis hash æ˜¯ä¸€ä¸ª string ç±»å‹çš„ fieldï¼ˆå­—æ®µï¼‰ å’Œ valueï¼ˆå€¼ï¼‰ çš„æ˜ å°„è¡¨ï¼Œhash ç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚</p>
<p>Redis ä¸­æ¯ä¸ª hash å¯ä»¥å­˜å‚¨ $2^{32}$ - 1 é”®å€¼å¯¹ï¼ˆ40å¤šäº¿ï¼‰ã€‚</p>
<p><br></p>
<p><strong>hash å¤§éƒ¨åˆ†çš„å‘½ä»¤éƒ½æ˜¯ä»¥ h å¼€å¤´ï¼Œè¡¨ç¤ºè¿™æ˜¯ hash çš„å‘½ä»¤</strong></p>
<div class="note success">
            <p>hset hash k1 v1 k2 v2 åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªé”®å€¼å¯¹åˆ° hashä¸­ï¼ˆhmset å’Œå®ƒçš„åŠŸèƒ½ä¸€æ¨¡ä¸€æ ·ï¼‰</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># user:1:{</span></span><br><span class="line"><span class="comment">#	name: "yqx",</span></span><br><span class="line"><span class="comment">#	age : 16</span></span><br><span class="line"><span class="comment">#}</span></span><br><span class="line">127.0.0.1:6379&gt; hset user:1 name yqx age 16</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>hget hash key è·å–è¯¥ hash ä¸­æŒ‡å®šé”®çš„å€¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hget user:1 name	<span class="comment"># è·å–nameå€¼</span></span><br><span class="line"><span class="string">"yqx"</span></span><br><span class="line">127.0.0.1:6379&gt; hget user:1 age</span><br><span class="line"><span class="string">"16"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>hgetall key è·å–è¯¥ hash ä¸­æ‰€æœ‰çš„é”®å€¼å¯¹</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hgetall user:1</span><br><span class="line">1) <span class="string">"name"</span></span><br><span class="line">2) <span class="string">"yqx"</span></span><br><span class="line">3) <span class="string">"age"</span></span><br><span class="line">4) <span class="string">"16"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>hexists hash key è¿”å›è¯¥ hash ä¸­æ˜¯å¦å­˜åœ¨ä»¥ key ä¸ºé”®çš„é”®å€¼å¯¹</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hexists user:1 name	<span class="comment"># æ˜¯å¦å­˜åœ¨nameé”®</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; hexists user:1 job</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>hkeys hash è·å–è¯¥ hash ä¸­çš„æ‰€æœ‰é”®</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hkeys user:1	<span class="comment"># è·å–æ‰€æœ‰é”®</span></span><br><span class="line">1) <span class="string">"name"</span></span><br><span class="line">2) <span class="string">"age"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>hvals hash è·å–è¯¥ hash ä¸­çš„æ‰€æœ‰å€¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hvals user:1	<span class="comment"># è·å–æ‰€æœ‰å€¼</span></span><br><span class="line">1) <span class="string">"yqx"</span></span><br><span class="line">2) <span class="string">"16"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>hincrby hash key increment ä¸º hash ä¸­é”®ä¸º key çš„å€¼ï¼ˆæ•´å‹ï¼‰åŠ ä¸€ä¸ªå¢é‡ increment</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hincrby user:1 age 10	<span class="comment"># å¹´é¾„+10</span></span><br><span class="line">(<span class="built_in">integer</span>) 26</span><br><span class="line">127.0.0.1:6379&gt; hget user:1 age</span><br><span class="line"><span class="string">"26"</span></span><br><span class="line">127.0.0.1:6379&gt; hincrby user:1 name 10</span><br><span class="line">(error) ERR <span class="built_in">hash</span> value is not an <span class="built_in">integer</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>hincrby hash key increment ä¸º hash ä¸­é”®ä¸º key çš„å€¼åŠ ä¸€ä¸ªå¢é‡ increment</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hgetall user:1</span><br><span class="line">1) <span class="string">"name"</span></span><br><span class="line">2) <span class="string">"yqx"</span></span><br><span class="line">3) <span class="string">"age"</span></span><br><span class="line">4) <span class="string">"26"</span></span><br><span class="line">5) <span class="string">"weight"</span></span><br><span class="line">6) <span class="string">"60.2"</span></span><br><span class="line">127.0.0.1:6379&gt; hincrby user:1 weight 10		<span class="comment"># floatç±»å‹æ— æ³•ä½¿ç”¨intçš„è‡ªå¢æ–¹æ³•</span></span><br><span class="line">(error) ERR <span class="built_in">hash</span> value is not an <span class="built_in">integer</span></span><br><span class="line">127.0.0.1:6379&gt; hincrbyfloat user:1 weight 10	<span class="comment"># ä½“é‡+10</span></span><br><span class="line"><span class="string">"70.2"</span></span><br><span class="line">127.0.0.1:6379&gt; hget user:1 weight</span><br><span class="line"><span class="string">"70.2"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>hlen hash è·å–è¯¥ hash ä¸­çš„é”®å€¼å¯¹æ•°é‡</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hkeys user:1</span><br><span class="line">1) <span class="string">"name"</span></span><br><span class="line">2) <span class="string">"age"</span></span><br><span class="line">3) <span class="string">"weight"</span></span><br><span class="line">127.0.0.1:6379&gt; hlen user:1	<span class="comment"># è·å–é”®å€¼å¯¹æ•°é‡</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>hmget hash k1 k2â€¦ è·å–æ‰€æœ‰ç»™å®šå­—æ®µçš„å€¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hmget user:1 name weight</span><br><span class="line">1) <span class="string">"yqx"</span></span><br><span class="line">2) <span class="string">"70.2"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>hsetnx hash key value åªæœ‰åœ¨å­—æ®µ key ä¸å­˜åœ¨æ—¶ï¼Œæ‰ä¼šè®¾ç½®å€¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hsetnx user:1 name deflory	<span class="comment"># set if not exist</span></span><br><span class="line">(<span class="built_in">integer</span>) 0									<span class="comment"># å­—æ®µå­˜åœ¨ï¼Œè®¾å€¼å¤±è´¥</span></span><br><span class="line">127.0.0.1:6379&gt; hsetnx user:1 height 175</span><br><span class="line">(<span class="built_in">integer</span>) 1									<span class="comment"># å­—æ®µä¸å­˜åœ¨ï¼Œè®¾å€¼æˆåŠŸ</span></span><br><span class="line">127.0.0.1:6379&gt; hgetall user:1</span><br><span class="line">1) <span class="string">"name"</span></span><br><span class="line">2) <span class="string">"yqx"</span></span><br><span class="line">3) <span class="string">"age"</span></span><br><span class="line">4) <span class="string">"26"</span></span><br><span class="line">5) <span class="string">"weight"</span></span><br><span class="line">6) <span class="string">"70.2"</span></span><br><span class="line">7) <span class="string">"height"</span></span><br><span class="line">8) <span class="string">"175"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>hscan hash cursor [MATCH pattern] [COUNT count] è¿­ä»£ hash çš„é”®å€¼å¯¹å¹¶è¿›è¡ŒåŒ¹é…ï¼ˆcount é»˜è®¤ä¸º10ï¼‰</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hscan user:1 0 match <span class="string">"*gh*"</span>	<span class="comment"># ä»ä¸‹æ ‡0å¼€å§‹åŒ¹é…é”®ä¸­åŒ…å«ghçš„é¡¹</span></span><br><span class="line">1) <span class="string">"0"</span></span><br><span class="line">2) 1) <span class="string">"weight"</span></span><br><span class="line">   2) <span class="string">"70.2"</span></span><br><span class="line">   3) <span class="string">"height"</span></span><br><span class="line">   4) <span class="string">"175"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h4 id="4-3ã€åˆ—è¡¨ï¼ˆListï¼‰"><a href="#4-3ã€åˆ—è¡¨ï¼ˆListï¼‰" class="headerlink" title="4.3ã€åˆ—è¡¨ï¼ˆListï¼‰"></a>4.3ã€åˆ—è¡¨ï¼ˆListï¼‰</h4><p>Redisåˆ—è¡¨æ˜¯ç®€å•çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºæ’åºã€‚ä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°åˆ—è¡¨çš„å¤´éƒ¨ï¼ˆå·¦è¾¹ï¼‰æˆ–è€…å°¾éƒ¨ï¼ˆå³è¾¹ï¼‰</p>
<p>ä¸€ä¸ªåˆ—è¡¨æœ€å¤šå¯ä»¥åŒ…å« $2^{32}$ - 1 ä¸ªå…ƒç´  (4294967295, æ¯ä¸ªåˆ—è¡¨è¶…è¿‡40äº¿ä¸ªå…ƒç´ )ã€‚</p>
<p><br></p>
<p><strong>list å¤§éƒ¨åˆ†çš„å‘½ä»¤éƒ½æ˜¯ä»¥ L å¼€å¤´ï¼Œè¡¨ç¤ºè¿™æ˜¯ list çš„å‘½ä»¤</strong></p>
<div class="note success">
            <p>lpush list value å°†æ•°ç»„ä»å·¦è¾¹æ’å…¥åˆ° list ä¸­ï¼Œæ²¡æœ‰è¯¥åˆ—è¡¨ï¼Œåˆ™ä¼šå…ˆåˆ›å»ºå†æ’å…¥</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lpush list redis		 <span class="comment"># æ’å…¥redis</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; lpush list mongodb mysql <span class="comment"># å¯ä»¥åŒæ—¶æ’å…¥å¤šä¸ªå…ƒç´ </span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>lpushx list value å°†æ•°ç»„ä»å·¦è¾¹æ’å…¥åˆ°ä¸€ä¸ª<code>å­˜åœ¨</code>çš„ list ä¸­</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lpushx list2 yqx	<span class="comment"># pushx åˆ°ä¸€ä¸ªä¸å­˜åœ¨çš„åˆ—è¡¨ä¸­</span></span><br><span class="line">(<span class="built_in">integer</span>) 0							<span class="comment"># å¤±è´¥</span></span><br><span class="line">127.0.0.1:6379&gt; lindex list2 0</span><br><span class="line">(nil)</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; lpushx list oracle	<span class="comment"># åªèƒ½ pushx åˆ°å­˜åœ¨çš„åˆ—è¡¨ä¸­</span></span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"oracle"</span></span><br><span class="line">2) <span class="string">"mysql"</span></span><br><span class="line">3) <span class="string">"mongodb"</span></span><br><span class="line">4) <span class="string">"redis"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>lrange list start end æŸ¥çœ‹ list æŒ‡å®šèŒƒå›´çš„æ•°æ®ï¼ˆå·¦é—­å³é—­ï¼‰</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lrange list 0 -1 <span class="comment"># pushå’Œæ ˆä¸€æ ·ï¼Œæœ€åæ”¾è¿›æ¥çš„åœ¨æœ€ä¸Šé¢</span></span><br><span class="line">1) <span class="string">"mysql"</span></span><br><span class="line">2) <span class="string">"mongodb"</span></span><br><span class="line">3) <span class="string">"redis"</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; lrange list 1 2  <span class="comment"># æŸ¥çœ‹ä¸‹æ ‡åŒºé—´ä¸º[1, 2]çš„æ•°æ®</span></span><br><span class="line">1) <span class="string">"mongodb"</span></span><br><span class="line">2) <span class="string">"redis"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>lindex list index è·å–æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ </p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lindex list 0</span><br><span class="line"><span class="string">"mysql"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>linsert list before|after pivot value åœ¨åˆ—è¡¨å…ƒç´ çš„å‰é¢æˆ–åé¢æ’å…¥å…ƒç´ </p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; linsert list before redis oracle <span class="comment"># åœ¨liståˆ—è¡¨ä¸­rediså‰é¢æ’å…¥oracleï¼Œå¦‚æœæœ‰å¤šä¸ªredisï¼Œé»˜è®¤æ’å…¥åœ¨ç¬¬ä¸€ä¸ªrediså‰</span></span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"mysql"</span></span><br><span class="line">2) <span class="string">"mongodb"</span></span><br><span class="line">3) <span class="string">"oracle"</span></span><br><span class="line">4) <span class="string">"redis"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>llen list è·å–åˆ—è¡¨é•¿åº¦</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; llen list	<span class="comment"># æŸ¥çœ‹listçš„é•¿åº¦</span></span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>lpop list å¼¹å‡ºåˆ—è¡¨ç¬¬ä¸€ä¸ªå…ƒç´ </p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"mysql"</span></span><br><span class="line">2) <span class="string">"mongodb"</span></span><br><span class="line">3) <span class="string">"oracle"</span></span><br><span class="line">4) <span class="string">"redis"</span></span><br><span class="line">127.0.0.1:6379&gt; llen list</span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">127.0.0.1:6379&gt; lpop list	<span class="comment"># listç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯mysql</span></span><br><span class="line"><span class="string">"mysql"</span></span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"mongodb"</span></span><br><span class="line">2) <span class="string">"oracle"</span></span><br><span class="line">3) <span class="string">"redis"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>lrem list count value ç§»å‡ºåˆ—è¡¨å…ƒç´ </p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"mysql"</span></span><br><span class="line">2) <span class="string">"mysql"</span></span><br><span class="line">3) <span class="string">"oracle"</span></span><br><span class="line">4) <span class="string">"sqlserver"</span></span><br><span class="line">5) <span class="string">"oracle"</span></span><br><span class="line">6) <span class="string">"mysql"</span></span><br><span class="line">7) <span class="string">"mongodb"</span></span><br><span class="line">8) <span class="string">"redis"</span></span><br><span class="line">127.0.0.1:6379&gt; lrem list 1 oracle	<span class="comment"># count&gt;0ï¼Œä»å‰å¾€åæ‰¾</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"mysql"</span></span><br><span class="line">2) <span class="string">"mysql"</span></span><br><span class="line">3) <span class="string">"sqlserver"</span></span><br><span class="line">4) <span class="string">"oracle"</span></span><br><span class="line">5) <span class="string">"mysql"</span></span><br><span class="line">6) <span class="string">"mongodb"</span></span><br><span class="line">7) <span class="string">"redis"</span></span><br><span class="line">127.0.0.1:6379&gt; lrem list -1 mysql  <span class="comment"># count&lt;0ï¼Œä»å‰å¾€åæ‰¾</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"mysql"</span></span><br><span class="line">2) <span class="string">"mysql"</span></span><br><span class="line">3) <span class="string">"sqlserver"</span></span><br><span class="line">4) <span class="string">"oracle"</span></span><br><span class="line">5) <span class="string">"mongodb"</span></span><br><span class="line">6) <span class="string">"redis"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>lset list index value é€šè¿‡ç´¢å¼•è®¾ç½®åˆ—è¡¨å…ƒç´ çš„å€¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lset list 0 mybatis	<span class="comment"># å°†ç¬¬ä¸€ä¸ªå…ƒç´ æ”¹ä¸ºmybatis</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"mybatis"</span></span><br><span class="line">2) <span class="string">"mysql"</span></span><br><span class="line">3) <span class="string">"sqlserver"</span></span><br><span class="line">4) <span class="string">"oracle"</span></span><br><span class="line">5) <span class="string">"mongodb"</span></span><br><span class="line">6) <span class="string">"redis"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>ltrim list start stop åªä¿ç•™ list åœ¨åŒºé—´[start, stop]ä¸Šçš„å…ƒç´ </p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"mybatis"</span></span><br><span class="line">2) <span class="string">"mysql"</span></span><br><span class="line">3) <span class="string">"sqlserver"</span></span><br><span class="line">4) <span class="string">"oracle"</span></span><br><span class="line">5) <span class="string">"mongodb"</span></span><br><span class="line">6) <span class="string">"redis"</span></span><br><span class="line">127.0.0.1:6379&gt; ltrim list 2 5	<span class="comment"># æˆªæ–­list[2, 5]</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"sqlserver"</span></span><br><span class="line">2) <span class="string">"oracle"</span></span><br><span class="line">3) <span class="string">"mongodb"</span></span><br><span class="line">4) <span class="string">"redis"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>rpush list value åœ¨åˆ—è¡¨æœ«å°¾æ’å…¥å…ƒç´ ï¼ŒåŒ lpush</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"sqlserver"</span></span><br><span class="line">2) <span class="string">"oracle"</span></span><br><span class="line">3) <span class="string">"mongodb"</span></span><br><span class="line">4) <span class="string">"redis"</span></span><br><span class="line">127.0.0.1:6379&gt; rpush list mysql hibernate</span><br><span class="line">(<span class="built_in">integer</span>) 6</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"sqlserver"</span></span><br><span class="line">2) <span class="string">"oracle"</span></span><br><span class="line">3) <span class="string">"mongodb"</span></span><br><span class="line">4) <span class="string">"redis"</span></span><br><span class="line">5) <span class="string">"mysql"</span></span><br><span class="line">6) <span class="string">"hibernate"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>rpushx list value åœ¨å·²å­˜åœ¨åˆ—è¡¨æœ«å°¾æ’å…¥å…ƒç´ ï¼ŒåŒ rpushx</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; rpushx name deflory</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; rpushx list2 hello world</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; lrange list2 0 -1</span><br><span class="line">1) <span class="string">"test"</span></span><br><span class="line">2) <span class="string">"hello"</span></span><br><span class="line">3) <span class="string">"world"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>rpop list å¼¹å‡ºåˆ—è¡¨æœ€åä¸€ä¸ªå…ƒç´ </p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"sqlserver"</span></span><br><span class="line">2) <span class="string">"oracle"</span></span><br><span class="line">3) <span class="string">"mongodb"</span></span><br><span class="line">4) <span class="string">"redis"</span></span><br><span class="line">5) <span class="string">"mysql"</span></span><br><span class="line">6) <span class="string">"hibernate"</span></span><br><span class="line">127.0.0.1:6379&gt; rpop list	<span class="comment"># å¼¹å‡ºlistæœ€åä¸€ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="string">"hibernate"</span></span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"sqlserver"</span></span><br><span class="line">2) <span class="string">"oracle"</span></span><br><span class="line">3) <span class="string">"mongodb"</span></span><br><span class="line">4) <span class="string">"redis"</span></span><br><span class="line">5) <span class="string">"mysql"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>rpoplpush source destination å°† source ä¸­æœ€åä¸€ä¸ªå…ƒç´ æ’å…¥åˆ° destination æœ€å‰é¢</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># åŸåˆ—è¡¨</span></span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"sqlserver"</span></span><br><span class="line">2) <span class="string">"oracle"</span></span><br><span class="line">3) <span class="string">"mongodb"</span></span><br><span class="line">4) <span class="string">"redis"</span></span><br><span class="line">5) <span class="string">"mysql"</span></span><br><span class="line">127.0.0.1:6379&gt; lrange list2 0 -1</span><br><span class="line">1) <span class="string">"test"</span></span><br><span class="line">2) <span class="string">"hello"</span></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; rpoplpush list list2</span><br><span class="line"><span class="string">"mysql"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç°åˆ—è¡¨</span></span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">"sqlserver"</span></span><br><span class="line">2) <span class="string">"oracle"</span></span><br><span class="line">3) <span class="string">"mongodb"</span></span><br><span class="line">4) <span class="string">"redis"</span></span><br><span class="line">127.0.0.1:6379&gt; lrange list2 0 -1</span><br><span class="line">1) <span class="string">"mysql"</span></span><br><span class="line">2) <span class="string">"test"</span></span><br><span class="line">3) <span class="string">"hello"</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong><font size="5px">å°ç»“ï¼š</font></strong></p>
<ul>
<li><p>list åˆ—è¡¨å®é™…ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨</p>
</li>
<li><p>å¦‚æœç§»é™¤äº†é“¾è¡¨ä¸­çš„æ‰€æœ‰å€¼ï¼Œé‚£ä¹ˆè¯¥é“¾è¡¨ä¸å­˜åœ¨</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lpush list v1 v2	<span class="comment"># åˆ›å»ºæµ‹è¯•åˆ—è¡¨</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; lrem list 1 v1		<span class="comment"># ç§»é™¤æ‰€æœ‰å…ƒç´ </span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; lrem list 1 v2</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1	<span class="comment"># æŸ¥çœ‹æ•°ç»„å†…å®¹</span></span><br><span class="line">(empty array)</span><br><span class="line">127.0.0.1:6379&gt; lpushx list v3		<span class="comment"># æ— æ³•ç»™ç©ºæ•°ç»„lpushxå…ƒç´ ï¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1	<span class="comment"># è¿˜æ˜¯ç©ºæ•°ç»„!</span></span><br><span class="line">(empty array)</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>åœ¨ä¸¤éæ’å…¥æˆ–ä¿®æ”¹å€¼æ—¶ï¼Œæ•ˆç‡æœ€é«˜ï¼åä¹‹ï¼Œæ“ä½œä¸­é—´å…ƒç´ æ—¶ï¼Œæ•ˆç‡è¾ƒä½ï¼</p>
</li>
<li><p>å¦‚æœåªä½¿ç”¨ lpushï¼Œrpopï¼Œå³æ¶ˆæ¯é˜Ÿåˆ—ï¼›åªä½¿ç”¨ lpushã€lpopï¼Œå³æ ˆã€‚</p>
</li>
</ul>
<h4 id="4-4ã€é›†åˆï¼ˆSetï¼‰"><a href="#4-4ã€é›†åˆï¼ˆSetï¼‰" class="headerlink" title="4.4ã€é›†åˆï¼ˆSetï¼‰"></a>4.4ã€é›†åˆï¼ˆSetï¼‰</h4><p>Redis çš„ Set æ˜¯ String ç±»å‹çš„æ— åºé›†åˆã€‚é›†åˆæˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œè¿™å°±æ„å‘³ç€é›†åˆä¸­ä¸èƒ½å‡ºç°é‡å¤çš„æ•°æ®ã€‚</p>
<p>é›†åˆå¯¹è±¡çš„ç¼–ç å¯ä»¥æ˜¯ intset æˆ–è€… hashtableã€‚</p>
<p>Redis ä¸­é›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨å®ç°çš„ï¼Œæ‰€ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½æ˜¯ O(1)ã€‚</p>
<p>é›†åˆä¸­æœ€å¤§çš„æˆå‘˜æ•°ä¸º $2^{32} - 1$ (4294967295, æ¯ä¸ªé›†åˆå¯å­˜å‚¨40å¤šäº¿ä¸ªæˆå‘˜)ã€‚</p>
<p><br></p>
<p><strong>set å¤§éƒ¨åˆ†çš„å‘½ä»¤éƒ½æ˜¯ä»¥ s å¼€å¤´ï¼Œè¡¨ç¤ºè¿™æ˜¯ set çš„å‘½ä»¤</strong></p>
<div class="note success">
            <p>sadd set value æ·»åŠ  value åˆ° set ä¸­</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sadd <span class="built_in">set</span> redis mongodb <span class="comment"># å¯ä»¥åŒæ—¶æ·»åŠ å¤šä¸ªå…ƒç´ </span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd <span class="built_in">set</span> mysql</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>smembers set æŸ¥çœ‹è¯¥é›†åˆä¸­çš„å…ƒç´ </p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sadd <span class="built_in">set</span> redis</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd <span class="built_in">set</span> mongodb</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd <span class="built_in">set</span> mysql</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd <span class="built_in">set</span> mysql	<span class="comment"># æ·»åŠ ä¸¤ä¸ªmysql</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; smembers <span class="built_in">set</span>	<span class="comment"># æœ€åé›†åˆä¸­åªæœ‰ä¸€ä¸ªmysql</span></span><br><span class="line">1) <span class="string">"mongodb"</span></span><br><span class="line">2) <span class="string">"redis"</span></span><br><span class="line">3) <span class="string">"mysql"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>scard set æŸ¥çœ‹è¯¥é›†åˆæ•°é‡</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; scard <span class="built_in">set</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>sdiff set1 set2 æ±‚å·®é›†ï¼ˆset1 - set2ï¼‰</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; smembers <span class="built_in">set</span></span><br><span class="line">1) <span class="string">"mongodb"</span></span><br><span class="line">2) <span class="string">"redis"</span></span><br><span class="line">3) <span class="string">"mysql"</span></span><br><span class="line">127.0.0.1:6379&gt; smembers set2</span><br><span class="line">1) <span class="string">"mysql"</span></span><br><span class="line">2) <span class="string">"c"</span></span><br><span class="line">3) <span class="string">"java"</span></span><br><span class="line">127.0.0.1:6379&gt; sdiff <span class="built_in">set</span> set2	<span class="comment"># åœ¨setä¸­è€Œä¸åœ¨set2ä¸­çš„å°±æ˜¯rediså’Œmongodb</span></span><br><span class="line">1) <span class="string">"redis"</span></span><br><span class="line">2) <span class="string">"mongodb"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>sdiffstore destination set1 set2 å°† set1 å’Œ set2 çš„å·®é›†å­˜å‚¨åœ¨ destination ä¸­</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sdiffstore result <span class="built_in">set</span> set2	<span class="comment"># å°†ç»“æœå­˜å‚¨åœ¨resultä¸­</span></span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; smembers result</span><br><span class="line">1) <span class="string">"redis"</span></span><br><span class="line">2) <span class="string">"mongodb"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>sinter set1 set2 æ±‚ set1 å’Œ set2 çš„äº¤é›†</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sinter <span class="built_in">set</span> set2</span><br><span class="line">1) <span class="string">"mysql"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>sinnerstore destination set1 set2 å°† set1 å’Œ set2 çš„äº¤é›†å­˜å‚¨åœ¨ destination ä¸­</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sinterstore result <span class="built_in">set</span> set2	<span class="comment"># ä¼šå°†åŸå…ˆresultä¸­çš„å†…å®¹è¦†ç›–</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; smembers result</span><br><span class="line">1) <span class="string">"mysql"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>sunion set1 set2 æ±‚ set1 å’Œ set2 çš„å¹¶é›†</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; smembers <span class="built_in">set</span></span><br><span class="line">1) <span class="string">"mongodb"</span></span><br><span class="line">2) <span class="string">"sqlserver"</span></span><br><span class="line">3) <span class="string">"oracle"</span></span><br><span class="line">127.0.0.1:6379&gt; smembers set2</span><br><span class="line">1) <span class="string">"python"</span></span><br><span class="line">2) <span class="string">"java"</span></span><br><span class="line">127.0.0.1:6379&gt; sunion <span class="built_in">set</span> set2</span><br><span class="line">1) <span class="string">"mongodb"</span></span><br><span class="line">2) <span class="string">"oracle"</span></span><br><span class="line">3) <span class="string">"sqlserver"</span></span><br><span class="line">4) <span class="string">"python"</span></span><br><span class="line">5) <span class="string">"java"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>sunionstore destination set1 set2 å°† set1 å’Œ set2 çš„å¹¶é›†å­˜å‚¨åœ¨ destination ä¸­</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sunionstore result <span class="built_in">set</span> set2</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">127.0.0.1:6379&gt; smembers result</span><br><span class="line">1) <span class="string">"mongodb"</span></span><br><span class="line">2) <span class="string">"oracle"</span></span><br><span class="line">3) <span class="string">"sqlserver"</span></span><br><span class="line">4) <span class="string">"python"</span></span><br><span class="line">5) <span class="string">"java"</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>sismember set member åˆ¤æ–­ member æ˜¯å¦å­˜åœ¨äº set ä¸­</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; smembers result</span><br><span class="line">1) <span class="string">"mysql"</span></span><br><span class="line">127.0.0.1:6379&gt; sismember result mysql	<span class="comment"># mysqlå­˜åœ¨äºresultä¸­</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sismember result mysql1 <span class="comment"># mysql1ä¸å­˜åœ¨ä¸resultä¸­</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>smove source destination member å°† member ä» source ä¸­è½¬ç§»åˆ°destination ä¸­</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; smembers <span class="built_in">set</span></span><br><span class="line">1) <span class="string">"mongodb"</span></span><br><span class="line">2) <span class="string">"redis"</span></span><br><span class="line">3) <span class="string">"mysql"</span></span><br><span class="line">127.0.0.1:6379&gt; smembers set2</span><br><span class="line">1) <span class="string">"mysql"</span></span><br><span class="line">2) <span class="string">"c"</span></span><br><span class="line">3) <span class="string">"java"</span></span><br><span class="line">127.0.0.1:6379&gt; smove <span class="built_in">set</span> set2 redis</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; smembers <span class="built_in">set</span></span><br><span class="line">1) <span class="string">"mongodb"</span></span><br><span class="line">2) <span class="string">"mysql"</span></span><br><span class="line">127.0.0.1:6379&gt; smembers set2</span><br><span class="line">1) <span class="string">"redis"</span></span><br><span class="line">2) <span class="string">"mysql"</span></span><br><span class="line">3) <span class="string">"c"</span></span><br><span class="line">4) <span class="string">"java"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>spop set éšæœºå¼¹å‡º set ä¸­çš„æŸä¸ªå…ƒç´ </p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; smembers set2</span><br><span class="line">1) <span class="string">"redis"</span></span><br><span class="line">2) <span class="string">"mysql"</span></span><br><span class="line">3) <span class="string">"c"</span></span><br><span class="line">4) <span class="string">"java"</span></span><br><span class="line">127.0.0.1:6379&gt; spop set2</span><br><span class="line"><span class="string">"java"</span></span><br><span class="line">127.0.0.1:6379&gt; spop set2</span><br><span class="line"><span class="string">"mysql"</span></span><br><span class="line">127.0.0.1:6379&gt; spop set2</span><br><span class="line"><span class="string">"redis"</span></span><br><span class="line">127.0.0.1:6379&gt; spop set2</span><br><span class="line"><span class="string">"c"</span></span><br><span class="line">127.0.0.1:6379&gt; spop set2</span><br><span class="line">(nil)</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>srandmember set [count] éšå³è¿”å›é›†åˆä¸­çš„å…ƒç´ ï¼Œé»˜è®¤count=1ï¼ˆä¸ç§»é™¤ï¼ï¼‰</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; smembers <span class="built_in">set</span></span><br><span class="line">1) <span class="string">"redis"</span></span><br><span class="line">2) <span class="string">"oracle"</span></span><br><span class="line">3) <span class="string">"sqlserver"</span></span><br><span class="line">4) <span class="string">"mysql"</span></span><br><span class="line">5) <span class="string">"mongodb"</span></span><br><span class="line">127.0.0.1:6379&gt; srandmember <span class="built_in">set</span></span><br><span class="line"><span class="string">"mongodb"</span></span><br><span class="line">127.0.0.1:6379&gt; srandmember <span class="built_in">set</span></span><br><span class="line"><span class="string">"oracle"</span></span><br><span class="line">127.0.0.1:6379&gt; srandmember <span class="built_in">set</span> 3</span><br><span class="line">1) <span class="string">"mysql"</span></span><br><span class="line">2) <span class="string">"mongodb"</span></span><br><span class="line">3) <span class="string">"sqlserver"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>srem set value1 value2â€¦ ç§»é™¤é›†åˆä¸­çš„å…ƒç´ </p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; smembers <span class="built_in">set</span></span><br><span class="line">1) <span class="string">"redis"</span></span><br><span class="line">2) <span class="string">"mysql"</span></span><br><span class="line">3) <span class="string">"mongodb"</span></span><br><span class="line">4) <span class="string">"sqlserver"</span></span><br><span class="line">5) <span class="string">"oracle"</span></span><br><span class="line">127.0.0.1:6379&gt; srem <span class="built_in">set</span> redis mysql</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; smembers <span class="built_in">set</span></span><br><span class="line">1) <span class="string">"mongodb"</span></span><br><span class="line">2) <span class="string">"sqlserver"</span></span><br><span class="line">3) <span class="string">"oracle"</span></span><br></pre></td></tr></tbody></table></figure>
<p>å¯ç”¨äºå¾®åšï¼Œå…±åŒå…³æ³¨ï¼Œå…±åŒçˆ±å¥½ï¼Œæ¨èå¥½å‹ç­‰â€¦â€¦</p>
<h4 id="4-5ã€æœ‰åºé›†åˆï¼ˆsorted-setï¼‰"><a href="#4-5ã€æœ‰åºé›†åˆï¼ˆsorted-setï¼‰" class="headerlink" title="4.5ã€æœ‰åºé›†åˆï¼ˆsorted setï¼‰"></a>4.5ã€æœ‰åºé›†åˆï¼ˆsorted setï¼‰</h4><p>Redis æœ‰åºé›†åˆå’Œé›†åˆä¸€æ ·ä¹Ÿæ˜¯ string ç±»å‹å…ƒç´ çš„é›†åˆ,ä¸”ä¸å…è®¸é‡å¤çš„æˆå‘˜ã€‚</p>
<p>ä¸åŒçš„æ˜¯æ¯ä¸ªå…ƒç´ éƒ½ä¼šå…³è”ä¸€ä¸ª double ç±»å‹çš„åˆ†æ•°ã€‚redis æ­£æ˜¯é€šè¿‡åˆ†æ•°æ¥ä¸ºé›†åˆä¸­çš„æˆå‘˜è¿›è¡Œä»å°åˆ°å¤§çš„æ’åºã€‚</p>
<p>æœ‰åºé›†åˆçš„æˆå‘˜æ˜¯å”¯ä¸€çš„,ä½†åˆ†æ•°(score)å´å¯ä»¥é‡å¤ã€‚</p>
<p>é›†åˆæ˜¯é€šè¿‡å“ˆå¸Œè¡¨å®ç°çš„ï¼Œæ‰€ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾çš„å¤æ‚åº¦éƒ½æ˜¯ O(1)ã€‚ é›†åˆä¸­æœ€å¤§çš„æˆå‘˜æ•°ä¸º $2^{32} - 1$ (4294967295, æ¯ä¸ªé›†åˆå¯å­˜å‚¨40å¤šäº¿ä¸ªæˆå‘˜)ã€‚</p>
<p><br></p>
<div class="note success">
            <p>zadd zset score1 member1 score2 member2â€¦. å‘æœ‰åºé›†åˆæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ï¼Œæˆ–è€…æ›´æ–°æˆå‘˜åˆ†æ•°</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd salary 500 yqx 1000 sk 3000 deflory</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>zcard zset è·å–æœ‰åºé›†åˆçš„å…ƒç´ ä¸ªæ•°</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zcard salary</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>zrange zset min max byscore æ ¹æ®åˆ†æ•°ä»å°åˆ°å¤§è¿”å›æ•°æ®</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange salary -inf +inf byscore</span><br><span class="line">1) <span class="string">"yqx"</span></span><br><span class="line">2) <span class="string">"sk"</span></span><br><span class="line">3) <span class="string">"deflory"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>zcount zset min max æŸ¥æ‰¾æŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ ä¸ªæ•°</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zcount salary 10 1000</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>zscore zset member è·å–æŒ‡å®šæŸä¸ªæˆå‘˜çš„åˆ†æ•°</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zscore salary yqx</span><br><span class="line"><span class="string">"500"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>zincrby zset increment member ä¸ºæŒ‡å®šæˆå‘˜æ·»åŠ å¢é‡</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zincrby salary 20 nojob</span><br><span class="line"><span class="string">"20"</span></span><br><span class="line">127.0.0.1:6379&gt; zscore salary nojob</span><br><span class="line"><span class="string">"20"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>zrank zset member è·å–æŒ‡å®šæˆå‘˜çš„ç´¢å¼•</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrank salary yqx</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>zrangebyscore zset -inf +inf [withscores] æ ¹æ®åˆ†æ•°ä»å°åˆ°å¤§è¿”å›æ•°æ®ï¼Œå¯ä»¥é€‰æ‹©æ˜¯å¦è¿åŒåˆ†æ•°ä¸€èµ·è¿”å›</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrangebyscore salary -inf +inf withscores</span><br><span class="line">1) <span class="string">"nojob"</span></span><br><span class="line">2) <span class="string">"20"</span></span><br><span class="line">3) <span class="string">"yqx"</span></span><br><span class="line">4) <span class="string">"500"</span></span><br><span class="line">5) <span class="string">"sk"</span></span><br><span class="line">6) <span class="string">"1000"</span></span><br><span class="line">7) <span class="string">"deflory"</span></span><br><span class="line">8) <span class="string">"3000"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>zrevrange zset start end [withscores] æ ¹æ®åˆ†æ•°ä»å¤§åˆ°å°ä¸”ç´¢å¼•åœ¨[start, end]ä¸­çš„æ•°æ®ï¼Œå¯ä»¥é€‰æ‹©æ˜¯å¦è¿åŒåˆ†æ•°ä¸€èµ·è¿”å›</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrevrange salary 0 10 withscores</span><br><span class="line">1) <span class="string">"deflory"</span></span><br><span class="line">2) <span class="string">"3000"</span></span><br><span class="line">3) <span class="string">"sk"</span></span><br><span class="line">4) <span class="string">"1000"</span></span><br><span class="line">5) <span class="string">"yqx"</span></span><br><span class="line">6) <span class="string">"500"</span></span><br><span class="line">7) <span class="string">"nojob"</span></span><br><span class="line">8) <span class="string">"20"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>zrevrangebyscore zset max min [withscores] æ ¹æ®åˆ†æ•°ä»å¤§åˆ°å°ï¼ŒèŒƒå›´åœ¨[min, max]è¿”å›æ•°æ®ï¼Œå¯ä»¥é€‰æ‹©æ˜¯å¦è¿åŒåˆ†æ•°ä¸€èµ·è¿”å›</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrevrangebyscore salary +inf -inf withscores</span><br><span class="line">1) <span class="string">"deflory"</span></span><br><span class="line">2) <span class="string">"3000"</span></span><br><span class="line">3) <span class="string">"sk"</span></span><br><span class="line">4) <span class="string">"1000"</span></span><br><span class="line">5) <span class="string">"yqx"</span></span><br><span class="line">6) <span class="string">"500"</span></span><br><span class="line">7) <span class="string">"nojob"</span></span><br><span class="line">8) <span class="string">"20"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>zrem zset member1 member2â€¦ åˆ é™¤æŒ‡å®šå¤šä¸ªæˆå‘˜</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrem salary nojob</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zrange salary -inf +inf byscore</span><br><span class="line">1) <span class="string">"yqx"</span></span><br><span class="line">2) <span class="string">"sk"</span></span><br><span class="line">3) <span class="string">"deflory"</span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="äº”ã€ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹"><a href="#äº”ã€ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹" class="headerlink" title="äº”ã€ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹"></a>äº”ã€ä¸‰ç§ç‰¹æ®Šæ•°æ®ç±»å‹</h2><h4 id="5-1ã€Geo"><a href="#5-1ã€Geo" class="headerlink" title="5.1ã€Geo"></a>5.1ã€Geo</h4><p>Redis GEO ä¸»è¦ç”¨äºå­˜å‚¨åœ°ç†ä½ç½®ä¿¡æ¯ï¼Œå¹¶å¯¹å­˜å‚¨çš„ä¿¡æ¯è¿›è¡Œæ“ä½œï¼Œè¯¥åŠŸèƒ½åœ¨ Redis 3.2 ç‰ˆæœ¬æ–°å¢ã€‚</p>
<p>Redis GEO æ“ä½œæ–¹æ³•æœ‰ï¼š</p>
<ul>
<li>geoaddï¼šæ·»åŠ åœ°ç†ä½ç½®çš„åæ ‡ã€‚</li>
<li>geoposï¼šè·å–åœ°ç†ä½ç½®çš„åæ ‡ã€‚</li>
<li>geodistï¼šè®¡ç®—ä¸¤ä¸ªä½ç½®ä¹‹é—´çš„è·ç¦»ã€‚</li>
<li>georadiusï¼šæ ¹æ®ç”¨æˆ·ç»™å®šçš„ç»çº¬åº¦åæ ‡æ¥è·å–æŒ‡å®šèŒƒå›´å†…çš„åœ°ç†ä½ç½®é›†åˆã€‚</li>
<li>georadiusbymemberï¼šæ ¹æ®å‚¨å­˜åœ¨ä½ç½®é›†åˆé‡Œé¢çš„æŸä¸ªåœ°ç‚¹è·å–æŒ‡å®šèŒƒå›´å†…çš„åœ°ç†ä½ç½®é›†åˆã€‚</li>
<li>geohashï¼šè¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªä½ç½®å¯¹è±¡çš„ geohash å€¼ã€‚</li>
</ul>
<p><br></p>
<div class="note success">
            <p>geoadd geo longitude1 latitude1 member1â€¦ å°†å¤šä¸ªç»çº¬åº¦å’Œä½ç½®åç§°çš„ä¿¡æ¯æ·»åŠ åˆ° geo ä¸­</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrem salary nojob</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zrange salary -inf +inf byscore</span><br><span class="line">1) <span class="string">"yqx"</span></span><br><span class="line">2) <span class="string">"sk"</span></span><br><span class="line">3) <span class="string">"deflory"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>geopos geo member1 member2 è·å–å¤šä¸ªæˆå‘˜çš„åœ°ç†ä½ç½®</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geopos geo Palermo	<span class="comment"># è·å–Palermoçš„åœ°ç†ä½ç½®</span></span><br><span class="line">1) 1) <span class="string">"13.36099773645401001"</span>		<span class="comment"># ç”±äºåè½¬äºŒæ•°æ®ç²¾åº¦ä¸¢å¤±çš„é—®é¢˜</span></span><br><span class="line">   2) <span class="string">"38.1149987568412385"</span>			<span class="comment"># è¿™é‡Œä¸€èˆ¬ç›´æ¥ä¸æˆ‘ä»¬è®¾ç½®çš„å€¼å¤§è‡´ç›¸ç­‰</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>geodist geo member1 member2 [m|km|ft|mi] è·å–ä¸¤ä¸ªæˆå‘˜é—´çš„è·ç¦»</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geodist geo Palermo Catania <span class="comment"># è®¡ç®—Palermoä¸Cataniaçš„è·ç¦»</span></span><br><span class="line"><span class="string">"166290.2746"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>geodius geo longitude latitude radius m|km [WITHCOORD] [WITHDIST] [WITHHASH] [COUNT count] [ASC|DESC] [STORE key] [STOREDIST key] è·å– geo åœ¨ä»¥ç»™å®šç»çº¬åº¦ä¸ºåœ†å¿ƒï¼Œradius ä¸ºåŠå¾„çš„åœ†ä¸­çš„æˆå‘˜é›†åˆ</p>
          </div>
<ul>
<li>m ï¼šç±³ï¼Œé»˜è®¤å•ä½ã€‚</li>
<li>km ï¼šåƒç±³ã€‚</li>
<li>mi ï¼šè‹±é‡Œã€‚</li>
<li>ft ï¼šè‹±å°ºã€‚</li>
<li>WITHDIST: åœ¨è¿”å›ä½ç½®å…ƒç´ çš„åŒæ—¶ï¼Œ å°†ä½ç½®å…ƒç´ ä¸ä¸­å¿ƒä¹‹é—´çš„è·ç¦»ä¹Ÿä¸€å¹¶è¿”å›ã€‚</li>
<li>WITHCOORD: å°†ä½ç½®å…ƒç´ çš„ç»åº¦å’Œç»´åº¦ä¹Ÿä¸€å¹¶è¿”å›ã€‚</li>
<li>WITHHASH: ä»¥ 52 ä½æœ‰ç¬¦å·æ•´æ•°çš„å½¢å¼ï¼Œ è¿”å›ä½ç½®å…ƒç´ ç»è¿‡åŸå§‹ geohash ç¼–ç çš„æœ‰åºé›†åˆåˆ†å€¼ã€‚ è¿™ä¸ªé€‰é¡¹ä¸»è¦ç”¨äºåº•å±‚åº”ç”¨æˆ–è€…è°ƒè¯•ï¼Œ å®é™…ä¸­çš„ä½œç”¨å¹¶ä¸å¤§ã€‚</li>
<li>COUNT é™å®šè¿”å›çš„è®°å½•æ•°ã€‚</li>
<li>ASC: æŸ¥æ‰¾ç»“æœæ ¹æ®è·ç¦»ä»è¿‘åˆ°è¿œæ’åºã€‚</li>
<li>DESC: æŸ¥æ‰¾ç»“æœæ ¹æ®ä»è¿œåˆ°è¿‘æ’åºã€‚</li>
</ul>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; georadius geo 15 37 200 km</span><br><span class="line">1) <span class="string">"Palermo"</span></span><br><span class="line">2) <span class="string">"Catania"</span></span><br><span class="line">127.0.0.1:6379&gt; georadius geo 15 37 200 km withcoord	<span class="comment"># è¿”å›ç»çº¬åº¦</span></span><br><span class="line">1) 1) <span class="string">"Palermo"</span></span><br><span class="line">   2) 1) <span class="string">"13.36099773645401001"</span></span><br><span class="line">      2) <span class="string">"38.1149987568412385"</span></span><br><span class="line">2) 1) <span class="string">"Catania"</span></span><br><span class="line">   2) 1) <span class="string">"15.08699923753738403"</span></span><br><span class="line">      2) <span class="string">"37.50199925694555247"</span></span><br><span class="line">127.0.0.1:6379&gt; georadius geo 15 37 200 km withdist		<span class="comment"># è¿”å›åˆ°åœ†å¿ƒè·ç¦»</span></span><br><span class="line">1) 1) <span class="string">"Palermo"</span></span><br><span class="line">   2) <span class="string">"190.4286"</span></span><br><span class="line">2) 1) <span class="string">"Catania"</span></span><br><span class="line">   2) <span class="string">"56.3643"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>georadiusbymember è¯­æ³•åŒä¸Šï¼Œä½†æ˜¯ä»¥æˆå‘˜ä¸ºåœ†å¿ƒ</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geoadd geo 13.583333 37.316667 <span class="string">"Agrigento"</span> 13.361389 38.115556 <span class="string">"Palermo"</span> 15.087269 37.502669 <span class="string">"Catania"</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; georadiusbymember geo Agrigento 100 km	<span class="comment"># è·å–è·ç¦»Agrigentoè·ç¦»100kmèŒƒå›´å†…çš„æˆå‘˜</span></span><br><span class="line">1) <span class="string">"Agrigento"</span></span><br><span class="line">2) <span class="string">"Palermo"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>geohash member1 member2 è·å–å¤šä¸ªæˆå‘˜çš„ geohash å€¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; geohash geo Palermo Catania</span><br><span class="line">1) <span class="string">"sqc8b49rny0"</span></span><br><span class="line">2) <span class="string">"sqdtr74hyu0"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<p><code>å› ä¸º geo åº•å±‚æ˜¯ä½¿ç”¨ zset å®ç°çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ zset çš„æ–¹æ³•åœ¨ geo ä¸Šï¼ï¼ï¼</code></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange geo 0 -1	<span class="comment"># ä½¿ç”¨zrangeè·å–geoä¸­æ‰€æœ‰çš„æˆå‘˜</span></span><br><span class="line">1) <span class="string">"Agrigento"</span></span><br><span class="line">2) <span class="string">"Palermo"</span></span><br><span class="line">3) <span class="string">"Catania"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h4 id="5-2ã€HyperLogLog"><a href="#5-2ã€HyperLogLog" class="headerlink" title="5.2ã€HyperLogLog"></a>5.2ã€HyperLogLog</h4><p>Redis åœ¨ 2.8.9 ç‰ˆæœ¬æ·»åŠ äº† HyperLogLog ç»“æ„ã€‚</p>
<p>Redis HyperLogLog æ˜¯ç”¨æ¥åšåŸºæ•°ç»Ÿè®¡çš„ç®—æ³•ï¼ŒHyperLogLog çš„ä¼˜ç‚¹æ˜¯ï¼Œåœ¨è¾“å…¥å…ƒç´ çš„æ•°é‡æˆ–è€…ä½“ç§¯éå¸¸éå¸¸å¤§æ—¶ï¼Œè®¡ç®—åŸºæ•°æ‰€éœ€çš„ç©ºé—´æ€»æ˜¯å›ºå®š çš„ã€å¹¶ä¸”æ˜¯å¾ˆå°çš„ã€‚</p>
<p>åœ¨ Redis é‡Œé¢ï¼Œæ¯ä¸ª HyperLogLog é”®åªéœ€è¦èŠ±è´¹ 12 KB å†…å­˜ï¼Œå°±å¯ä»¥è®¡ç®—æ¥è¿‘ 2^64 ä¸ªä¸åŒå…ƒç´ çš„åŸº æ•°ã€‚è¿™å’Œè®¡ç®—åŸºæ•°æ—¶ï¼Œå…ƒç´ è¶Šå¤šè€—è´¹å†…å­˜å°±è¶Šå¤šçš„é›†åˆå½¢æˆé²œæ˜å¯¹æ¯”ã€‚</p>
<p>ä½†æ˜¯ï¼Œ<strong>å› ä¸º HyperLogLog åªä¼šæ ¹æ®è¾“å…¥å…ƒç´ æ¥è®¡ç®—åŸºæ•°ï¼Œè€Œä¸ä¼šå‚¨å­˜è¾“å…¥å…ƒç´ æœ¬èº«ï¼Œæ‰€ä»¥ HyperLogLog ä¸èƒ½åƒé›†åˆé‚£æ ·ï¼Œè¿”å›è¾“å…¥çš„å„ä¸ªå…ƒç´ ã€‚</strong></p>
<p><br></p>
<p><strong>é‚£ä¹ˆä»€ä¹ˆæ˜¯åŸºæ•°å‘¢ï¼Ÿ</strong></p>
<p>æ¯”å¦‚æ•°æ®é›† {1, 3, 5, 7, 5, 7, 8}ï¼Œ é‚£ä¹ˆè¿™ä¸ªæ•°æ®é›†çš„åŸºæ•°é›†ä¸º {1, 3, 5 ,7, 8}, åŸºæ•°(ä¸é‡å¤å…ƒç´ )ä¸º5ã€‚ åŸºæ•°ä¼°è®¡å°±æ˜¯åœ¨è¯¯å·®å¯æ¥å—çš„èŒƒå›´å†…ï¼Œå¿«é€Ÿè®¡ç®—åŸºæ•°ã€‚</p>
<p><br></p>
<div class="note success">
            <p>pfadd pf v1 v2 v3â€¦ æ·»åŠ å¤šä¸ªå€¼åˆ° HyperLogLog ä¸­</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; pfadd pf1 a b c d e f g</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; pfadd pf2 a b c x y z</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>pfcount pf1 [pf2â€¦] è¿”å›ç»™å®š HyperLogLog çš„åŸºæ•°ä¼°ç®—å€¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; pfcount pf1	<span class="comment"># pf1åŸºæ•°ä¸º7</span></span><br><span class="line">(<span class="built_in">integer</span>) 7</span><br><span class="line">127.0.0.1:6379&gt; pfcount pf2	<span class="comment"># pf2åŸºæ•°ä¸º6</span></span><br><span class="line">(<span class="built_in">integer</span>) 6</span><br><span class="line">127.0.0.1:6379&gt; pfcount pf1 pf2	<span class="comment"># pf1å’Œpf2ç»„åˆçš„HyperLogLogåŸºæ•°ä¸º10</span></span><br><span class="line">(<span class="built_in">integer</span>) 10</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>pfmerge destkey sourcekey [sourcekeyâ€¦]</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; pfmerge pf1 pf2 <span class="comment"># å°†pf1å’Œpf2åˆå¹¶çš„ç»“æœèµ‹ç»™pf1</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; pfcount pf1		<span class="comment"># åˆå¹¶åpf1çš„åŸºæ•°ä¸º10</span></span><br><span class="line">(<span class="built_in">integer</span>) 10</span><br><span class="line">127.0.0.1:6379&gt; pfcount pf2		<span class="comment"># åˆå¹¶åpf2æ²¡æœ‰æ”¹å˜ï¼ŒåŸºæ•°ä¸º6</span></span><br><span class="line">(<span class="built_in">integer</span>) 6</span><br><span class="line">127.0.0.1:6379&gt; pfcount pf1 pf2	<span class="comment"># ä¸ç”¨pfcountæ±‚åŸºæ•°ç»“æœä¸€è‡´</span></span><br><span class="line">(<span class="built_in">integer</span>) 10</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h4 id="5-3ã€Bitmaps"><a href="#5-3ã€Bitmaps" class="headerlink" title="5.3ã€Bitmaps"></a>5.3ã€Bitmaps</h4><p>Bitmaps ä½å›¾ï¼Œæ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œé€šè¿‡æ“ä½œäºŒè¿›åˆ¶ä½æ¥è¿›è¡Œè®°å½•ï¼Œåªæœ‰0å’Œ1ä¸¤ä¸ªçŠ¶æ€ã€‚</p>
<p>å¦‚æœè¦ç»Ÿè®¡ä¸€å¹´çš„æ‰“å¡æƒ…å†µï¼Œ365å¤© = 365bitï¼Œçº¦ç­‰äº46Bã€‚</p>
<p><br></p>
<div class="note success">
            <p>setbit bitmap index value è®¾å€¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; setbit bitmap 0 2	<span class="comment"># ä½å›¾åªæœ‰0å’Œ1ä¸¤ç§çŠ¶æ€</span></span><br><span class="line">(error) ERR bit is not an <span class="built_in">integer</span> or out of range</span><br><span class="line">127.0.0.1:6379&gt; setbit bitmap 0 0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit bitmap 0 1	<span class="comment"># é‡æ–°å°†ä¸‹æ ‡0çš„å€¼è®¾ä¸º1</span></span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit bitmap 1 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit bitmap 2 0</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit bitmap 3 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit bitmap 4 1</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>bitcount bitmap ç»Ÿè®¡å€¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; bitcount bitmap</span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>getbit è·å–æŒ‡å®šä¸‹æ ‡çš„å€¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; getbit bitmap 1</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; getbit bitmap 2</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></tbody></table></figure>
<h2 id="å…­ã€äº‹åŠ¡"><a href="#å…­ã€äº‹åŠ¡" class="headerlink" title="å…­ã€äº‹åŠ¡"></a>å…­ã€äº‹åŠ¡</h2><p>Redis äº‹åŠ¡å¯ä»¥ä¸€æ¬¡æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œ å¹¶ä¸”å¸¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªé‡è¦çš„ä¿è¯ï¼š</p>
<ul>
<li>æ‰¹é‡æ“ä½œåœ¨å‘é€ EXEC å‘½ä»¤å‰è¢«æ”¾å…¥é˜Ÿåˆ—ç¼“å­˜ã€‚</li>
<li>æ”¶åˆ° EXEC å‘½ä»¤åè¿›å…¥äº‹åŠ¡æ‰§è¡Œï¼Œäº‹åŠ¡ä¸­ä»»æ„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶ä½™çš„å‘½ä»¤ä¾ç„¶è¢«æ‰§è¡Œã€‚</li>
<li>åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ï¼Œå…¶ä»–å®¢æˆ·ç«¯æäº¤çš„å‘½ä»¤è¯·æ±‚ä¸ä¼šæ’å…¥åˆ°äº‹åŠ¡æ‰§è¡Œå‘½ä»¤åºåˆ—ä¸­ã€‚</li>
</ul>
<p>ä¸€ä¸ªäº‹åŠ¡ä»å¼€å§‹åˆ°æ‰§è¡Œä¼šç»å†ä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li>å¼€å§‹äº‹åŠ¡ã€‚</li>
<li>å‘½ä»¤å…¥é˜Ÿã€‚</li>
<li>æ‰§è¡Œäº‹åŠ¡ã€‚</li>
</ul>
<p><br></p>
<h4 id="6-1ã€å¼€å¯äº‹åŠ¡"><a href="#6-1ã€å¼€å¯äº‹åŠ¡" class="headerlink" title="6.1ã€å¼€å¯äº‹åŠ¡"></a>6.1ã€å¼€å¯äº‹åŠ¡</h4><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªäº‹åŠ¡çš„ä¾‹å­ï¼Œ å®ƒå…ˆä»¥ <strong>MULTI</strong> å¼€å§‹ä¸€ä¸ªäº‹åŠ¡ï¼Œ ç„¶åå°†å¤šä¸ªå‘½ä»¤å…¥é˜Ÿåˆ°äº‹åŠ¡ä¸­ï¼Œ æœ€åç”± <strong>EXEC</strong> å‘½ä»¤è§¦å‘äº‹åŠ¡ï¼Œ ä¸€å¹¶æ‰§è¡Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi	<span class="comment"># å¼€å¯äº‹åŠ¡</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> name yqx</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> age 16</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> weight 60</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">exec</span>	<span class="comment"># æ‰§è¡Œäº‹åŠ¡</span></span><br><span class="line">1) OK</span><br><span class="line">2) OK</span><br><span class="line">3) OK</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line"><span class="string">"yqx"</span></span><br><span class="line">127.0.0.1:6379&gt; get age</span><br><span class="line"><span class="string">"16"</span></span><br><span class="line">127.0.0.1:6379&gt; get weight</span><br><span class="line"><span class="string">"60"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<p><strong>å½“äº‹åŠ¡ä¸­å‡ºç°ç¼–è¯‘é”™è¯¯æ—¶ï¼Œè¿™å…¶ä¸­æ‰€æœ‰çš„æ“ä½œéƒ½ä¸ä¼šè¢«æ‰§è¡Œ</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> name yqx</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; set123 age 16	<span class="comment"># é”™è¯¯çš„å‘½ä»¤</span></span><br><span class="line">(error) ERR unknown <span class="built_in">command</span> `set123`, with args beginning with: `age`, `16`, </span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> height 175</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">exec</span></span><br><span class="line">(error) EXECABORT Transaction discarded because of previous errors.</span><br><span class="line">127.0.0.1:6379&gt; get name	<span class="comment"># æ²¡æœ‰è·å–åˆ°nameçš„å€¼</span></span><br><span class="line">(nil)</span><br><span class="line">127.0.0.1:6379&gt; get age</span><br><span class="line">(nil)</span><br><span class="line">127.0.0.1:6379&gt; get height</span><br><span class="line">(nil)</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<p>å•ä¸ª Redis å‘½ä»¤çš„æ‰§è¡Œæ˜¯åŸå­æ€§çš„ï¼Œä½† Redis æ²¡æœ‰åœ¨äº‹åŠ¡ä¸Šå¢åŠ ä»»ä½•ç»´æŒåŸå­æ€§çš„æœºåˆ¶ï¼Œæ‰€ä»¥ Redis äº‹åŠ¡çš„æ‰§è¡Œå¹¶ä¸æ˜¯åŸå­æ€§çš„ã€‚</p>
<p>äº‹åŠ¡å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ‰“åŒ…çš„æ‰¹é‡æ‰§è¡Œè„šæœ¬ï¼Œä½†æ‰¹é‡æŒ‡ä»¤å¹¶éåŸå­åŒ–çš„æ“ä½œï¼Œ<strong>ä¸­é—´æŸæ¡æŒ‡ä»¤çš„å¤±è´¥ä¸ä¼šå¯¼è‡´å‰é¢å·²åšæŒ‡ä»¤çš„å›æ»šï¼Œä¹Ÿä¸ä¼šé€ æˆåç»­çš„æŒ‡ä»¤ä¸åš</strong>ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> name yqx</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">set</span> age 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; incr name	<span class="comment"># æ­¤ä¸ºè¯­æ³•é”™è¯¯ï¼Œå­—ç¬¦ä¸²æ— æ³•è¿›è¡Œè‡ªå¢è¿ç®—</span></span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; get name</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">exec</span></span><br><span class="line">1) OK	<span class="comment"># é™¤äº†è¯­æ³•é”™è¯¯çš„å‘½ä»¤ï¼Œå…¶ä»–å‘½ä»¤éƒ½æ­£ç¡®æ‰§è¡Œäº†</span></span><br><span class="line">2) OK</span><br><span class="line">3) (error) ERR value is not an <span class="built_in">integer</span> or out of range</span><br><span class="line">4) <span class="string">"yqx"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>discard å–æ¶ˆäº‹åŠ¡</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; zadd zset 10 score</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; discard	<span class="comment"># å–æ¶ˆäº‹åŠ¡</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; </span><br></pre></td></tr></tbody></table></figure>
<h4 id="6-2ã€watch-ç›‘å¬"><a href="#6-2ã€watch-ç›‘å¬" class="headerlink" title="6.2ã€watch ç›‘å¬"></a>6.2ã€watch ç›‘å¬</h4><p><strong>æ‚²è§‚é”ï¼š</strong></p>
<ul>
<li>å¾ˆæ‚²è§‚ï¼Œè®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¼šå‡ºé—®é¢˜ï¼Œæ— è®ºåšä»€ä¹ˆéƒ½ä¼šåŠ é”ï¼</li>
</ul>
<p><strong>ä¹è§‚é”ï¼š</strong></p>
<ul>
<li>å¾ˆä¹è§‚ï¼Œè®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¸ä¼šå‡ºé—®é¢˜ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼æ›´æ–°æ•°æ®çš„æ—¶å€™ä¼šè¿›è¡Œåˆ¤æ–­ï¼Œåœ¨æ­¤å‰æ˜¯å¦æœ‰äººä¿®æ”¹è¿‡è¿™ä¸ªæ•°æ®ã€‚</li>
</ul>
<div class="note success">
            <p>watch key1 key2â€¦ ç›‘å¬ä¸€ä¸ªæˆ–å¤šä¸ª key ï¼Œå¦‚æœåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰ï¼Œè¿™ä¸ª key è¢«å…¶å®ƒå‘½ä»¤æ‰€æ”¹åŠ¨ï¼Œé‚£ä¹ˆäº‹åŠ¡å°†è¢«æ‰“æ–­ï¼Œç”±æ­¤å®ç°ä¹è§‚é”çš„æ•ˆæœã€‚</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> money 100</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> out 0</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; watch money	<span class="comment"># ç›‘å¬money</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; multi	<span class="comment"># å¯åŠ¨äº‹åŠ¡</span></span><br><span class="line">OK</span><br></pre></td></tr></tbody></table></figure>
<p>åœ¨å¯åŠ¨äº‹åŠ¡çš„åŒæ—¶ï¼Œæˆ‘ä»¬æ–°è¿æ¥ä¸€ä¸ª redis å®¢æˆ·ç«¯ï¼Œä¿®æ”¹ money çš„å€¼ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> money 1000</span><br><span class="line">OK</span><br></pre></td></tr></tbody></table></figure>
<p>æ­¤æ—¶å†å›åˆ°ç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå®Œå–„äº‹åŠ¡ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379(TX)&gt; incrby money 200</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; decrby out 200</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379(TX)&gt; <span class="built_in">exec</span>	<span class="comment"># äº‹åŠ¡æ²¡æœ‰æ‰§è¡Œï¼Œè¢«æ‰“æ–­äº†</span></span><br><span class="line">(nil)</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<div class="note success">
            <p>ä¸ watch ç›¸å¯¹çš„ï¼Œæœ‰ä¸€ä¸ªå‘½ä»¤å«åš unwatchï¼Œç”¨äºå–æ¶ˆå¯¹æ‰€æœ‰ key çš„ç›‘è§†</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; watch money</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; unwatch	<span class="comment"># å–æ¶ˆç›‘å¬</span></span><br><span class="line">OK</span><br></pre></td></tr></tbody></table></figure>
<h2 id="ä¸ƒã€Jedis"><a href="#ä¸ƒã€Jedis" class="headerlink" title="ä¸ƒã€Jedis"></a>ä¸ƒã€Jedis</h2><h4 id="7-1ã€é…ç½®"><a href="#7-1ã€é…ç½®" class="headerlink" title="7.1ã€é…ç½®"></a>7.1ã€é…ç½®</h4><p>å¦‚æœæƒ³è¦åœ¨ Java ä¸­è¿æ¥ Redisï¼Œå°±éœ€è¦ä½¿ç”¨ Jedis è¿™ä¸ª jar åŒ…ï¼Œä»¥ä¸‹æ˜¯å®ƒçš„ Maven ä¾èµ–ã€‚</p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.7.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>å½“ç„¶ï¼Œåœ¨è¿æ¥ä¹‹å‰è¿˜éœ€è¦ä¿®æ”¹ä¸€ä¸‹é˜¿é‡Œäº‘ä¸­ Redis çš„é…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸‹ã€‚</p>
<ol>
<li><p>æ³¨é‡Š bind 127.0.0.1</p>
<p><img src="https://z3.ax1x.com/2021/11/26/oEptuF.png" alt=""></p>
</li>
<li><p>protect-mode æ”¹ä¸º no</p>
<p><img src="https://z3.ax1x.com/2021/11/26/oEp041.png" alt=""></p>
</li>
</ol>
<p>ä¹‹åé‡å¯ Redis å³å¯ã€‚</p>
<ul>
<li><p>åœæ­¢æ‰€æœ‰å®¢æˆ·ç«¯</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">./redis-cli shutdown</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>å¯åŠ¨ Redis</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">redis-server ../MyRedis.conf</span><br></pre></td></tr></tbody></table></figure>
</li>
</ul>
<p>æµ‹è¯•è¿æ¥ï¼ŒæˆåŠŸè¾“å‡º <code>PONG</code>!</p>
<p><img src="https://z3.ax1x.com/2021/11/26/oEpXUs.png" alt=""></p>
<h4 id="7-2ã€Jedis-ä½¿ç”¨"><a href="#7-2ã€Jedis-ä½¿ç”¨" class="headerlink" title="7.2ã€Jedis ä½¿ç”¨"></a>7.2ã€Jedis ä½¿ç”¨</h4><p>æµ‹è¯•é”®</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">KeyTest</span><span class="params">()</span> </span>{</span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"47.102.124.75"</span>, <span class="number">6379</span>);</span><br><span class="line">        System.out.println(<span class="string">"æ¸…ç©ºæ•°æ®:"</span> + jedis.flushDB());</span><br><span class="line">        System.out.println(<span class="string">"åˆ¤æ–­æŸä¸ªé”®æ˜¯å¦å­˜åœ¨:"</span> + jedis.exists(<span class="string">"username"</span>));</span><br><span class="line">        System.out.println(<span class="string">"æ–°å¢&lt;'username','deflory'&gt;çš„é”®å€¼å¯¹:"</span> + jedis.set(<span class="string">"username"</span>, <span class="string">"deflory"</span>));</span><br><span class="line">        System.out.println(<span class="string">"æ–°å¢&lt;'password','123456'&gt;çš„é”®å€¼å¯¹:"</span> + jedis.set(<span class="string">"password"</span>, <span class="string">"123456"</span>));</span><br><span class="line">        System.out.println(<span class="string">"ç³»ç»Ÿä¸­æ‰€æœ‰çš„é”®:"</span> + jedis.keys(<span class="string">"*"</span>));</span><br><span class="line">        System.out.println(<span class="string">"åˆ é™¤é”®password:"</span> + jedis.del(<span class="string">"password"</span>));</span><br><span class="line">        System.out.println(<span class="string">"åˆ¤æ–­é”®passwordæ˜¯å¦å­˜åœ¨:"</span> + jedis.exists(<span class="string">"password"</span>));</span><br><span class="line">        System.out.println(<span class="string">"æŸ¥çœ‹é”®usernameæ‰€å­˜å‚¨å€¼çš„ç±»å‹:"</span> + jedis.type(<span class="string">"username"</span>));</span><br><span class="line">        System.out.println(<span class="string">"éšå³è¿”å›keyç©ºé—´ä¸­çš„ä¸€ä¸ª:"</span> + jedis.randomKey());</span><br><span class="line">        System.out.println(<span class="string">"é‡å‘½åusernameä¸ºname:"</span> + jedis.rename(<span class="string">"username"</span>, <span class="string">"name"</span>));</span><br><span class="line">        System.out.println(<span class="string">"å–å‡ºä¿®æ”¹åçš„name:"</span> + jedis.get(<span class="string">"name"</span>));</span><br><span class="line">        System.out.println(<span class="string">"åˆ‡æ¢è‡³1å·æ•°æ®åº“:"</span> + jedis.select(<span class="number">1</span>));</span><br><span class="line">        System.out.println(<span class="string">"æŸ¥çœ‹å½“å‰æ•°æ®åº“å¤§å°:"</span> + jedis.dbSize());</span><br><span class="line">        System.out.println(<span class="string">"åˆ‡æ¢å›é»˜è®¤æ•°æ®åº“:"</span> + jedis.select(<span class="number">0</span>));</span><br><span class="line">        System.out.println(<span class="string">"åˆ é™¤å½“å‰é€‰ä¸­æ•°æ®åº“çš„æ‰€æœ‰key:"</span> + jedis.flushDB());</span><br><span class="line">        System.out.println(<span class="string">"ç³»ç»Ÿä¸­æ‰€æœ‰çš„é”®:"</span> + jedis.keys(<span class="string">"*"</span>));</span><br><span class="line">        System.out.println(<span class="string">"åˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰key:"</span> + jedis.flushAll());</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯• String</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void StringTest() throws InterruptedException {</span><br><span class="line">    Jedis jedis = new Jedis(<span class="string">"47.102.124.75"</span>, 6379);</span><br><span class="line">    jedis.flushDB();</span><br><span class="line">    System.out.println(<span class="string">"============å¢åŠ æ•°æ®============"</span>);</span><br><span class="line">    System.out.println(jedis.set(<span class="string">"key1"</span>, <span class="string">"value1"</span>));</span><br><span class="line">    System.out.println(jedis.set(<span class="string">"key2"</span>, <span class="string">"value2"</span>));</span><br><span class="line">    System.out.println(jedis.set(<span class="string">"key3"</span>, <span class="string">"value3"</span>));</span><br><span class="line">    System.out.println(<span class="string">"åˆ é™¤é”®key2:"</span> + jedis.del(<span class="string">"key2"</span>));</span><br><span class="line">    System.out.println(<span class="string">"è·å–é”®key2:"</span> + jedis.get(<span class="string">"key2"</span>));</span><br><span class="line">    System.out.println(<span class="string">"ä¿®æ”¹é”®key1:"</span> + jedis.set(<span class="string">"key1"</span>, <span class="string">"NewValue1"</span>));</span><br><span class="line">    System.out.println(<span class="string">"åœ¨key3çš„å€¼åé¢è¿½åŠ å€¼:"</span> + jedis.append(<span class="string">"key3"</span>, <span class="string">"End"</span>));</span><br><span class="line">    System.out.println(<span class="string">"è·å–key3çš„å€¼:"</span> + jedis.get(<span class="string">"key3"</span>));</span><br><span class="line">    System.out.println(<span class="string">"å¢åŠ å¤šä¸ªé”®å€¼å¯¹:"</span> + jedis.mset(<span class="string">"key01"</span>, <span class="string">"value01"</span>, <span class="string">"key02"</span>, <span class="string">"value02"</span>, <span class="string">"key03"</span>, <span class="string">"value03"</span>));</span><br><span class="line">    System.out.println(<span class="string">"è·å–å¤šä¸ªé”®å€¼å¯¹:"</span> + jedis.mget(<span class="string">"key01"</span>, <span class="string">"key02"</span>, <span class="string">"key03"</span>));</span><br><span class="line">    System.out.println(<span class="string">"åˆ é™¤å¤šä¸ªé”®å€¼å¯¹:"</span> + jedis.del(<span class="string">"key01"</span>, <span class="string">"key02"</span>));</span><br><span class="line">    System.out.println(<span class="string">"è·å–å¤šä¸ªé”®å€¼å¯¹:"</span> + jedis.mget(<span class="string">"key01"</span>, <span class="string">"key02"</span>, <span class="string">"key03"</span>));</span><br><span class="line"></span><br><span class="line">    jedis.flushDB();</span><br><span class="line">    System.out.println(<span class="string">"============æ–°å¢é”®å€¼å¯¹é˜²æ­¢è¦†ç›–åŸå…ˆå€¼============"</span>);</span><br><span class="line">    System.out.println(jedis.setnx(<span class="string">"key1"</span>, <span class="string">"value1"</span>));</span><br><span class="line">    System.out.println(jedis.setnx(<span class="string">"key2"</span>, <span class="string">"value2"</span>));</span><br><span class="line">    System.out.println(jedis.setnx(<span class="string">"key2"</span>, <span class="string">"NewValue2"</span>));</span><br><span class="line">    System.out.println(jedis.mget(<span class="string">"key1"</span>, <span class="string">"key2"</span>));</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">"============æ–°å¢é”®å€¼å¯¹å¹¶è®¾ç½®æœ‰æ•ˆæ—¶é—´============"</span>);</span><br><span class="line">    System.out.println(jedis.setex(<span class="string">"key3"</span>, 2, <span class="string">"value3"</span>));</span><br><span class="line">    System.out.println(jedis.get(<span class="string">"key3"</span>));</span><br><span class="line">    System.out.println(jedis.ttl(<span class="string">"key3"</span>));</span><br><span class="line">    Thread.sleep(4000);</span><br><span class="line">    System.out.println(<span class="string">"4ç§’å......"</span>);</span><br><span class="line">    System.out.println(jedis.get(<span class="string">"key3"</span>));</span><br><span class="line">    System.out.println(jedis.ttl(<span class="string">"key3"</span>));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯• Set</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetTest</span><span class="params">()</span></span>{</span><br><span class="line">    Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"47.102.124.75"</span>, <span class="number">6379</span>);</span><br><span class="line">    jedis.flushDB();</span><br><span class="line">    System.out.println(<span class="string">"æ·»åŠ æ•°æ®åˆ°é›†åˆ1:"</span> + jedis.sadd(<span class="string">"set1"</span>, <span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>));</span><br><span class="line">    System.out.println(<span class="string">"æ·»åŠ æ•°æ®åˆ°é›†åˆ2:"</span> + jedis.sadd(<span class="string">"set2"</span>, <span class="string">"e"</span>, <span class="string">"f"</span>, <span class="string">"g"</span>, <span class="string">"h"</span>));</span><br><span class="line">    System.out.println(<span class="string">"æŸ¥çœ‹é›†åˆ1å…ƒç´ æ•°é‡:"</span> + jedis.scard(<span class="string">"set1"</span>));</span><br><span class="line">    System.out.println(<span class="string">"æŸ¥çœ‹é›†åˆ1å…ƒç´ :"</span> + jedis.smembers(<span class="string">"set1"</span>));</span><br><span class="line">    System.out.println(<span class="string">"é›†åˆ1ä¸é›†åˆ2å·®é›†:"</span> + jedis.sdiff(<span class="string">"set1"</span>, <span class="string">"set2"</span>));</span><br><span class="line">    System.out.println(<span class="string">"é›†åˆ1ä¸é›†åˆ2å¹¶é›†:"</span> + jedis.sunion(<span class="string">"set1"</span>, <span class="string">"set2"</span>));</span><br><span class="line">    System.out.println(<span class="string">"é›†åˆ1ä¸é›†åˆ2äº¤é›†:"</span> + jedis.sinter(<span class="string">"set1"</span>, <span class="string">"set2"</span>));</span><br><span class="line">    System.out.println(<span class="string">"éšæœºç§»é™¤é›†åˆ1çš„ä¸€ä¸ªå…ƒç´ :"</span> + jedis.spop(<span class="string">"set1"</span>));</span><br><span class="line">    System.out.println(<span class="string">"æŸ¥çœ‹é›†åˆ1å…ƒç´ :"</span> + jedis.smembers(<span class="string">"set1"</span>));</span><br><span class="line">    System.out.println(<span class="string">"éšæœºè¿”å›é›†åˆ1çš„ä¸‰ä¸ªå…ƒç´ "</span> + jedis.srandmember(<span class="string">"set1"</span>));</span><br><span class="line">    System.out.println(<span class="string">"æŸ¥çœ‹gæ˜¯å¦å­˜å‚¨åœ¨é›†åˆ2ä¸­:"</span> + jedis.sismember(<span class="string">"set2"</span>, <span class="string">"g"</span>));</span><br><span class="line">    System.out.println(<span class="string">"å°†é›†åˆ2çš„gç§»åŠ¨åˆ°é›†åˆ1ä¸­:"</span> + jedis.smove(<span class="string">"set2"</span>, <span class="string">"set1"</span>, <span class="string">"g"</span>));</span><br><span class="line">    System.out.println(<span class="string">"æŸ¥çœ‹é›†åˆ1çš„å…ƒç´ :"</span> + jedis.smembers(<span class="string">"set1"</span>));</span><br><span class="line">    System.out.println(<span class="string">"ç§»é™¤é›†åˆ1çš„g:"</span> + jedis.srem(<span class="string">"set1"</span>, <span class="string">"g"</span>));</span><br><span class="line">    System.out.println(<span class="string">"æŸ¥çœ‹é›†åˆ1çš„å…ƒç´ :"</span> + jedis.smembers(<span class="string">"set1"</span>));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>å¤ªå¤šäº†ï¼Œåé¢çš„å°±ä¸å†™äº†ï¼Œå’Œ Redis çš„ä½¿ç”¨å·®ä¸å¤šï¼</p>
<p>äº‹åŠ¡</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TransactionTest1</span><span class="params">()</span></span>{</span><br><span class="line">    Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"47.102.124.75"</span>, <span class="number">6379</span>);</span><br><span class="line">    jedis.flushDB();</span><br><span class="line">    Transaction transaction = jedis.multi();	<span class="comment">// å¯åŠ¨äº‹åŠ¡</span></span><br><span class="line">    transaction.set(<span class="string">"name"</span>, <span class="string">"yqx"</span>);</span><br><span class="line">    transaction.set(<span class="string">"age"</span>, <span class="string">"20"</span>);</span><br><span class="line">    transaction.incr(<span class="string">"name"</span>);					<span class="comment">// æµ‹è¯•é”™è¯¯è¯­æ³•</span></span><br><span class="line">    transaction.exec();</span><br><span class="line">    System.out.println(jedis.get(<span class="string">"name"</span>)); <span class="comment">// yqx</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TransactionTest2</span><span class="params">()</span></span>{</span><br><span class="line">    Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"47.102.124.75"</span>, <span class="number">6379</span>);</span><br><span class="line">    jedis.flushDB();</span><br><span class="line">    Transaction transaction = jedis.multi();</span><br><span class="line">    <span class="comment">// å…¨éƒ½ä¸ä¼šè¢«æ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">try</span>{</span><br><span class="line">        transaction.set(<span class="string">"name"</span>, <span class="string">"yqx"</span>);</span><br><span class="line">        System.out.println(jedis.get(<span class="string">"name"</span>));	</span><br><span class="line">        transaction.set(<span class="string">"age"</span>, <span class="string">"20"</span>);</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">        transaction.exec();</span><br><span class="line">    }<span class="keyword">catch</span> (Exception e){</span><br><span class="line">        transaction.discard();					<span class="comment">// äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œåˆ™å–æ¶ˆäº‹åŠ¡</span></span><br><span class="line">    }<span class="keyword">finally</span> {</span><br><span class="line">        System.out.println(jedis.get(<span class="string">"name"</span>));	<span class="comment">// null</span></span><br><span class="line">        System.out.println(jedis.get(<span class="string">"age"</span>));	<span class="comment">// null</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="å…«ã€Redis-é…ç½®"><a href="#å…«ã€Redis-é…ç½®" class="headerlink" title="å…«ã€Redis é…ç½®"></a>å…«ã€Redis é…ç½®</h2><div class="note success">
            <p>Redis å•ä½ä¸åŒºåˆ†å¤§å°å†™</p>
          </div>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line"># it in the usual form of 1k 5GB 4M and so forth:</span><br><span class="line">#</span><br><span class="line"># 1k =&gt; 1000 bytes</span><br><span class="line"># 1kb =&gt; 1024 bytes</span><br><span class="line"># 1m =&gt; 1000000 bytes</span><br><span class="line"># 1mb =&gt; 1024*1024 bytes</span><br><span class="line"># 1g =&gt; 1000000000 bytes</span><br><span class="line"># 1gb =&gt; 1024*1024*1024 bytes</span><br><span class="line">#</span><br><span class="line"># units are case insensitive so 1GB 1Gb 1gB are all the same</span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>ä¸»è¦é…ç½®å­—æ®µè¯´æ˜</p>
          </div>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">åºå·</th>
<th style="text-align:left">é…ç½®é¡¹</th>
<th style="text-align:left">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left"><code>daemonize no</code></td>
<td style="text-align:left">Redis é»˜è®¤ä¸æ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œå¯ä»¥é€šè¿‡è¯¥é…ç½®é¡¹ä¿®æ”¹ï¼Œä½¿ç”¨ yes å¯ç”¨å®ˆæŠ¤è¿›ç¨‹ï¼ˆWindows ä¸æ”¯æŒå®ˆæŠ¤çº¿ç¨‹çš„é…ç½®ä¸º no ï¼‰</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left"><code>pidfile /var/run/redis.pid</code></td>
<td style="text-align:left">å½“ Redis ä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œæ—¶ï¼ŒRedis é»˜è®¤ä¼šæŠŠ pid å†™å…¥ /var/run/redis.pid æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ pidfile æŒ‡å®š</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left"><code>port 6379</code></td>
<td style="text-align:left">æŒ‡å®š Redis ç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º 6379ï¼Œä½œè€…åœ¨è‡ªå·±çš„ä¸€ç¯‡åšæ–‡ä¸­è§£é‡Šäº†ä¸ºä»€ä¹ˆé€‰ç”¨ 6379 ä½œä¸ºé»˜è®¤ç«¯å£ï¼Œå› ä¸º 6379 åœ¨æ‰‹æœºæŒ‰é”®ä¸Š MERZ å¯¹åº”çš„å·ç ï¼Œè€Œ MERZ å–è‡ªæ„å¤§åˆ©æ­Œå¥³ Alessia Merz çš„åå­—</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left"><code>bind 127.0.0.1</code></td>
<td style="text-align:left">ç»‘å®šçš„ä¸»æœºåœ°å€</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left"><code>timeout 300</code></td>
<td style="text-align:left">å½“å®¢æˆ·ç«¯é—²ç½®å¤šé•¿ç§’åå…³é—­è¿æ¥ï¼Œå¦‚æœæŒ‡å®šä¸º 0 ï¼Œè¡¨ç¤ºå…³é—­è¯¥åŠŸèƒ½</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:left"><code>loglevel notice</code></td>
<td style="text-align:left">æŒ‡å®šæ—¥å¿—è®°å½•çº§åˆ«ï¼ŒRedis æ€»å…±æ”¯æŒå››ä¸ªçº§åˆ«ï¼šdebugã€verboseã€noticeã€warningï¼Œé»˜è®¤ä¸º notice</td>
</tr>
<tr>
<td style="text-align:left">7</td>
<td style="text-align:left"><code>logfile stdout</code></td>
<td style="text-align:left">æ—¥å¿—è®°å½•æ–¹å¼ï¼Œé»˜è®¤ä¸ºæ ‡å‡†è¾“å‡ºï¼Œå¦‚æœé…ç½® Redis ä¸ºå®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œï¼Œè€Œè¿™é‡Œåˆé…ç½®ä¸ºæ—¥å¿—è®°å½•æ–¹å¼ä¸ºæ ‡å‡†è¾“å‡ºï¼Œåˆ™æ—¥å¿—å°†ä¼šå‘é€ç»™ /dev/null</td>
</tr>
<tr>
<td style="text-align:left">8</td>
<td style="text-align:left"><code>databases 16</code></td>
<td style="text-align:left">è®¾ç½®æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ•°æ®åº“ä¸º0ï¼Œå¯ä»¥ä½¿ç”¨SELECT å‘½ä»¤åœ¨è¿æ¥ä¸ŠæŒ‡å®šæ•°æ®åº“id</td>
</tr>
<tr>
<td style="text-align:left">9</td>
<td style="text-align:left"><code>save &lt;seconds&gt; &lt;changes&gt;</code>Redis é»˜è®¤é…ç½®æ–‡ä»¶ä¸­æä¾›äº†ä¸‰ä¸ªæ¡ä»¶ï¼š<strong>save 900 1**</strong>save 300 10<strong>**save 60 10000</strong>åˆ†åˆ«è¡¨ç¤º 900 ç§’ï¼ˆ15 åˆ†é’Ÿï¼‰å†…æœ‰ 1 ä¸ªæ›´æ”¹ï¼Œ300 ç§’ï¼ˆ5 åˆ†é’Ÿï¼‰å†…æœ‰ 10 ä¸ªæ›´æ”¹ä»¥åŠ 60 ç§’å†…æœ‰ 10000 ä¸ªæ›´æ”¹ã€‚</td>
<td style="text-align:left">æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªæ¡ä»¶é…åˆ</td>
</tr>
<tr>
<td style="text-align:left">10</td>
<td style="text-align:left"><code>rdbcompression yes</code></td>
<td style="text-align:left">æŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸º yesï¼ŒRedis é‡‡ç”¨ LZF å‹ç¼©ï¼Œå¦‚æœä¸ºäº†èŠ‚çœ CPU æ—¶é—´ï¼Œå¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶å˜çš„å·¨å¤§</td>
</tr>
<tr>
<td style="text-align:left">11</td>
<td style="text-align:left"><code>dbfilename dump.rdb</code></td>
<td style="text-align:left">æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸º dump.rdb</td>
</tr>
<tr>
<td style="text-align:left">12</td>
<td style="text-align:left"><code>dir ./</code></td>
<td style="text-align:left">æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½•</td>
</tr>
<tr>
<td style="text-align:left">13</td>
<td style="text-align:left"><code>slaveof &lt;masterip&gt; &lt;masterport&gt;</code></td>
<td style="text-align:left">è®¾ç½®å½“æœ¬æœºä¸º slave æœåŠ¡æ—¶ï¼Œè®¾ç½® master æœåŠ¡çš„ IP åœ°å€åŠç«¯å£ï¼Œåœ¨ Redis å¯åŠ¨æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ä» master è¿›è¡Œæ•°æ®åŒæ­¥</td>
</tr>
<tr>
<td style="text-align:left">14</td>
<td style="text-align:left"><code>masterauth &lt;master-password&gt;</code></td>
<td style="text-align:left">å½“ master æœåŠ¡è®¾ç½®äº†å¯†ç ä¿æŠ¤æ—¶ï¼Œslav æœåŠ¡è¿æ¥ master çš„å¯†ç </td>
</tr>
<tr>
<td style="text-align:left">15</td>
<td style="text-align:left"><code>requirepass foobared</code></td>
<td style="text-align:left">è®¾ç½® Redis è¿æ¥å¯†ç ï¼Œå¦‚æœé…ç½®äº†è¿æ¥å¯†ç ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥ Redis æ—¶éœ€è¦é€šè¿‡ AUTH <password> å‘½ä»¤æä¾›å¯†ç ï¼Œé»˜è®¤å…³é—­</password></td>
</tr>
<tr>
<td style="text-align:left">16</td>
<td style="text-align:left"><code>maxclients 128</code></td>
<td style="text-align:left">è®¾ç½®åŒä¸€æ—¶é—´æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°ï¼Œé»˜è®¤æ— é™åˆ¶ï¼ŒRedis å¯ä»¥åŒæ—¶æ‰“å¼€çš„å®¢æˆ·ç«¯è¿æ¥æ•°ä¸º Redis è¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•°ï¼Œå¦‚æœè®¾ç½® maxclients 0ï¼Œè¡¨ç¤ºä¸ä½œé™åˆ¶ã€‚å½“å®¢æˆ·ç«¯è¿æ¥æ•°åˆ°è¾¾é™åˆ¶æ—¶ï¼ŒRedis ä¼šå…³é—­æ–°çš„è¿æ¥å¹¶å‘å®¢æˆ·ç«¯è¿”å› max number of clients reached é”™è¯¯ä¿¡æ¯</td>
</tr>
<tr>
<td style="text-align:left">17</td>
<td style="text-align:left"><code>maxmemory &lt;bytes&gt;</code></td>
<td style="text-align:left">æŒ‡å®š Redis æœ€å¤§å†…å­˜é™åˆ¶ï¼ŒRedis åœ¨å¯åŠ¨æ—¶ä¼šæŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¾¾åˆ°æœ€å¤§å†…å­˜åï¼ŒRedis ä¼šå…ˆå°è¯•æ¸…é™¤å·²åˆ°æœŸæˆ–å³å°†åˆ°æœŸçš„ Keyï¼Œå½“æ­¤æ–¹æ³•å¤„ç† åï¼Œä»ç„¶åˆ°è¾¾æœ€å¤§å†…å­˜è®¾ç½®ï¼Œå°†æ— æ³•å†è¿›è¡Œå†™å…¥æ“ä½œï¼Œä½†ä»ç„¶å¯ä»¥è¿›è¡Œè¯»å–æ“ä½œã€‚Redis æ–°çš„ vm æœºåˆ¶ï¼Œä¼šæŠŠ Key å­˜æ”¾å†…å­˜ï¼ŒValue ä¼šå­˜æ”¾åœ¨ swap åŒº</td>
</tr>
<tr>
<td style="text-align:left">18</td>
<td style="text-align:left"><code>appendonly no</code></td>
<td style="text-align:left">æŒ‡å®šæ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ“ä½œåè¿›è¡Œæ—¥å¿—è®°å½•ï¼ŒRedis åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼‚æ­¥çš„æŠŠæ•°æ®å†™å…¥ç£ç›˜ï¼Œå¦‚æœä¸å¼€å¯ï¼Œå¯èƒ½ä¼šåœ¨æ–­ç”µæ—¶å¯¼è‡´ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®ä¸¢å¤±ã€‚å› ä¸º redis æœ¬èº«åŒæ­¥æ•°æ®æ–‡ä»¶æ˜¯æŒ‰ä¸Šé¢ save æ¡ä»¶æ¥åŒæ­¥çš„ï¼Œæ‰€ä»¥æœ‰çš„æ•°æ®ä¼šåœ¨ä¸€æ®µæ—¶é—´å†…åªå­˜åœ¨äºå†…å­˜ä¸­ã€‚é»˜è®¤ä¸º no</td>
</tr>
<tr>
<td style="text-align:left">19</td>
<td style="text-align:left"><code>appendfilename appendonly.aof</code></td>
<td style="text-align:left">æŒ‡å®šæ›´æ–°æ—¥å¿—æ–‡ä»¶åï¼Œé»˜è®¤ä¸º appendonly.aof</td>
</tr>
<tr>
<td style="text-align:left">20</td>
<td style="text-align:left"><code>appendfsync everysec</code></td>
<td style="text-align:left">æŒ‡å®šæ›´æ–°æ—¥å¿—æ¡ä»¶ï¼Œå…±æœ‰ 3 ä¸ªå¯é€‰å€¼ï¼š<strong>no</strong>ï¼šè¡¨ç¤ºç­‰æ“ä½œç³»ç»Ÿè¿›è¡Œæ•°æ®ç¼“å­˜åŒæ­¥åˆ°ç£ç›˜ï¼ˆå¿«ï¼‰<strong>always</strong>ï¼šè¡¨ç¤ºæ¯æ¬¡æ›´æ–°æ“ä½œåæ‰‹åŠ¨è°ƒç”¨ fsync() å°†æ•°æ®å†™åˆ°ç£ç›˜ï¼ˆæ…¢ï¼Œå®‰å…¨ï¼‰<strong>everysec</strong>ï¼šè¡¨ç¤ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼ˆæŠ˜ä¸­ï¼Œé»˜è®¤å€¼ï¼‰</td>
</tr>
<tr>
<td style="text-align:left">21</td>
<td style="text-align:left"><code>vm-enabled no</code></td>
<td style="text-align:left">æŒ‡å®šæ˜¯å¦å¯ç”¨è™šæ‹Ÿå†…å­˜æœºåˆ¶ï¼Œé»˜è®¤å€¼ä¸º noï¼Œç®€å•çš„ä»‹ç»ä¸€ä¸‹ï¼ŒVM æœºåˆ¶å°†æ•°æ®åˆ†é¡µå­˜æ”¾ï¼Œç”± Redis å°†è®¿é—®é‡è¾ƒå°‘çš„é¡µå³å†·æ•°æ® swap åˆ°ç£ç›˜ä¸Šï¼Œè®¿é—®å¤šçš„é¡µé¢ç”±ç£ç›˜è‡ªåŠ¨æ¢å‡ºåˆ°å†…å­˜ä¸­ï¼ˆåœ¨åé¢çš„æ–‡ç« æˆ‘ä¼šä»”ç»†åˆ†æ Redis çš„ VM æœºåˆ¶ï¼‰</td>
</tr>
<tr>
<td style="text-align:left">22</td>
<td style="text-align:left"><code>vm-swap-file /tmp/redis.swap</code></td>
<td style="text-align:left">è™šæ‹Ÿå†…å­˜æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤å€¼ä¸º /tmp/redis.swapï¼Œä¸å¯å¤šä¸ª Redis å®ä¾‹å…±äº«</td>
</tr>
<tr>
<td style="text-align:left">23</td>
<td style="text-align:left"><code>vm-max-memory 0</code></td>
<td style="text-align:left">å°†æ‰€æœ‰å¤§äº vm-max-memory çš„æ•°æ®å­˜å…¥è™šæ‹Ÿå†…å­˜ï¼Œæ— è®º vm-max-memory è®¾ç½®å¤šå°ï¼Œæ‰€æœ‰ç´¢å¼•æ•°æ®éƒ½æ˜¯å†…å­˜å­˜å‚¨çš„(Redis çš„ç´¢å¼•æ•°æ® å°±æ˜¯ keys)ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ vm-max-memory è®¾ç½®ä¸º 0 çš„æ—¶å€™ï¼Œå…¶å®æ˜¯æ‰€æœ‰ value éƒ½å­˜åœ¨äºç£ç›˜ã€‚é»˜è®¤å€¼ä¸º 0</td>
</tr>
<tr>
<td style="text-align:left">24</td>
<td style="text-align:left"><code>vm-page-size 32</code></td>
<td style="text-align:left">Redis swap æ–‡ä»¶åˆ†æˆäº†å¾ˆå¤šçš„ pageï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥ä¿å­˜åœ¨å¤šä¸ª page ä¸Šé¢ï¼Œä½†ä¸€ä¸ª page ä¸Šä¸èƒ½è¢«å¤šä¸ªå¯¹è±¡å…±äº«ï¼Œvm-page-size æ˜¯è¦æ ¹æ®å­˜å‚¨çš„ æ•°æ®å¤§å°æ¥è®¾å®šçš„ï¼Œä½œè€…å»ºè®®å¦‚æœå­˜å‚¨å¾ˆå¤šå°å¯¹è±¡ï¼Œpage å¤§å°æœ€å¥½è®¾ç½®ä¸º 32 æˆ–è€… 64bytesï¼›å¦‚æœå­˜å‚¨å¾ˆå¤§å¤§å¯¹è±¡ï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ›´å¤§çš„ pageï¼Œå¦‚æœä¸ç¡®å®šï¼Œå°±ä½¿ç”¨é»˜è®¤å€¼</td>
</tr>
<tr>
<td style="text-align:left">25</td>
<td style="text-align:left"><code>vm-pages 134217728</code></td>
<td style="text-align:left">è®¾ç½® swap æ–‡ä»¶ä¸­çš„ page æ•°é‡ï¼Œç”±äºé¡µè¡¨ï¼ˆä¸€ç§è¡¨ç¤ºé¡µé¢ç©ºé—²æˆ–ä½¿ç”¨çš„ bitmapï¼‰æ˜¯åœ¨æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œï¼Œåœ¨ç£ç›˜ä¸Šæ¯ 8 ä¸ª pages å°†æ¶ˆè€— 1byte çš„å†…å­˜ã€‚</td>
</tr>
<tr>
<td style="text-align:left">26</td>
<td style="text-align:left"><code>vm-max-threads 4</code></td>
<td style="text-align:left">è®¾ç½®è®¿é—®swapæ–‡ä»¶çš„çº¿ç¨‹æ•°,æœ€å¥½ä¸è¦è¶…è¿‡æœºå™¨çš„æ ¸æ•°,å¦‚æœè®¾ç½®ä¸º0,é‚£ä¹ˆæ‰€æœ‰å¯¹swapæ–‡ä»¶çš„æ“ä½œéƒ½æ˜¯ä¸²è¡Œçš„ï¼Œå¯èƒ½ä¼šé€ æˆæ¯”è¾ƒé•¿æ—¶é—´çš„å»¶è¿Ÿã€‚é»˜è®¤å€¼ä¸º4</td>
</tr>
<tr>
<td style="text-align:left">27</td>
<td style="text-align:left"><code>glueoutputbuf yes</code></td>
<td style="text-align:left">è®¾ç½®åœ¨å‘å®¢æˆ·ç«¯åº”ç­”æ—¶ï¼Œæ˜¯å¦æŠŠè¾ƒå°çš„åŒ…åˆå¹¶ä¸ºä¸€ä¸ªåŒ…å‘é€ï¼Œé»˜è®¤ä¸ºå¼€å¯</td>
</tr>
<tr>
<td style="text-align:left">28</td>
<td style="text-align:left"><code>hash-max-zipmap-entries 64 hash-max-zipmap-value 512</code></td>
<td style="text-align:left">æŒ‡å®šåœ¨è¶…è¿‡ä¸€å®šçš„æ•°é‡æˆ–è€…æœ€å¤§çš„å…ƒç´ è¶…è¿‡æŸä¸€ä¸´ç•Œå€¼æ—¶ï¼Œé‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„å“ˆå¸Œç®—æ³•</td>
</tr>
<tr>
<td style="text-align:left">29</td>
<td style="text-align:left"><code>activerehashing yes</code></td>
<td style="text-align:left">æŒ‡å®šæ˜¯å¦æ¿€æ´»é‡ç½®å“ˆå¸Œï¼Œé»˜è®¤ä¸ºå¼€å¯ï¼ˆåé¢åœ¨ä»‹ç» Redis çš„å“ˆå¸Œç®—æ³•æ—¶å…·ä½“ä»‹ç»ï¼‰</td>
</tr>
<tr>
<td style="text-align:left">30</td>
<td style="text-align:left"><code>include /path/to/local.conf</code></td>
<td style="text-align:left">æŒ‡å®šåŒ…å«å…¶å®ƒçš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨åŒä¸€ä¸»æœºä¸Šå¤šä¸ªRediså®ä¾‹ä¹‹é—´ä½¿ç”¨åŒä¸€ä»½é…ç½®æ–‡ä»¶ï¼Œè€ŒåŒæ—¶å„ä¸ªå®ä¾‹åˆæ‹¥æœ‰è‡ªå·±çš„ç‰¹å®šé…ç½®æ–‡ä»¶</td>
</tr>
</tbody>
</table>
</div>
<h2 id="ä¹ã€æŒä¹…åŒ–"><a href="#ä¹ã€æŒä¹…åŒ–" class="headerlink" title="ä¹ã€æŒä¹…åŒ–"></a>ä¹ã€æŒä¹…åŒ–</h2><p>ç”±äº Redis çš„æ•°æ®éƒ½æ˜¯ä¿å­˜åœ¨å†…å­˜ä¸­çš„ï¼Œå› æ­¤å¦‚æœå“ªå„¿å¤©æœåŠ¡å™¨å®•æœºäº†ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ•°æ®å°±éƒ½æ¶ˆå¤±äº†ï¼Œè¿™æ˜¯ç»å¯¹ä¸ä¼šè¢«å…è®¸çš„ï¼ï¼ï¼å› æ­¤éœ€è¦æŒä¹…åŒ–åˆ°ç¡¬ç›˜ä¸­ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/26/oZyOTs.png" alt=""></p>
<p><br></p>
<h4 id="9-1ã€RDB-æŒä¹…åŒ–"><a href="#9-1ã€RDB-æŒä¹…åŒ–" class="headerlink" title="9.1ã€RDB æŒä¹…åŒ–"></a>9.1ã€RDB æŒä¹…åŒ–</h4><p><strong>RDB</strong> æŒä¹…åŒ–å°±æ˜¯æ¯è¿‡ä¸€ä¸ªå‘¨æœŸï¼Œå°±å°†å†…å­˜ä¸­çš„æ•°æ®å…¨éƒ½éå†ä¸€éå¹¶å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œè€Œä¸”ä¸ºäº†èŠ‚çœç©ºé—´ï¼Œå®šä¹‰äº†ä¸€ä¸ªäºŒè¿›åˆ¶çš„æ ¼å¼è¿›è¡Œå­˜å‚¨ï¼Œå°†æ•°æ®ä¸€æ¡ä¸€æ¡è¿åœ¨ä¸€èµ·ï¼Œç”Ÿæˆäº†ä¸€ä¸ª <strong>RDB</strong> æ–‡ä»¶ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/26/oZ6F0J.png" alt=""></p>
<p>é‚£ä¹ˆè¯¥å¦‚ä½•è®¾ç½®ä¿å­˜å‘¨æœŸå‘¢ï¼Ÿåœ¨ Redis çš„ config æ–‡ä»¶ä¸­ï¼Œæœ‰ç€å¦‚ä¸‹ä¸‰è¡Œå†…å®¹ï¼Œå¯ä»¥æŒ‰éœ€è¿›è¡Œä¿®æ”¹ã€‚å¤šä¸ªæ¡ä»¶å¯ä»¥ç»„åˆä½¿ç”¨ï¼Œåªè¦ä¸‹é¢å…¶ä¸­ä¸€ä¸ªæ¡ä»¶æ»¡è¶³ï¼ŒRedis å°±ä¼šå»è¿›è¡Œå¤‡ä»½ã€‚</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">save 900 1    # 900ç§’ï¼ˆ15åˆ†é’Ÿï¼‰å†…æœ‰1ä¸ªå†™å…¥</span><br><span class="line">save 300 10   # 300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰å†…æœ‰10ä¸ªå†™å…¥</span><br><span class="line">save 60 10000 # 60ç§’ï¼ˆ1åˆ†é’Ÿï¼‰å†…æœ‰10000ä¸ªå†™å…¥</span><br></pre></td></tr></tbody></table></figure>
<p>é‚£ä¹ˆå¦‚æœåœ¨ä¿å­˜æ•°æ®åº“æ–‡ä»¶çš„æ—¶å€™ï¼Œåˆæœ‰æ–°çš„è¯·æ±‚è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå¾ˆè‡ªç„¶è€Œç„¶åœ°ï¼Œå°±èƒ½æƒ³åˆ°å¯ä»¥ <strong>fork</strong> å‡ºä¸€ä¸ªå­çº¿ç¨‹æ¥åšå¤‡ä»½æ•°æ®åº“çš„äº‹æƒ…ã€‚</p>
<p>ä½†æ˜¯å•Šï¼Œå‘¨æœŸæ€§åœ°å¤‡ä»½æ–‡ä»¶æœ‰ä¸€ä¸ªè‡´å‘½æ€§çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯å‘¨æœŸæ—¶é—´â€”â€”<strong>ç«Ÿç„¶æ˜¯åˆ†é’Ÿçº§åˆ«</strong>ï¼ï¼ï¼å¦‚æœå‡ºç°åœæœºç­‰é—®é¢˜ï¼Œè¿˜æ˜¯ä¼šæŸå¤±è¿™ä¸€åˆ†é’Ÿå†…çš„æ•°æ®ã€‚è¯šç„¶ï¼Œä½ ä¹Ÿå¯ä»¥è®¾ç½®æˆæ¯ç§’é’Ÿå¤‡ä»½ä¸€æ¬¡ï¼Œé‚£æ•ˆç‡å°±å¤ªä½ä¸‹äº†ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/27/oZc5M8.png" alt=""></p>
<p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¼•å‡ºäº†æ–°çš„æ¦‚å¿µâ€”â€” AOFã€‚</p>
<p><br></p>
<h4 id="9-2ã€AOF-æŒä¹…åŒ–"><a href="#9-2ã€AOF-æŒä¹…åŒ–" class="headerlink" title="9.2ã€AOF æŒä¹…åŒ–"></a>9.2ã€AOF æŒä¹…åŒ–</h4><p>AOF å…¨ç§° <strong>Append Only File</strong>ï¼ˆåªè¿½åŠ æ–‡ä»¶ï¼‰ï¼Œç±»ä¼¼äº mysql çš„äºŒè¿›åˆ¶æ—¥å¿— binlogã€‚<strong>å…¶åŸç†å°±æ˜¯è®°å½•æ•°æ®æ›´æ”¹çš„æ“ä½œï¼ˆä¸åŒ…æ‹¬æŸ¥è¯¢ï¼‰ï¼Œè€Œä¸æ˜¯è®°å½•æ•°æ®æœ¬èº«ã€‚</strong>æ¯•ç«Ÿåªè¦è®°å½•æ•°æ®åœ¨è¿™ä¸€æ®µæ—¶é—´å†…æ˜¯å¦‚ä½•ä¿®æ”¹çš„ï¼Œé‚£ä¹‹åä¹Ÿèƒ½é€šè¿‡æ‰§è¡Œè¿™ä¸ª AOF æ–‡ä»¶è¿˜åŸå›å»ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/27/oZgYy8.png" alt=""></p>
<p>é‚£ä¹ˆ AOF åº”è¯¥å¤šä¹…å†™ä¸€æ¬¡æ–‡ä»¶å‘¢ï¼Ÿ</p>
<p>è‚¯å®šä¸èƒ½æ¯æ‰§è¡Œä¸€æ¡ä¿®æ”¹å‘½ä»¤å°±è®°å½•åˆ°æ–‡ä»¶ä¸­ï¼ŒIO æ“ä½œååˆ†æ˜‚è´µï¼Œè¿™å›ä¸¥é‡æ‹–å®æ•°æ®åº“æ€§èƒ½ï¼å› æ­¤éœ€è¦å‡†å¤‡ä¸€ä¸ªç¼“å†²åŒºï¼Œå°†è¦è®°å½•çš„å‘½ä»¤å…ˆä¸´æ—¶ä¿å­˜åœ¨è¿™é‡Œï¼Œå†æ‹©æœºå†™å…¥æ–‡ä»¶ï¼Œæˆ‘æŠŠè¿™ä¸ªä¸´æ—¶ç¼“å†²åŒºå«åš <strong>aof_buf</strong>ã€‚</p>
<p>å…·ä½“å¦‚ä½•è®¾ç½®åˆ·æ–°å‘¨æœŸå¯ä»¥åœ¨ Redis çš„é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ã€‚</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">appendfsync always|everysec|no</span><br><span class="line"></span><br><span class="line">always: æ¯ä¸ªäº‹ä»¶å‘¨æœŸéƒ½åŒæ­¥åˆ·æ–°ä¸€æ¬¡</span><br><span class="line">everysec(é»˜è®¤): æ¯ä¸€ç§’éƒ½åŒæ­¥åˆ·æ–°ä¸€æ¬¡</span><br><span class="line">no: æˆ‘åªç®¡å†™ï¼Œè®©æ“ä½œç³»ç»Ÿè‡ªå·±å†³å®šä»€ä¹ˆæ—¶å€™çœŸæ­£å†™å…¥å§</span><br></pre></td></tr></tbody></table></figure>
<p><strong><font size="4px">AOF é‡å†™</font></strong></p>
<p>ä½†æ˜¯æ­£å¦‚å…¶åï¼Œåªè¿½åŠ æ–‡ä»¶åªä¼šè¿½åŠ æ•°æ®ï¼Œè¿™å°±ä¼šå¯¼è‡´éšç€æ—¶é—´çš„æ¨ç§»ï¼Œè¿™ä¸ª <strong>AOF</strong> å¤‡ä»½æ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ï¼ï¼ï¼ä¸ä»…éå¸¸å ç¡¬ç›˜ç©ºé—´ï¼Œå¤åˆ¶ç§»åŠ¨ï¼ŒåŠ è½½åˆ†æç­‰æ“ä½œéƒ½å¼‚å¸¸éº»çƒ¦è€—æ—¶ã€‚</p>
<p>è¿™å°±éœ€è¦å¯¹ <strong>AOF</strong> æ–‡ä»¶è¿›è¡Œ<code>å‹ç¼©</code>ï¼Œä¹Ÿå°±æ˜¯ <strong>AOF</strong> é‡å†™ã€‚</p>
<p>è§‚å¯Ÿä»¥ä¸‹å‘½ä»¤ï¼Œæ˜¯ä¸æ˜¯éå¸¸å†—ä½™ï¼</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">set</span> name yqx</span><br><span class="line"><span class="built_in">set</span> name deflory</span><br><span class="line"><span class="built_in">set</span> name SuicideKing</span><br><span class="line"><span class="built_in">set</span> name DreamFragrance</span><br></pre></td></tr></tbody></table></figure>
<p>å°†æ¯æ¬¡ä¿®æ”¹æ“ä½œéƒ½è®°å½•ä¸‹æ¥å¯¼è‡´æ–‡ä»¶è¿‡å¤§ï¼Œè€Œä¸”æ•°æ®æ”¹æ¥æ”¹å»ï¼Œå¾ˆå¤šä¸­é—´çŠ¶æ€æ ¹æœ¬æ²¡æœ‰ç”¨ï¼Œåªéœ€è¦è®°å½•æœ€ç»ˆçš„çŠ¶æ€å³å¯ï¼Œè¿™å°±æ˜¯ <strong>AOF</strong> é‡å†™çš„æ€æƒ³ã€‚</p>
<p>å› æ­¤ä¸Šè¿°å‘½ä»¤åªéœ€è¦ä¸€è¡Œå³å¯è®°å½•å®Œæ¯•ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="built_in">set</span> name DreamFragrance</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://z3.ax1x.com/2021/11/27/oZRigx.png" alt="image"></p>
<p>åŒ RDB ä¸€æ ·ï¼ŒIO æ“ä½œæ€»æ˜¯ä»£ä»·æ˜‚è´µçš„ï¼Œå› æ­¤è¦ <strong>fork</strong> ä¸€ä¸ªå­è¿›ç¨‹æ¥é‡å†™æ–‡ä»¶ã€‚</p>
<p><strong>ä½†æ˜¯ï¼Œè¿™æ ·å°±çœŸçš„æ²¡æœ‰é—®é¢˜äº†å—ï¼Ÿ</strong></p>
<p>å¦‚æœåœ¨é‡å†™ AOF æ–‡ä»¶çš„æ—¶å€™ï¼Œæ–°çš„æ•°æ®è¢«ä¿®æ”¹äº†ï¼Œé‚£å²‚ä¸æ˜¯ä¼šå‡ºç°æ•°æ®åº“æ•°æ®å’Œé‡å†™å†…å®¹ä¸ä¸€è‡´çš„æƒ…å†µå—ï¼Ÿ</p>
<p><img src="https://z3.ax1x.com/2021/11/27/oZReVe.png" alt="image"></p>
<p>äºæ˜¯ï¼Œç»§ä¹‹å‰çš„ <strong>aof_buf</strong>ï¼ŒRedis åˆå‡†å¤‡äº†ä¸€ä¸ªæ–°çš„ç¼“å†²åŒºâ€”â€” <strong>AOF é‡å†™ç¼“å†²åŒº</strong>ã€‚</p>
<p>ä»åˆ›å»ºé‡å†™ <strong>AOF</strong> å­è¿›ç¨‹çš„é‚£ä¸ªä¸€åˆ»èµ·ï¼ŒRedis å°†åé¢æ¥çš„å†™å…¥å‘½ä»¤éƒ½å¤åˆ¶åˆ°è¿™ä¸ªé‡å†™ç¼“å†²åŒºä¸­ï¼Œç­‰åˆ°å­è¿›ç¨‹é‡å†™ <strong>AOF</strong> æ–‡ä»¶ç»“æŸä»¥åï¼Œå†å°†è¿™ä¸ªç¼“å†²åŒºçš„æ–‡ä»¶å†™å…¥åˆ°æ–°çš„ AOF æ–‡ä»¶ä¸­ã€‚</p>
<p>æœ€åå†å°†è¿™ä¸ªå´­æ–°çš„ AOF æ–‡ä»¶æ›¿æ¢æ‰åŸå…ˆé‚£ä¸ªå†—ä½™çš„ AOF æ–‡ä»¶ï¼Œæ•´ä¸ªé‡å†™è¿‡ç¨‹å°±ç®—å¤§åŠŸå‘Šæˆäº†ï¼</p>
<p><img src="https://z3.ax1x.com/2021/11/27/oZRHde.png" alt="image"></p>
<p><br></p>
<h4 id="9-3ã€è¯¦è§£-RDB-å’Œ-AOF"><a href="#9-3ã€è¯¦è§£-RDB-å’Œ-AOF" class="headerlink" title="9.3ã€è¯¦è§£ RDB å’Œ AOF"></a>9.3ã€è¯¦è§£ RDB å’Œ AOF</h4><p><strong><font size="4px">Redis æŒä¹…åŒ–ï¼š</font></strong></p>
<p>Redis æä¾›äº†å¤šç§ä¸åŒçº§åˆ«çš„æŒä¹…åŒ–æ–¹å¼ï¼šä¸€ç§æ˜¯ <strong>RDB</strong>,å¦ä¸€ç§æ˜¯ <strong>AOF</strong>ã€‚</p>
<p>RDB æŒä¹…åŒ–å¯ä»¥åœ¨<strong>æŒ‡å®šçš„æ—¶é—´é—´éš”å†…ç”Ÿæˆæ•°æ®é›†çš„æ—¶é—´ç‚¹å¿«ç…§</strong>ï¼ˆpoint-in-time snapshotï¼‰ã€‚</p>
<p><strong>AOF æŒä¹…åŒ–è®°å½•æœåŠ¡å™¨æ‰§è¡Œçš„æ‰€æœ‰å†™æ“ä½œå‘½ä»¤</strong>ï¼Œå¹¶åœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œé€šè¿‡é‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥è¿˜åŸæ•°æ®é›†ã€‚ AOF æ–‡ä»¶ä¸­çš„å‘½ä»¤å…¨éƒ¨ä»¥ Redis åè®®çš„æ ¼å¼æ¥ä¿å­˜ï¼Œæ–°å‘½ä»¤ä¼šè¢«è¿½åŠ åˆ°æ–‡ä»¶çš„æœ«å°¾ã€‚ Redis è¿˜å¯ä»¥åœ¨åå°å¯¹ AOF æ–‡ä»¶è¿›è¡Œé‡å†™ï¼ˆrewriteï¼‰ï¼Œä½¿å¾— AOF æ–‡ä»¶çš„ä½“ç§¯ä¸ä¼šè¶…å‡ºä¿å­˜æ•°æ®é›†çŠ¶æ€æ‰€éœ€çš„å®é™…å¤§å°ã€‚Redis è¿˜å¯ä»¥åŒæ—¶ä½¿ç”¨ AOF æŒä¹…åŒ–å’Œ RDB æŒä¹…åŒ–ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ å½“ Redis é‡å¯æ—¶ï¼Œ å®ƒä¼šä¼˜å…ˆä½¿ç”¨ AOF æ–‡ä»¶æ¥è¿˜åŸæ•°æ®é›†ï¼Œ å› ä¸º AOF æ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†é€šå¸¸æ¯” RDB æ–‡ä»¶æ‰€ä¿å­˜çš„æ•°æ®é›†æ›´å®Œæ•´ã€‚ä½ ç”šè‡³å¯ä»¥å…³é—­æŒä¹…åŒ–åŠŸèƒ½ï¼Œè®©æ•°æ®åªåœ¨æœåŠ¡å™¨è¿è¡Œæ—¶å­˜åœ¨ã€‚</p>
<p><strong><font size="4px">RDB çš„ä¼˜ç‚¹ï¼š</font></strong></p>
<p>RDB æ˜¯ä¸€ä¸ªéå¸¸ç´§å‡‘ï¼ˆcompactï¼‰çš„æ–‡ä»¶ï¼Œå®ƒä¿å­˜äº† Redis åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šçš„æ•°æ®é›†ã€‚ è¿™ç§æ–‡ä»¶éå¸¸é€‚åˆç”¨äºè¿›è¡Œå¤‡ä»½ï¼š æ¯”å¦‚è¯´ï¼Œä½ å¯ä»¥åœ¨æœ€è¿‘çš„ 24 å°æ—¶å†…ï¼Œæ¯å°æ—¶å¤‡ä»½ä¸€æ¬¡ RDB æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªæœˆçš„æ¯ä¸€å¤©ï¼Œä¹Ÿå¤‡ä»½ä¸€ä¸ª RDB æ–‡ä»¶ã€‚ è¿™æ ·çš„è¯ï¼Œå³ä½¿é‡ä¸Šé—®é¢˜ï¼Œä¹Ÿå¯ä»¥éšæ—¶å°†æ•°æ®é›†è¿˜åŸåˆ°ä¸åŒçš„ç‰ˆæœ¬ã€‚RDB éå¸¸é€‚ç”¨äºç¾éš¾æ¢å¤ï¼ˆdisaster recoveryï¼‰ï¼šå®ƒåªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”å†…å®¹éƒ½éå¸¸ç´§å‡‘ï¼Œå¯ä»¥ï¼ˆåœ¨åŠ å¯†åï¼‰å°†å®ƒä¼ é€åˆ°åˆ«çš„æ•°æ®ä¸­å¿ƒï¼Œæˆ–è€…äºšé©¬é€Š S3 ä¸­ã€‚RDB å¯ä»¥æœ€å¤§åŒ– Redis çš„æ€§èƒ½ï¼šçˆ¶è¿›ç¨‹åœ¨ä¿å­˜ RDB æ–‡ä»¶æ—¶å”¯ä¸€è¦åšçš„å°±æ˜¯ fork å‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç„¶åè¿™ä¸ªå­è¿›ç¨‹å°±ä¼šå¤„ç†æ¥ä¸‹æ¥çš„æ‰€æœ‰ä¿å­˜å·¥ä½œï¼Œçˆ¶è¿›ç¨‹æ— é¡»æ‰§è¡Œä»»ä½•ç£ç›˜ I/O æ“ä½œã€‚RDB åœ¨æ¢å¤å¤§æ•°æ®é›†æ—¶çš„é€Ÿåº¦æ¯” AOF çš„æ¢å¤é€Ÿåº¦è¦å¿«ã€‚</p>
<p><strong><font size="4px">RDB çš„ç¼ºç‚¹ï¼š</font></strong></p>
<p>å¦‚æœä½ éœ€è¦å°½é‡é¿å…åœ¨æœåŠ¡å™¨æ•…éšœæ—¶ä¸¢å¤±æ•°æ®ï¼Œé‚£ä¹ˆ RDB ä¸é€‚åˆä½ ã€‚ è™½ç„¶ Redis å…è®¸ä½ è®¾ç½®ä¸åŒçš„ä¿å­˜ç‚¹ï¼ˆsave pointï¼‰æ¥æ§åˆ¶ä¿å­˜ RDB æ–‡ä»¶çš„é¢‘ç‡ï¼Œ ä½†æ˜¯ï¼Œ <strong>å› ä¸ºRDB æ–‡ä»¶éœ€è¦ä¿å­˜æ•´ä¸ªæ•°æ®é›†çš„çŠ¶æ€ï¼Œ æ‰€ä»¥å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªè½»æ¾çš„æ“ä½œã€‚</strong> å› æ­¤ä½ å¯èƒ½ä¼šè‡³å°‘ 5 åˆ†é’Ÿæ‰ä¿å­˜ä¸€æ¬¡ RDB æ–‡ä»¶ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ ä¸€æ—¦å‘ç”Ÿæ•…éšœåœæœºï¼Œ ä½ å°±å¯èƒ½ä¼šä¸¢å¤±å¥½å‡ åˆ†é’Ÿçš„æ•°æ®ã€‚æ¯æ¬¡ä¿å­˜ RDB çš„æ—¶å€™ï¼ŒRedis éƒ½è¦ fork å‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå¹¶ç”±å­è¿›ç¨‹æ¥è¿›è¡Œå®é™…çš„æŒä¹…åŒ–å·¥ä½œã€‚ åœ¨æ•°æ®é›†æ¯”è¾ƒåºå¤§æ—¶ï¼Œ fork å¯èƒ½ä¼šéå¸¸è€—æ—¶ï¼Œé€ æˆæœåŠ¡å™¨åœ¨æŸæŸæ¯«ç§’å†…åœæ­¢å¤„ç†å®¢æˆ·ç«¯ï¼› <strong>å¦‚æœæ•°æ®é›†éå¸¸å·¨å¤§ï¼Œå¹¶ä¸” CPU æ—¶é—´éå¸¸ç´§å¼ çš„è¯ï¼Œé‚£ä¹ˆè¿™ç§åœæ­¢æ—¶é—´ç”šè‡³å¯èƒ½ä¼šé•¿è¾¾æ•´æ•´ä¸€ç§’ã€‚ è™½ç„¶ AOF é‡å†™ä¹Ÿéœ€è¦è¿›è¡Œ fork ï¼Œä½†æ— è®º AOF é‡å†™çš„æ‰§è¡Œé—´éš”æœ‰å¤šé•¿ï¼Œæ•°æ®çš„è€ä¹…æ€§éƒ½ä¸ä¼šæœ‰ä»»ä½•æŸå¤±ã€‚</strong></p>
<p><strong><font size="4px">AOF çš„ä¼˜ç‚¹ï¼š</font></strong></p>
<p>ä½¿ç”¨ AOF æŒä¹…åŒ–ä¼šè®© Redis å˜å¾—éå¸¸è€ä¹…ï¼ˆmuch more durableï¼‰ï¼šä½ å¯ä»¥è®¾ç½®ä¸åŒçš„ fsync ç­–ç•¥ï¼Œæ¯”å¦‚æ—  fsync ï¼Œæ¯ç§’é’Ÿä¸€æ¬¡ fsync ï¼Œæˆ–è€…æ¯æ¬¡æ‰§è¡Œå†™å…¥å‘½ä»¤æ—¶ fsync ã€‚AOF çš„é»˜è®¤ç­–ç•¥ä¸ºæ¯ç§’é’Ÿ fsync ä¸€æ¬¡ï¼Œåœ¨è¿™ç§é…ç½®ä¸‹ï¼ŒRedis ä»ç„¶å¯ä»¥ä¿æŒè‰¯å¥½çš„æ€§èƒ½ï¼Œå¹¶ä¸”å°±ç®—å‘ç”Ÿæ•…éšœåœæœºï¼Œä¹Ÿæœ€å¤šåªä¼šä¸¢å¤±ä¸€ç§’é’Ÿçš„æ•°æ®ï¼ˆ fsync ä¼šåœ¨åå°çº¿ç¨‹æ‰§è¡Œï¼Œæ‰€ä»¥ä¸»çº¿ç¨‹å¯ä»¥ç»§ç»­åŠªåŠ›åœ°å¤„ç†å‘½ä»¤è¯·æ±‚ï¼‰ã€‚AOF æ–‡ä»¶æ˜¯ä¸€ä¸ªåªè¿›è¡Œè¿½åŠ æ“ä½œçš„æ—¥å¿—æ–‡ä»¶ï¼ˆappend only logï¼‰ï¼Œ å› æ­¤å¯¹ AOF æ–‡ä»¶çš„å†™å…¥ä¸éœ€è¦è¿›è¡Œ seek ï¼Œ å³ä½¿æ—¥å¿—å› ä¸ºæŸäº›åŸå› è€ŒåŒ…å«äº†æœªå†™å…¥å®Œæ•´çš„å‘½ä»¤ï¼ˆæ¯”å¦‚å†™å…¥æ—¶ç£ç›˜å·²æ»¡ï¼Œå†™å…¥ä¸­é€”åœæœºï¼Œç­‰ç­‰ï¼‰ï¼Œ redis-check-aof å·¥å…·ä¹Ÿå¯ä»¥è½»æ˜“åœ°ä¿®å¤è¿™ç§é—®é¢˜ï¼Œè‡³äºæ˜¯å¦‚ä½•ä¿®å¤çš„å˜›ï¼Œåªæ˜¯æŠŠæœ‰é—®é¢˜çš„å‘½ä»¤åˆ å»è€Œå·²ã€‚æ—¢ç„¶è§£å†³ä¸äº†é—®é¢˜ï¼Œé‚£å°±è§£å†³æ‰æå‡ºé—®é¢˜çš„äººã€‚<br>Redis å¯ä»¥åœ¨ AOF æ–‡ä»¶ä½“ç§¯å˜å¾—è¿‡å¤§æ—¶ï¼Œè‡ªåŠ¨åœ°åœ¨åå°å¯¹ AOF è¿›è¡Œé‡å†™ï¼š é‡å†™åçš„æ–° AOF æ–‡ä»¶åŒ…å«äº†æ¢å¤å½“å‰æ•°æ®é›†æ‰€éœ€çš„æœ€å°å‘½ä»¤é›†åˆã€‚ æ•´ä¸ªé‡å†™æ“ä½œæ˜¯ç»å¯¹å®‰å…¨çš„ï¼Œå› ä¸º Redis åœ¨åˆ›å»ºæ–° AOF æ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œä¼šç»§ç»­å°†å‘½ä»¤è¿½åŠ åˆ°ç°æœ‰çš„ AOF æ–‡ä»¶é‡Œé¢ï¼Œå³ä½¿é‡å†™è¿‡ç¨‹ä¸­å‘ç”Ÿåœæœºï¼Œç°æœ‰çš„ AOF æ–‡ä»¶ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚ è€Œä¸€æ—¦æ–° AOF æ–‡ä»¶åˆ›å»ºå®Œæ¯•ï¼ŒRedis å°±ä¼šä»æ—§ AOF æ–‡ä»¶åˆ‡æ¢åˆ°æ–° AOF æ–‡ä»¶ï¼Œå¹¶å¼€å§‹å¯¹æ–° AOF æ–‡ä»¶è¿›è¡Œè¿½åŠ æ“ä½œã€‚AOF æ–‡ä»¶æœ‰åºåœ°ä¿å­˜äº†å¯¹æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰å†™å…¥æ“ä½œï¼Œ è¿™äº›å†™å…¥æ“ä½œä»¥ Redis åè®®çš„æ ¼å¼ä¿å­˜ï¼Œ å› æ­¤ AOF æ–‡ä»¶çš„å†…å®¹éå¸¸å®¹æ˜“è¢«äººè¯»æ‡‚ï¼Œ å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æï¼ˆparseï¼‰ä¹Ÿå¾ˆè½»æ¾ã€‚ å¯¼å‡ºï¼ˆexportï¼‰ AOF æ–‡ä»¶ä¹Ÿéå¸¸ç®€å•ï¼š ä¸¾ä¸ªä¾‹å­ï¼Œ å¦‚æœä½ ä¸å°å¿ƒæ‰§è¡Œäº† FLUSHALL å‘½ä»¤ï¼Œ ä½†åªè¦ AOF æ–‡ä»¶æœªè¢«é‡å†™ï¼Œ é‚£ä¹ˆåªè¦åœæ­¢æœåŠ¡å™¨ï¼Œ ç§»é™¤ AOF æ–‡ä»¶æœ«å°¾çš„ FLUSHALL å‘½ä»¤ï¼Œ å¹¶é‡å¯ Redis ï¼Œ å°±å¯ä»¥å°†æ•°æ®é›†æ¢å¤åˆ° FLUSHALL æ‰§è¡Œä¹‹å‰çš„çŠ¶æ€ã€‚</p>
<p><strong><font size="4px">AOF çš„ç¼ºç‚¹ï¼š</font></strong></p>
<p>å¯¹äºç›¸åŒçš„æ•°æ®é›†æ¥è¯´ï¼ŒAOF æ–‡ä»¶çš„ä½“ç§¯é€šå¸¸è¦å¤§äº RDB æ–‡ä»¶çš„ä½“ç§¯ã€‚æ ¹æ®æ‰€ä½¿ç”¨çš„ fsync ç­–ç•¥ï¼ŒAOF çš„é€Ÿåº¦å¯èƒ½ä¼šæ…¢äº RDB ã€‚ åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ æ¯ç§’ fsync çš„æ€§èƒ½ä¾ç„¶éå¸¸é«˜ï¼Œ è€Œå…³é—­ fsync å¯ä»¥è®© AOF çš„é€Ÿåº¦å’Œ RDB ä¸€æ ·å¿«ï¼Œ å³ä½¿åœ¨é«˜è´Ÿè·ä¹‹ä¸‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ ä¸è¿‡åœ¨å¤„ç†å·¨å¤§çš„å†™å…¥è½½å…¥æ—¶ï¼ŒRDB å¯ä»¥æä¾›æ›´æœ‰ä¿è¯çš„æœ€å¤§å»¶è¿Ÿæ—¶é—´ï¼ˆlatencyï¼‰ã€‚AOF åœ¨è¿‡å»æ›¾ç»å‘ç”Ÿè¿‡è¿™æ ·çš„ bug ï¼š å› ä¸ºä¸ªåˆ«å‘½ä»¤çš„åŸå› ï¼Œå¯¼è‡´ AOF æ–‡ä»¶åœ¨é‡æ–°è½½å…¥æ—¶ï¼Œæ— æ³•å°†æ•°æ®é›†æ¢å¤æˆä¿å­˜æ—¶çš„åŸæ ·ã€‚ ï¼ˆä¸¾ä¸ªä¾‹å­ï¼Œé˜»å¡å‘½ä»¤ BRPOPLPUSH å°±æ›¾ç»å¼•èµ·è¿‡è¿™æ ·çš„ bug ã€‚ï¼‰ æµ‹è¯•å¥—ä»¶é‡Œä¸ºè¿™ç§æƒ…å†µæ·»åŠ äº†æµ‹è¯•ï¼š å®ƒä»¬ä¼šè‡ªåŠ¨ç”Ÿæˆéšæœºçš„ã€å¤æ‚çš„æ•°æ®é›†ï¼Œ å¹¶é€šè¿‡é‡æ–°è½½å…¥è¿™äº›æ•°æ®æ¥ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ã€‚ è™½ç„¶è¿™ç§ bug åœ¨ AOF æ–‡ä»¶ä¸­å¹¶ä¸å¸¸è§ï¼Œ ä½†æ˜¯å¯¹æ¯”æ¥è¯´ï¼Œ RDB å‡ ä¹æ˜¯ä¸å¯èƒ½å‡ºç°è¿™ç§ bug çš„ã€‚</p>
<p><strong><font size="4px">RDB å’Œ AOF è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿ</font></strong></p>
<p>ä¸€èˆ¬æ¥è¯´,å¦‚æœæƒ³è¾¾åˆ°è¶³ä»¥åª²ç¾ PostgreSQL çš„æ•°æ®å®‰å…¨æ€§ï¼Œ ä½ åº”è¯¥åŒæ—¶ä½¿ç”¨ä¸¤ç§æŒä¹…åŒ–åŠŸèƒ½ã€‚å¦‚æœä½ éå¸¸å…³å¿ƒä½ çš„æ•°æ®,ä½†ä»ç„¶å¯ä»¥æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œ é‚£ä¹ˆä½ å¯ä»¥åªä½¿ç”¨ RDB æŒä¹…åŒ–ã€‚æœ‰å¾ˆå¤šç”¨æˆ·éƒ½åªä½¿ç”¨ AOF æŒä¹…åŒ–ï¼Œ ä½†æˆ‘ä»¬å¹¶ä¸æ¨èè¿™ç§æ–¹å¼ï¼š å› ä¸ºå®šæ—¶ç”Ÿæˆ RDB å¿«ç…§ï¼ˆsnapshotï¼‰éå¸¸ä¾¿äºè¿›è¡Œæ•°æ®åº“å¤‡ä»½ï¼Œ å¹¶ä¸” RDB æ¢å¤æ•°æ®é›†çš„é€Ÿåº¦ä¹Ÿè¦æ¯” AOF æ¢å¤çš„é€Ÿåº¦è¦å¿«ï¼Œ é™¤æ­¤ä¹‹å¤–ï¼Œ ä½¿ç”¨ RDB è¿˜å¯ä»¥é¿å…ä¹‹å‰æåˆ°çš„ AOF ç¨‹åºçš„ bug ã€‚å› ä¸ºä»¥ä¸Šæåˆ°çš„ç§ç§åŸå› ï¼Œ æœªæ¥æˆ‘ä»¬å¯èƒ½ä¼šå°† AOF å’Œ RDB æ•´åˆæˆå•ä¸ªæŒä¹…åŒ–æ¨¡å‹ã€‚ ï¼ˆè¿™æ˜¯ä¸€ä¸ªé•¿æœŸè®¡åˆ’ã€‚ï¼‰</p>
<p><strong><font size="4px">RDB å¿«ç…§ï¼š</font></strong></p>
<p>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ Redis å°†æ•°æ®åº“å¿«ç…§ä¿å­˜åœ¨åå­—ä¸º dump.rdb çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚ä½ å¯ä»¥å¯¹ Redis è¿›è¡Œè®¾ç½®ï¼Œ è®©å®ƒåœ¨â€œ N ç§’å†…æ•°æ®é›†è‡³å°‘æœ‰ M ä¸ªæ”¹åŠ¨â€è¿™ä¸€æ¡ä»¶è¢«æ»¡è¶³æ—¶ï¼Œ è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡æ•°æ®é›†ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ SAVE æˆ–è€… BGSAVE ï¼Œ æ‰‹åŠ¨è®© Redis è¿›è¡Œæ•°æ®é›†ä¿å­˜æ“ä½œã€‚æ¯”å¦‚è¯´ï¼Œ ä»¥ä¸‹è®¾ç½®ä¼šè®© Redis åœ¨æ»¡è¶³â€œ 60 ç§’å†…æœ‰è‡³å°‘æœ‰ 1000 ä¸ªé”®è¢«æ”¹åŠ¨â€è¿™ä¸€æ¡ä»¶æ—¶ï¼Œ è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡æ•°æ®é›†ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">save 60 1000</span><br></pre></td></tr></tbody></table></figure>
<p>è¿™ç§æŒä¹…åŒ–æ–¹å¼è¢«ç§°ä¸ºå¿«ç…§ï¼ˆsnapshotï¼‰ã€‚</p>
<p><strong><font size="4px">å¿«ç…§çš„è¿ä½œæ–¹å¼ï¼š</font></strong></p>
<p>å½“ Redis éœ€è¦ä¿å­˜ dump.rdb æ–‡ä»¶æ—¶ï¼Œ æœåŠ¡å™¨æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br>Redis è°ƒç”¨ fork() ï¼ŒåŒæ—¶æ‹¥æœ‰çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ã€‚<br>å­è¿›ç¨‹å°†æ•°æ®é›†å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶ RDB æ–‡ä»¶ä¸­ã€‚<br>å½“å­è¿›ç¨‹å®Œæˆå¯¹æ–° RDB æ–‡ä»¶çš„å†™å…¥æ—¶ï¼ŒRedis ç”¨æ–° RDB æ–‡ä»¶æ›¿æ¢åŸæ¥çš„ RDB æ–‡ä»¶ï¼Œå¹¶åˆ é™¤æ—§çš„ RDB æ–‡ä»¶ã€‚<br>è¿™ç§å·¥ä½œæ–¹å¼ä½¿å¾— Redis å¯ä»¥ä»å†™æ—¶å¤åˆ¶ï¼ˆcopy-on-writeï¼‰æœºåˆ¶ä¸­è·ç›Šã€‚<br>åªè¿›è¡Œè¿½åŠ æ“ä½œçš„æ–‡ä»¶ï¼ˆappend-only fileï¼ŒAOFï¼‰<br>å¿«ç…§åŠŸèƒ½å¹¶ä¸æ˜¯éå¸¸è€ä¹…ï¼ˆdurableï¼‰ï¼š å¦‚æœ Redis å› ä¸ºæŸäº›åŸå› è€Œé€ æˆæ•…éšœåœæœºï¼Œ é‚£ä¹ˆæœåŠ¡å™¨å°†ä¸¢å¤±æœ€è¿‘å†™å…¥ã€ä¸”ä»æœªä¿å­˜åˆ°å¿«ç…§ä¸­çš„é‚£äº›æ•°æ®ã€‚å°½ç®¡å¯¹äºæŸäº›ç¨‹åºæ¥è¯´ï¼Œ æ•°æ®çš„è€ä¹…æ€§å¹¶ä¸æ˜¯æœ€é‡è¦çš„è€ƒè™‘å› ç´ ï¼Œ ä½†æ˜¯å¯¹äºé‚£äº›è¿½æ±‚å®Œå…¨è€ä¹…èƒ½åŠ›ï¼ˆfull durabilityï¼‰çš„ç¨‹åºæ¥è¯´ï¼Œ å¿«ç…§åŠŸèƒ½å°±ä¸å¤ªé€‚ç”¨äº†ã€‚<br>ä» 1.1 ç‰ˆæœ¬å¼€å§‹ï¼Œ Redis å¢åŠ äº†ä¸€ç§å®Œå…¨è€ä¹…çš„æŒä¹…åŒ–æ–¹å¼ï¼š AOF æŒä¹…åŒ–ã€‚<br>ä½ å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥æ‰“å¼€ AOF åŠŸèƒ½ï¼š<br>appendonly yes<br>ä»ç°åœ¨å¼€å§‹ï¼Œ æ¯å½“ Redis æ‰§è¡Œä¸€ä¸ªæ”¹å˜æ•°æ®é›†çš„å‘½ä»¤æ—¶ï¼ˆæ¯”å¦‚ SETï¼‰ï¼Œ è¿™ä¸ªå‘½ä»¤å°±ä¼šè¢«è¿½åŠ åˆ° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚<br>è¿™æ ·çš„è¯ï¼Œ å½“ Redis é‡æ–°å¯æ—¶ï¼Œ ç¨‹åºå°±å¯ä»¥é€šè¿‡é‡æ–°æ‰§è¡Œ AOF æ–‡ä»¶ä¸­çš„å‘½ä»¤æ¥è¾¾åˆ°é‡å»ºæ•°æ®é›†çš„ç›®çš„ã€‚</p>
<p><strong><font size="4px">å¿«ç…§çš„è¿ä½œæ–¹å¼ï¼š</font></strong></p>
<p>å½“ Redis éœ€è¦ä¿å­˜ dump.rdb æ–‡ä»¶æ—¶ï¼Œ æœåŠ¡å™¨æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š<br>Redis è°ƒç”¨ fork() ï¼ŒåŒæ—¶æ‹¥æœ‰çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ã€‚<br>å­è¿›ç¨‹å°†æ•°æ®é›†å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶ RDB æ–‡ä»¶ä¸­ã€‚<br>å½“å­è¿›ç¨‹å®Œæˆå¯¹æ–° RDB æ–‡ä»¶çš„å†™å…¥æ—¶ï¼ŒRedis ç”¨æ–° RDB æ–‡ä»¶æ›¿æ¢åŸæ¥çš„ RDB æ–‡ä»¶ï¼Œå¹¶åˆ é™¤æ—§çš„ RDB æ–‡ä»¶ã€‚<br>è¿™ç§å·¥ä½œæ–¹å¼ä½¿å¾— Redis å¯ä»¥ä»å†™æ—¶å¤åˆ¶ï¼ˆcopy-on-writeï¼‰æœºåˆ¶ä¸­è·ç›Šã€‚<br>åªè¿›è¡Œè¿½åŠ æ“ä½œçš„æ–‡ä»¶ï¼ˆappend-only fileï¼ŒAOFï¼‰<br>å¿«ç…§åŠŸèƒ½å¹¶ä¸æ˜¯éå¸¸è€ä¹…ï¼ˆdurableï¼‰ï¼š å¦‚æœ Redis å› ä¸ºæŸäº›åŸå› è€Œé€ æˆæ•…éšœåœæœºï¼Œ é‚£ä¹ˆæœåŠ¡å™¨å°†ä¸¢å¤±æœ€è¿‘å†™å…¥ã€ä¸”ä»æœªä¿å­˜åˆ°å¿«ç…§ä¸­çš„é‚£äº›æ•°æ®ã€‚å°½ç®¡å¯¹äºæŸäº›ç¨‹åºæ¥è¯´ï¼Œ æ•°æ®çš„è€ä¹…æ€§å¹¶ä¸æ˜¯æœ€é‡è¦çš„è€ƒè™‘å› ç´ ï¼Œ ä½†æ˜¯å¯¹äºé‚£äº›è¿½æ±‚å®Œå…¨è€ä¹…èƒ½åŠ›ï¼ˆfull durabilityï¼‰çš„ç¨‹åºæ¥è¯´ï¼Œ å¿«ç…§åŠŸèƒ½å°±ä¸å¤ªé€‚ç”¨äº†ã€‚<br>ä» 1.1 ç‰ˆæœ¬å¼€å§‹ï¼Œ Redis å¢åŠ äº†ä¸€ç§å®Œå…¨è€ä¹…çš„æŒä¹…åŒ–æ–¹å¼ï¼š AOF æŒä¹…åŒ–ã€‚<br>ä½ å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥æ‰“å¼€ AOF åŠŸèƒ½ï¼š<br>appendonly yes<br>ä»ç°åœ¨å¼€å§‹ï¼Œ æ¯å½“ Redis æ‰§è¡Œä¸€ä¸ªæ”¹å˜æ•°æ®é›†çš„å‘½ä»¤æ—¶ï¼ˆæ¯”å¦‚ SETï¼‰ï¼Œ è¿™ä¸ªå‘½ä»¤å°±ä¼šè¢«è¿½åŠ åˆ° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚<br>è¿™æ ·çš„è¯ï¼Œ å½“ Redis é‡æ–°å¯æ—¶ï¼Œ ç¨‹åºå°±å¯ä»¥é€šè¿‡é‡æ–°æ‰§è¡Œ AOF æ–‡ä»¶ä¸­çš„å‘½ä»¤æ¥è¾¾åˆ°é‡å»ºæ•°æ®é›†çš„ç›®çš„ã€‚</p>
<p><strong><font size="4px">AOF é‡å†™ï¼š</font></strong></p>
<p>å› ä¸º AOF çš„è¿ä½œæ–¹å¼æ˜¯ä¸æ–­åœ°å°†å‘½ä»¤è¿½åŠ åˆ°æ–‡ä»¶çš„æœ«å°¾ï¼Œ æ‰€ä»¥éšç€å†™å…¥å‘½ä»¤çš„ä¸æ–­å¢åŠ ï¼Œ AOF æ–‡ä»¶çš„ä½“ç§¯ä¹Ÿä¼šå˜å¾—è¶Šæ¥è¶Šå¤§ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œ å¦‚æœä½ å¯¹ä¸€ä¸ªè®¡æ•°å™¨è°ƒç”¨äº† 100 æ¬¡ INCR ï¼Œ é‚£ä¹ˆä»…ä»…æ˜¯ä¸ºäº†ä¿å­˜è¿™ä¸ªè®¡æ•°å™¨çš„å½“å‰å€¼ï¼Œ AOF æ–‡ä»¶å°±éœ€è¦ä½¿ç”¨ 100 æ¡è®°å½•ï¼ˆentryï¼‰ã€‚ç„¶è€Œåœ¨å®é™…ä¸Šï¼Œ åªä½¿ç”¨ä¸€æ¡ SET å‘½ä»¤å·²ç»è¶³ä»¥ä¿å­˜è®¡æ•°å™¨çš„å½“å‰å€¼äº†ï¼Œ å…¶ä½™ 99 æ¡è®°å½•å®é™…ä¸Šéƒ½æ˜¯å¤šä½™çš„ã€‚ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼Œ Redis æ”¯æŒä¸€ç§æœ‰è¶£çš„ç‰¹æ€§ï¼š å¯ä»¥åœ¨ä¸æ‰“æ–­æœåŠ¡å®¢æˆ·ç«¯çš„æƒ…å†µä¸‹ï¼Œ å¯¹ AOF æ–‡ä»¶è¿›è¡Œé‡å»ºï¼ˆrebuildï¼‰ã€‚æ‰§è¡Œ BGREWRITEAOF å‘½ä»¤ï¼Œ Redis å°†ç”Ÿæˆä¸€ä¸ªæ–°çš„ AOF æ–‡ä»¶ï¼Œ è¿™ä¸ªæ–‡ä»¶åŒ…å«é‡å»ºå½“å‰æ•°æ®é›†æ‰€éœ€çš„æœ€å°‘å‘½ä»¤ã€‚</p>
<p><strong><font size="4px">å¦‚æœ AOF å‡ºé”™äº†ï¼š</font></strong></p>
<p>æœåŠ¡å™¨å¯èƒ½åœ¨ç¨‹åºæ­£åœ¨å¯¹ AOF æ–‡ä»¶è¿›è¡Œå†™å…¥æ—¶åœæœºï¼Œ å¦‚æœåœæœºé€ æˆäº† AOF æ–‡ä»¶å‡ºé”™ï¼ˆcorruptï¼‰ï¼Œ é‚£ä¹ˆ Redis åœ¨é‡å¯æ—¶ä¼šæ‹’ç»è½½å…¥è¿™ä¸ª AOF æ–‡ä»¶ï¼Œ ä»è€Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ä¸ä¼šè¢«ç ´åã€‚</p>
<p>å½“å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œ å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•æ¥ä¿®å¤å‡ºé”™çš„ AOF æ–‡ä»¶ï¼š</p>
<ol>
<li><p>ä¸ºç°æœ‰çš„ AOF æ–‡ä»¶åˆ›å»ºä¸€ä¸ªå¤‡ä»½ã€‚</p>
</li>
<li><p>ä½¿ç”¨ Redis é™„å¸¦çš„ redis-check-aof ç¨‹åºï¼Œå¯¹åŸæ¥çš„ AOF æ–‡ä»¶è¿›è¡Œä¿®å¤ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">redis-check-aof --fix</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>ä½¿ç”¨ diff -u å¯¹æ¯”ä¿®å¤åçš„ AOF æ–‡ä»¶å’ŒåŸå§‹ AOF æ–‡ä»¶çš„å¤‡ä»½ï¼ŒæŸ¥çœ‹ä¸¤ä¸ªæ–‡ä»¶ä¹‹é—´çš„ä¸åŒä¹‹å¤„ï¼ˆå¯é€‰ï¼‰ã€‚</p>
</li>
<li><p>é‡å¯ Redis æœåŠ¡å™¨ï¼Œç­‰å¾…æœåŠ¡å™¨è½½å…¥ä¿®å¤åçš„ AOF æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œæ•°æ®æ¢å¤ã€‚</p>
</li>
</ol>
<p><strong>AOF é‡å†™å’Œ RDB åˆ›å»ºå¿«ç…§ä¸€æ ·ï¼Œéƒ½å·§å¦™åœ°åˆ©ç”¨äº†å†™æ—¶å¤åˆ¶æœºåˆ¶ã€‚</strong></p>
<p><strong><font size="4px">AOF é‡å†™çš„æ‰§è¡Œæ­¥éª¤ï¼š</font></strong></p>
<p>Redis æ‰§è¡Œ fork() ï¼Œç°åœ¨åŒæ—¶æ‹¥æœ‰çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹ã€‚<br>å­è¿›ç¨‹å¼€å§‹å°†æ–° AOF æ–‡ä»¶çš„å†…å®¹å†™å…¥åˆ°ä¸´æ—¶æ–‡ä»¶ã€‚å¯¹äºæ‰€æœ‰æ–°æ‰§è¡Œçš„å†™å…¥å‘½ä»¤ï¼Œçˆ¶è¿›ç¨‹ä¸€è¾¹å°†å®ƒä»¬ç´¯ç§¯åˆ°ä¸€ä¸ªå†…å­˜ç¼“å­˜ä¸­ï¼Œä¸€è¾¹å°†è¿™äº›æ”¹åŠ¨è¿½åŠ åˆ°ç°æœ‰ AOF æ–‡ä»¶çš„æœ«å°¾ï¼š è¿™æ ·å³ä½¿åœ¨é‡å†™çš„ä¸­é€”å‘ç”Ÿåœæœºï¼Œç°æœ‰çš„ AOF æ–‡ä»¶ä¹Ÿè¿˜æ˜¯å®‰å…¨çš„ã€‚å½“å­è¿›ç¨‹å®Œæˆé‡å†™å·¥ä½œæ—¶ï¼Œå®ƒç»™çˆ¶è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ï¼Œçˆ¶è¿›ç¨‹åœ¨æ¥æ”¶åˆ°ä¿¡å·ä¹‹åï¼Œå°†å†…å­˜ç¼“å­˜ä¸­çš„æ‰€æœ‰æ•°æ®è¿½åŠ åˆ°æ–° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚ç°åœ¨ Redis åŸå­åœ°ç”¨æ–°æ–‡ä»¶æ›¿æ¢æ—§æ–‡ä»¶ï¼Œä¹‹åæ‰€æœ‰å‘½ä»¤éƒ½ä¼šç›´æ¥è¿½åŠ åˆ°æ–° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚</p>
<p><strong><font size="4px">RDB å’Œ AOF ä¹‹é—´çš„ç›¸äº’ä½œç”¨ï¼š</font></strong></p>
<p>åœ¨ç‰ˆæœ¬å·å¤§äºç­‰äº 2.4 çš„ Redis ä¸­ï¼Œ BGSAVE æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œ ä¸å¯ä»¥æ‰§è¡Œ BGREWRITEAOF ã€‚ åè¿‡æ¥è¯´ï¼Œ åœ¨ BGREWRITEAOF æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œ ä¹Ÿä¸å¯ä»¥æ‰§è¡Œ BGSAVE ã€‚<br>è¿™å¯ä»¥é˜²æ­¢ä¸¤ä¸ª Redis åå°è¿›ç¨‹åŒæ—¶å¯¹ç£ç›˜è¿›è¡Œå¤§é‡çš„ I/O æ“ä½œã€‚<br>å¦‚æœ BGSAVE æ­£åœ¨æ‰§è¡Œï¼Œ å¹¶ä¸”ç”¨æˆ·æ˜¾ç¤ºåœ°è°ƒç”¨ BGREWRITEAOF å‘½ä»¤ï¼Œ é‚£ä¹ˆæœåŠ¡å™¨å°†å‘ç”¨æˆ·å›å¤ä¸€ä¸ª OK çŠ¶æ€ï¼Œ å¹¶å‘ŠçŸ¥ç”¨æˆ·ï¼Œ BGREWRITEAOF å·²ç»è¢«é¢„å®šæ‰§è¡Œï¼š ä¸€æ—¦ BGSAVE æ‰§è¡Œå®Œæ¯•ï¼Œ BGREWRITEAOF å°±ä¼šæ­£å¼å¼€å§‹ã€‚å½“ Redis å¯åŠ¨æ—¶ï¼Œ å¦‚æœ RDB æŒä¹…åŒ–å’Œ AOF æŒä¹…åŒ–éƒ½è¢«æ‰“å¼€äº†ï¼Œ é‚£ä¹ˆç¨‹åºä¼šä¼˜å…ˆä½¿ç”¨ AOF æ–‡ä»¶æ¥æ¢å¤æ•°æ®é›†ï¼Œ å› ä¸º AOF æ–‡ä»¶æ‰€ä¿å­˜çš„æ•°æ®é€šå¸¸æ˜¯æœ€å®Œæ•´çš„ã€‚</p>
<p><strong><font size="4px">å¤‡ä»½ Redis æ•°æ®ï¼š</font></strong></p>
<p>Redis å¯¹äºæ•°æ®å¤‡ä»½æ˜¯éå¸¸å‹å¥½çš„ï¼Œ å› ä¸ºä½ å¯ä»¥åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å¯¹ RDB æ–‡ä»¶è¿›è¡Œå¤åˆ¶ï¼š RDB æ–‡ä»¶ä¸€æ—¦è¢«åˆ›å»ºï¼Œ å°±ä¸ä¼šè¿›è¡Œä»»ä½•ä¿®æ”¹ã€‚ å½“æœåŠ¡å™¨è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ RDB æ–‡ä»¶æ—¶ï¼Œ å®ƒå…ˆå°†æ–‡ä»¶çš„å†…å®¹ä¿å­˜åœ¨ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶é‡Œé¢ï¼Œ å½“ä¸´æ—¶æ–‡ä»¶å†™å…¥å®Œæ¯•æ—¶ï¼Œ ç¨‹åºæ‰ä½¿ç”¨ åŸå­åœ°ç”¨ä¸´æ—¶æ–‡ä»¶æ›¿æ¢åŸæ¥çš„ RDB æ–‡ä»¶ã€‚è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œ æ— è®ºä½•æ—¶ï¼Œ å¤åˆ¶ RDB æ–‡ä»¶éƒ½æ˜¯ç»å¯¹å®‰å…¨çš„ã€‚</p>
<h2 id="åã€å‘å¸ƒè®¢é˜…"><a href="#åã€å‘å¸ƒè®¢é˜…" class="headerlink" title="åã€å‘å¸ƒè®¢é˜…"></a>åã€å‘å¸ƒè®¢é˜…</h2><h4 id="10-1ã€ä»€ä¹ˆæ˜¯å‘å¸ƒè®¢é˜…ï¼Ÿ"><a href="#10-1ã€ä»€ä¹ˆæ˜¯å‘å¸ƒè®¢é˜…ï¼Ÿ" class="headerlink" title="10.1ã€ä»€ä¹ˆæ˜¯å‘å¸ƒè®¢é˜…ï¼Ÿ"></a>10.1ã€ä»€ä¹ˆæ˜¯å‘å¸ƒè®¢é˜…ï¼Ÿ</h4><p>Redis å‘å¸ƒè®¢é˜… (pub/sub) æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æ¨¡å¼ï¼šå‘é€è€… (pub) å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€… (sub) æ¥æ”¶æ¶ˆæ¯ã€‚</p>
<p>Redis å®¢æˆ·ç«¯å¯ä»¥è®¢é˜…ä»»æ„æ•°é‡çš„é¢‘é“ã€‚</p>
<p>ä¸‹å›¾å±•ç¤ºäº†é¢‘é“ channel1 ï¼Œ ä»¥åŠè®¢é˜…è¿™ä¸ªé¢‘é“çš„ä¸‰ä¸ªå®¢æˆ·ç«¯ â€”â€” client2 ã€ client5 å’Œ client1 ä¹‹é—´çš„å…³ç³»ï¼š</p>
<p><img src="https://z3.ax1x.com/2021/11/27/oeNpJe.png" alt="image"></p>
<p>å½“æœ‰æ–°æ¶ˆæ¯é€šè¿‡ PUBLISH å‘½ä»¤å‘é€ç»™é¢‘é“ channel1 æ—¶ï¼Œ è¿™ä¸ªæ¶ˆæ¯å°±ä¼šè¢«å‘é€ç»™è®¢é˜…å®ƒçš„ä¸‰ä¸ªå®¢æˆ·ç«¯ï¼š</p>
<p><img src="https://z3.ax1x.com/2021/11/27/oeNCzd.png" alt="image"></p>
<p><br></p>
<p>è¦æƒ³åœ¨ Redis ä¸­æ¨¡æ‹Ÿå‘å¸ƒè®¢é˜…çš„è¿‡ç¨‹ï¼Œéœ€è¦å¼€å¯ä¸¤ä¸ª redis-cli å®¢æˆ·ç«¯ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># è®¢é˜…channel1é¢‘é“</span></span><br><span class="line">127.0.0.1:6379&gt; subscribe channel1</span><br><span class="line">Reading messages... (press Ctrl-C to quit)</span><br><span class="line">1) <span class="string">"subscribe"</span></span><br><span class="line">2) <span class="string">"channel1"</span></span><br><span class="line">3) (<span class="built_in">integer</span>) 1</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># é¢‘é“channel1å‘å¸ƒæ¶ˆæ¯ï¼Œâ€œhelloï¼Œit's channel1â€</span></span><br><span class="line">127.0.0.1:6379&gt; publish channel1 <span class="string">"hello,it's channel1"</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># ç”¨æˆ·æ”¶åˆ°æ¥è‡ªchannel1çš„æ¶ˆæ¯</span></span><br><span class="line">127.0.0.1:6379&gt; subscribe channel1</span><br><span class="line">Reading messages... (press Ctrl-C to quit)</span><br><span class="line">1) <span class="string">"subscribe"</span></span><br><span class="line">2) <span class="string">"channel1"</span></span><br><span class="line">3) (<span class="built_in">integer</span>) 1</span><br><span class="line">1) <span class="string">"message"</span></span><br><span class="line">2) <span class="string">"channel1"</span></span><br><span class="line">3) <span class="string">"hello,it's channel1"</span></span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h4 id="10-2ã€å‘å¸ƒè®¢é˜…å¸¸ç”¨å‘½ä»¤"><a href="#10-2ã€å‘å¸ƒè®¢é˜…å¸¸ç”¨å‘½ä»¤" class="headerlink" title="10.2ã€å‘å¸ƒè®¢é˜…å¸¸ç”¨å‘½ä»¤"></a>10.2ã€å‘å¸ƒè®¢é˜…å¸¸ç”¨å‘½ä»¤</h4><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">åºå·</th>
<th style="text-align:left">å‘½ä»¤</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">PSUBSCRIBE pattern [pattern â€¦]</td>
<td>è®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªç¬¦åˆç»™å®šæ¨¡å¼çš„é¢‘é“ã€‚</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">PUBSUB subcommand [argument [argument â€¦]]</td>
<td>æŸ¥çœ‹è®¢é˜…ä¸å‘å¸ƒç³»ç»ŸçŠ¶æ€ã€‚</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">PUBLISH channel message</td>
<td>å°†ä¿¡æ¯å‘é€åˆ°æŒ‡å®šçš„é¢‘é“ã€‚</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left">PUNSUBSCRIBE [pattern [pattern â€¦]]</td>
<td>é€€è®¢æ‰€æœ‰ç»™å®šæ¨¡å¼çš„é¢‘é“ã€‚</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">SUBSCRIBE channel [channel â€¦]</td>
<td>è®¢é˜…ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªé¢‘é“çš„ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:left">UNSUBSCRIBE [channel [channel â€¦]]</td>
<td>æŒ‡é€€è®¢ç»™å®šçš„é¢‘é“ã€‚</td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
<h4 id="10-3ã€åŸç†"><a href="#10-3ã€åŸç†" class="headerlink" title="10.3ã€åŸç†"></a>10.3ã€åŸç†</h4><p>Redis æ˜¯ä½¿ç”¨ C å®ç°çš„ï¼Œé€šè¿‡åˆ†æ Redis æºç é‡Œçš„ public.c æ–‡ä»¶ï¼Œäº†è§£å‘å¸ƒå’Œè®¢é˜…æœºåˆ¶çš„åº•å±‚å®ç°ï¼Œå€Ÿæ­¤åŠ æ·±å¯¹ Redis çš„ç†è§£ã€‚</p>
<p>Redis é€šè¿‡ PUBLISHã€SUBSCRIBE å’Œ PSUBSCRIBE ç­‰å‘½ä»¤å®ç°å‘å¸ƒå’Œè®¢é˜…åŠŸèƒ½ã€‚</p>
<p>é€šè¿‡ SUBSCRIBE å‘½ä»¤è®¢é˜…æŸé¢‘é“åï¼Œredis-server é‡Œç»´æŠ¤äº†ä¸€ä¸ªå­—å…¸ï¼Œå­—å…¸çš„é”®å°±æ˜¯ä¸€ä¸ªä¸ª channelï¼Œè€Œå­—å…¸çš„å€¼åˆ™æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸­ä¿å­˜äº†æ‰€æœ‰è®¢é˜…è¿™ä¸ª channel çš„å®¢æˆ·ç«¯ã€‚SUBSCRIBE å‘½ä»¤çš„å…³é”®ï¼Œå°±æ˜¯å°†å®¢æˆ·ç«¯æ·»åŠ åˆ°ç»™å®š channel çš„è®¢é˜…é“¾è¡¨ä¸­ã€‚</p>
<p>é€šè¿‡ PUBLISH å‘½ä»¤å‘è®¢é˜…è€…å‘é€ä¿¡æ¯ï¼Œredis-server ä¼šä½¿ç”¨ç»™å®šçš„é¢‘é“ä½œä¸ºé”®ï¼Œåœ¨å®ƒæ‰€ç»´æŠ¤çš„ channel å­—å…¸ä¸­æŸ¥æ‰¾è®¢é˜…äº†è¿™ä¸ªé¢‘é“æ‰€æœ‰çš„å®¢æˆ·ç«¯é“¾è¡¨ï¼Œå€Ÿæ­¤å°†æ¶ˆæ¯å‘å¸ƒç»™æ‰€æœ‰çš„è®¢é˜…è€…ã€‚</p>
<p>Pub/Sub ä»å­—é¢ä¸Šç†è§£å°±æ˜¯å‘å¸ƒï¼ˆPublishï¼‰ä¸è®¢é˜…ï¼ˆSubcribeï¼‰ï¼Œåœ¨Redisä¸­ï¼Œä½ å¯ä»¥è®¾å®šå¯¹æŸä¸€ä¸ª key è¿›è¡Œæ¶ˆæ¯å‘å¸ƒåŠæ¶ˆæ¯è®¢é˜…ï¼Œå½“ä¸€ä¸ª key å€¼ä¸Šè¿›è¡Œäº†æ¶ˆæ¯å‘å¸ƒåï¼Œæ‰€æœ‰è®¢é˜…å®ƒçš„å®¢æˆ·ç«¯éƒ½ä¼šå—åˆ°ç›¸åº”çš„ä¿¡æ¯ã€‚è¿™ä¸€åŠŸèƒ½æœ€æ˜æ˜¾çš„ç”¨æ³•å°±æ˜¯ç”¨ä½œå®æ—¶æ¶ˆæ¯ç³»ç»Ÿï¼Œä¾‹å¦‚ç¾¤èŠç­‰ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/27/oeaKrn.jpg" alt="v2 76e3e06285cdeea65abf6877497be3f1 720w"></p>
<h2 id="åä¸€ã€ä¸»ä»å¤åˆ¶"><a href="#åä¸€ã€ä¸»ä»å¤åˆ¶" class="headerlink" title="åä¸€ã€ä¸»ä»å¤åˆ¶"></a>åä¸€ã€ä¸»ä»å¤åˆ¶</h2><h4 id="11-1ã€ç®€ä»‹"><a href="#11-1ã€ç®€ä»‹" class="headerlink" title="11.1ã€ç®€ä»‹"></a>11.1ã€ç®€ä»‹</h4><p>ä¸»ä»å¤åˆ¶æ˜¯ä¸ºäº†è¾¾æˆé«˜å¯ç”¨</p>
<ul>
<li>ä¸ºäº†é¿å…å•ç‚¹RedisæœåŠ¡å™¨æ•…éšœï¼Œå‡†å¤‡å¤šå°æœåŠ¡å™¨ï¼Œäº’ç›¸è¿é€šã€‚å°†æ•°æ®å¤åˆ¶å¤šä¸ªå‰¯æœ¬ä¿å­˜åœ¨ä¸åŒçš„æœ<br>åŠ¡å™¨ä¸Šï¼Œè¿æ¥åœ¨ä¸€èµ·ï¼Œå¹¶ä¿è¯æ•°æ®æ˜¯åŒæ­¥çš„ã€‚</li>
<li>å³ä½¿æœ‰å…¶ä¸­ä¸€å°æœåŠ¡å™¨å®•æœºï¼Œå…¶ä»–æœåŠ¡å™¨ä¾ç„¶å¯ä»¥ç»§ç»­æä¾›æœåŠ¡ï¼Œå®ç°Redisçš„é«˜å¯ç”¨ï¼ŒåŒæ—¶å®ç°æ•°æ®å†—ä½™å¤‡ä»½ã€‚</li>
</ul>
<p><img src="https://z3.ax1x.com/2021/11/27/oeysv8.png" alt="image"></p>
<ul>
<li>æä¾›æ•°æ®æ–¹ï¼šmaster<ul>
<li>å†™æ•°æ®</li>
<li>æ‰§è¡Œå†™æ“ä½œæ—¶ï¼Œå°†å‡ºç°å˜åŒ–çš„æ•°æ®è‡ªåŠ¨åŒæ­¥åˆ°slave</li>
<li>è¯»æ•°æ®ï¼ˆå¯å¿½ç•¥ï¼‰</li>
<li>ä¸€ä¸ªmasterå¯ä»¥æ‹¥æœ‰å¤šä¸ªslave</li>
</ul>
</li>
<li>æ¥æ”¶æ•°æ®æ–¹ï¼šslave<ul>
<li>è¯»æ•°æ®</li>
<li>å†™æ•°æ®ï¼ˆç¦æ­¢ï¼‰</li>
<li>ä¸€ä¸ªslaveåªå¯¹åº”ä¸€ä¸ªmaster</li>
</ul>
</li>
<li>éœ€è¦è§£å†³çš„é—®é¢˜<ul>
<li>æ•°æ®åŒæ­¥</li>
</ul>
</li>
<li>æ ¸å¿ƒå·¥ä½œ<ul>
<li>masterçš„æ•°æ®å¤åˆ¶åˆ°slaveä¸­</li>
</ul>
</li>
</ul>
<h4 id="11-2ã€ä½œç”¨"><a href="#11-2ã€ä½œç”¨" class="headerlink" title="11.2ã€ä½œç”¨"></a>11.2ã€ä½œç”¨</h4><p>ä¸»ä»å¤åˆ¶ï¼Œæ˜¯æŒ‡å°†ä¸€å°RedisæœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„RedisæœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹(master/leader)ï¼Œåè€…ç§°ä¸ºä»èŠ‚ç‚¹(slave/follower) ; æ•°æ®çš„å¤åˆ¶æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”±ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ã€‚Masterä»¥å†™ä¸ºä¸»ï¼ŒSlaveä»¥è¯»ä¸ºä¸»ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯å°RedisæœåŠ¡å™¨éƒ½æ˜¯ä¸»èŠ‚ç‚¹ ;</p>
<p>ä¸”ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªä»èŠ‚ç‚¹(æˆ–æ²¡æœ‰ä»èŠ‚ç‚¹)ï¼Œä½†ä¸€ä¸ªä»èŠ‚ç‚¹åªèƒ½æœ‰ä¸€ä¸ªä¸»èŠ‚ç‚¹ã€‚</p>
<p>å…¶ä½œç”¨æœ‰ä»¥ä¸‹äº”ç‚¹ï¼š</p>
<ol>
<li><strong>è¯»å†™åˆ†ç¦»</strong>ï¼šä¸»èŠ‚ç‚¹å†™ï¼Œä»èŠ‚ç‚¹è¯»ï¼Œæé«˜æœåŠ¡å™¨çš„è¯»å†™è´Ÿè½½èƒ½åŠ›</li>
<li><strong>æ•°æ®å†—ä½™</strong>ï¸°ä¸»ä»å¤åˆ¶å®ç°äº†æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚</li>
<li><strong>æ•…éšœæ¢å¤</strong>ï¸°å½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ ; å®é™…ä¸Šæ˜¯ä¸€ç§æœåŠ¡çš„å†—ä½™ã€‚</li>
<li><strong>è´Ÿè½½å‡è¡¡</strong>ï¸°åœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼ˆå³å†™Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä¸»èŠ‚ç‚¹ï¼Œè¯»Redisæ•°æ®æ—¶åº”ç”¨è¿æ¥ä»èŠ‚ç‚¹ï¼‰ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ ; å°¤å…¶æ˜¯åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜RedisæœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚</li>
<li><strong>é«˜å¯ç”¨ï¼ˆé›†ç¾¤ï¼‰åŸºçŸ³</strong>ï¸°é™¤äº†ä¸Šè¿°ä½œç”¨ä»¥å¤–ï¼Œä¸»ä»å¤åˆ¶è¿˜æ˜¯å“¨å…µå’Œé›†ç¾¤èƒ½å¤Ÿå®æ–½çš„åŸºç¡€ï¼Œå› æ­¤è¯´ä¸»ä»å¤åˆ¶æ˜¯Redisé«˜å¯ç”¨çš„åŸºç¡€ã€‚</li>
</ol>
<h4 id="11-3ã€ç¯å¢ƒæ­å»º"><a href="#11-3ã€ç¯å¢ƒæ­å»º" class="headerlink" title="11.3ã€ç¯å¢ƒæ­å»º"></a>11.3ã€ç¯å¢ƒæ­å»º</h4><p>è¿™é‡Œæˆ‘ä»¬å®ç°çš„æ˜¯<code>ä¸€ä¸»äºŒä»</code>ï¼Œå…ˆå‡†å¤‡ä¸‰ä»½é…ç½®æ–‡ä»¶ï¼Œå› ä¸ºæ˜¯æ ¹æ®é…ç½®æ–‡ä»¶åˆ›å»ºæœåŠ¡çš„ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@deflory redis-6.2.6]<span class="comment"># mkdir master-slaver-config</span></span><br><span class="line">[root@deflory redis-6.2.6]<span class="comment"># cp MyRedis.conf master-slaver-config/redis79.config</span></span><br><span class="line">[root@deflory redis-6.2.6]<span class="comment"># cp MyRedis.conf master-slaver-config/redis80.config</span></span><br><span class="line">[root@deflory redis-6.2.6]<span class="comment"># cp MyRedis.conf master-slaver-config/redis81.config</span></span><br></pre></td></tr></tbody></table></figure>
<p>æ¯ä¸ªé…ç½®æ–‡ä»¶éƒ½éœ€è¦ä¿®æ”¹ä¸€ä¸‹å››ä¸ªåœ°æ–¹ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">port 6379	<span class="comment"># ç«¯å£å·</span></span><br><span class="line">pidfile /var/run/redis_6379.pid	<span class="comment"># åå°è¿›ç¨‹æ–‡ä»¶</span></span><br><span class="line">logfile <span class="string">"6379.log"</span>	<span class="comment"># æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line">dbfilename dump6379.rdb	<span class="comment"># å¤‡ä»½æ–‡ä»¶</span></span><br></pre></td></tr></tbody></table></figure>
<p>å¼€å¯ä¸‰ä¸ªæœåŠ¡å™¨ç«¯ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@deflory src]<span class="comment"># ./redis-server ../master-slaver-config/redis79.config </span></span><br><span class="line">[root@deflory src]<span class="comment"># ./redis-server ../master-slaver-config/redis80.config </span></span><br><span class="line">[root@deflory src]<span class="comment"># ./redis-server ../master-slaver-config/redis81.config </span></span><br></pre></td></tr></tbody></table></figure>
<p>æŸ¥çœ‹åå°è¿›ç¨‹ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@deflory src]<span class="comment"># ps -ef | grep redis</span></span><br><span class="line">root      3526     1  0 Nov26 ?        00:02:25 ./redis-server *:6379</span><br><span class="line">root     10786     1  0 15:54 ?        00:00:00 ./redis-server *:6380</span><br><span class="line">root     10848     1  0 15:54 ?        00:00:00 ./redis-server *:6381</span><br><span class="line">root     11456 27951  0 15:54 pts/0    00:00:00 grep --color=auto redis</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<h4 id="11-4ã€ä¸»ä»å¤åˆ¶å®æˆ˜"><a href="#11-4ã€ä¸»ä»å¤åˆ¶å®æˆ˜" class="headerlink" title="11.4ã€ä¸»ä»å¤åˆ¶å®æˆ˜"></a>11.4ã€ä¸»ä»å¤åˆ¶å®æˆ˜</h4><p>è¿æ¥æœåŠ¡å™¨ç«¯ï¼Œä½¿ç”¨ <code>info replication</code> æ¥æŸ¥çœ‹å½“å‰ä¸»ä»æƒ…å†µã€‚</p>
<p>ç”±äºæœåŠ¡å™¨é»˜è®¤éƒ½æ˜¯ä»¥ä¸»æœºå¯åŠ¨çš„ï¼Œå› æ­¤ç›®å‰â€œä¸‰å°æœºå™¨â€éƒ½æ˜¯ä¸»æœºã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master			<span class="comment"># è§’è‰²ä¸ºä¸»æœº</span></span><br><span class="line">connected_slaves:0	<span class="comment"># æ²¡æœ‰ä»æœº</span></span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:1c16ac389c930c4f0bec48f654f4aea35c83975e</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:0</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:0</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:0</span><br><span class="line">repl_backlog_histlen:0</span><br></pre></td></tr></tbody></table></figure>
<p>é€šè¿‡ <code>slaveof host port</code> æ¥è¿æ¥ä¸»æœºï¼Œå¦‚æœä¸»æœºæœ‰è®¾ç½®å¯†ç ï¼Œåˆ™ä¼šè¦æ±‚è¿›è¡Œ auth éªŒè¯ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6380&gt; slaveof 127.0.0.1 6379</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6380&gt; info replication	<span class="comment"># ä»æœºçš„ä¸»ä»ä¿¡æ¯</span></span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:slave</span><br><span class="line">master_host:127.0.0.1</span><br><span class="line">master_port:6379</span><br><span class="line">master_link_status:down</span><br><span class="line">master_last_io_seconds_ago:-1</span><br><span class="line">master_sync_in_progress:1</span><br><span class="line">slave_read_repl_offset:1</span><br><span class="line">slave_repl_offset:1</span><br><span class="line">master_sync_total_bytes:-1</span><br><span class="line">master_sync_read_bytes:0</span><br><span class="line">master_sync_left_bytes:-1</span><br><span class="line">master_sync_perc:-0.00</span><br><span class="line">master_sync_last_io_seconds_ago:0</span><br><span class="line">master_link_down_since_seconds:-1</span><br><span class="line">slave_priority:100</span><br><span class="line">slave_read_only:1</span><br><span class="line">replica_announced:1</span><br><span class="line">connected_slaves:0</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:54b564a0c9ce365c28c6cfdad02b242bd1bd43b1</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:0</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:0</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:0</span><br><span class="line">repl_backlog_histlen:0</span><br></pre></td></tr></tbody></table></figure>
<p>ä¸»æœºçš„ä¸»ä»ä¿¡æ¯ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:2	<span class="comment"># è¿æ¥äº†ä¸¤ä¸ªä»æœº</span></span><br><span class="line">slave0:ip=127.0.0.1,port=6380,state=wait_bgsave,offset=0,lag=0</span><br><span class="line">slave1:ip=127.0.0.1,port=6381,state=wait_bgsave,offset=0,lag=0</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:1a9562c7e236c63f924abd1bdad46192f466337d</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:70</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1</span><br><span class="line">repl_backlog_histlen:70</span><br></pre></td></tr></tbody></table></figure>
<p><br></p>
<p><strong><font size="4px">è¿è¡Œæµ‹è¯•</font></strong></p>
<p>åœ¨ä¸»æœºå†™å…¥<strong>name:deflory</strong>åï¼Œä»æœºä¹Ÿèƒ½è¯»å–åˆ°ç›¸åº”å†…å®¹ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸»æœºå†™å…¥</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> name deflory</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line"><span class="string">"deflory"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»æœº1è¯»å–</span></span><br><span class="line">127.0.0.1:6380&gt; get name</span><br><span class="line"><span class="string">"deflory"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»æœº2è¯»å–</span></span><br><span class="line">127.0.0.1:6381&gt; get name</span><br><span class="line"><span class="string">"deflory"</span></span><br></pre></td></tr></tbody></table></figure>
<p>ä½†æ˜¯ï¼Œä»æœºåªèƒ½ç”¨æ¥è¯»å–æ•°æ®ï¼Œè€Œä¸èƒ½ä¿®æ”¹æ•°æ®ï¼Œåªè¯»ï¼</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6380&gt; <span class="built_in">set</span> age 10</span><br><span class="line">(error) READONLY You can<span class="string">'t write against a read only replica.</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>é‚£ä¹ˆå¦‚æœæ­¤æ—¶ï¼Œæˆ‘ä»¬çš„ä¸»æœºå®•æœºäº†ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸»æœºå®•æœº</span></span><br><span class="line">127.0.0.1:6379&gt; shutdown</span><br><span class="line">not connected&gt; <span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å³ä½¿ä¸»æœºå®•æœºäº†ï¼Œç”±äºæ•°æ®å·²ç»å¤åˆ¶åˆ°ä»æœºä¸Šäº†ï¼Œå› æ­¤ä»ç„¶å¯ä»¥æŸ¥è¯¢åˆ°</span></span><br><span class="line">127.0.0.1:6380&gt; get name</span><br><span class="line"><span class="string">"deflory"</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>æ¥ä¸‹æ¥æˆ‘ä»¬æ¢ä¸ªè§’åº¦ï¼Œä»æœºå®•æœºå‘¢ï¼Ÿ</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># ä»æœº1å®•æœº</span></span><br><span class="line">127.0.0.1:6380&gt; shutdown</span><br><span class="line">not connected&gt; <span class="built_in">exit</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»æœºå†™å…¥æ•°æ®</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> age 20</span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»æœº2ä»ç„¶å¯ä»¥æ­£å¸¸è¯»å–æ•°æ®</span></span><br><span class="line">127.0.0.1:6381&gt; get age</span><br><span class="line"><span class="string">"20"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡æ–°è¿æ¥ä»æœº1</span></span><br><span class="line">[root@deflory src]<span class="comment"># ./redis-server ../master-slaver-config/redis80.config </span></span><br><span class="line">[root@deflory src]<span class="comment"># ./redis-cli -p 6380</span></span><br><span class="line">127.0.0.1:6380&gt; clear</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”±äºä¹‹å‰æˆ‘ä»¬æ˜¯åœ¨å‘½ä»¤è¡Œä¸­è®¾ç½®ä¸»ä»æœºï¼Œå› æ­¤é‡å¯ä¹‹åå°±åˆé»˜è®¤æˆä¸ºäº†ä¸»æœº</span></span><br><span class="line"><span class="comment"># æƒ³è¦å®ç°é‡å¯è¿˜æ˜¯ä»æœºçš„è¯ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹</span></span><br><span class="line">127.0.0.1:6380&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:0</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:e2f04142dad9c956952dd6cc62d27db9f654bf14</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:0</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:0</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:0</span><br><span class="line">repl_backlog_histlen:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡æ–°è®¾ç½®ä¸»æœº</span></span><br><span class="line">127.0.0.1:6380&gt; replicaof 127.0.0.1 6379</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6380&gt; get age	<span class="comment"># ä»æœºåœ¨è¿æ¥ä¸»æœºæ—¶ä¼šè¿›è¡Œå…¨é‡å¤åˆ¶ï¼Œå› æ­¤å®•æœºå†è¿æ¥è¿˜æ˜¯å¯ä»¥æŸ¥è¯¢åˆ°ä¿¡æ¯çš„</span></span><br><span class="line"><span class="string">"20"</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note success">
            <p>æ³¨ï¼šé…ç½®æ–‡ä»¶ä¸»ä»å¤åˆ¶è®¾ç½®</p><p>åœ¨5.0.0ä¹‹åï¼Œslaveof é€æ¸è¢« replicaof æ‰€å–ä»£ï¼Œå› æ­¤åœ¨é…ç½®æ–‡ä»¶ä¸­ä¹Ÿä¸å« slaveof äº†ï¼Œæ‰¾äº†æˆ‘å¥½ä¹…ï¼ï¼ï¼</p>
          </div>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ä¸»æœºipå’Œç«¯å£</span></span><br><span class="line"><span class="comment"># replicaof &lt;masterip&gt; &lt;masterport&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># If the master is password protected (using the "requirepass" configuration</span></span><br><span class="line"><span class="comment"># directive below) it is possible to tell the replica to authenticate before</span></span><br><span class="line"><span class="comment"># starting the replication synchronization process, otherwise the master will</span></span><br><span class="line"><span class="comment"># refuse the replica request.</span></span><br><span class="line"><span class="comment"># å¦‚æœä¸»æœºæœ‰å¯†ç ï¼Œéœ€è¦è¿›è¡Œauthè®¤è¯</span></span><br><span class="line"><span class="comment"># masterauth &lt;master-password&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>ä¸è¿‡ï¼Œå°±æ­£å¸¸è€Œè¨€ï¼Œå¦‚æœä¸»æœºå®•æœºäº†ï¼Œå‰©ä¸‹çš„ä»æœºæ˜¯æ— æ³•è¿›è¡Œå†™å…¥æ“ä½œçš„ï¼Œå› æ­¤ä¸€ä¸ªæ¯”è¾ƒå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå°±æ˜¯ä»å‰©ä¸‹çš„ä»æœºä¸­ï¼Œå†é€‰å‡ºä¸€ä¸ªä¸»æœºã€‚</strong></p>
<p><br></p>
<h4 id="11-5ã€é“¾å¼ä¸»ä»æ¨¡å¼"><a href="#11-5ã€é“¾å¼ä¸»ä»æ¨¡å¼" class="headerlink" title="11.5ã€é“¾å¼ä¸»ä»æ¨¡å¼"></a>11.5ã€é“¾å¼ä¸»ä»æ¨¡å¼</h4><p>å³å¦‚ä¸‹è®¾è®¡ç»“æ„ï¼Œä¸­é—´çš„æœåŠ¡å™¨æ—¢æ˜¯å‰é¢çš„ä»æœåŠ¡å™¨ï¼Œä¹Ÿæ˜¯åé¢çš„ä¸»æœåŠ¡å™¨ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/27/oejcsU.png" alt=""></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># æœåŠ¡å™¨1ï¼Œè§’è‰²ï¼šmasterï¼Œæœ‰ä¸€ä¸ªslaver</span></span><br><span class="line">127.0.0.1:6379&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:1</span><br><span class="line">slave0:ip=127.0.0.1,port=6380,state=online,offset=44034,lag=1</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:87d1dd88912bc43511d8542553412c7047692e75</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:44034</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1</span><br><span class="line">repl_backlog_histlen:44034</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœåŠ¡å™¨2ï¼Œè§’è‰²ï¼šslaverï¼Œæœ‰ä¸€ä¸ªslaver</span></span><br><span class="line">127.0.0.1:6380&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:slave</span><br><span class="line">master_host:127.0.0.1</span><br><span class="line">master_port:6379</span><br><span class="line">master_link_status:up</span><br><span class="line">master_last_io_seconds_ago:2</span><br><span class="line">master_sync_in_progress:0</span><br><span class="line">slave_read_repl_offset:44020</span><br><span class="line">slave_repl_offset:44020</span><br><span class="line">slave_priority:100</span><br><span class="line">slave_read_only:1</span><br><span class="line">replica_announced:1</span><br><span class="line">connected_slaves:1</span><br><span class="line">slave0:ip=127.0.0.1,port=6381,state=online,offset=44020,lag=0</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:87d1dd88912bc43511d8542553412c7047692e75</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:44020</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1650</span><br><span class="line">repl_backlog_histlen:42371</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœåŠ¡å™¨3ï¼Œè§’è‰²ï¼šslaverï¼Œæ²¡æœ‰slaverï¼Œå¤„äºè¯¥é“¾çš„æœ«å°¾</span></span><br><span class="line">127.0.0.1:6381&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:slave</span><br><span class="line">master_host:127.0.0.1</span><br><span class="line">master_port:6380</span><br><span class="line">master_link_status:up</span><br><span class="line">master_last_io_seconds_ago:5</span><br><span class="line">master_sync_in_progress:0</span><br><span class="line">slave_read_repl_offset:44006</span><br><span class="line">slave_repl_offset:44006</span><br><span class="line">slave_priority:100</span><br><span class="line">slave_read_only:1</span><br><span class="line">replica_announced:1</span><br><span class="line">connected_slaves:0</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:87d1dd88912bc43511d8542553412c7047692e75</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:44006</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1</span><br><span class="line">repl_backlog_histlen:44006</span><br></pre></td></tr></tbody></table></figure>
<p>æµ‹è¯•ï¼Œä¸»æœåŠ¡å™¨å†™å…¥æ•°æ®ï¼Œåé¢ä¸¤ä¸ªä»æœåŠ¡å™¨éƒ½èƒ½è¯»å–æ•°æ®ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> name yqx</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6380&gt; get name</span><br><span class="line"><span class="string">"yqx"</span></span><br><span class="line">127.0.0.1:6381&gt; get name</span><br><span class="line"><span class="string">"yqx"</span></span><br></pre></td></tr></tbody></table></figure>
<p>ä½†å½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œç¬¬äºŒå°æœåŠ¡å™¨ä¾æ—§ä¸èƒ½å†™å…¥æ•°æ®ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; shutdown</span><br><span class="line">not connected&gt; <span class="built_in">exit</span></span><br><span class="line">127.0.0.1:6380&gt; <span class="built_in">set</span> weight 60</span><br><span class="line">(error) READONLY You can<span class="string">'t write against a read only replica</span></span><br></pre></td></tr></tbody></table></figure>
<p>éœ€è¦ä½¿ç”¨ <code>replicaof no one</code>ï¼Œæ¥å°†è‡ªå·±æå‡ä¸ºä¸»æœåŠ¡å™¨ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6380&gt; replicaof no one</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6380&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:1</span><br><span class="line">slave0:ip=127.0.0.1,port=6381,state=online,offset=28,lag=1</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:ae7b3b6cbc8f62fbcb8d179325de0e83afe61701</span><br><span class="line">master_replid2:78124558cc7e470c3eca6b2517ffbc3a0a6557a7</span><br><span class="line">master_repl_offset:28</span><br><span class="line">second_repl_offset:15</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1</span><br><span class="line">repl_backlog_histlen:28</span><br><span class="line">127.0.0.1:6380&gt; <span class="built_in">set</span> weight 666</span><br><span class="line">OK</span><br><span class="line"><span class="comment"># æ­¤æ—¶å¤„äºæœ«å°¾çš„ä»æœåŠ¡å™¨ä¹Ÿèƒ½è·å–åˆ°åˆšåˆšè®¾ç½®çš„ä½“é‡å€¼</span></span><br><span class="line">127.0.0.1:6381&gt; get weight</span><br><span class="line"><span class="string">"666"</span></span><br></pre></td></tr></tbody></table></figure>
<div class="note danger">
            <p>ä½†æ˜¯è¿™ç§ç±»ä¼¼é“¾å¼çš„ä¸»ä»å¤åˆ¶æ¨¡å‹ï¼Œæœ‰ç€ä¸‰ä¸ªéå¸¸å¤§çš„é—®é¢˜ï¼ï¼ï¼</p>
          </div>
<ul>
<li>å¦‚æœä¸­é—´çš„æŸå°æœåŠ¡å™¨å®•æœºäº†ï¼Œé‚£ä¹ˆåé¢çš„æœåŠ¡å™¨å°±æ— æ³•å†æ¥å—åˆ°æ›´æ–°çš„æ•°æ®äº†ï¼</li>
<li>ç”±äºæ•°æ®æ˜¯åƒé“¾å¼ä¸€æ ·è¿›è¡Œæ›´æ–°ï¼Œå¤„äºæœ«å°¾çš„ä»æœåŠ¡å™¨ä¼šå’Œå‰é¢çš„æœåŠ¡å™¨çš„æ›´æ–°æ—¶é—´å·®è·å¾ˆå¤§ï¼</li>
<li>æ¯æ¬¡éƒ½è¦æ‰‹åŠ¨çš„é€‰æ‹©ä¸»æœåŠ¡å™¨ï¼Œæ•ˆç‡éå¸¸ä½ï¼</li>
</ul>
<p><br></p>
<h4 id="11-6ã€ä¸»ä»å¤åˆ¶è¿è¡ŒåŸç†"><a href="#11-6ã€ä¸»ä»å¤åˆ¶è¿è¡ŒåŸç†" class="headerlink" title="11.6ã€ä¸»ä»å¤åˆ¶è¿è¡ŒåŸç†"></a>11.6ã€ä¸»ä»å¤åˆ¶è¿è¡ŒåŸç†</h4><p>Slave å¯åŠ¨æˆåŠŸè¿æ¥åˆ° master åä¼šå‘é€ä¸€ä¸ª sync åŒæ­¥æŒ‡ä»¤</p>
<p>Master æ¥åˆ°æŒ‡ä»¤ï¼Œå¯åŠ¨åå°çš„å­˜ç›˜è¿›ç¨‹ï¼ŒåŒæ—¶æ”¶é›†æ‰€æœ‰æ¥æ”¶åˆ°çš„ç”¨äºä¿®æ”¹æ•°æ®é›†å‘½ä»¤ï¼Œåœ¨åå°è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œmaster å°†ä¼ é€æ•´ä¸ªæ•°æ®æ–‡ä»¶åˆ° slave å¹¶å®Œæˆä¸€æ¬¡å®Œå…¨åŒæ­¥ã€‚</p>
<p>å…¨é‡å¤åˆ¶ï¼šslave åœ¨æ¥æ”¶åˆ°æ•°æ®åº“æ–‡ä»¶æ•°æ®åï¼Œå°†å…¶å­˜ç›˜å¹¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</p>
<p>å¢é‡å¤åˆ¶ï¼šMaster ç»§ç»­å°†æ–°çš„æ‰€æœ‰æ”¶é›†åˆ°çš„ä¿®æ”¹å‘½ä»¤ä¸€æ¬¡ä¼ ç»™ slave ï¼Œå®ŒæˆåŒæ­¥ã€‚</p>
<p>åªè¦æ˜¯é‡æ–°è¿æ¥åˆ° Masterï¼Œå°±ä¼šè¿›è¡Œä¸€æ¬¡å®Œå…¨åŒæ­¥ï¼ˆå…¨é‡å¤åˆ¶ + å¢é‡å¤åˆ¶ï¼‰ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/27/oeXVBQ.png" alt="image"></p>
<p><strong><font size="5px">å¢é‡å¤åˆ¶å®ç°</font></strong></p>
<ul>
<li>ä¸»æœåŠ¡å™¨çš„å¤åˆ¶åç§»é‡ï¼ˆreplication offsetï¼‰å’Œä»æœåŠ¡å™¨çš„å¤åˆ¶åç§»é‡</li>
<li>ä¸»æœåŠ¡å™¨çš„å¤åˆ¶ç§¯å‹ç¼“å†²åŒºï¼ˆreplication backlogï¼‰</li>
<li>æœåŠ¡å™¨è¿è¡ŒIDï¼ˆrun IDï¼‰</li>
</ul>
<div class="note success">
            <p><strong>å¤åˆ¶åç§»é‡</strong></p>
          </div>
<p>æ‰§è¡Œå¤åˆ¶çš„åŒæ–¹â€”â€”ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨åˆ†åˆ«ç»´æŠ¤ç€ä¸€ä¸ªå¯¹åº”çš„å¤åˆ¶åç§»é‡ã€‚</p>
<ul>
<li>ä¸»æœåŠ¡å™¨æ¯æ¬¡å‘ä»æœåŠ¡å™¨ä¼ æ’­ N ä¸ªå­—èŠ‚çš„æ•°æ®æ—¶ï¼Œå°±å°†è‡ªå·±çš„å¤åˆ¶åç§»é‡çš„å€¼åŠ ä¸Š Nã€‚</li>
<li>ä»æœåŠ¡å™¨æ¯æ¬¡æ”¶åˆ°ä¸»æœåŠ¡å™¨ä¼ æ¥çš„ N ä¸ªå­—èŠ‚çš„æ•°æ®æ—¶ï¼Œä¹Ÿå°†è‡ªå·±çš„å¤åˆ¶åç§»é‡çš„å€¼åŠ ä¸Š Nã€‚</li>
</ul>
<p>é€šè¿‡å¯¹æ¯”ä¸»ä»æœåŠ¡å™¨çš„å¤åˆ¶åç§»é‡ï¼Œç¨‹åºå¾ˆå®¹æ˜“å°±èƒ½çŸ¥é“ä¸»ä»æœåŠ¡å™¨æ˜¯å¦å¤„äºåŒä¸€ä¸ªçŠ¶æ€ã€‚</p>
<ul>
<li>å¦‚æœä¸»ä»æœåŠ¡å™¨å¤„äºä¸€è‡´çš„çŠ¶æ€ï¼Œé‚£ä¹ˆä»–ä»¬çš„å¤åˆ¶åç§»é‡æ€»æ˜¯ç›¸åŒçš„ã€‚</li>
<li>ç›¸åï¼Œå¦‚æœä¸»ä»æœåŠ¡å™¨çš„å¤åˆ¶åç§»é‡ä¸ç›¸åŒï¼Œé‚£ä¹ˆä»–ä»¬å°±å¹¶æœªå¤„äºä¸€è‡´çš„çŠ¶æ€</li>
</ul>
<p><img src="https://z3.ax1x.com/2021/11/28/ouNngg.png" alt="image"></p>
<div class="note success">
            <p><strong>å¤åˆ¶ç§¯å‹ç¼“å†²åŒº</strong></p>
          </div>
<p>å¤åˆ¶ç§¯å‹ç¼“å†²åŒºæ˜¯ç”±ä¸»æœåŠ¡å™¨ç»´æŠ¤çš„ä¸€ä¸ªå›ºå®šé•¿åº¦ï¼ˆfixed-sizeï¼‰å…ˆè¿›å…ˆå‡ºçš„é˜Ÿåˆ—ï¼Œé»˜è®¤å¤§å°ä¸º1MBã€‚å›ºå®šé•¿åº¦çš„å…ˆå…¥å…ˆå‡ºé˜Ÿåˆ—ä¸èƒ½éšç€å…ƒç´ çš„å¢åŠ å’Œå‡å°‘è€ŒåŠ¨æ€çš„è°ƒæ•´é•¿åº¦ï¼Œå›ºå®šé•¿åº¦å…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œ<strong>å½“å…¥é˜Ÿå…ƒç´ çš„æ•°é‡å¤§äºé˜Ÿåˆ—é•¿åº¦æ—¶ï¼Œæœ€å…ˆå…¥é˜Ÿçš„å…ƒç´ ä¼šè¢«å¼¹å‡ºï¼Œè€Œæ–°å…ƒç´ ä¼šè¢«æ”¾å…¥é˜Ÿåˆ—</strong>ã€‚</p>
<p>å½“ä¸»æœåŠ¡å™¨è¿›è¡Œå‘½ä»¤ä¼ æ’­æ—¶ï¼Œå®ƒä¸ä»…ä¼šå°†å†™å‘½ä»¤å‘é€ç»™æ‰€æœ‰ä»æœåŠ¡å™¨ï¼Œè¿˜ä¼šé™æ‰€æœ‰å†™å‘½ä»¤å…¥é˜Ÿåˆ°å¤åˆ¶ç§¯å‹ç¼“å†²åŒºé‡Œé¢ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://z3.ax1x.com/2021/11/28/ouNUv4.png" alt="image"></p>
<p><strong>é‡è¿åŒæ­¥æµç¨‹ï¼š</strong></p>
<ol>
<li>å½“ä»æœåŠ¡å™¨A(ä¸Šå›¾ä¸ºä¾‹)æ–­çº¿é‡è¿åï¼Œå‘ä¸»æœåŠ¡å™¨å‘é€PSYNCå‘½ä»¤ï¼ŒæŠ¥å‘Šè‡ªå·±çš„åç§»é‡ä¸º10086ã€‚</li>
<li>ä¸»æœåŠ¡å™¨æ”¶åˆ°å‘½ä»¤åï¼Œæ£€æŸ¥åç§»é‡10086ä¹‹åçš„æ•°æ®æ˜¯å¦å­˜åœ¨äºå¤åˆ¶ç§¯å‹ç¼“å†²åŒºé‡Œã€‚å­˜åœ¨ï¼Œå‘æœåŠ¡å™¨å‘é€+CONTINUEå›å¤ï¼Œè¡¨ç¤ºæ•°æ®åŒæ­¥å°†ä»¥éƒ¨åˆ†é‡åŒæ­¥æ¨¡å¼è¿›è¡Œã€‚ï¼ˆä¸å­˜åœ¨ï¼Œä¸»æœåŠ¡å™¨å°†å¯¹ä»æœåŠ¡å™¨æ‰§è¡Œå®Œæ•´é‡åŒæ­¥æ“ä½œï¼‰ã€‚</li>
<li>ä¸»æœåŠ¡å™¨å°†å¤åˆ¶ç§¯å‹ç¼“å†²åŒº10086ä¹‹åçš„æ‰€æœ‰æ•°æ®å‘é€ç»™ä»æœåŠ¡å™¨ã€‚</li>
<li>ä»æœåŠ¡å™¨æ¥æ”¶ç¼ºå¤±æ•°æ®ï¼Œå›åˆ°ä¸ä¸»æœåŠ¡å™¨ä¸€è‡´çš„çŠ¶æ€ã€‚</li>
</ol>
<p>å› æ­¤ï¼Œä¸»æœåŠ¡å™¨çš„å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¼šå­˜æ”¾è¿‘æœŸä¼ æ’­è¿‡çš„å†™å‘½ä»¤ï¼Œå¹¶ä¸”<strong>å¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¼šä¸ºé˜Ÿåˆ—ä¸­çš„æ¯ä¸ªå­—èŠ‚è®°å½•å“åº”çš„å¤åˆ¶åç§»é‡</strong>ã€‚</p>
<p>å½“ä»æœåŠ¡å™¨é‡æ–°è¿æ¥ä¸Šä¸»æœåŠ¡å™¨æ—¶ï¼Œä»æœåŠ¡å™¨ä¼šé€šè¿‡ PSYNC å‘½ä»¤å°†è‡ªå·±çš„å¤åˆ¶åç§»é‡ offset å‘é€ç»™ä¸»æœåŠ¡å™¨ï¼Œä¸»æœåŠ¡å™¨ä¼šæ ¹æ®ä»æœåŠ¡å™¨çš„å¤åˆ¶åç§»é‡æ¥å†³å®šå¯¹ä»æœåŠ¡å™¨æ‰§è¡Œä½•ç§åŒæ­¥æ“ä½œã€‚</p>
<ul>
<li>å¦‚æœåç§»é‡ offset ä¹‹åçš„æ•°æ®ä»ç„¶å¤„äºå¤åˆ¶ç§¯å‹ç¼“å†²åŒºé‡Œï¼Œé‚£ä¹ˆä¸»æœåŠ¡å™¨å°†ä¼šå¯¹ä»æœåŠ¡å™¨æ‰§è¡Œéƒ¨åˆ†åŒæ­¥æ“ä½œï¼ˆå¢é‡å¤åˆ¶ï¼‰ã€‚</li>
<li>å¦‚æœåç§»é‡ offset ä¹‹åçš„æ•°æ®å·²ç»ä¸å­˜åœ¨äºå¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¸­ï¼Œé‚£ä¹ˆä¸»æœåŠ¡å™¨å°†ä¼šå¯¹ä»æœåŠ¡å™¨æ‰§è¡Œå®Œæ•´åŒæ­¥æ“ä½œï¼ˆå…¨é‡å¤åˆ¶ï¼‰ã€‚</li>
</ul>
<div class="note success">
            <p><strong>æœåŠ¡å™¨è¿è¡Œ ID</strong></p>
          </div>
<p>é™¤äº†å¤åˆ¶åç§»é‡å’Œå¤åˆ¶ç§¯å‹ç¼“å†²åŒºä¹‹å¤–ï¼Œæ˜¯éƒ¨åˆ†é‡åŒæ­¥è¿˜éœ€è¦ç”¨åˆ°æœåŠ¡å™¨ IDï¼š</p>
<ul>
<li>æ¯ä¸ª Redis æœåŠ¡å™¨ï¼Œä¸è®ºæ˜¯ä¸»æœåŠ¡å™¨è¿˜æ˜¯ä»æœåŠ¡å™¨ï¼Œéƒ½ä¼šæœ‰è‡ªå·±çš„è¿è¡Œ ID</li>
<li>è¿è¡Œ ID åœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶è‡ªåŠ¨ç”Ÿæˆï¼Œç”±40ä¸ªéšæœºçš„åå…­è¿›åˆ¶åœ°åºœç»„æˆ</li>
</ul>
<p>å½“ä»æœåŠ¡å™¨å¯¹ä¸»æœåŠ¡å™¨è¿›è¡Œåˆæ¬¡å¤åˆ¶æ—¶ï¼Œä¸»æœåŠ¡å™¨ä¼šå°†è‡ªå·±çš„è¿è¡Œ ID ä¼ é€’ç»™ä»æœåŠ¡å™¨ï¼Œä»æœåŠ¡å™¨åˆ™ä¼šå°†è¿™ä¸ªè¿è¡Œ ID ä¿å­˜èµ·æ¥ã€‚å½“ä»æœåŠ¡å™¨æ–­çº¿å¹¶é‡æ–°è¿æ¥åˆ°ä¸»æœåŠ¡å™¨æ—¶ï¼Œä»æœåŠ¡å™¨å°±ä¼šæ¯”å¯¹ä¹‹å‰è¿æ¥çš„ä¸»æœåŠ¡å™¨çš„è¿è¡Œ IDï¼š</p>
<ul>
<li>å¦‚æœä»æœåŠ¡å™¨ä¿å­˜çš„è¿è¡Œ ID å’Œå½“å‰è¿æ¥çš„ä¸»æœåŠ¡å™¨çš„è¿è¡Œ ID ä¸€è‡´ï¼Œè¯´æ˜ä»æœåŠ¡å™¨ç°åœ¨ä¸ä¹‹å‰è¿æ¥çš„ä¸»æœåŠ¡å™¨éƒ½æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä¸»æœåŠ¡å™¨å¯ä»¥ç»§ç»­å°è¯•æ‰§è¡Œéƒ¨åˆ†é‡åŒæ­¥çš„æ“ä½œã€‚</li>
<li>å¦‚æœä»æœåŠ¡å™¨ä¿å­˜çš„è¿è¡Œ ID å’Œå½“å‰è¿æ¥çš„ä¸»æœåŠ¡å™¨çš„è¿è¡Œ ID ä¸ä¸€è‡´ï¼Œè¯´æ˜åœ¨ä»æœåŠ¡å™¨æ–­è¿çš„è¿™ä¸€æ®µæ—¶é—´é‡Œï¼Œå·²ç»æ›´æ¢äº†ä¸€ä¸ªä¸»æœåŠ¡å™¨ï¼Œç°åœ¨çš„ä¸»æœåŠ¡å™¨éœ€è¦å¯¹ä»æœåŠ¡å™¨æ‰§è¡Œå®Œæ•´çš„é‡åŒæ­¥æ“ä½œã€‚</li>
</ul>
<div class="note success">
            <p><strong>PSYNC å‘½ä»¤çš„å®ç°</strong></p>
          </div>
<p>PSYNC å‘½ä»¤çš„è°ƒç”¨æ–¹å¼æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li>å¦‚æœä»æœåŠ¡å™¨ä¹‹å‰ä»æ¥æ²¡æœ‰å¤åˆ¶è¿‡ä»»ä½•ä¸»æœåŠ¡å™¨ï¼Œæˆ–è€…ä¹‹å‰æ²¡æœ‰æ‰§è¡Œè¿‡ <code>slaveof no one</code> å‘½ä»¤ï¼Œé‚£ä¹ˆä»æœåŠ¡å™¨åˆ™ä¼šå‘ä¸»æœåŠ¡å™¨å‘é€ PSYNC? -1å‘½ä»¤ï¼Œä¸»åŠ¨è¯·æ±‚æœåŠ¡å™¨è¿›è¡Œå®Œæ•´é‡åŒæ­¥</li>
<li>ç›¸åçš„ï¼Œå¦‚æœä»æœåŠ¡å™¨å·²ç»å¤åˆ¶è¿‡æŸä¸ªä¸»æœåŠ¡å™¨ï¼Œé‚£ä¹ˆä»æœåŠ¡å™¨åœ¨å¼€å§‹ä¸€æ¬¡æ–°çš„å¤åˆ¶æ—¶ï¼Œå°†å‘ä¸»æœåŠ¡å™¨å‘é€ PSYNC runid offset å‘½ä»¤ï¼šå…¶ä¸­ runid æ˜¯ä¸Šä¸€æ¬¡å¤åˆ¶çš„ä¸»æœåŠ¡å™¨çš„è¿è¡Œ IDï¼Œè€Œ offset åˆ™æ˜¯ä»æœåŠ¡å™¨å½“å‰çš„å¤åˆ¶åç§»é‡ï¼Œæ¥æ”¶åˆ°è¿™ä¸ªå‘½ä»¤çš„ä¸»æœåŠ¡å™¨ä¼šæ ¹æ®è¿™ä¸¤ä¸ªå‚æ•°æ¥åˆ¤æ–­å¯¹è¯¥ä»æœåŠ¡å™¨æ‰§è¡Œå“ªå„¿ä¸­åŒæ­¥æ“ä½œã€‚<ul>
<li>å¦‚æœä¸»æœåŠ¡å™¨è¿”å› <code>+FULLRESYNC &lt;runid&gt; &lt;offset&gt;</code>ï¼Œé‚£ä¹ˆåˆ™è¡¨ç¤ºä¸»æœåŠ¡å™¨å°†ä¸ä»æœåŠ¡å™¨è¿›è¡Œå®Œæ•´é‡åŒæ­¥ï¼š å…¶ä¸­ runid æ˜¯å½“å‰ä¸»æœåŠ¡å™¨çš„è¿è¡Œ IDï¼Œä»æœåŠ¡å™¨éœ€å°†è¿™ä¸ª ID ä¿å­˜èµ·æ¥ï¼Œå†ä¸‹ä¸€æ¬¡å‘é€ PASYNC æ—¶ä½¿ç”¨ï¼›è€Œ offset åˆ™æ˜¯å½“å‰ä¸»æœåŠ¡å™¨çš„å¤åˆ¶åç§»é‡ï¼Œè€Œä»æœåŠ¡å™¨åˆ™ä¼šå°†è¿™ä¸ªå€¼ä½œä¸ºè‡ªå·±çš„åˆå§‹åŒ–å¤åˆ¶åç§»é‡ã€‚</li>
<li>å¦‚æœä¸»æœåŠ¡å™¨è¿”å› <code>+Continue</code>ï¼Œé‚£ä¹ˆè¡¨ç¤ºä¸»æœåŠ¡å™¨å°†ä¸ä»æœåŠ¡å™¨è¿›è¡Œéƒ¨åˆ†é‡åŒæ­¥æ“ä½œï¼Œä»æœåŠ¡å™¨åªè¦ç­‰ç€ä¸»æœåŠ¡å™¨å°†è‡ªå·±ç¼ºå°‘çš„é‚£éƒ¨åˆ†æ•°æ®å‘é€è¿‡æ¥å³å¯ï¼</li>
<li>å¦‚æœä¸»æœåŠ¡å™¨è¿”å› <code>-ERR</code>ï¼Œè¡¨ç¤ºå½“å‰çš„ä¸»æœåŠ¡å™¨ç‰ˆæœ¬ä½äº2.8ï¼Œå®ƒè¯†åˆ«ä¸äº† PSYNC å‘½ä»¤ï¼Œä»æœåŠ¡å™¨å°†å‘ä¸»æœåŠ¡å™¨å‘é€ SYNC å‘½ä»¤ï¼Œå¹¶ä¸”ä¸ä¸»æœåŠ¡å™¨æ‰§è¡Œå®Œå…¨é‡åŒæ­¥æ“ä½œã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://z3.ax1x.com/2021/11/28/ouNIat.png" alt=""></p>
<div class="note success">
            <p><strong>å¿ƒè·³æ£€æµ‹</strong></p>
          </div>
<p>åœ¨å‘½ä»¤ä¼ æ’­é˜¶æ®µï¼Œä»æœåŠ¡å™¨é»˜è®¤ä¼šä»¥æ¯ç§’ä¸€æ¬¡çš„é¢‘ç‡ã€‚åƒä¸»æœåŠ¡å™¨å‘é€å‘½ä»¤ï¼š<code>REPLCONF ACK &lt;offset&gt;</code>ï¼Œå…¶ä¸­ <code>offset</code> æ˜¯ä»æœåŠ¡å™¨å½“å‰çš„å¤åˆ¶åç§»é‡ã€‚</p>
<p>ä½œç”¨ï¼š</p>
<ul>
<li><p>æ£€æµ‹ ä¸»ä»æœåŠ¡å™¨çš„ç½‘ç»œè¿æ¥çŠ¶æ€</p>
</li>
<li><p>è¾…åŠ©å®ç° <strong>min-slaves</strong> é€‰é¡¹ï¼Œmin-slaves-to-write å’Œ min-slaves-max-lag éƒ½æ˜¯ä¸ºäº†é˜²æ­¢ä¸»æœåŠ¡å™¨åœ¨ä¸å®‰å…¨çš„æƒ…å†µä¸‹æ‰§è¡Œå†™å‘½ä»¤ã€‚</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="code"><pre><span class="line">min-slaves-to-write 3</span><br><span class="line">min-slaves-max-lag 10</span><br></pre></td></tr></tbody></table></figure>
<p>åœ¨ä»æœåŠ¡å™¨æ•°é‡å°äº3ä¸ªï¼Œæˆ–è€…ä¸‰ä¸ªä»æœåŠ¡å™¨çš„å»¶è¿Ÿå€¼ï¼ˆæœ€åä¸€æ¬¡å¿ƒè·³æ£€æµ‹è·ç¦»ç°åœ¨è¿‡äº†å¤šå°‘ç§’ï¼‰éƒ½å¤§äºç­‰äºåç§’æ—¶ï¼Œä¸»æœåŠ¡å™¨å°†æ‹’ç»æ‰§è¡Œå†™å‘½ä»¤ã€‚</p>
</li>
<li><p>æ£€æµ‹å‘½ä»¤ä¸¢å¤±ã€‚åç§»é‡ä¸ä¸€è‡´æ—¶ï¼Œä¼šè¿›è¡Œè¡¥å‘ç¼ºå¤±æ•°æ®çš„æ“ä½œã€‚</p>
</li>
</ul>
<p><br></p>
<h4 id="11-7ã€å“¨å…µæ¨¡å¼ï¼ˆSentinelï¼‰ã€æ¨èã€‘"><a href="#11-7ã€å“¨å…µæ¨¡å¼ï¼ˆSentinelï¼‰ã€æ¨èã€‘" class="headerlink" title="11.7ã€å“¨å…µæ¨¡å¼ï¼ˆSentinelï¼‰ã€æ¨èã€‘"></a>11.7ã€å“¨å…µæ¨¡å¼ï¼ˆSentinelï¼‰ã€æ¨èã€‘</h4><p>ä¸Šè¿°ä¸»ä»åˆ‡æ¢æŠ€æœ¯çš„æ–¹æ³•ï¼Œä¸»è¦æ˜¯é€šè¿‡åœ¨ä¸»æœåŠ¡å™¨å®•æœºçš„æ—¶å€™ï¼Œäººå·¥æ‰‹åŠ¨åœ°å°†æŸå°ä»æœåŠ¡å™¨åˆ‡æ¢æˆä¸»æœåŠ¡å™¨ï¼Œå†å°†å…¶ä½™çš„ä»æœåŠ¡å™¨éƒ½é…ç½®æˆå®ƒçš„ slaverã€‚<strong>è¿™æ•´ä¸€ä¸ªè¿‡ç¨‹éœ€è¦äººå·¥å¹²é¢„ï¼Œè´¹æ—¶åˆè´¹åŠ›ï¼Œè¿˜ä¼šé€ æˆä¸€æ®µæ—¶é—´å†…çš„æœåŠ¡ä¸å¯ç”¨</strong>ã€‚ä¸æ¨èï¼</p>
<p>å› æ­¤å°±æœ‰äº†<strong>å“¨å…µæ¨¡å¼</strong>ã€‚</p>
<div class="note success">
            <p><strong>ä»€ä¹ˆæ˜¯å“¨å…µæ¨¡å¼ï¼Ÿ</strong></p>
          </div>
<p>å“¨å…µæ¨¡å¼æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¨¡å¼ï¼Œé¦–å…ˆRedisæä¾›äº†å“¨å…µçš„å‘½ä»¤ï¼Œå“¨å…µæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä½œä¸ºè¿›ç¨‹ï¼Œå®ƒä¼šç‹¬ç«‹è¿è¡Œã€‚å…¶åŸç†æ˜¯<strong>å“¨å…µé€šè¿‡å‘é€å‘½ä»¤ï¼Œç­‰å¾…RedisæœåŠ¡å™¨å“åº”ï¼Œä»è€Œç›‘æ§è¿è¡Œçš„å¤šä¸ªRediså®ä¾‹ã€‚</strong></p>
<p><img src="https://z3.ax1x.com/2021/11/28/oucAVU.png" alt="image"></p>
<p>è¿™é‡Œå“¨å…µæœ‰ä¸‰ä¸ªä½œç”¨ï¼š</p>
<ul>
<li><strong>ç›‘æ§ï¼ˆMonitoringï¼‰</strong>ï¼šSentinel ä¼šä¸æ–­æ£€æŸ¥ä½ çš„ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚</li>
<li><strong>æé†’ï¼ˆNotificationï¼‰</strong>ï¼šå½“è¢«ç›‘æ§çš„æŸä¸ª Redis æœåŠ¡å™¨å‡ºç°é—®é¢˜æ—¶ï¼ŒSentinel å¯ä»¥é€šè¿‡ API å‘ç®¡ç†å‘˜æˆ–è€…å…¶ä»–åº”ç”¨ç¨‹åºå‘é€é€šçŸ¥ã€‚</li>
<li><strong>è‡ªåŠ¨æ•…éšœè¿ç§»ï¼ˆAutomotic failoverï¼‰</strong>ï¼šå½“ä¸€ä¸ªä¸»æœåŠ¡å™¨ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼ŒSentinel ä¼šå¼€å§‹ä¸€æ¬¡è‡ªåŠ¨æ•…éšœè¿ç§»æ“ä½œï¼Œå®ƒä¼šå°†å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶ä¸­ä¸€ä¸ªä»æœåŠ¡å™¨å‡çº§ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œå¹¶è®©å¤±æ•ˆä¸»æœåŠ¡å™¨çš„å…¶å®ƒä»æœåŠ¡å™¨ä¹Ÿæ”¹ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨çš„ä»æœåŠ¡å™¨ã€‚è€Œå½“å®¢æˆ·ç«¯è¯•å›¾è¿æ¥å¤±æ•ˆçš„ä¸»æœåŠ¡å™¨æ—¶ï¼Œé›†ç¾¤ä¹Ÿä¼šå‘å®¢æˆ·ç«¯è¿”å›æ–°ä¸»æœåŠ¡å™¨çš„åœ°å€ï¼Œä½¿å¾—é›†ç¾¤å¯ä»¥ä½¿ç”¨æ–°ä¸»æœåŠ¡å™¨æ¥ä»£æ›¿å¤±æ•ˆçš„æœåŠ¡å™¨ã€‚</li>
</ul>
<p>è¯¶ï¼Œå¯æ˜¯å¦‚æœè¿™ä¸ªå“¨å…µè¿›ç¨‹å®•æœºäº†ï¼Œæ•´ä¸ªç³»ç»Ÿä¸å°±å´©ç›˜äº†å—ï¼Ÿ</p>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªå“¨å…µè¿›è¡Œç›‘æ§ã€‚å„ä¸ªå“¨å…µä¹‹é—´ä¹Ÿä¼šäº’ç›¸ç›‘æ§ï¼Œè¿™æ ·å°±å½¢æˆäº†å¤šå“¨å…µæ¨¡å¼ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/28/ougD61.png" alt="image"></p>
<p>è¿™é‡Œç®€å•ç”¨æ–‡å­—æè¿°ä¸€ä¸‹<strong>æ•…éšœåˆ‡æ¢ï¼ˆfailoverï¼‰</strong>çš„è¿‡ç¨‹ã€‚</p>
<p>å‡è®¾ä¸»æœåŠ¡å™¨å®•æœºï¼Œå“¨å…µ1å…ˆæ£€æµ‹åˆ°è¿™ä¸ªç»“æœï¼Œç³»ç»Ÿå¹¶ä¸ä¼šé©¬ä¸Šè¿›è¡Œ failover è¿‡ç¨‹ï¼Œä»…ä»…æ˜¯å“¨å…µ1ä¸»è§‚åœ°è®¤ä¸ºä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œè¿™ä¸ªç°è±¡è¢«ç§°ä¸º<strong>ä¸»è§‚ä¸‹çº¿</strong>ã€‚å½“åé¢çš„å“¨å…µä¹Ÿæ£€æµ‹åˆ°ä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œå¹¶ä¸”æ•°é‡è¾¾åˆ°ä¸€å®šå€¼æ—¶ï¼Œé‚£ä¹ˆå“¨å…µä¹‹é—´å°±è¡Œè¿›è¡Œä¸€æ¬¡æŠ•ç¥¨ï¼ŒæŠ•ç¥¨çš„ç»“æœç”±ä¸€ä¸ªå“¨å…µå‘èµ·ï¼Œè¿›è¡Œ failover æ“ä½œã€‚åˆ‡æ¢æˆåŠŸåï¼Œå°±ä¼šé€šè¿‡å‘å¸ƒè®¢é˜…çš„æ–¹å¼ï¼Œè®©å„ä¸ªå“¨å…µæŠŠè‡ªå·±ç›‘æ§çš„ä»æœåŠ¡å™¨å®ç°åˆ‡æ¢ä¸»æœºï¼Œåœ¨ä¸ªè¿‡ç¨‹æˆä¸º<strong>å®¢è§‚ä¸‹çº¿</strong>ï¼Œè¿™æ ·å¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œä¸€åˆ‡éƒ½æ˜¯é€æ˜çš„ã€‚</p>
<div class="note success">
            <p><strong>æ¯ä¸ª Sentinel éƒ½éœ€è¦å®šæœŸæ‰§è¡Œçš„ä»»åŠ¡</strong></p>
          </div>
<ul>
<li>æ¯ä¸ª Sentinel ä»¥æ¯ç§’é’Ÿä¸€æ¬¡çš„é¢‘ç‡å‘å®ƒæ‰€çŸ¥çš„ä¸»æœåŠ¡å™¨ã€ä»æœåŠ¡å™¨ä»¥åŠå…¶ä»– Sentinel å®ä¾‹å‘é€ä¸€ä¸ª PING å‘½ä»¤ã€‚</li>
<li>å¦‚æœä¸€ä¸ªå®ä¾‹ï¼ˆinstanceï¼‰è·ç¦»æœ€åä¸€æ¬¡æœ‰æ•ˆå›å¤ PING å‘½ä»¤çš„æ—¶é—´è¶…è¿‡ down-after-milliseconds é€‰é¡¹æ‰€æŒ‡å®šçš„å€¼ï¼Œ é‚£ä¹ˆè¿™ä¸ªå®ä¾‹ä¼šè¢« Sentinel æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ã€‚ ä¸€ä¸ªæœ‰æ•ˆå›å¤å¯ä»¥æ˜¯ï¼š +PONG ã€ -LOADING æˆ–è€… -MASTERDOWN ã€‚</li>
<li>å¦‚æœä¸€ä¸ªä¸»æœåŠ¡å™¨è¢«æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ï¼Œ é‚£ä¹ˆæ­£åœ¨ç›‘è§†è¿™ä¸ªä¸»æœåŠ¡å™¨çš„æ‰€æœ‰ Sentinel è¦ä»¥æ¯ç§’ä¸€æ¬¡çš„é¢‘ç‡ç¡®è®¤ä¸»æœåŠ¡å™¨çš„ç¡®è¿›å…¥äº†ä¸»è§‚ä¸‹çº¿çŠ¶æ€ã€‚</li>
<li>å¦‚æœä¸€ä¸ªä¸»æœåŠ¡å™¨è¢«æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ï¼Œ å¹¶ä¸”æœ‰è¶³å¤Ÿæ•°é‡çš„ Sentinel ï¼ˆè‡³å°‘è¦è¾¾åˆ°é…ç½®æ–‡ä»¶æŒ‡å®šçš„æ•°é‡ï¼‰åœ¨æŒ‡å®šçš„æ—¶é—´èŒƒå›´å†…åŒæ„è¿™ä¸€åˆ¤æ–­ï¼Œ é‚£ä¹ˆè¿™ä¸ªä¸»æœåŠ¡å™¨è¢«æ ‡è®°ä¸ºå®¢è§‚ä¸‹çº¿ã€‚</li>
<li>åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ æ¯ä¸ª Sentinel ä¼šä»¥æ¯ 10 ç§’ä¸€æ¬¡çš„é¢‘ç‡å‘å®ƒå·²çŸ¥çš„æ‰€æœ‰ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨å‘é€ INFO å‘½ä»¤ã€‚ å½“ä¸€ä¸ªä¸»æœåŠ¡å™¨è¢« Sentinel æ ‡è®°ä¸ºå®¢è§‚ä¸‹çº¿æ—¶ï¼Œ Sentinel å‘ä¸‹çº¿ä¸»æœåŠ¡å™¨çš„æ‰€æœ‰ä»æœåŠ¡å™¨å‘é€ INFO å‘½ä»¤çš„é¢‘ç‡ä¼šä» 10 ç§’ä¸€æ¬¡æ”¹ä¸ºæ¯ç§’ä¸€æ¬¡ã€‚</li>
<li>å½“æ²¡æœ‰è¶³å¤Ÿæ•°é‡çš„ Sentinel åŒæ„ä¸»æœåŠ¡å™¨å·²ç»ä¸‹çº¿ï¼Œ ä¸»æœåŠ¡å™¨çš„å®¢è§‚ä¸‹çº¿çŠ¶æ€å°±ä¼šè¢«ç§»é™¤ã€‚ å½“ä¸»æœåŠ¡å™¨é‡æ–°å‘ Sentinel çš„ PING å‘½ä»¤è¿”å›æœ‰æ•ˆå›å¤æ—¶ï¼Œ ä¸»æœåŠ¡å™¨çš„ä¸»è§‚ä¸‹çº¿çŠ¶æ€å°±ä¼šè¢«ç§»é™¤ã€‚</li>
</ul>
<div class="note success">
            <p><strong>è‡ªåŠ¨å‘ç° Sentinel å’Œä»æœåŠ¡å™¨</strong></p>
          </div>
<p>ä¸€ä¸ª Sentinel å¯ä»¥ä¸å…¶ä»–å¤šä¸ª Sentinel è¿›è¡Œè¿æ¥ï¼Œ å„ä¸ª Sentinel ä¹‹é—´å¯ä»¥äº’ç›¸æ£€æŸ¥å¯¹æ–¹çš„å¯ç”¨æ€§ï¼Œ å¹¶è¿›è¡Œä¿¡æ¯äº¤æ¢ã€‚</p>
<p>ä½ æ— é¡»ä¸ºè¿è¡Œçš„æ¯ä¸ª Sentinel åˆ†åˆ«è®¾ç½®å…¶ä»– Sentinel çš„åœ°å€ï¼Œ å› ä¸º Sentinel å¯ä»¥é€šè¿‡å‘å¸ƒä¸è®¢é˜…åŠŸèƒ½æ¥è‡ªåŠ¨å‘ç°æ­£åœ¨ç›‘è§†ç›¸åŒä¸»æœåŠ¡å™¨çš„å…¶ä»– Sentinel ï¼Œ è¿™ä¸€åŠŸèƒ½æ˜¯é€šè¿‡å‘é¢‘é“ <strong>sentinel:hello</strong> å‘é€ä¿¡æ¯æ¥å®ç°çš„ã€‚</p>
<p>ä¸æ­¤ç±»ä¼¼ï¼Œ ä½ ä¹Ÿä¸å¿…æ‰‹åŠ¨åˆ—å‡ºä¸»æœåŠ¡å™¨å±ä¸‹çš„æ‰€æœ‰ä»æœåŠ¡å™¨ï¼Œ å› ä¸º Sentinel å¯ä»¥é€šè¿‡è¯¢é—®ä¸»æœåŠ¡å™¨æ¥è·å¾—æ‰€æœ‰ä»æœåŠ¡å™¨çš„ä¿¡æ¯ã€‚</p>
<ul>
<li>æ¯ä¸ª Sentinel ä¼šä»¥æ¯ä¸¤ç§’ä¸€æ¬¡çš„é¢‘ç‡ï¼Œ é€šè¿‡å‘å¸ƒä¸è®¢é˜…åŠŸèƒ½ï¼Œ å‘è¢«å®ƒç›‘è§†çš„æ‰€æœ‰ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨çš„ <strong>sentinel:hello</strong> é¢‘é“å‘é€ä¸€æ¡ä¿¡æ¯ï¼Œ ä¿¡æ¯ä¸­åŒ…å«äº† Sentinel çš„ IP åœ°å€ã€ç«¯å£å·å’Œè¿è¡Œ ID ï¼ˆrunidï¼‰ã€‚</li>
<li>æ¯ä¸ª Sentinel éƒ½è®¢é˜…äº†è¢«å®ƒç›‘è§†çš„æ‰€æœ‰ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨çš„ <strong>sentinel:hello</strong> é¢‘é“ï¼Œ æŸ¥æ‰¾ä¹‹å‰æœªå‡ºç°è¿‡çš„ sentinel ï¼ˆlooking for unknown sentinelsï¼‰ã€‚ å½“ä¸€ä¸ª Sentinel å‘ç°ä¸€ä¸ªæ–°çš„ Sentinel æ—¶ï¼Œ å®ƒä¼šå°†æ–°çš„ Sentinel æ·»åŠ åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œ è¿™ä¸ªåˆ—è¡¨ä¿å­˜äº† Sentinel å·²çŸ¥çš„ï¼Œ ç›‘è§†åŒä¸€ä¸ªä¸»æœåŠ¡å™¨çš„æ‰€æœ‰å…¶ä»– Sentinel ã€‚</li>
<li>Sentinel å‘é€çš„ä¿¡æ¯ä¸­è¿˜åŒ…æ‹¬å®Œæ•´çš„ä¸»æœåŠ¡å™¨å½“å‰é…ç½®ï¼ˆconfigurationï¼‰ã€‚ å¦‚æœä¸€ä¸ª Sentinel åŒ…å«çš„ä¸»æœåŠ¡å™¨é…ç½®æ¯”å¦ä¸€ä¸ª Sentinel å‘é€çš„é…ç½®è¦æ—§ï¼Œ é‚£ä¹ˆè¿™ä¸ª Sentinel ä¼šç«‹å³å‡çº§åˆ°æ–°é…ç½®ä¸Šã€‚</li>
<li>åœ¨å°†ä¸€ä¸ªæ–° Sentinel æ·»åŠ åˆ°ç›‘è§†ä¸»æœåŠ¡å™¨çš„åˆ—è¡¨ä¸Šé¢ä¹‹å‰ï¼Œ Sentinel ä¼šå…ˆæ£€æŸ¥åˆ—è¡¨ä¸­æ˜¯å¦å·²ç»åŒ…å«äº†å’Œè¦æ·»åŠ çš„ Sentinel æ‹¥æœ‰ç›¸åŒè¿è¡Œ ID æˆ–è€…ç›¸åŒåœ°å€ï¼ˆåŒ…æ‹¬ IP åœ°å€å’Œç«¯å£å·ï¼‰çš„ Sentinel ï¼Œ å¦‚æœæ˜¯çš„è¯ï¼Œ Sentinel ä¼šå…ˆç§»é™¤åˆ—è¡¨ä¸­å·²æœ‰çš„é‚£äº›æ‹¥æœ‰ç›¸åŒè¿è¡Œ ID æˆ–è€…ç›¸åŒåœ°å€çš„ Sentinel ï¼Œ ç„¶åå†æ·»åŠ æ–° Sentinel ã€‚</li>
</ul>
<div class="note success">
            <p><strong>æ•…éšœè½¬ç§»</strong></p>
          </div>
<p>ä¸€æ¬¡æ•…éšœè½¬ç§»æ“ä½œç”±ä»¥ä¸‹æ­¥éª¤ç»„æˆï¼š</p>
<ul>
<li>å‘ç°ä¸»æœåŠ¡å™¨å·²ç»è¿›å…¥å®¢è§‚ä¸‹çº¿çŠ¶æ€ã€‚</li>
<li>å¯¹æˆ‘ä»¬çš„å½“å‰çºªå…ƒè¿›è¡Œè‡ªå¢ï¼ˆè¯¦æƒ…è¯·å‚è€ƒ Raft leader election ï¼‰ï¼Œ å¹¶å°è¯•åœ¨è¿™ä¸ªçºªå…ƒä¸­å½“é€‰ã€‚</li>
<li>å¦‚æœå½“é€‰å¤±è´¥ï¼Œ é‚£ä¹ˆåœ¨è®¾å®šçš„æ•…éšœè¿ç§»è¶…æ—¶æ—¶é—´çš„ä¸¤å€ä¹‹åï¼Œ é‡æ–°å°è¯•å½“é€‰ã€‚ å¦‚æœå½“é€‰æˆåŠŸï¼Œ é‚£ä¹ˆæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ã€‚</li>
<li>é€‰å‡ºä¸€ä¸ªä»æœåŠ¡å™¨ï¼Œå¹¶å°†å®ƒå‡çº§ä¸ºä¸»æœåŠ¡å™¨ã€‚</li>
<li>å‘è¢«é€‰ä¸­çš„ä»æœåŠ¡å™¨å‘é€ <code>SLAVEOF NO ONE</code> å‘½ä»¤ï¼Œè®©å®ƒè½¬å˜ä¸ºä¸»æœåŠ¡å™¨ã€‚</li>
<li>é€šè¿‡å‘å¸ƒä¸è®¢é˜…åŠŸèƒ½ï¼Œ å°†æ›´æ–°åçš„é…ç½®ä¼ æ’­ç»™æ‰€æœ‰å…¶ä»– Sentinel ï¼Œ å…¶ä»– Sentinel å¯¹å®ƒä»¬è‡ªå·±çš„é…ç½®è¿›è¡Œæ›´æ–°ã€‚</li>
<li>å‘å·²ä¸‹çº¿ä¸»æœåŠ¡å™¨çš„ä»æœåŠ¡å™¨å‘é€ <strong>SLAVEOF</strong> å‘½ä»¤ï¼Œ è®©å®ƒä»¬å»è·Ÿéšæ–°çš„ä¸»æœåŠ¡å™¨ã€‚</li>
<li>å½“æ‰€æœ‰ä»æœåŠ¡å™¨éƒ½å·²ç»å¼€å§‹è·Ÿéšæ–°çš„ä¸»æœåŠ¡å™¨æ—¶ï¼Œ é¢†å¤´ Sentinel ç»ˆæ­¢è¿™æ¬¡æ•…éšœè¿ç§»æ“ä½œã€‚</li>
</ul>
<p>æ¯å½“ä¸€ä¸ª Redis å®ä¾‹è¢«é‡æ–°é…ç½®ï¼ˆreconfiguredï¼‰ â€”â€” æ— è®ºæ˜¯è¢«è®¾ç½®æˆä¸»æœåŠ¡å™¨ã€ä»æœåŠ¡å™¨ã€åˆæˆ–è€…è¢«è®¾ç½®æˆå…¶ä»–ä¸»æœåŠ¡å™¨çš„ä»æœåŠ¡å™¨ â€”â€” Sentinel éƒ½ä¼šå‘è¢«é‡æ–°é…ç½®çš„å®ä¾‹å‘é€ä¸€ä¸ª CONFIG REWRITE å‘½ä»¤ï¼Œ ä»è€Œç¡®ä¿è¿™äº›é…ç½®ä¼šæŒä¹…åŒ–åœ¨ç¡¬ç›˜é‡Œã€‚</p>
<p>Sentinel ä½¿ç”¨ä»¥ä¸‹è§„åˆ™æ¥é€‰æ‹©æ–°çš„ä¸»æœåŠ¡å™¨ï¼š</p>
<ul>
<li>åœ¨å¤±æ•ˆä¸»æœåŠ¡å™¨å±ä¸‹çš„ä»æœåŠ¡å™¨å½“ä¸­ï¼Œ é‚£äº›è¢«æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ã€å·²æ–­çº¿ã€æˆ–è€…æœ€åä¸€æ¬¡å›å¤ PING å‘½ä»¤çš„æ—¶é—´å¤§äºäº”ç§’é’Ÿçš„ä»æœåŠ¡å™¨éƒ½ä¼šè¢«æ·˜æ±°ã€‚</li>
<li>åœ¨å¤±æ•ˆä¸»æœåŠ¡å™¨å±ä¸‹çš„ä»æœåŠ¡å™¨å½“ä¸­ï¼Œ é‚£äº›ä¸å¤±æ•ˆä¸»æœåŠ¡å™¨è¿æ¥æ–­å¼€çš„æ—¶é•¿è¶…è¿‡ down-after é€‰é¡¹æŒ‡å®šçš„æ—¶é•¿åå€çš„ä»æœåŠ¡å™¨éƒ½ä¼šè¢«æ·˜æ±°ã€‚</li>
<li>åœ¨ç»å†äº†ä»¥ä¸Šä¸¤è½®æ·˜æ±°ä¹‹åå‰©ä¸‹æ¥çš„ä»æœåŠ¡å™¨ä¸­ï¼Œ æˆ‘ä»¬é€‰å‡ºå¤åˆ¶åç§»é‡ï¼ˆreplication offsetï¼‰æœ€å¤§çš„é‚£ä¸ªä»æœåŠ¡å™¨ä½œä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼› å¦‚æœå¤åˆ¶åç§»é‡ä¸å¯ç”¨ï¼Œ æˆ–è€…ä»æœåŠ¡å™¨çš„å¤åˆ¶åç§»é‡ç›¸åŒï¼Œ é‚£ä¹ˆå¸¦æœ‰æœ€å°è¿è¡Œ ID çš„é‚£ä¸ªä»æœåŠ¡å™¨æˆä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ã€‚</li>
</ul>
<div class="note success">
            <p><strong>Sentinel è‡ªåŠ¨æ•…éšœè¿ç§»çš„ä¸€è‡´æ€§ç‰¹è´¨</strong></p>
          </div>
<p>Sentinel è‡ªåŠ¨æ•…éšœè¿ç§»ä½¿ç”¨ Raft ç®—æ³•æ¥é€‰ä¸¾é¢†å¤´ï¼ˆleaderï¼‰ Sentinel ï¼Œ ä»è€Œç¡®ä¿åœ¨ä¸€ä¸ªç»™å®šçš„çºªå…ƒï¼ˆepochï¼‰é‡Œï¼Œ åªæœ‰ä¸€ä¸ªé¢†å¤´äº§ç”Ÿã€‚</p>
<p>è¿™è¡¨ç¤ºåœ¨åŒä¸€ä¸ªçºªå…ƒä¸­ï¼Œ ä¸ä¼šæœ‰ä¸¤ä¸ª Sentinel åŒæ—¶è¢«é€‰ä¸­ä¸ºé¢†å¤´ï¼Œ å¹¶ä¸”å„ä¸ª Sentinel åœ¨åŒä¸€ä¸ªçºªå…ƒä¸­åªä¼šå¯¹ä¸€ä¸ªé¢†å¤´è¿›è¡ŒæŠ•ç¥¨ã€‚</p>
<p>æ›´é«˜çš„é…ç½®çºªå…ƒæ€»æ˜¯ä¼˜äºè¾ƒä½çš„çºªå…ƒï¼Œ å› æ­¤æ¯ä¸ª Sentinel éƒ½ä¼šä¸»åŠ¨ä½¿ç”¨æ›´æ–°çš„çºªå…ƒæ¥ä»£æ›¿è‡ªå·±çš„é…ç½®ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œ æˆ‘ä»¬å¯ä»¥å°† Sentinel é…ç½®çœ‹ä½œæ˜¯ä¸€ä¸ªå¸¦æœ‰ç‰ˆæœ¬å·çš„çŠ¶æ€ã€‚ ä¸€ä¸ªçŠ¶æ€ä¼šä»¥æœ€åå†™å…¥è€…èƒœå‡ºï¼ˆlast-write-winsï¼‰çš„æ–¹å¼ï¼ˆä¹Ÿå³æ˜¯ï¼Œæœ€æ–°çš„é…ç½®æ€»æ˜¯èƒœå‡ºï¼‰ä¼ æ’­è‡³æ‰€æœ‰å…¶ä»– Sentinel ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œ å½“å‡ºç°ç½‘ç»œåˆ†å‰²ï¼ˆnetwork partitionsï¼‰æ—¶ï¼Œ ä¸€ä¸ª Sentinel å¯èƒ½ä¼šåŒ…å«äº†è¾ƒæ—§çš„é…ç½®ï¼Œ è€Œå½“è¿™ä¸ª Sentinel æ¥åˆ°å…¶ä»– Sentinel å‘æ¥çš„ç‰ˆæœ¬æ›´æ–°çš„é…ç½®æ—¶ï¼Œ Sentinel å°±ä¼šå¯¹è‡ªå·±çš„é…ç½®è¿›è¡Œæ›´æ–°ã€‚</p>
<p>å¦‚æœè¦åœ¨ç½‘ç»œåˆ†å‰²å‡ºç°çš„æƒ…å†µä¸‹ä»ç„¶ä¿æŒä¸€è‡´æ€§ï¼Œ é‚£ä¹ˆåº”è¯¥ä½¿ç”¨ min-slaves-to-write é€‰é¡¹ï¼Œ è®©ä¸»æœåŠ¡å™¨åœ¨è¿æ¥çš„ä»å®ä¾‹å°‘äºç»™å®šæ•°é‡æ—¶åœæ­¢æ‰§è¡Œå†™æ“ä½œï¼Œ ä¸æ­¤åŒæ—¶ï¼Œ åº”è¯¥åœ¨æ¯ä¸ªè¿è¡Œ Redis ä¸»æœåŠ¡å™¨æˆ–ä»æœåŠ¡å™¨çš„æœºå™¨ä¸Šè¿è¡Œ Redis Sentinel è¿›ç¨‹ã€‚</p>
<div class="note success">
            <p><strong>Sentinel çŠ¶æ€çš„æŒä¹…åŒ–</strong></p>
          </div>
<p>Sentinel çš„çŠ¶æ€ä¼šè¢«æŒä¹…åŒ–åœ¨ Sentinel é…ç½®æ–‡ä»¶é‡Œé¢ã€‚</p>
<p>æ¯å½“ Sentinel æ¥æ”¶åˆ°ä¸€ä¸ªæ–°çš„é…ç½®ï¼Œ æˆ–è€…å½“é¢†å¤´ Sentinel ä¸ºä¸»æœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªæ–°çš„é…ç½®æ—¶ï¼Œ è¿™ä¸ªé…ç½®ä¼šä¸é…ç½®çºªå…ƒä¸€èµ·è¢«ä¿å­˜åˆ°ç£ç›˜é‡Œé¢ã€‚</p>
<p>è¿™æ„å‘³ç€åœæ­¢å’Œé‡å¯ Sentinel è¿›ç¨‹éƒ½æ˜¯å®‰å…¨çš„ã€‚</p>
<div class="note success">
            <p><strong>Sentinel åœ¨éæ•…éšœè¿ç§»çš„æƒ…å†µä¸‹å¯¹å®ä¾‹è¿›è¡Œé‡æ–°é…ç½®</strong></p>
          </div>
<p>å³ä½¿æ²¡æœ‰è‡ªåŠ¨æ•…éšœè¿ç§»æ“ä½œåœ¨è¿›è¡Œï¼Œ Sentinel æ€»ä¼šå°è¯•å°†å½“å‰çš„é…ç½®è®¾ç½®åˆ°è¢«ç›‘è§†çš„å®ä¾‹ä¸Šé¢ã€‚ ç‰¹åˆ«æ˜¯ï¼š</p>
<ul>
<li>æ ¹æ®å½“å‰çš„é…ç½®ï¼Œ å¦‚æœä¸€ä¸ªä»æœåŠ¡å™¨è¢«å®£å‘Šä¸ºä¸»æœåŠ¡å™¨ï¼Œ é‚£ä¹ˆå®ƒä¼šä»£æ›¿åŸæœ‰çš„ä¸»æœåŠ¡å™¨ï¼Œ æˆä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ï¼Œ å¹¶ä¸”æˆä¸ºåŸæœ‰ä¸»æœåŠ¡å™¨çš„æ‰€æœ‰ä»æœåŠ¡å™¨çš„å¤åˆ¶å¯¹è±¡ã€‚ é‚£äº›è¿æ¥äº†é”™è¯¯ä¸»æœåŠ¡å™¨çš„ä»æœåŠ¡å™¨ä¼šè¢«é‡æ–°é…ç½®ï¼Œ ä½¿å¾—è¿™äº›ä»æœåŠ¡å™¨ä¼šå»å¤åˆ¶æ­£ç¡®çš„ä¸»æœåŠ¡å™¨ã€‚</li>
</ul>
<p>ä¸è¿‡ï¼Œ åœ¨ä»¥ä¸Šè¿™äº›æ¡ä»¶æ»¡è¶³ä¹‹åï¼Œ Sentinel åœ¨å¯¹å®ä¾‹è¿›è¡Œé‡æ–°é…ç½®ä¹‹å‰ä»ç„¶ä¼šç­‰å¾…ä¸€æ®µè¶³å¤Ÿé•¿çš„æ—¶é—´ï¼Œ ç¡®ä¿å¯ä»¥æ¥æ”¶åˆ°å…¶ä»– Sentinel å‘æ¥çš„é…ç½®æ›´æ–°ï¼Œ ä»è€Œé¿å…è‡ªèº«å› ä¸ºä¿å­˜äº†è¿‡æœŸçš„é…ç½®è€Œå¯¹å®ä¾‹è¿›è¡Œäº†ä¸å¿…è¦çš„é‡æ–°é…ç½®ã€‚</p>
<div class="note success">
            <p><strong>TILT æ¨¡å¼</strong></p>
          </div>
<p>Redis Sentinel ä¸¥é‡ä¾èµ–è®¡ç®—æœºçš„æ—¶é—´åŠŸèƒ½ï¼š æ¯”å¦‚è¯´ï¼Œ ä¸ºäº†åˆ¤æ–­ä¸€ä¸ªå®ä¾‹æ˜¯å¦å¯ç”¨ï¼Œ Sentinel ä¼šè®°å½•è¿™ä¸ªå®ä¾‹æœ€åä¸€æ¬¡ç›¸åº” PING å‘½ä»¤çš„æ—¶é—´ï¼Œ å¹¶å°†è¿™ä¸ªæ—¶é—´å’Œå½“å‰æ—¶é—´è¿›è¡Œå¯¹æ¯”ï¼Œ ä»è€ŒçŸ¥é“è¿™ä¸ªå®ä¾‹æœ‰å¤šé•¿æ—¶é—´æ²¡æœ‰å’Œ Sentinel è¿›è¡Œä»»ä½•æˆåŠŸé€šè®¯ã€‚</p>
<p>ä¸è¿‡ï¼Œ ä¸€æ—¦è®¡ç®—æœºçš„æ—¶é—´åŠŸèƒ½å‡ºç°æ•…éšœï¼Œ æˆ–è€…è®¡ç®—æœºéå¸¸å¿™ç¢Œï¼Œ åˆæˆ–è€…è¿›ç¨‹å› ä¸ºæŸäº›åŸå› è€Œè¢«é˜»å¡æ—¶ï¼Œ Sentinel å¯èƒ½ä¹Ÿä¼šè·Ÿç€å‡ºç°æ•…éšœã€‚</p>
<p>TILT æ¨¡å¼æ˜¯ä¸€ç§ç‰¹æ®Šçš„ä¿æŠ¤æ¨¡å¼ï¼š å½“ Sentinel å‘ç°ç³»ç»Ÿæœ‰äº›ä¸å¯¹åŠ²æ—¶ï¼Œ Sentinel å°±ä¼šè¿›å…¥ TILT æ¨¡å¼ã€‚</p>
<p>å› ä¸º Sentinel çš„æ—¶é—´ä¸­æ–­å™¨é»˜è®¤æ¯ç§’æ‰§è¡Œ 10 æ¬¡ï¼Œ æ‰€ä»¥æˆ‘ä»¬é¢„æœŸæ—¶é—´ä¸­æ–­å™¨çš„ä¸¤æ¬¡æ‰§è¡Œä¹‹é—´çš„é—´éš”ä¸º 100 æ¯«ç§’å·¦å³ã€‚ Sentinel çš„åšæ³•æ˜¯ï¼Œ è®°å½•ä¸Šä¸€æ¬¡æ—¶é—´ä¸­æ–­å™¨æ‰§è¡Œæ—¶çš„æ—¶é—´ï¼Œ å¹¶å°†å®ƒå’Œè¿™ä¸€æ¬¡æ—¶é—´ä¸­æ–­å™¨æ‰§è¡Œçš„æ—¶é—´è¿›è¡Œå¯¹æ¯”ï¼š</p>
<ul>
<li>å¦‚æœä¸¤æ¬¡è°ƒç”¨æ—¶é—´ä¹‹é—´çš„å·®è·ä¸ºè´Ÿå€¼ï¼Œ æˆ–è€…éå¸¸å¤§ï¼ˆè¶…è¿‡ 2 ç§’é’Ÿï¼‰ï¼Œ é‚£ä¹ˆ Sentinel è¿›å…¥ TILT æ¨¡å¼ã€‚</li>
<li>å¦‚æœ Sentinel å·²ç»è¿›å…¥ TILT æ¨¡å¼ï¼Œ é‚£ä¹ˆ Sentinel å»¶è¿Ÿé€€å‡º TILT æ¨¡å¼çš„æ—¶é—´ã€‚</li>
</ul>
<p>å½“ Sentinel è¿›å…¥ TILT æ¨¡å¼æ—¶ï¼Œ å®ƒä»ç„¶ä¼šç»§ç»­ç›‘è§†æ‰€æœ‰ç›®æ ‡ï¼Œ ä½†æ˜¯ï¼š</p>
<ul>
<li>å®ƒä¸å†æ‰§è¡Œä»»ä½•æ“ä½œï¼Œæ¯”å¦‚æ•…éšœè½¬ç§»ã€‚</li>
<li>å½“æœ‰å®ä¾‹å‘è¿™ä¸ª Sentinel å‘é€ SENTINEL is-master-down-by-addr å‘½ä»¤æ—¶ï¼Œ Sentinel è¿”å›è´Ÿå€¼ï¼š å› ä¸ºè¿™ä¸ª Sentinel æ‰€è¿›è¡Œçš„ä¸‹çº¿åˆ¤æ–­å·²ç»ä¸å†å‡†ç¡®ã€‚</li>
</ul>
<p>å¦‚æœ TILT å¯ä»¥æ­£å¸¸ç»´æŒ 30 ç§’é’Ÿï¼Œ é‚£ä¹ˆ Sentinel é€€å‡º TILT æ¨¡å¼ã€‚</p>
<div class="note success">
            <p><strong>å¤„ç† -BUSY çŠ¶æ€</strong></p>
          </div>
<p>å½“ Lua è„šæœ¬çš„è¿è¡Œæ—¶é—´è¶…è¿‡æŒ‡å®šæ—¶é™æ—¶ï¼Œ Redis å°±ä¼šè¿”å› -BUSY é”™è¯¯ã€‚</p>
<p>å½“å‡ºç°è¿™ç§æƒ…å†µæ—¶ï¼Œ Sentinel åœ¨å°è¯•æ‰§è¡Œæ•…éšœè½¬ç§»æ“ä½œä¹‹å‰ï¼Œ ä¼šå…ˆå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ª SCRIPT KILL å‘½ä»¤ï¼Œ å¦‚æœæœåŠ¡å™¨æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªåªè¯»è„šæœ¬çš„è¯ï¼Œ é‚£ä¹ˆè¿™ä¸ªè„šæœ¬å°±ä¼šè¢«æ€æ­»ï¼Œ æœåŠ¡å™¨å°±ä¼šå›åˆ°æ­£å¸¸çŠ¶æ€ã€‚</p>
<h4 id="11-8ã€å“¨å…µæ¨¡å¼å®æˆ˜"><a href="#11-8ã€å“¨å…µæ¨¡å¼å®æˆ˜" class="headerlink" title="11.8ã€å“¨å…µæ¨¡å¼å®æˆ˜"></a>11.8ã€å“¨å…µæ¨¡å¼å®æˆ˜</h4><p>åˆ›å»ºé…ç½®æ–‡ä»¶ sentinel.conf</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment"># å“¨å…µå®ä¾‹è¿è¡Œç«¯å£</span></span><br><span class="line">port 26379</span><br><span class="line"></span><br><span class="line"><span class="comment"># å“¨å…µå·¥ä½œç›®å½•</span></span><br><span class="line">/tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># sentinel monitor &lt;master-name&gt; &lt;ip&gt; &lt;redis-port&gt; &lt;quorum&gt;</span></span><br><span class="line"><span class="comment"># quorum è¡¨ç¤ºæœ‰å¤šå°‘å“¨å…µè®¤ä¸ºä¸»æœåŠ¡å™¨ä¸»è§‚ä¸‹çº¿æ—¶ï¼Œé‚£ä¹ˆè¿™æ—¶ä¸»æœåŠ¡å™¨å°±å˜æˆäº†å®¢è§‚ä¸‹çº¿</span></span><br><span class="line">sentinel monitor mymaster 127.0.0.1 6379 1</span><br></pre></td></tr></tbody></table></figure>
<p><strong>å“¨å…µæ¨¡å¼é…ç½®å‚æ•°</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>é…ç½®é¡¹</th>
<th>å‚æ•°ç±»å‹</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>port</td>
<td>æ•´æ•°</td>
<td>å¯åŠ¨å“¨å…µè¿›ç¨‹ç«¯å£</td>
</tr>
<tr>
<td>dir</td>
<td>æ–‡ä»¶å¤¹ç›®å½•</td>
<td>å“¨å…µè¿›ç¨‹æœåŠ¡ä¸´æ—¶æ–‡ä»¶å¤¹ï¼Œé»˜è®¤ä¸º/tmpï¼Œè¦ä¿è¯æœ‰å¯å†™å…¥çš„æƒé™</td>
</tr>
<tr>
<td>sentinel down-after-milliseconds</td>
<td>&lt;æœåŠ¡åç§°&gt;&lt;æ¯«ç§’æ•°ï¼ˆæ•´æ•°ï¼‰&gt;</td>
<td>æŒ‡å®šå“¨å…µåœ¨ç›‘æ§RedisæœåŠ¡æ—¶ï¼Œå½“RedisæœåŠ¡åœ¨ä¸€ä¸ªé»˜è®¤æ¯«ç§’æ•°å†…éƒ½æ— æ³•å›ç­”æ—¶ï¼Œå•ä¸ªå“¨å…µè®¤ä¸ºçš„ä¸»è§‚ä¸‹çº¿æ—¶é—´ï¼Œé»˜è®¤ä¸º30000ï¼ˆ30ç§’ï¼‰</td>
</tr>
<tr>
<td>sentinel parallel-syncs</td>
<td>&lt;æœåŠ¡åç§°&gt;&lt;æœåŠ¡å™¨æ•°ï¼ˆæ•´æ•°ï¼‰&gt;</td>
<td>æŒ‡å®šå¯ä»¥æœ‰å¤šå°‘ä¸ªRedisæœåŠ¡åŒæ­¥æ–°çš„ä¸»æœºï¼Œä¸€èˆ¬è€Œè¨€ï¼Œè¿™ä¸ªæ•°å­—è¶Šå°åŒæ­¥æ—¶é—´è¶Šé•¿ï¼Œè€Œè¶Šå¤§ï¼Œåˆ™å¯¹ç½‘ç»œèµ„æºè¦æ±‚è¶Šé«˜</td>
</tr>
<tr>
<td>sentinel failover-timeout</td>
<td>&lt;æœåŠ¡åç§°&gt;&lt;æ¯«ç§’æ•°ï¼ˆæ•´æ•°ï¼‰&gt;</td>
<td>æŒ‡å®šæ•…éšœåˆ‡æ¢å…è®¸çš„æ¯«ç§’æ•°ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´ï¼Œå°±è®¤ä¸ºæ•…éšœåˆ‡æ¢å¤±è´¥ï¼Œé»˜è®¤ä¸º3åˆ†é’Ÿ</td>
</tr>
<tr>
<td>sentinel notification-script</td>
<td>&lt;æœåŠ¡åç§°&gt;&lt;è„šæœ¬è·¯å¾„&gt;</td>
<td>æŒ‡å®šsentinelæ£€æµ‹åˆ°è¯¥ç›‘æ§çš„rediså®ä¾‹æŒ‡å‘çš„å®ä¾‹å¼‚å¸¸æ—¶ï¼Œè°ƒç”¨çš„æŠ¥è­¦è„šæœ¬ã€‚è¯¥é…ç½®é¡¹å¯é€‰ï¼Œæ¯”è¾ƒå¸¸ç”¨</td>
</tr>
</tbody>
</table>
</div>
<p><strong>è¿è¡Œå“¨å…µè¿›ç¨‹</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@deflory src]<span class="comment"># ./redis-sentinel ../master-slaver-config/sentinel.conf </span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>æŸ¥çœ‹å“¨å…µè¿›ç¨‹</strong></p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">[root@deflory src]<span class="comment"># ps -ef|grep sentinel</span></span><br><span class="line">root     14853     1  0 20:54 ?        00:00:00 ./redis-sentinel *:26379 [sentinel]</span><br><span class="line">root     15149 28363  0 20:54 pts/2    00:00:00 grep --color=auto sentinel</span><br></pre></td></tr></tbody></table></figure>
<p>æ¥ä¸‹æ¥é…ç½®ä¸»ä»å¤åˆ¶ï¼Œè¿™é‡Œæˆ‘ä»¬ä»ç„¶é€‰æ‹©<strong>ä¸€ä¸»äºŒä»</strong>çš„æ¨¡å¼ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:2</span><br><span class="line">slave0:ip=127.0.0.1,port=6381,state=online,offset=25982,lag=0</span><br><span class="line">slave1:ip=127.0.0.1,port=6380,state=online,offset=25982,lag=0</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:3c7139ce2e8248ef2ea5d79c00387b3356c16e14</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:25982</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:72</span><br><span class="line">repl_backlog_histlen:25911</span><br></pre></td></tr></tbody></table></figure>
<p>å…³é—­ä¸»æœåŠ¡å™¨ï¼ˆç«¯å£6379ï¼‰ï¼Œå“¨å…µè¿›ç¨‹å°±å¼€å§‹å·¥ä½œäº†ï¼Œå°†ä¸»æœåŠ¡å™¨çš„èº«ä»½ç§»ç»™äº†ä»æœåŠ¡å™¨ï¼ˆç«¯å£6380ï¼‰ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">32507:X 28 Nov 2021 21:06:51.180 <span class="comment"># +failover-end master mymaster 127.0.0.1 6379</span></span><br><span class="line">32507:X 28 Nov 2021 21:06:51.180 <span class="comment"># +switch-master mymaster 127.0.0.1 6379 127.0.0.1 6380</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6380&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:1</span><br><span class="line">slave0:ip=127.0.0.1,port=6381,state=online,offset=37163,lag=1</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:c8d0b6a5529667f15d6322888a45a8f42ca1e5b9</span><br><span class="line">master_replid2:3c7139ce2e8248ef2ea5d79c00387b3356c16e14</span><br><span class="line">master_repl_offset:37296</span><br><span class="line">second_repl_offset:36595</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:22964</span><br><span class="line">repl_backlog_histlen:14333</span><br></pre></td></tr></tbody></table></figure>
<p>ç´§æ¥ç€æˆ‘å†æŠŠå½“å‰æ–°çš„ä¸»æœåŠ¡å™¨å…³é—­ï¼Œç°åœ¨åªå‰©ä¸€å°æœåŠ¡å™¨ï¼Œç†æ‰€å½“ç„¶å°±æˆä¸ºäº†ä¸»æœåŠ¡å™¨ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">32507:X 28 Nov 2021 21:09:07.218 <span class="comment"># +failover-end master mymaster 127.0.0.1 6380</span></span><br><span class="line">32507:X 28 Nov 2021 21:09:07.218 <span class="comment"># +switch-master mymaster 127.0.0.1 6380 127.0.0.1 6381</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6381&gt; info replication</span><br><span class="line">Error: Server closed the connection</span><br><span class="line">127.0.0.1:6381&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:0</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:8203b47d316f6e313b7512a9d78c9ea12ff10d42</span><br><span class="line">master_replid2:c8d0b6a5529667f15d6322888a45a8f42ca1e5b9</span><br><span class="line">master_repl_offset:44095</span><br><span class="line">second_repl_offset:43674</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:13301</span><br><span class="line">repl_backlog_histlen:30795</span><br></pre></td></tr></tbody></table></figure>
<p>æ­¤æ—¶å†å°†åŸæ¥çš„ä¸»æœåŠ¡å™¨ï¼ˆç«¯å£6379ï¼‰é‡æ–°è¿æ¥ï¼Œç›´æ¥å°±å˜æˆäº†ç°ä¸»æœåŠ¡å™¨çš„ä»æœåŠ¡å™¨ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">32507:X 28 Nov 2021 21:11:08.150 * +convert-to-slave slave 127.0.0.1:6379 127.0.0.1 6379 @ mymaster 127.0.0.1 6381</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6379&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:slave</span><br><span class="line">master_host:127.0.0.1</span><br><span class="line">master_port:6381</span><br><span class="line">master_link_status:up</span><br><span class="line">master_last_io_seconds_ago:1</span><br><span class="line">master_sync_in_progress:0</span><br><span class="line">slave_read_repl_offset:63627</span><br><span class="line">slave_repl_offset:63627</span><br><span class="line">slave_priority:100</span><br><span class="line">slave_read_only:1</span><br><span class="line">replica_announced:1</span><br><span class="line">connected_slaves:0</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:8203b47d316f6e313b7512a9d78c9ea12ff10d42</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:63627</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:51544</span><br><span class="line">repl_backlog_histlen:12084</span><br></pre></td></tr></tbody></table></figure>
<p>åŸæ¥çš„ä»æœåŠ¡å™¨ï¼ˆç«¯å£6380ï¼‰å°±æ›´æ˜¯å¦‚æ­¤äº†ã€‚</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">32507:X 28 Nov 2021 21:14:49.324 * +convert-to-slave slave 127.0.0.1:6380 127.0.0.1 6380 @ mymaster 127.0.0.1 6381</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">127.0.0.1:6380&gt; info replication</span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:slave</span><br><span class="line">master_host:127.0.0.1</span><br><span class="line">master_port:6381</span><br><span class="line">master_link_status:up</span><br><span class="line">master_last_io_seconds_ago:0</span><br><span class="line">master_sync_in_progress:0</span><br><span class="line">slave_read_repl_offset:69747</span><br><span class="line">slave_repl_offset:69747</span><br><span class="line">slave_priority:100</span><br><span class="line">slave_read_only:1</span><br><span class="line">replica_announced:1</span><br><span class="line">connected_slaves:0</span><br><span class="line">master_failover_state:no-failover</span><br><span class="line">master_replid:8203b47d316f6e313b7512a9d78c9ea12ff10d42</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:69747</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:66211</span><br><span class="line">repl_backlog_histlen:3537</span><br></pre></td></tr></tbody></table></figure>
<h2 id="åäºŒã€ç¼“å­˜é—®é¢˜"><a href="#åäºŒã€ç¼“å­˜é—®é¢˜" class="headerlink" title="åäºŒã€ç¼“å­˜é—®é¢˜"></a>åäºŒã€ç¼“å­˜é—®é¢˜</h2><h4 id="11-1ã€ç¼“å­˜é›ªå´©"><a href="#11-1ã€ç¼“å­˜é›ªå´©" class="headerlink" title="11.1ã€ç¼“å­˜é›ªå´©"></a>11.1ã€ç¼“å­˜é›ªå´©</h4><p>å½“æŸä¸€ä¸ªæ—¶åˆ»å‡ºç°å¤§è§„æ¨¡çš„ç¼“å­˜å¤±æ•ˆçš„æƒ…å†µï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´å¤§é‡çš„è¯·æ±‚ç›´æ¥æ‰“åœ¨æ•°æ®åº“ä¸Šé¢ï¼Œå¯¼è‡´æ•°æ®åº“å‹åŠ›å·¨å¤§ï¼Œå¦‚æœåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ç¬é—´å°±ä¼šå¯¼è‡´æ•°æ®åº“å®•æœºã€‚è¿™æ—¶å€™å¦‚æœè¿ç»´é©¬ä¸Šåˆé‡å¯æ•°æ®åº“ï¼Œé©¬ä¸Šåˆä¼šæœ‰æ–°çš„æµé‡æŠŠæ•°æ®åº“æ‰“æ­»ã€‚è¿™å°±æ˜¯ç¼“å­˜é›ªå´©ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/11/28/ouvfZ8.png" alt=""></p>
<p><strong><font size="4px">åˆ†æï¼š</font></strong></p>
<p>é€ æˆç¼“å­˜é›ªå´©çš„å…³é”®åœ¨äºåœ¨åŒä¸€æ—¶é—´å¤§è§„æ¨¡çš„keyå¤±æ•ˆã€‚ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªé—®é¢˜å‘¢ï¼Œæœ‰å‡ ç§å¯èƒ½ï¼Œç¬¬ä¸€ç§å¯èƒ½æ˜¯ Redis å®•æœºï¼Œç¬¬äºŒç§å¯èƒ½æ˜¯é‡‡ç”¨äº†ç›¸åŒçš„è¿‡æœŸæ—¶é—´ï¼ˆè´­ç‰©èŠ‚é›¶ç‚¹ç§’æ€ï¼Œå¤§é‡å•†å“åŒæ—¶å¤±æ•ˆï¼‰ã€‚ææ¸…æ¥šåŸå› ä¹‹åï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆè§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿ</p>
<p><strong><font size="4px">è§£å†³æ–¹æ¡ˆï¼š</font></strong></p>
<ol>
<li>åœ¨åŸæœ‰çš„å¤±æ•ˆæ—¶é—´ä¸ŠåŠ ä¸Šä¸€ä¸ªéšæœºå€¼ï¼Œæ¯”å¦‚1-5åˆ†é’Ÿéšæœºã€‚è¿™æ ·å°±é¿å…äº†å› ä¸ºé‡‡ç”¨ç›¸åŒçš„è¿‡æœŸæ—¶é—´å¯¼è‡´çš„ç¼“å­˜é›ªå´©ã€‚</li>
<li>ä½¿ç”¨ç†”æ–­æœºåˆ¶ã€‚å½“æµé‡åˆ°è¾¾ä¸€å®šçš„é˜ˆå€¼æ—¶ï¼Œå°±ç›´æ¥è¿”å›â€œç³»ç»Ÿæ‹¥æŒ¤â€ä¹‹ç±»çš„æç¤ºï¼Œé˜²æ­¢è¿‡å¤šçš„è¯·æ±‚æ‰“åœ¨æ•°æ®åº“ä¸Šã€‚è‡³å°‘èƒ½ä¿è¯ä¸€éƒ¨åˆ†ç”¨æˆ·æ˜¯å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œå…¶ä»–ç”¨æˆ·å¤šåˆ·æ–°å‡ æ¬¡ä¹Ÿèƒ½å¾—åˆ°ç»“æœã€‚</li>
<li>æé«˜æ•°æ®åº“çš„å®¹ç¾èƒ½åŠ›ï¼Œå¯ä»¥ä½¿ç”¨åˆ†åº“åˆ†è¡¨ï¼Œè¯»å†™åˆ†ç¦»çš„ç­–ç•¥ã€‚</li>
<li>ä¸ºäº†é˜²æ­¢Rediså®•æœºå¯¼è‡´ç¼“å­˜é›ªå´©çš„é—®é¢˜ï¼Œå¯ä»¥æ­å»ºRedisé›†ç¾¤ï¼Œæé«˜Redisçš„å®¹ç¾æ€§ã€‚</li>
</ol>
<p><br></p>
<h4 id="11-2ã€ç¼“å­˜å‡»ç©¿"><a href="#11-2ã€ç¼“å­˜å‡»ç©¿" class="headerlink" title="11.2ã€ç¼“å­˜å‡»ç©¿"></a>11.2ã€ç¼“å­˜å‡»ç©¿</h4><p>å…¶å®è·Ÿç¼“å­˜é›ªå´©æœ‰ç‚¹ç±»ä¼¼ï¼Œç¼“å­˜é›ªå´©æ˜¯å¤§è§„æ¨¡çš„keyå¤±æ•ˆï¼Œè€Œç¼“å­˜å‡»ç©¿æ˜¯ä¸€ä¸ªçƒ­ç‚¹çš„Keyï¼Œæœ‰å¤§å¹¶å‘é›†ä¸­å¯¹å…¶è¿›è¡Œè®¿é—®ï¼Œçªç„¶é—´è¿™ä¸ªKeyå¤±æ•ˆäº†ï¼Œå¯¼è‡´å¤§å¹¶å‘å…¨éƒ¨æ‰“åœ¨æ•°æ®åº“ä¸Šï¼Œå¯¼è‡´æ•°æ®åº“å‹åŠ›å‰§å¢ã€‚è¿™ç§ç°è±¡å°±å«åšç¼“å­˜å‡»ç©¿ã€‚</p>
<p><strong><font size="4px">åˆ†æï¼š</font></strong></p>
<p>å…³é”®åœ¨äºæŸä¸ªçƒ­ç‚¹çš„keyå¤±æ•ˆäº†ï¼Œå¯¼è‡´å¤§å¹¶å‘é›†ä¸­æ‰“åœ¨æ•°æ®åº“ä¸Šã€‚æ‰€ä»¥è¦ä»ä¸¤ä¸ªæ–¹é¢è§£å†³ï¼Œç¬¬ä¸€æ˜¯å¦å¯ä»¥è€ƒè™‘çƒ­ç‚¹keyä¸è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œç¬¬äºŒæ˜¯å¦å¯ä»¥è€ƒè™‘é™ä½æ‰“åœ¨æ•°æ®åº“ä¸Šçš„è¯·æ±‚æ•°é‡ã€‚</p>
<p><strong><font size="4px">è§£å†³æ–¹æ¡ˆï¼š</font></strong></p>
<ol>
<li>å¦‚æœä¸šåŠ¡å…è®¸çš„è¯ï¼Œå¯¹äºçƒ­ç‚¹çš„ key å¯ä»¥è®¾ç½®æ°¸ä¸è¿‡æœŸã€‚</li>
<li>ä½¿ç”¨äº’æ–¥é”ã€‚å¦‚æœç¼“å­˜å¤±æ•ˆçš„æƒ…å†µï¼Œåªæœ‰æ‹¿åˆ°é”æ‰å¯ä»¥æŸ¥è¯¢æ•°æ®åº“ï¼Œé™ä½äº†åœ¨åŒä¸€æ—¶åˆ»æ‰“åœ¨æ•°æ®åº“ä¸Šçš„è¯·æ±‚ï¼Œé˜²æ­¢æ•°æ®åº“æ‰“æ­»ã€‚å½“ç„¶è¿™æ ·ä¼šå¯¼è‡´ç³»ç»Ÿçš„æ€§èƒ½å˜å·®ã€‚</li>
</ol>
<p><br></p>
<h4 id="11-3ã€ç¼“å­˜ç©¿é€"><a href="#11-3ã€ç¼“å­˜ç©¿é€" class="headerlink" title="11.3ã€ç¼“å­˜ç©¿é€"></a>11.3ã€ç¼“å­˜ç©¿é€</h4><p>æˆ‘ä»¬ä½¿ç”¨Rediså¤§éƒ¨åˆ†æƒ…å†µéƒ½æ˜¯é€šè¿‡KeyæŸ¥è¯¢å¯¹åº”çš„å€¼ï¼Œå‡å¦‚å‘é€çš„è¯·æ±‚ä¼ è¿›æ¥çš„keyæ˜¯ä¸å­˜åœ¨Redisä¸­çš„ï¼Œé‚£ä¹ˆå°±æŸ¥ä¸åˆ°ç¼“å­˜ï¼ŒæŸ¥ä¸åˆ°ç¼“å­˜å°±ä¼šå»æ•°æ®åº“æŸ¥è¯¢ã€‚å‡å¦‚æœ‰å¤§é‡è¿™æ ·çš„è¯·æ±‚ï¼Œè¿™äº›è¯·æ±‚åƒâ€œç©¿é€â€äº†ç¼“å­˜ä¸€æ ·ç›´æ¥æ‰“åœ¨æ•°æ®åº“ä¸Šï¼Œè¿™ç§ç°è±¡å°±å«åšç¼“å­˜ç©¿é€ã€‚</p>
<p><strong><font size="4px">åˆ†æï¼š</font></strong></p>
<p>å…³é”®åœ¨äºåœ¨RedisæŸ¥ä¸åˆ°keyå€¼ï¼Œè¿™å’Œç¼“å­˜å‡»ç©¿æœ‰æ ¹æœ¬çš„åŒºåˆ«ï¼ŒåŒºåˆ«åœ¨äº<strong>ç¼“å­˜ç©¿é€çš„æƒ…å†µæ˜¯ä¼ è¿›æ¥çš„keyåœ¨Redisä¸­æ˜¯ä¸å­˜åœ¨çš„</strong>ã€‚å‡å¦‚æœ‰é»‘å®¢ä¼ è¿›å¤§é‡çš„ä¸å­˜åœ¨çš„keyï¼Œé‚£ä¹ˆå¤§é‡çš„è¯·æ±‚æ‰“åœ¨æ•°æ®åº“ä¸Šæ˜¯å¾ˆè‡´å‘½çš„é—®é¢˜ï¼Œæ‰€ä»¥åœ¨æ—¥å¸¸å¼€å‘ä¸­è¦å¯¹å‚æ•°åšå¥½æ ¡éªŒï¼Œä¸€äº›éæ³•çš„å‚æ•°ï¼Œä¸å¯èƒ½å­˜åœ¨çš„keyå°±ç›´æ¥è¿”å›é”™è¯¯æç¤ºï¼Œè¦å¯¹è°ƒç”¨æ–¹ä¿æŒè¿™ç§â€œä¸ä¿¡ä»»â€çš„å¿ƒæ€ã€‚</p>
<p><strong><font size="4px">è§£å†³æ–¹æ¡ˆï¼š</font></strong></p>
<ol>
<li><strong>æŠŠæ— æ•ˆçš„Keyå­˜è¿›Redisä¸­</strong>ã€‚å¦‚æœRedisæŸ¥ä¸åˆ°æ•°æ®ï¼Œæ•°æ®åº“ä¹ŸæŸ¥ä¸åˆ°ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªKeyå€¼ä¿å­˜è¿›Redisï¼Œè®¾ç½®value=â€nullâ€ï¼Œå½“ä¸‹æ¬¡å†é€šè¿‡è¿™ä¸ªKeyæŸ¥è¯¢æ—¶å°±ä¸éœ€è¦å†æŸ¥è¯¢æ•°æ®åº“ã€‚è¿™ç§å¤„ç†æ–¹å¼è‚¯å®šæ˜¯æœ‰é—®é¢˜çš„ï¼Œå‡å¦‚ä¼ è¿›æ¥çš„è¿™ä¸ªä¸å­˜åœ¨çš„Keyå€¼æ¯æ¬¡éƒ½æ˜¯éšæœºçš„ï¼Œé‚£å­˜è¿›Redisä¹Ÿæ²¡æœ‰æ„ä¹‰ã€‚</li>
<li><strong>ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨</strong>ã€‚å¸ƒéš†è¿‡æ»¤å™¨çš„ä½œç”¨æ˜¯æŸä¸ª key ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°±ä¸€å®šä¸å­˜åœ¨ï¼Œå®ƒè¯´æŸä¸ª key å­˜åœ¨ï¼Œé‚£ä¹ˆå¾ˆå¤§å¯èƒ½æ˜¯å­˜åœ¨(å­˜åœ¨ä¸€å®šçš„è¯¯åˆ¤ç‡)ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨ç¼“å­˜ä¹‹å‰å†åŠ ä¸€å±‚å¸ƒéš†è¿‡æ»¤å™¨ï¼Œåœ¨æŸ¥è¯¢çš„æ—¶å€™å…ˆå»å¸ƒéš†è¿‡æ»¤å™¨æŸ¥è¯¢ key æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±ç›´æ¥è¿”å›ã€‚</li>
</ol>
<p><img src="https://z3.ax1x.com/2021/11/28/ouxz0f.png" alt="image"></p>
<p><br></p>
<h4 id="11-4ã€å°ç»“"><a href="#11-4ã€å°ç»“" class="headerlink" title="11.4ã€å°ç»“"></a>11.4ã€å°ç»“</h4><p>è¿™ä¸‰ä¸ªé—®é¢˜åœ¨ä½¿ç”¨Redisçš„æ—¶å€™æ˜¯è‚¯å®šä¼šé‡åˆ°çš„ï¼Œè€Œä¸”æ˜¯éå¸¸è‡´å‘½æ€§çš„é—®é¢˜ï¼Œæ‰€ä»¥åœ¨æ—¥å¸¸å¼€å‘ä¸­ä¸€å®šè¦æ³¨æ„ï¼Œæ¯æ¬¡ä½¿ç”¨Redisæ—¶ï¼Œéƒ½è¦å¯¹å…¶ä¿æŒä¸¥è°¨çš„æ€åº¦ã€‚è¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯è¦åšå¥½ç†”æ–­ï¼Œä¸€æ—¦å‡ºç°ç¼“å­˜é›ªå´©ï¼Œå‡»ç©¿ï¼Œç©¿é€è¿™ç§æƒ…å†µï¼Œè‡³å°‘è¿˜æœ‰ç†”æ–­æœºåˆ¶ä¿æŠ¤æ•°æ®åº“ä¸ä¼šè¢«æ‰“æ­»ã€‚</p>
]]></content>
      <categories>
        <category>DataBase System</category>
      </categories>
      <tags>
        <tag>NoSQL</tag>
      </tags>
  </entry>
</search>
